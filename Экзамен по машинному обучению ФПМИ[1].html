<!DOCTYPE html>

<html lang="en">

<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <meta name="mobile-web-app-capable" content="yes">
    <title>
        Экзамен по машинному обучению ФПМИ[1] - HackMD
    </title>
    <link rel="icon" type="image/png" href="https://hackmd.io/favicon.png">
    <link rel="apple-touch-icon" href="https://hackmd.io/apple-touch-icon.png">

    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha256-916EbMg70RQy9LHiGkXzG8hSg9EdNy97GazNG/aiY1w=" crossorigin="anonymous" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css" integrity="sha256-eZrrJcwDc/3uDhsdt61sL2oOBY362qM3lon1gyExkL0=" crossorigin="anonymous" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/ionicons/2.0.1/css/ionicons.min.css" integrity="sha256-3iu9jgsy9TpTwXKb7bNQzqWekRX7pPK+2OLj3R922fo=" crossorigin="anonymous" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/octicons/3.5.0/octicons.min.css" integrity="sha256-QiWfLIsCT02Sdwkogf6YMiQlj4NE84MKkzEMkZnMGdg=" crossorigin="anonymous" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.5.1/themes/prism.min.css" integrity="sha256-vtR0hSWRc3Tb26iuN2oZHt3KRUomwTufNIf5/4oeCyg=" crossorigin="anonymous" />
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@hackmd/emojify.js@2.1.0/dist/css/basic/emojify.min.css" integrity="sha256-UOrvMOsSDSrW6szVLe8ZDZezBxh5IoIfgTwdNDgTjiU=" crossorigin="anonymous" />
    <style>
        @charset "UTF-8";@import url(https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,500,500i|Source+Code+Pro:300,400,500|Source+Sans+Pro:300,300i,400,400i,600,600i|Source+Serif+Pro&subset=latin-ext);.hljs{display:block;background:#fff;padding:.5em;color:#333;overflow-x:auto}.hljs-comment,.hljs-meta{color:#969896}.hljs-emphasis,.hljs-quote,.hljs-string,.hljs-strong,.hljs-template-variable,.hljs-variable{color:#df5000}.hljs-keyword,.hljs-selector-tag,.hljs-type{color:#a71d5d}.hljs-attribute,.hljs-bullet,.hljs-literal,.hljs-number,.hljs-symbol{color:#0086b3}.hljs-built_in,.hljs-builtin-name{color:#005cc5}.hljs-name,.hljs-section{color:#63a35c}.hljs-tag{color:#333}.hljs-attr,.hljs-selector-attr,.hljs-selector-class,.hljs-selector-id,.hljs-selector-pseudo,.hljs-title{color:#795da3}.hljs-addition{color:#55a532;background-color:#eaffea}.hljs-deletion{color:#bd2c00;background-color:#ffecec}.hljs-link{text-decoration:underline}.markdown-body{font-size:16px;line-height:1.5;word-wrap:break-word}.markdown-body:after,.markdown-body:before{display:table;content:""}.markdown-body:after{clear:both}.markdown-body>:first-child{margin-top:0!important}.markdown-body>:last-child{margin-bottom:0!important}.markdown-body a:not([href]){color:inherit;text-decoration:none}.markdown-body .absent{color:#c00}.markdown-body .anchor{float:left;padding-right:4px;margin-left:-20px;line-height:1}.markdown-body .anchor:focus{outline:none}.markdown-body blockquote,.markdown-body dl,.markdown-body ol,.markdown-body p,.markdown-body pre,.markdown-body table,.markdown-body ul{margin-top:0;margin-bottom:16px}.markdown-body hr{height:.25em;padding:0;margin:24px 0;background-color:#e7e7e7;border:0}.markdown-body blockquote{font-size:16px;padding:0 1em;color:#777;border-left:.25em solid #ddd}.markdown-body blockquote>:first-child{margin-top:0}.markdown-body blockquote>:last-child{margin-bottom:0}.markdown-body kbd,.popover kbd{display:inline-block;padding:3px 5px;font-size:11px;line-height:10px;color:#555;vertical-align:middle;background-color:#fcfcfc;border:1px solid #ccc;border-bottom-color:#bbb;border-radius:3px;box-shadow:inset 0 -1px 0 #bbb}.markdown-body .loweralpha{list-style-type:lower-alpha}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{margin-top:24px;margin-bottom:16px;font-weight:600;line-height:1.25}.markdown-body h1 .octicon-link,.markdown-body h2 .octicon-link,.markdown-body h3 .octicon-link,.markdown-body h4 .octicon-link,.markdown-body h5 .octicon-link,.markdown-body h6 .octicon-link{color:#000;vertical-align:middle;visibility:hidden}.markdown-body h1:hover .anchor,.markdown-body h2:hover .anchor,.markdown-body h3:hover .anchor,.markdown-body h4:hover .anchor,.markdown-body h5:hover .anchor,.markdown-body h6:hover .anchor{text-decoration:none}.markdown-body h1:hover .anchor .octicon-link,.markdown-body h2:hover .anchor .octicon-link,.markdown-body h3:hover .anchor .octicon-link,.markdown-body h4:hover .anchor .octicon-link,.markdown-body h5:hover .anchor .octicon-link,.markdown-body h6:hover .anchor .octicon-link{visibility:visible}.markdown-body h1 code,.markdown-body h1 tt,.markdown-body h2 code,.markdown-body h2 tt,.markdown-body h3 code,.markdown-body h3 tt,.markdown-body h4 code,.markdown-body h4 tt,.markdown-body h5 code,.markdown-body h5 tt,.markdown-body h6 code,.markdown-body h6 tt{font-size:inherit}.markdown-body h1{font-size:2em}.markdown-body h1,.markdown-body h2{padding-bottom:.3em;border-bottom:1px solid #eee}.markdown-body h2{font-size:1.5em}.markdown-body h3{font-size:1.25em}.markdown-body h4{font-size:1em}.markdown-body h5{font-size:.875em}.markdown-body h6{font-size:.85em;color:#777}.markdown-body ol,.markdown-body ul{padding-left:2em}.markdown-body ol.no-list,.markdown-body ul.no-list{padding:0;list-style-type:none}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:0;margin-bottom:0}.markdown-body li>p{margin-top:16px}.markdown-body li+li{padding-top:.25em}.markdown-body dl{padding:0}.markdown-body dl dt{padding:0;margin-top:16px;font-size:1em;font-style:italic;font-weight:700}.markdown-body dl dd{padding:0 16px;margin-bottom:16px}.markdown-body table{display:block;width:100%;overflow:auto;word-break:normal;word-break:keep-all}.markdown-body table th{font-weight:700}.markdown-body table td,.markdown-body table th{padding:6px 13px;border:1px solid #ddd}.markdown-body table tr{background-color:#fff;border-top:1px solid #ccc}.markdown-body table tr:nth-child(2n){background-color:#f8f8f8}.markdown-body img{max-width:100%;box-sizing:content-box;background-color:#fff}.markdown-body img[align=right]{padding-left:20px}.markdown-body img[align=left]{padding-right:20px}.markdown-body .emoji{max-width:none;vertical-align:text-top;background-color:transparent}.markdown-body span.frame{display:block;overflow:hidden}.markdown-body span.frame>span{display:block;float:left;width:auto;padding:7px;margin:13px 0 0;overflow:hidden;border:1px solid #ddd}.markdown-body span.frame span img{display:block;float:left}.markdown-body span.frame span span{display:block;padding:5px 0 0;clear:both;color:#333}.markdown-body span.align-center{display:block;overflow:hidden;clear:both}.markdown-body span.align-center>span{display:block;margin:13px auto 0;overflow:hidden;text-align:center}.markdown-body span.align-center span img{margin:0 auto;text-align:center}.markdown-body span.align-right{display:block;overflow:hidden;clear:both}.markdown-body span.align-right>span{display:block;margin:13px 0 0;overflow:hidden;text-align:right}.markdown-body span.align-right span img{margin:0;text-align:right}.markdown-body span.float-left{display:block;float:left;margin-right:13px;overflow:hidden}.markdown-body span.float-left span{margin:13px 0 0}.markdown-body span.float-right{display:block;float:right;margin-left:13px;overflow:hidden}.markdown-body span.float-right>span{display:block;margin:13px auto 0;overflow:hidden;text-align:right}.markdown-body code,.markdown-body tt{padding:0;padding-top:.2em;padding-bottom:.2em;margin:0;font-size:85%;background-color:rgba(0,0,0,.04);border-radius:3px}.markdown-body code:after,.markdown-body code:before,.markdown-body tt:after,.markdown-body tt:before{letter-spacing:-.2em;content:"\00a0"}.markdown-body code br,.markdown-body tt br{display:none}.markdown-body del code{text-decoration:inherit}.markdown-body pre{word-wrap:normal}.markdown-body pre>code{padding:0;margin:0;font-size:100%;word-break:normal;white-space:pre;background:transparent;border:0}.markdown-body .highlight{margin-bottom:16px}.markdown-body .highlight pre{margin-bottom:0;word-break:normal}.markdown-body .highlight pre,.markdown-body pre{padding:16px;overflow:auto;font-size:85%;line-height:1.45;background-color:#f7f7f7;border-radius:3px}.markdown-body pre code,.markdown-body pre tt{display:inline;max-width:auto;padding:0;margin:0;overflow:visible;line-height:inherit;word-wrap:normal;background-color:transparent;border:0}.markdown-body pre code:after,.markdown-body pre code:before,.markdown-body pre tt:after,.markdown-body pre tt:before{content:normal}.markdown-body .csv-data td,.markdown-body .csv-data th{padding:5px;overflow:hidden;font-size:12px;line-height:1;text-align:left;white-space:nowrap}.markdown-body .csv-data .blob-line-num{padding:10px 8px 9px;text-align:right;background:#fff;border:0}.markdown-body .csv-data tr{border-top:0}.markdown-body .csv-data th{font-weight:700;background:#f8f8f8;border-top:0}.news .alert .markdown-body blockquote{padding:0 0 0 40px;border:0 none}.activity-tab .news .alert .commits,.activity-tab .news .markdown-body blockquote{padding-left:0}.task-list-item{list-style-type:none}.task-list-item label{font-weight:400}.task-list-item.enabled label{cursor:pointer}.task-list-item+.task-list-item{margin-top:3px}.task-list-item-checkbox{float:left;margin:.31em 0 .2em -1.3em!important;vertical-align:middle;cursor:default!important}.markdown-body{padding-top:40px;padding-bottom:40px;max-width:758px;overflow:visible!important;position:relative}.markdown-body .emoji{vertical-align:top}.markdown-body pre{border:inherit!important}.markdown-body code{color:inherit!important}.markdown-body pre code .wrapper{display:-moz-inline-flex;display:-ms-inline-flex;display:-o-inline-flex;display:inline-flex}.markdown-body pre code .gutter{float:left;overflow:hidden;-webkit-user-select:none;user-select:none}.markdown-body pre code .gutter.linenumber{text-align:right;position:relative;display:inline-block;cursor:default;z-index:4;padding:0 8px 0 0;min-width:20px;box-sizing:content-box;color:#afafaf!important;border-right:3px solid #6ce26c!important}.markdown-body pre code .gutter.linenumber>span:before{content:attr(data-linenumber)}.markdown-body pre code .code{float:left;margin:0 0 0 16px}.markdown-body .gist .line-numbers{border-left:none;border-top:none;border-bottom:none}.markdown-body .gist .line-data{border:none}.markdown-body .gist table{border-spacing:0;border-collapse:inherit!important}.markdown-body code[data-gist-id]{background:none;padding:0}.markdown-body code[data-gist-id]:after,.markdown-body code[data-gist-id]:before{content:""}.markdown-body code[data-gist-id] .blob-num{border:unset}.markdown-body code[data-gist-id] table{overflow:unset;margin-bottom:unset}.markdown-body code[data-gist-id] table tr{background:unset}.markdown-body[dir=rtl] pre{direction:ltr}.markdown-body[dir=rtl] code{direction:ltr;unicode-bidi:embed}.markdown-body .alert>p{margin-bottom:0}.markdown-body pre.abc,.markdown-body pre.flow-chart,.markdown-body pre.graphviz,.markdown-body pre.mermaid,.markdown-body pre.sequence-diagram,.markdown-body pre.vega{text-align:center;background-color:inherit;border-radius:0;white-space:inherit;overflow:visible}.markdown-body pre.abc>code,.markdown-body pre.flow-chart>code,.markdown-body pre.graphviz>code,.markdown-body pre.mermaid>code,.markdown-body pre.sequence-diagram>code,.markdown-body pre.vega>code{text-align:left}.markdown-body pre.abc>svg,.markdown-body pre.flow-chart>svg,.markdown-body pre.graphviz>svg,.markdown-body pre.mermaid>svg,.markdown-body pre.sequence-diagram>svg,.markdown-body pre.vega>svg{max-width:100%;height:100%}.markdown-body pre>code.wrap{white-space:pre-wrap;white-space:-moz-pre-wrap;white-space:-pre-wrap;white-space:-o-pre-wrap;word-wrap:break-word}.markdown-body .alert>p,.markdown-body .alert>ul{margin-bottom:0}.markdown-body summary{display:list-item}.markdown-body summary:focus{outline:none}.markdown-body details summary{cursor:pointer}.markdown-body details:not([open])>:not(summary){display:none}.markdown-body figure{margin:1em 40px}.markdown-body .mark,.markdown-body mark{background-color:#fff1a7}.vimeo,.youtube{cursor:pointer;display:table;text-align:center;background-position:50%;background-repeat:no-repeat;background-size:contain;background-color:#000;overflow:hidden}.vimeo,.youtube{position:relative;width:100%}.youtube{padding-bottom:56.25%}.vimeo img{width:100%;object-fit:contain;z-index:0}.youtube img{object-fit:cover;z-index:0}.vimeo iframe,.youtube iframe,.youtube img{width:100%;height:100%;position:absolute;top:0;left:0}.vimeo iframe,.youtube iframe{vertical-align:middle;z-index:1}.vimeo .icon,.youtube .icon{position:absolute;height:auto;width:auto;top:50%;left:50%;transform:translate(-50%,-50%);color:#fff;opacity:.3;transition:opacity .2s;z-index:0}.vimeo:hover .icon,.youtube:hover .icon{opacity:.6;transition:opacity .2s}.slideshare .inner,.speakerdeck .inner{position:relative;width:100%}.slideshare .inner iframe,.speakerdeck .inner iframe{position:absolute;top:0;bottom:0;left:0;right:0;width:100%;height:100%}.MJX_Assistive_MathML{display:none}.ui-infobar{position:relative;z-index:2;max-width:760px;margin:25px auto -25px;color:#777}.toc .invisable-node{list-style-type:none}.ui-toc{position:fixed;bottom:20px;z-index:998}.ui-toc.both-mode{margin-left:8px}.ui-toc.both-mode .ui-toc-label{height:40px;padding:10px 4px;border-top-left-radius:0;border-bottom-left-radius:0}.ui-toc-label{background-color:#e6e6e6;border:none;color:#868686;transition:opacity .2s}.ui-toc .open .ui-toc-label{opacity:1;color:#fff;transition:opacity .2s}.ui-toc-label:focus{opacity:.3;background-color:#ccc;color:#000}.ui-toc-label:hover{opacity:1;background-color:#ccc;transition:opacity .2s}.ui-toc-dropdown{margin-top:20px;margin-bottom:20px;padding-left:10px;padding-right:10px;max-width:45vw;width:25vw;max-height:70vh;overflow:auto;text-align:inherit}.ui-toc-dropdown>.toc{max-height:calc(70vh - 100px);overflow:auto}.ui-toc-dropdown[dir=rtl] .nav{padding-right:0;letter-spacing:.0029em}.ui-toc-dropdown a{overflow:hidden;text-overflow:ellipsis;white-space:pre}.ui-toc-dropdown .nav>li>a{display:block;padding:4px 20px;font-size:13px;font-weight:500;color:#767676}.ui-toc-dropdown .nav>li:first-child:last-child > ul,.ui-toc-dropdown .toc.expand ul{display:block}.ui-toc-dropdown .nav>li>a:focus,.ui-toc-dropdown .nav>li>a:hover{padding-left:19px;color:#000;text-decoration:none;background-color:transparent;border-left:1px solid #000}.ui-toc-dropdown[dir=rtl] .nav>li>a:focus,.ui-toc-dropdown[dir=rtl] .nav>li>a:hover{padding-right:19px;border-left:none;border-right:1px solid #000}.ui-toc-dropdown .nav>.active:focus>a,.ui-toc-dropdown .nav>.active:hover>a,.ui-toc-dropdown .nav>.active>a{padding-left:18px;font-weight:700;color:#000;background-color:transparent;border-left:2px solid #000}.ui-toc-dropdown[dir=rtl] .nav>.active:focus>a,.ui-toc-dropdown[dir=rtl] .nav>.active:hover>a,.ui-toc-dropdown[dir=rtl] .nav>.active>a{padding-right:18px;border-left:none;border-right:2px solid #000}.ui-toc-dropdown .nav .nav{display:none;padding-bottom:10px}.ui-toc-dropdown .nav>.active>ul{display:block}.ui-toc-dropdown .nav .nav>li>a{padding-top:1px;padding-bottom:1px;padding-left:30px;font-size:12px;font-weight:400}.ui-toc-dropdown[dir=rtl] .nav .nav>li>a{padding-right:30px}.ui-toc-dropdown .nav .nav>li>ul>li>a{padding-top:1px;padding-bottom:1px;padding-left:40px;font-size:12px;font-weight:400}.ui-toc-dropdown[dir=rtl] .nav .nav>li>ul>li>a{padding-right:40px}.ui-toc-dropdown .nav .nav>li>a:focus,.ui-toc-dropdown .nav .nav>li>a:hover{padding-left:29px}.ui-toc-dropdown[dir=rtl] .nav .nav>li>a:focus,.ui-toc-dropdown[dir=rtl] .nav .nav>li>a:hover{padding-right:29px}.ui-toc-dropdown .nav .nav>li>ul>li>a:focus,.ui-toc-dropdown .nav .nav>li>ul>li>a:hover{padding-left:39px}.ui-toc-dropdown[dir=rtl] .nav .nav>li>ul>li>a:focus,.ui-toc-dropdown[dir=rtl] .nav .nav>li>ul>li>a:hover{padding-right:39px}.ui-toc-dropdown .nav .nav>.active:focus>a,.ui-toc-dropdown .nav .nav>.active:hover>a,.ui-toc-dropdown .nav .nav>.active>a{padding-left:28px;font-weight:500}.ui-toc-dropdown[dir=rtl] .nav .nav>.active:focus>a,.ui-toc-dropdown[dir=rtl] .nav .nav>.active:hover>a,.ui-toc-dropdown[dir=rtl] .nav .nav>.active>a{padding-right:28px}.ui-toc-dropdown .nav .nav>.active>.nav>.active:focus>a,.ui-toc-dropdown .nav .nav>.active>.nav>.active:hover>a,.ui-toc-dropdown .nav .nav>.active>.nav>.active>a{padding-left:38px;font-weight:500}.ui-toc-dropdown[dir=rtl] .nav .nav>.active>.nav>.active:focus>a,.ui-toc-dropdown[dir=rtl] .nav .nav>.active>.nav>.active:hover>a,.ui-toc-dropdown[dir=rtl] .nav .nav>.active>.nav>.active>a{padding-right:38px}.markdown-body{font-family:-apple-system,BlinkMacSystemFont,Segoe UI,Helvetica Neue,Helvetica,Roboto,Arial,sans-serif}html[lang^=ja] .markdown-body{font-family:-apple-system,BlinkMacSystemFont,Segoe UI,Helvetica Neue,Helvetica,Roboto,Arial,Hiragino Kaku Gothic Pro,ヒラギノ角ゴ Pro W3,Osaka,Meiryo,メイリオ,MS Gothic,ＭＳ\ ゴシック,sans-serif}html[lang=zh-tw] .markdown-body{font-family:-apple-system,BlinkMacSystemFont,Segoe UI,Helvetica Neue,Helvetica,Roboto,Arial,PingFang TC,Microsoft JhengHei,微軟正黑,sans-serif}html[lang=zh-cn] .markdown-body{font-family:-apple-system,BlinkMacSystemFont,Segoe UI,Helvetica Neue,Helvetica,Roboto,Arial,PingFang SC,Microsoft YaHei,微软雅黑,sans-serif}html .markdown-body[lang^=ja]{font-family:-apple-system,BlinkMacSystemFont,Segoe UI,Helvetica Neue,Helvetica,Roboto,Arial,Hiragino Kaku Gothic Pro,ヒラギノ角ゴ Pro W3,Osaka,Meiryo,メイリオ,MS Gothic,ＭＳ\ ゴシック,sans-serif}html .markdown-body[lang=zh-tw]{font-family:-apple-system,BlinkMacSystemFont,Segoe UI,Helvetica Neue,Helvetica,Roboto,Arial,PingFang TC,Microsoft JhengHei,微軟正黑,sans-serif}html .markdown-body[lang=zh-cn]{font-family:-apple-system,BlinkMacSystemFont,Segoe UI,Helvetica Neue,Helvetica,Roboto,Arial,PingFang SC,Microsoft YaHei,微软雅黑,sans-serif}html[lang^=ja] .ui-toc-dropdown{font-family:Source Sans Pro,Helvetica,Arial,Meiryo UI,MS PGothic,ＭＳ\ Ｐゴシック,sans-serif}html[lang=zh-tw] .ui-toc-dropdown{font-family:Source Sans Pro,Helvetica,Arial,Microsoft JhengHei UI,微軟正黑UI,sans-serif}html[lang=zh-cn] .ui-toc-dropdown{font-family:Source Sans Pro,Helvetica,Arial,Microsoft YaHei UI,微软雅黑UI,sans-serif}html .ui-toc-dropdown[lang^=ja]{font-family:Source Sans Pro,Helvetica,Arial,Meiryo UI,MS PGothic,ＭＳ\ Ｐゴシック,sans-serif}html .ui-toc-dropdown[lang=zh-tw]{font-family:Source Sans Pro,Helvetica,Arial,Microsoft JhengHei UI,微軟正黑UI,sans-serif}html .ui-toc-dropdown[lang=zh-cn]{font-family:Source Sans Pro,Helvetica,Arial,Microsoft YaHei UI,微软雅黑UI,sans-serif}.ui-affix-toc{position:fixed;top:0;max-width:15vw;max-height:70vh;overflow:auto}.back-to-top,.expand-toggle,.go-to-bottom{display:block;padding:4px 10px;margin-top:10px;margin-left:10px;font-size:12px;font-weight:500;color:#999}.back-to-top:focus,.back-to-top:hover,.expand-toggle:focus,.expand-toggle:hover,.go-to-bottom:focus,.go-to-bottom:hover{color:#563d7c;text-decoration:none}.back-to-top,.go-to-bottom{margin-top:0}.ui-user-icon{width:20px;height:20px;display:block;border-radius:3px;margin-top:2px;margin-bottom:2px;margin-right:5px;background-position:50%;background-repeat:no-repeat;background-size:cover}.ui-user-icon.small{width:18px;height:18px;display:inline-block;vertical-align:middle;margin:0 0 .2em}.ui-infobar>small>span{line-height:22px}.ui-infobar>small .dropdown{display:inline-block}.ui-infobar>small .dropdown a:focus,.ui-infobar>small .dropdown a:hover{text-decoration:none}.ui-published-note{color:#337ab7}.ui-published-note .fa{font-size:20px;vertical-align:top}.unselectable{-webkit-user-select:none;-o-user-select:none;user-select:none}.selectable{-webkit-user-select:text;-o-user-select:text;user-select:text}@media print{blockquote,div,img,pre,table{page-break-inside:avoid!important}a[href]:after{font-size:12px!important}}.markdown-body.slides{position:relative;z-index:1;color:#222}.markdown-body.slides:before{content:"";display:block;position:absolute;top:0;left:0;right:0;bottom:0;z-index:-1;background-color:currentColor;box-shadow:0 0 0 50vw}.markdown-body.slides section[data-markdown]{position:relative;margin-bottom:1.5em;background-color:#fff;text-align:center}.markdown-body.slides section[data-markdown] code{text-align:left}.markdown-body.slides section[data-markdown]:before{content:"";display:block;padding-bottom:56.23%}.markdown-body.slides section[data-markdown]>div:first-child{position:absolute;top:50%;left:1em;right:1em;transform:translateY(-50%);max-height:100%;overflow:hidden}.markdown-body.slides section[data-markdown]>ul{display:inline-block}.markdown-body.slides>section>section+section:after{content:"";position:absolute;top:-1.5em;right:1em;height:1.5em;border:3px solid #777}body{font-smoothing:subpixel-antialiased!important;-webkit-font-smoothing:subpixel-antialiased!important;-moz-osx-font-smoothing:auto!important;text-shadow:0 0 1em transparent,1px 1px 1.2px rgba(0,0,0,.004);-webkit-overflow-scrolling:touch;letter-spacing:.025em}.focus,:focus{outline:none!important}::-moz-focus-inner{border:0!important}body{font-family:Source Sans Pro,Helvetica,Arial,sans-serif}html[lang^=ja] body{font-family:Source Sans Pro,Helvetica,Arial,Hiragino Kaku Gothic Pro,ヒラギノ角ゴ Pro W3,Osaka,Meiryo,メイリオ,MS Gothic,ＭＳ\ ゴシック,sans-serif}html[lang=zh-tw] body{font-family:Source Sans Pro,Helvetica,Arial,PingFang TC,Microsoft JhengHei,微軟正黑,sans-serif}html[lang=zh-cn] body{font-family:Source Sans Pro,Helvetica,Arial,PingFang SC,Microsoft YaHei,微软雅黑,sans-serif}abbr[title]{border-bottom:none;text-decoration:underline;-webkit-text-decoration:underline dotted;text-decoration:underline dotted}abbr[data-original-title],abbr[title]{cursor:help}body.modal-open{overflow-y:auto;padding-right:0!important}
    </style>
    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
    	<script src="https://cdnjs.cloudflare.com/ajax/libs/html5shiv/3.7.3/html5shiv.min.js" integrity="sha256-3Jy/GbSLrg0o9y5Z5n1uw0qxZECH7C6OQpVBgNFYa0g=" crossorigin="anonymous"></script>
    	<script src="https://cdnjs.cloudflare.com/ajax/libs/respond.js/1.4.2/respond.min.js" integrity="sha256-g6iAfvZp+nDQ2TdTR/VVKJf3bGro4ub5fvWSWVRi2NE=" crossorigin="anonymous"></script>
		<script src="https://cdnjs.cloudflare.com/ajax/libs/es5-shim/4.5.9/es5-shim.min.js" integrity="sha256-8E4Is26QH0bD52WoQpcB+R/tcWQtpzlCojrybUd7Mxo=" crossorigin="anonymous"></script>
    <![endif]-->
</head>

<body>
    <div id="doc" class="markdown-body container-fluid comment-enabled" data-hard-breaks="true"><h1 id="Экзамен-по-машинному-обучению-ФПМИ1" data-id="Экзамен-по-машинному-обучению-ФПМИ1"><a class="anchor hidden-xs" href="#Экзамен-по-машинному-обучению-ФПМИ1" title="Экзамен-по-машинному-обучению-ФПМИ1"><span class="octicon octicon-link"></span></a><span>Экзамен по машинному обучению ФПМИ</span><sup class="footnote-ref"><a href="#fn1" id="fnref1">[1]</a></sup></h1><h2 id="Список-тем" data-id="Список-тем"><a class="anchor hidden-xs" href="#Список-тем" title="Список-тем"><span class="octicon octicon-link"></span></a><span>Список тем</span></h2><h3 id="1-Метрики-качества-классификации-accuracy-balanced-accuracy-precision-recall-f1-score-w-multiclass-extensions-ROC-AUC" data-id="1-Метрики-качества-классификации-accuracy-balanced-accuracy-precision-recall-f1-score-w-multiclass-extensions-ROC-AUC"><a class="anchor hidden-xs" href="#1-Метрики-качества-классификации-accuracy-balanced-accuracy-precision-recall-f1-score-w-multiclass-extensions-ROC-AUC" title="1-Метрики-качества-классификации-accuracy-balanced-accuracy-precision-recall-f1-score-w-multiclass-extensions-ROC-AUC"><span class="octicon octicon-link"></span></a><span>1. Метрики качества классификации: accuracy, balanced accuracy, precision, recall, f1-score (/w multiclass extensions), ROC-AUC.</span></h3><p><span>Предположим, что рассматривается задача бинарной классификации (т.е. с классами </span><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-1-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 118%; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mo fence=&quot;false&quot; stretchy=&quot;false&quot;>{</mo><mo>&amp;#x2212;</mo><mn>1</mn><mo>,</mo><mo>+</mo><mn>1</mn><mo fence=&quot;false&quot; stretchy=&quot;false&quot;>}</mo></math>" role="presentation"><span id="MJXc-Node-1" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-2" class="mjx-mrow"><span id="MJXc-Node-3" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.479em; padding-bottom: 0.585em;">{</span></span><span id="MJXc-Node-4" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.32em; padding-bottom: 0.426em;">−</span></span><span id="MJXc-Node-5" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.373em; padding-bottom: 0.32em;">1</span></span><span id="MJXc-Node-6" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="margin-top: -0.156em; padding-bottom: 0.532em;">,</span></span><span id="MJXc-Node-7" class="mjx-mo MJXc-space1"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.32em; padding-bottom: 0.426em;">+</span></span><span id="MJXc-Node-8" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.373em; padding-bottom: 0.32em;">1</span></span><span id="MJXc-Node-9" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.479em; padding-bottom: 0.585em;">}</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo fence="false" stretchy="false">{</mo><mo>−</mo><mn>1</mn><mo>,</mo><mo>+</mo><mn>1</mn><mo fence="false" stretchy="false">}</mo></math></span></span><script type="math/tex" id="MathJax-Element-1">\{-1, +1\}</script></span><span>). Определим следующие величины:</span></p><ul>
<li><span>TP (True positive) — количество правильно угаданных меток позитивного класса (обычно класса с меткой </span><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-2-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 118%; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mo>+</mo><mn>1</mn></math>" role="presentation"><span id="MJXc-Node-10" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-11" class="mjx-mrow"><span id="MJXc-Node-12" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.32em; padding-bottom: 0.426em;">+</span></span><span id="MJXc-Node-13" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.373em; padding-bottom: 0.32em;">1</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo>+</mo><mn>1</mn></math></span></span><script type="math/tex" id="MathJax-Element-2">+1</script></span><span>).</span></li>
<li><span>TN (True negative) — количество правильно угаданных меток негативного класса (обычно класса с меткой </span><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-3-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 118%; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mn>0</mn></math>" role="presentation"><span id="MJXc-Node-14" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-15" class="mjx-mrow"><span id="MJXc-Node-16" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.373em; padding-bottom: 0.373em;">0</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mn>0</mn></math></span></span><script type="math/tex" id="MathJax-Element-3">0</script></span><span> или </span><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-4-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 118%; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mo>&amp;#x2212;</mo><mn>1</mn></math>" role="presentation"><span id="MJXc-Node-17" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-18" class="mjx-mrow"><span id="MJXc-Node-19" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.32em; padding-bottom: 0.426em;">−</span></span><span id="MJXc-Node-20" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.373em; padding-bottom: 0.32em;">1</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo>−</mo><mn>1</mn></math></span></span><script type="math/tex" id="MathJax-Element-4">-1</script></span><span>).</span></li>
<li><span>FP (False positive) — количество объектов негативного класса, которые классификатор назвал позитивными.</span></li>
<li><span>FN (False negative) — количество объектов позитивного класса, которые классификатор назвал негативными.</span><br>
<img src="https://i.imgur.com/TNMb7k7.png" alt=""></li>
</ul><p><span>Список метрик:</span></p><ul>
<li><strong><span>Accuracy</span></strong><span> (точность) — количество правильно классифицированных объектов:</span><br>
<span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span class="mjx-chtml MJXc-display" style="text-align: center;"><span id="MathJax-Element-5-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 118%; text-align: center; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><mfrac><mn>1</mn><mi>n</mi></mfrac><munderover><mo movablelimits=&quot;false&quot;>&amp;#x2211;</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>n</mi></munderover><mo stretchy=&quot;false&quot;>[</mo><msub><mi>y</mi><mi>i</mi></msub><mo>=</mo><msubsup><mi>y</mi><mi>i</mi><mi>p</mi></msubsup><mo stretchy=&quot;false&quot;>]</mo></math>" role="presentation"><span id="MJXc-Node-21" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-22" class="mjx-mrow"><span id="MJXc-Node-23" class="mjx-mfrac"><span class="mjx-box MJXc-stacked" style="width: 0.8em; padding: 0px 0.12em;"><span class="mjx-numerator" style="width: 0.8em; top: -1.368em;"><span id="MJXc-Node-24" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.373em; padding-bottom: 0.32em;">1</span></span></span><span class="mjx-denominator" style="width: 0.8em; bottom: -0.722em;"><span id="MJXc-Node-25" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.215em; padding-bottom: 0.267em;">n</span></span></span><span style="border-bottom-width: 1.3px; border-bottom-style: solid; top: -0.283em; width: 0.8em;" class="mjx-line"></span></span><span style="height: 2.089em; vertical-align: -0.722em;" class="mjx-vsize"></span></span><span id="MJXc-Node-26" class="mjx-munderover MJXc-space1"><span class="mjx-itable"><span class="mjx-row"><span class="mjx-cell"><span class="mjx-stack"><span class="mjx-over" style="font-size: 70.7%; padding-bottom: 0.247em; padding-top: 0.141em; padding-left: 0.721em;"><span id="MJXc-Node-33" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.215em; padding-bottom: 0.267em;">n</span></span></span><span class="mjx-op"><span id="MJXc-Node-27" class="mjx-mo"><span class="mjx-char MJXc-TeX-size2-R" style="padding-top: 0.744em; padding-bottom: 0.744em;">∑</span></span></span></span></span></span><span class="mjx-row"><span class="mjx-under" style="font-size: 70.7%; padding-top: 0.236em; padding-bottom: 0.141em; padding-left: 0.21em;"><span id="MJXc-Node-28" class="mjx-texatom" style=""><span id="MJXc-Node-29" class="mjx-mrow"><span id="MJXc-Node-30" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.426em; padding-bottom: 0.267em;">i</span></span><span id="MJXc-Node-31" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.056em; padding-bottom: 0.32em;">=</span></span><span id="MJXc-Node-32" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.373em; padding-bottom: 0.32em;">1</span></span></span></span></span></span></span></span><span id="MJXc-Node-34" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.479em; padding-bottom: 0.585em;">[</span></span><span id="MJXc-Node-35" class="mjx-msubsup"><span class="mjx-base" style="margin-right: -0.006em;"><span id="MJXc-Node-36" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.215em; padding-bottom: 0.479em; padding-right: 0.006em;">y</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-37" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.426em; padding-bottom: 0.267em;">i</span></span></span></span><span id="MJXc-Node-38" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.056em; padding-bottom: 0.32em;">=</span></span><span id="MJXc-Node-39" class="mjx-msubsup MJXc-space3"><span class="mjx-base" style="margin-right: -0.006em;"><span id="MJXc-Node-40" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.215em; padding-bottom: 0.479em; padding-right: 0.006em;">y</span></span></span><span class="mjx-stack" style="vertical-align: -0.311em;"><span class="mjx-sup" style="font-size: 70.7%; padding-bottom: 0.255em; padding-left: 0.082em; padding-right: 0.071em;"><span id="MJXc-Node-42" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.215em; padding-bottom: 0.479em;">p</span></span></span><span class="mjx-sub" style="font-size: 70.7%; padding-right: 0.071em;"><span id="MJXc-Node-41" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.426em; padding-bottom: 0.267em;">i</span></span></span></span></span><span id="MJXc-Node-43" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.479em; padding-bottom: 0.585em;">]</span></span></span></span><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mfrac><mn>1</mn><mi>n</mi></mfrac><munderover><mo movablelimits="false">∑</mo><mrow class="MJX-TeXAtom-ORD"><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>n</mi></munderover><mo stretchy="false">[</mo><msub><mi>y</mi><mi>i</mi></msub><mo>=</mo><msubsup><mi>y</mi><mi>i</mi><mi>p</mi></msubsup><mo stretchy="false">]</mo></math></span></span></span><script type="math/tex; mode=display" id="MathJax-Element-5">
 \frac{1}{n}\sum\limits_{i = 1}^n [y_i = y_i^p]
</script></span><br>
<span>Здесь </span><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-6-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 118%; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msubsup><mi>y</mi><mi>i</mi><mi>p</mi></msubsup></math>" role="presentation"><span id="MJXc-Node-44" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-45" class="mjx-mrow"><span id="MJXc-Node-46" class="mjx-msubsup"><span class="mjx-base" style="margin-right: -0.006em;"><span id="MJXc-Node-47" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.215em; padding-bottom: 0.479em; padding-right: 0.006em;">y</span></span></span><span class="mjx-stack" style="vertical-align: -0.311em;"><span class="mjx-sup" style="font-size: 70.7%; padding-bottom: 0.255em; padding-left: 0.082em; padding-right: 0.071em;"><span id="MJXc-Node-49" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.215em; padding-bottom: 0.479em;">p</span></span></span><span class="mjx-sub" style="font-size: 70.7%; padding-right: 0.071em;"><span id="MJXc-Node-48" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.426em; padding-bottom: 0.267em;">i</span></span></span></span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msubsup><mi>y</mi><mi>i</mi><mi>p</mi></msubsup></math></span></span><script type="math/tex" id="MathJax-Element-6">y_i^p</script></span><span> — предсказанная метка, а </span><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-7-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 118%; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>y</mi><mi>i</mi></msub></math>" role="presentation"><span id="MJXc-Node-50" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-51" class="mjx-mrow"><span id="MJXc-Node-52" class="mjx-msubsup"><span class="mjx-base" style="margin-right: -0.006em;"><span id="MJXc-Node-53" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.215em; padding-bottom: 0.479em; padding-right: 0.006em;">y</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-54" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.426em; padding-bottom: 0.267em;">i</span></span></span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>y</mi><mi>i</mi></msub></math></span></span><script type="math/tex" id="MathJax-Element-7">y_i</script></span><span> — истинная.</span>
<ul>
<li><strong><span>Balanced accuracy</span></strong><span> — усреднённая по классам точность</span><br>
<span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span class="mjx-chtml MJXc-display" style="text-align: center;"><span id="MathJax-Element-8-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 118%; text-align: center; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><mfrac><mn>1</mn><mi>C</mi></mfrac><munderover><mo movablelimits=&quot;false&quot;>&amp;#x2211;</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>k</mi><mo>=</mo><mn>1</mn></mrow><mi>C</mi></munderover><mfrac><mrow><munder><mo>&amp;#x2211;</mo><mi>i</mi></munder><mo stretchy=&quot;false&quot;>[</mo><msub><mi>y</mi><mi>i</mi></msub><mo>=</mo><msubsup><mi>y</mi><mi>i</mi><mi>p</mi></msubsup><mtext>&amp;#xA0;and&amp;#xA0;</mtext><msub><mi>y</mi><mi>i</mi></msub><mo>=</mo><mi>k</mi><mo stretchy=&quot;false&quot;>]</mo></mrow><mrow><munder><mo>&amp;#x2211;</mo><mi>i</mi></munder><mo stretchy=&quot;false&quot;>[</mo><msub><mi>y</mi><mi>i</mi></msub><mo>=</mo><mi>k</mi><mo stretchy=&quot;false&quot;>]</mo></mrow></mfrac></math>" role="presentation"><span id="MJXc-Node-55" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-56" class="mjx-mrow"><span id="MJXc-Node-57" class="mjx-mfrac"><span class="mjx-box MJXc-stacked" style="width: 0.96em; padding: 0px 0.12em;"><span class="mjx-numerator" style="width: 0.96em; top: -1.368em;"><span id="MJXc-Node-58" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.373em; padding-bottom: 0.32em;">1</span></span></span><span class="mjx-denominator" style="width: 0.96em; bottom: -0.753em;"><span id="MJXc-Node-59" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.32em; padding-right: 0.045em;">C</span></span></span><span style="border-bottom-width: 1.3px; border-bottom-style: solid; top: -0.283em; width: 0.96em;" class="mjx-line"></span></span><span style="height: 2.12em; vertical-align: -0.753em;" class="mjx-vsize"></span></span><span id="MJXc-Node-60" class="mjx-munderover MJXc-space1"><span class="mjx-itable"><span class="mjx-row"><span class="mjx-cell"><span class="mjx-stack"><span class="mjx-over" style="font-size: 70.7%; padding-bottom: 0.236em; padding-top: 0.141em; padding-left: 0.641em;"><span id="MJXc-Node-67" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.32em; padding-right: 0.045em;">C</span></span></span><span class="mjx-op"><span id="MJXc-Node-61" class="mjx-mo"><span class="mjx-char MJXc-TeX-size2-R" style="padding-top: 0.744em; padding-bottom: 0.744em;">∑</span></span></span></span></span></span><span class="mjx-row"><span class="mjx-under" style="font-size: 70.7%; padding-top: 0.236em; padding-bottom: 0.141em; padding-left: 0.122em;"><span id="MJXc-Node-62" class="mjx-texatom" style=""><span id="MJXc-Node-63" class="mjx-mrow"><span id="MJXc-Node-64" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.267em;">k</span></span><span id="MJXc-Node-65" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.056em; padding-bottom: 0.32em;">=</span></span><span id="MJXc-Node-66" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.373em; padding-bottom: 0.32em;">1</span></span></span></span></span></span></span></span><span id="MJXc-Node-68" class="mjx-mfrac MJXc-space1"><span class="mjx-box MJXc-stacked" style="width: 9.869em; padding: 0px 0.12em;"><span class="mjx-numerator" style="width: 9.869em; top: -1.651em;"><span id="MJXc-Node-69" class="mjx-mrow"><span id="MJXc-Node-70" class="mjx-munderover"><span class="mjx-base"><span id="MJXc-Node-71" class="mjx-mo"><span class="mjx-char MJXc-TeX-size1-R" style="padding-top: 0.532em; padding-bottom: 0.532em;">∑</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.439em; padding-right: 0.071em;"><span id="MJXc-Node-72" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.426em; padding-bottom: 0.267em;">i</span></span></span></span><span id="MJXc-Node-73" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.479em; padding-bottom: 0.585em;">[</span></span><span id="MJXc-Node-74" class="mjx-msubsup"><span class="mjx-base" style="margin-right: -0.006em;"><span id="MJXc-Node-75" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.215em; padding-bottom: 0.479em; padding-right: 0.006em;">y</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-76" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.426em; padding-bottom: 0.267em;">i</span></span></span></span><span id="MJXc-Node-77" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.056em; padding-bottom: 0.32em;">=</span></span><span id="MJXc-Node-78" class="mjx-msubsup MJXc-space3"><span class="mjx-base" style="margin-right: -0.006em;"><span id="MJXc-Node-79" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.215em; padding-bottom: 0.479em; padding-right: 0.006em;">y</span></span></span><span class="mjx-stack" style="vertical-align: -0.311em;"><span class="mjx-sup" style="font-size: 70.7%; padding-bottom: 0.255em; padding-left: 0.082em; padding-right: 0.071em;"><span id="MJXc-Node-81" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.215em; padding-bottom: 0.479em;">p</span></span></span><span class="mjx-sub" style="font-size: 70.7%; padding-right: 0.071em;"><span id="MJXc-Node-80" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.426em; padding-bottom: 0.267em;">i</span></span></span></span></span><span id="MJXc-Node-82" class="mjx-mtext"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.426em; padding-bottom: 0.373em;">&nbsp;and&nbsp;</span></span><span id="MJXc-Node-83" class="mjx-msubsup"><span class="mjx-base" style="margin-right: -0.006em;"><span id="MJXc-Node-84" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.215em; padding-bottom: 0.479em; padding-right: 0.006em;">y</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-85" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.426em; padding-bottom: 0.267em;">i</span></span></span></span><span id="MJXc-Node-86" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.056em; padding-bottom: 0.32em;">=</span></span><span id="MJXc-Node-87" class="mjx-mi MJXc-space3"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.267em;">k</span></span><span id="MJXc-Node-88" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.479em; padding-bottom: 0.585em;">]</span></span></span></span><span class="mjx-denominator" style="width: 9.869em; bottom: -1.086em;"><span id="MJXc-Node-89" class="mjx-mrow"><span id="MJXc-Node-90" class="mjx-munderover"><span class="mjx-base"><span id="MJXc-Node-91" class="mjx-mo"><span class="mjx-char MJXc-TeX-size1-R" style="padding-top: 0.532em; padding-bottom: 0.532em;">∑</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.439em; padding-right: 0.071em;"><span id="MJXc-Node-92" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.426em; padding-bottom: 0.267em;">i</span></span></span></span><span id="MJXc-Node-93" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.479em; padding-bottom: 0.585em;">[</span></span><span id="MJXc-Node-94" class="mjx-msubsup"><span class="mjx-base" style="margin-right: -0.006em;"><span id="MJXc-Node-95" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.215em; padding-bottom: 0.479em; padding-right: 0.006em;">y</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-96" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.426em; padding-bottom: 0.267em;">i</span></span></span></span><span id="MJXc-Node-97" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.056em; padding-bottom: 0.32em;">=</span></span><span id="MJXc-Node-98" class="mjx-mi MJXc-space3"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.267em;">k</span></span><span id="MJXc-Node-99" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.479em; padding-bottom: 0.585em;">]</span></span></span></span><span style="border-bottom-width: 1.3px; border-bottom-style: solid; top: -0.283em; width: 9.869em;" class="mjx-line"></span></span><span style="height: 2.737em; vertical-align: -1.086em;" class="mjx-vsize"></span></span></span></span><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mfrac><mn>1</mn><mi>C</mi></mfrac><munderover><mo movablelimits="false">∑</mo><mrow class="MJX-TeXAtom-ORD"><mi>k</mi><mo>=</mo><mn>1</mn></mrow><mi>C</mi></munderover><mfrac><mrow><munder><mo>∑</mo><mi>i</mi></munder><mo stretchy="false">[</mo><msub><mi>y</mi><mi>i</mi></msub><mo>=</mo><msubsup><mi>y</mi><mi>i</mi><mi>p</mi></msubsup><mtext>&nbsp;and&nbsp;</mtext><msub><mi>y</mi><mi>i</mi></msub><mo>=</mo><mi>k</mi><mo stretchy="false">]</mo></mrow><mrow><munder><mo>∑</mo><mi>i</mi></munder><mo stretchy="false">[</mo><msub><mi>y</mi><mi>i</mi></msub><mo>=</mo><mi>k</mi><mo stretchy="false">]</mo></mrow></mfrac></math></span></span></span><script type="math/tex; mode=display" id="MathJax-Element-8">
\frac{1}{C}\sum\limits_{k = 1}^C \frac{\sum_i[y_i = y_i^p \text{ and } y_i = k]}{\sum_i[y_i = k]}
</script></span></li>
</ul>
</li>
<li><strong><span>Precision</span></strong><span> (точность) — доля </span><em><span>правильно</span></em><span> классифицированных объектов из тех, которые классификатор назвал позитивными.</span><br>
<span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span class="mjx-chtml MJXc-display" style="text-align: center;"><span id="MathJax-Element-9-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 118%; text-align: center; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><mfrac><mrow><mi>T</mi><mi>P</mi></mrow><mrow><mi>T</mi><mi>P</mi><mo>+</mo><mi>F</mi><mi>P</mi></mrow></mfrac></math>" role="presentation"><span id="MJXc-Node-100" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-101" class="mjx-mrow"><span id="MJXc-Node-102" class="mjx-mfrac"><span class="mjx-box MJXc-stacked" style="width: 4.377em; padding: 0px 0.12em;"><span class="mjx-numerator" style="width: 4.377em; top: -1.385em;"><span id="MJXc-Node-103" class="mjx-mrow"><span id="MJXc-Node-104" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.267em; padding-right: 0.12em;">T</span></span><span id="MJXc-Node-105" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.267em; padding-right: 0.109em;">P</span></span></span></span><span class="mjx-denominator" style="width: 4.377em; bottom: -0.793em;"><span id="MJXc-Node-106" class="mjx-mrow"><span id="MJXc-Node-107" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.267em; padding-right: 0.12em;">T</span></span><span id="MJXc-Node-108" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.267em; padding-right: 0.109em;">P</span></span><span id="MJXc-Node-109" class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.32em; padding-bottom: 0.426em;">+</span></span><span id="MJXc-Node-110" class="mjx-mi MJXc-space2"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.267em; padding-right: 0.106em;">F</span></span><span id="MJXc-Node-111" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.267em; padding-right: 0.109em;">P</span></span></span></span><span style="border-bottom-width: 1.3px; border-bottom-style: solid; top: -0.283em; width: 4.377em;" class="mjx-line"></span></span><span style="height: 2.177em; vertical-align: -0.793em;" class="mjx-vsize"></span></span></span></span><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mfrac><mrow><mi>T</mi><mi>P</mi></mrow><mrow><mi>T</mi><mi>P</mi><mo>+</mo><mi>F</mi><mi>P</mi></mrow></mfrac></math></span></span></span><script type="math/tex; mode=display" id="MathJax-Element-9">
 \frac{TP}{TP + FP}
</script></span></li>
<li><strong><span>Recall</span></strong><span> (полнота) — доля объектов позитивного класса, которых правильно классифицировал алгоритм.</span><br>
<span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span class="mjx-chtml MJXc-display" style="text-align: center;"><span id="MathJax-Element-10-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 118%; text-align: center; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><mfrac><mrow><mi>T</mi><mi>P</mi></mrow><mrow><mi>T</mi><mi>P</mi><mo>+</mo><mi>F</mi><mi>N</mi></mrow></mfrac></math>" role="presentation"><span id="MJXc-Node-112" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-113" class="mjx-mrow"><span id="MJXc-Node-114" class="mjx-mfrac"><span class="mjx-box MJXc-stacked" style="width: 4.514em; padding: 0px 0.12em;"><span class="mjx-numerator" style="width: 4.514em; top: -1.385em;"><span id="MJXc-Node-115" class="mjx-mrow"><span id="MJXc-Node-116" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.267em; padding-right: 0.12em;">T</span></span><span id="MJXc-Node-117" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.267em; padding-right: 0.109em;">P</span></span></span></span><span class="mjx-denominator" style="width: 4.514em; bottom: -0.793em;"><span id="MJXc-Node-118" class="mjx-mrow"><span id="MJXc-Node-119" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.267em; padding-right: 0.12em;">T</span></span><span id="MJXc-Node-120" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.267em; padding-right: 0.109em;">P</span></span><span id="MJXc-Node-121" class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.32em; padding-bottom: 0.426em;">+</span></span><span id="MJXc-Node-122" class="mjx-mi MJXc-space2"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.267em; padding-right: 0.106em;">F</span></span><span id="MJXc-Node-123" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.267em; padding-right: 0.085em;">N</span></span></span></span><span style="border-bottom-width: 1.3px; border-bottom-style: solid; top: -0.283em; width: 4.514em;" class="mjx-line"></span></span><span style="height: 2.177em; vertical-align: -0.793em;" class="mjx-vsize"></span></span></span></span><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mfrac><mrow><mi>T</mi><mi>P</mi></mrow><mrow><mi>T</mi><mi>P</mi><mo>+</mo><mi>F</mi><mi>N</mi></mrow></mfrac></math></span></span></span><script type="math/tex; mode=display" id="MathJax-Element-10">
 \frac{TP}{TP + FN}
</script></span></li>
<li><strong><span>F1-score</span></strong><span> — гармоническое среднее </span><em><span>precision</span></em><span> и </span><em><span>recall</span></em><br>
<span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span class="mjx-chtml MJXc-display" style="text-align: center;"><span id="MathJax-Element-11-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 118%; text-align: center; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><mfrac><mn>2</mn><mrow><msup><mtext>precision</mtext><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo>&amp;#x2212;</mo><mn>1</mn></mrow></msup><mo>+</mo><msup><mtext>recall</mtext><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo>&amp;#x2212;</mo><mn>1</mn></mrow></msup></mrow></mfrac><mo>=</mo><mfrac><mrow><mn>2</mn><mo>&amp;#x22C5;</mo><mtext>precision</mtext><mo>&amp;#x22C5;</mo><mtext>recall</mtext></mrow><mrow><mtext>precision</mtext><mo>+</mo><mtext>recall</mtext></mrow></mfrac></math>" role="presentation"><span id="MJXc-Node-124" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-125" class="mjx-mrow"><span id="MJXc-Node-126" class="mjx-mfrac"><span class="mjx-box MJXc-stacked" style="width: 9.479em; padding: 0px 0.12em;"><span class="mjx-numerator" style="width: 9.479em; top: -1.368em;"><span id="MJXc-Node-127" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.373em; padding-bottom: 0.32em;">2</span></span></span><span class="mjx-denominator" style="width: 9.479em; bottom: -1.129em;"><span id="MJXc-Node-128" class="mjx-mrow"><span id="MJXc-Node-129" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-130" class="mjx-mtext"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.373em; padding-bottom: 0.532em;">precision</span></span></span><span class="mjx-sup" style="font-size: 70.7%; vertical-align: 0.595em; padding-left: 0px; padding-right: 0.071em;"><span id="MJXc-Node-131" class="mjx-texatom" style=""><span id="MJXc-Node-132" class="mjx-mrow"><span id="MJXc-Node-133" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.32em; padding-bottom: 0.426em;">−</span></span><span id="MJXc-Node-134" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.373em; padding-bottom: 0.32em;">1</span></span></span></span></span></span><span id="MJXc-Node-135" class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.32em; padding-bottom: 0.426em;">+</span></span><span id="MJXc-Node-136" class="mjx-msubsup MJXc-space2"><span class="mjx-base"><span id="MJXc-Node-137" class="mjx-mtext"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.426em; padding-bottom: 0.373em;">recall</span></span></span><span class="mjx-sup" style="font-size: 70.7%; vertical-align: 0.631em; padding-left: 0px; padding-right: 0.071em;"><span id="MJXc-Node-138" class="mjx-texatom" style=""><span id="MJXc-Node-139" class="mjx-mrow"><span id="MJXc-Node-140" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.32em; padding-bottom: 0.426em;">−</span></span><span id="MJXc-Node-141" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.373em; padding-bottom: 0.32em;">1</span></span></span></span></span></span></span></span><span style="border-bottom-width: 1.3px; border-bottom-style: solid; top: -0.283em; width: 9.479em;" class="mjx-line"></span></span><span style="height: 2.497em; vertical-align: -1.129em;" class="mjx-vsize"></span></span><span id="MJXc-Node-142" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.056em; padding-bottom: 0.32em;">=</span></span><span id="MJXc-Node-143" class="mjx-mfrac MJXc-space3"><span class="mjx-box MJXc-stacked" style="width: 8.323em; padding: 0px 0.12em;"><span class="mjx-numerator" style="width: 8.323em; top: -1.414em;"><span id="MJXc-Node-144" class="mjx-mrow"><span id="MJXc-Node-145" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.373em; padding-bottom: 0.32em;">2</span></span><span id="MJXc-Node-146" class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.003em; padding-bottom: 0.32em;">⋅</span></span><span id="MJXc-Node-147" class="mjx-mtext MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.373em; padding-bottom: 0.532em;">precision</span></span><span id="MJXc-Node-148" class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.003em; padding-bottom: 0.32em;">⋅</span></span><span id="MJXc-Node-149" class="mjx-mtext MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.426em; padding-bottom: 0.373em;">recall</span></span></span></span><span class="mjx-denominator" style="width: 8.323em; bottom: -0.914em;"><span id="MJXc-Node-150" class="mjx-mrow"><span id="MJXc-Node-151" class="mjx-mtext"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.373em; padding-bottom: 0.532em;">precision</span></span><span id="MJXc-Node-152" class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.32em; padding-bottom: 0.426em;">+</span></span><span id="MJXc-Node-153" class="mjx-mtext MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.426em; padding-bottom: 0.373em;">recall</span></span></span></span><span style="border-bottom-width: 1.3px; border-bottom-style: solid; top: -0.283em; width: 8.323em;" class="mjx-line"></span></span><span style="height: 2.327em; vertical-align: -0.914em;" class="mjx-vsize"></span></span></span></span><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mfrac><mn>2</mn><mrow><msup><mtext>precision</mtext><mrow class="MJX-TeXAtom-ORD"><mo>−</mo><mn>1</mn></mrow></msup><mo>+</mo><msup><mtext>recall</mtext><mrow class="MJX-TeXAtom-ORD"><mo>−</mo><mn>1</mn></mrow></msup></mrow></mfrac><mo>=</mo><mfrac><mrow><mn>2</mn><mo>⋅</mo><mtext>precision</mtext><mo>⋅</mo><mtext>recall</mtext></mrow><mrow><mtext>precision</mtext><mo>+</mo><mtext>recall</mtext></mrow></mfrac></math></span></span></span><script type="math/tex; mode=display" id="MathJax-Element-11">
\frac{2}{\text{precision}^{-1} + \text{recall}^{-1}} = \frac{2\cdot \text{precision} \cdot \text{recall}}{\text{precision} + \text{recall}}
</script></span>
<ul>
<li><span>Три метрики описанные выше можно определить и для случая </span><strong><span>многоклассовой классификации</span></strong><span>. Есть несколько способов это сделать, но суть всех в каком-либо усреднении метрики для каждого класса.</span>
<ul>
<li><span>Macro F1 — сумма f1-score для каждого класса разделённая на количество классов.</span></li>
<li><span>Weighted F1 — аналогичная сумма, но взвешенная (</span><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-12-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 118%; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>f</mi><mn>1</mn></math>" role="presentation"><span id="MJXc-Node-154" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-155" class="mjx-mrow"><span id="MJXc-Node-156" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.479em; padding-right: 0.06em;">f</span></span><span id="MJXc-Node-157" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.373em; padding-bottom: 0.32em;">1</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>f</mi><mn>1</mn></math></span></span><script type="math/tex" id="MathJax-Element-12">f1</script></span><span> каждого класса умножается на количество объектов в классе и затем вся сумма делится на количество объектов в выборке)</span></li>
<li><span>Micro F1 — сумма взвешенная по выборке. Совпадает с accuracy.</span></li>
</ul>
</li>
</ul>
</li>
<li><strong><span>ROC-curve</span></strong><span> — график в осях FPR (False Positive Rate, ось </span><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-13-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 118%; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>x</mi></math>" role="presentation"><span id="MJXc-Node-158" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-159" class="mjx-mrow"><span id="MJXc-Node-160" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.215em; padding-bottom: 0.267em;">x</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>x</mi></math></span></span><script type="math/tex" id="MathJax-Element-13">x</script></span><span>) и TPR (True Positive Rate, ось </span><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-14-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 118%; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>y</mi></math>" role="presentation"><span id="MJXc-Node-161" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-162" class="mjx-mrow"><span id="MJXc-Node-163" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.215em; padding-bottom: 0.479em; padding-right: 0.006em;">y</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>y</mi></math></span></span><script type="math/tex" id="MathJax-Element-14">y</script></span><span>).</span><br>
<span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span class="mjx-chtml MJXc-display" style="text-align: center;"><span id="MathJax-Element-15-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 118%; text-align: center; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><mtext>FPR</mtext><mo>=</mo><mfrac><mrow><mi>F</mi><mi>P</mi></mrow><mrow><mi>F</mi><mi>P</mi><mo>+</mo><mi>T</mi><mi>N</mi></mrow></mfrac><mo>,</mo><mspace width=&quot;thickmathspace&quot; /><mtext>TPR</mtext><mo>=</mo><mfrac><mrow><mi>T</mi><mi>P</mi></mrow><mrow><mi>T</mi><mi>P</mi><mo>+</mo><mi>F</mi><mi>N</mi></mrow></mfrac><mo stretchy=&quot;false&quot;>(</mo><mo>=</mo><mtext>Recall</mtext><mo stretchy=&quot;false&quot;>)</mo></math>" role="presentation"><span id="MJXc-Node-164" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-165" class="mjx-mrow"><span id="MJXc-Node-166" class="mjx-mtext"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.373em; padding-bottom: 0.373em;">FPR</span></span><span id="MJXc-Node-167" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.056em; padding-bottom: 0.32em;">=</span></span><span id="MJXc-Node-168" class="mjx-mfrac MJXc-space3"><span class="mjx-box MJXc-stacked" style="width: 4.514em; padding: 0px 0.12em;"><span class="mjx-numerator" style="width: 4.514em; top: -1.385em;"><span id="MJXc-Node-169" class="mjx-mrow"><span id="MJXc-Node-170" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.267em; padding-right: 0.106em;">F</span></span><span id="MJXc-Node-171" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.267em; padding-right: 0.109em;">P</span></span></span></span><span class="mjx-denominator" style="width: 4.514em; bottom: -0.793em;"><span id="MJXc-Node-172" class="mjx-mrow"><span id="MJXc-Node-173" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.267em; padding-right: 0.106em;">F</span></span><span id="MJXc-Node-174" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.267em; padding-right: 0.109em;">P</span></span><span id="MJXc-Node-175" class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.32em; padding-bottom: 0.426em;">+</span></span><span id="MJXc-Node-176" class="mjx-mi MJXc-space2"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.267em; padding-right: 0.12em;">T</span></span><span id="MJXc-Node-177" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.267em; padding-right: 0.085em;">N</span></span></span></span><span style="border-bottom-width: 1.3px; border-bottom-style: solid; top: -0.283em; width: 4.514em;" class="mjx-line"></span></span><span style="height: 2.177em; vertical-align: -0.793em;" class="mjx-vsize"></span></span><span id="MJXc-Node-178" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="margin-top: -0.156em; padding-bottom: 0.532em;">,</span></span><span id="MJXc-Node-179" class="mjx-mspace" style="width: 0.278em; height: 0px;"></span><span id="MJXc-Node-180" class="mjx-mtext MJXc-space1"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.373em; padding-bottom: 0.373em;">TPR</span></span><span id="MJXc-Node-181" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.056em; padding-bottom: 0.32em;">=</span></span><span id="MJXc-Node-182" class="mjx-mfrac MJXc-space3"><span class="mjx-box MJXc-stacked" style="width: 4.514em; padding: 0px 0.12em;"><span class="mjx-numerator" style="width: 4.514em; top: -1.385em;"><span id="MJXc-Node-183" class="mjx-mrow"><span id="MJXc-Node-184" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.267em; padding-right: 0.12em;">T</span></span><span id="MJXc-Node-185" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.267em; padding-right: 0.109em;">P</span></span></span></span><span class="mjx-denominator" style="width: 4.514em; bottom: -0.793em;"><span id="MJXc-Node-186" class="mjx-mrow"><span id="MJXc-Node-187" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.267em; padding-right: 0.12em;">T</span></span><span id="MJXc-Node-188" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.267em; padding-right: 0.109em;">P</span></span><span id="MJXc-Node-189" class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.32em; padding-bottom: 0.426em;">+</span></span><span id="MJXc-Node-190" class="mjx-mi MJXc-space2"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.267em; padding-right: 0.106em;">F</span></span><span id="MJXc-Node-191" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.267em; padding-right: 0.085em;">N</span></span></span></span><span style="border-bottom-width: 1.3px; border-bottom-style: solid; top: -0.283em; width: 4.514em;" class="mjx-line"></span></span><span style="height: 2.177em; vertical-align: -0.793em;" class="mjx-vsize"></span></span><span id="MJXc-Node-192" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.479em; padding-bottom: 0.585em;">(</span></span><span id="MJXc-Node-193" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.056em; padding-bottom: 0.32em;">=</span></span><span id="MJXc-Node-194" class="mjx-mtext MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.426em; padding-bottom: 0.373em;">Recall</span></span><span id="MJXc-Node-195" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.479em; padding-bottom: 0.585em;">)</span></span></span></span><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mtext>FPR</mtext><mo>=</mo><mfrac><mrow><mi>F</mi><mi>P</mi></mrow><mrow><mi>F</mi><mi>P</mi><mo>+</mo><mi>T</mi><mi>N</mi></mrow></mfrac><mo>,</mo><mspace width="thickmathspace"></mspace><mtext>TPR</mtext><mo>=</mo><mfrac><mrow><mi>T</mi><mi>P</mi></mrow><mrow><mi>T</mi><mi>P</mi><mo>+</mo><mi>F</mi><mi>N</mi></mrow></mfrac><mo stretchy="false">(</mo><mo>=</mo><mtext>Recall</mtext><mo stretchy="false">)</mo></math></span></span></span><script type="math/tex; mode=display" id="MathJax-Element-15">
 \text{FPR} = \frac{FP}{FP + TN}, \; \text{TPR} = \frac{TP}{TP + FN} (= \text{Recall})
</script></span>
<ul>
<li><span>FPR — доля неправильно угаданных объектов негативного класса.</span></li>
<li><span>TPR — доля правильно угаданных объектов позитивного класса.</span></li>
<li><span>Используется для классификаторов, предсказывающих вероятность позитивного класса. Соответственно, после получения этих вероятностей выбирается граница (threshold) для вероятности. Если вероятность объекта выше этой границы, он относится к позитивному классу, иначе — к негативному. Обычно граница </span><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-16-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 118%; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mo>=</mo><mn>0.5.</mn></math>" role="presentation"><span id="MJXc-Node-196" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-197" class="mjx-mrow"><span id="MJXc-Node-198" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.056em; padding-bottom: 0.32em;">=</span></span><span id="MJXc-Node-199" class="mjx-mn MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.373em; padding-bottom: 0.373em;">0.5.</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo>=</mo><mn>0.5.</mn></math></span></span><script type="math/tex" id="MathJax-Element-16">= 0.5.</script></span><span> Соответственно, двигая эту границу от 0 к 1 мы получим конечное количество точек в указанных осях. Соединяя их мы получаем кривую, которая является метрикой качества алгоритма.</span></li>
<li><span>Свойства кривой:</span>
<ul>
<li><span>Всегда начинается в точке </span><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-17-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 118%; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mo stretchy=&quot;false&quot;>(</mo><mn>0</mn><mo>,</mo><mn>0</mn><mo stretchy=&quot;false&quot;>)</mo></math>" role="presentation"><span id="MJXc-Node-200" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-201" class="mjx-mrow"><span id="MJXc-Node-202" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.479em; padding-bottom: 0.585em;">(</span></span><span id="MJXc-Node-203" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.373em; padding-bottom: 0.373em;">0</span></span><span id="MJXc-Node-204" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="margin-top: -0.156em; padding-bottom: 0.532em;">,</span></span><span id="MJXc-Node-205" class="mjx-mn MJXc-space1"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.373em; padding-bottom: 0.373em;">0</span></span><span id="MJXc-Node-206" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.479em; padding-bottom: 0.585em;">)</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo stretchy="false">(</mo><mn>0</mn><mo>,</mo><mn>0</mn><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-17">(0, 0)</script></span><span> и заканчивается в точке </span><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-18-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 118%; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mo stretchy=&quot;false&quot;>(</mo><mn>1</mn><mo>,</mo><mn>1</mn><mo stretchy=&quot;false&quot;>)</mo><mo>.</mo></math>" role="presentation"><span id="MJXc-Node-207" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-208" class="mjx-mrow"><span id="MJXc-Node-209" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.479em; padding-bottom: 0.585em;">(</span></span><span id="MJXc-Node-210" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.373em; padding-bottom: 0.32em;">1</span></span><span id="MJXc-Node-211" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="margin-top: -0.156em; padding-bottom: 0.532em;">,</span></span><span id="MJXc-Node-212" class="mjx-mn MJXc-space1"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.373em; padding-bottom: 0.32em;">1</span></span><span id="MJXc-Node-213" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.479em; padding-bottom: 0.585em;">)</span></span><span id="MJXc-Node-214" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="margin-top: -0.156em; padding-bottom: 0.32em;">.</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo stretchy="false">(</mo><mn>1</mn><mo>,</mo><mn>1</mn><mo stretchy="false">)</mo><mo>.</mo></math></span></span><script type="math/tex" id="MathJax-Element-18">(1, 1).</script></span></li>
<li><span>Чем лучше алгоритм — тем выше эта кривая</span></li>
<li><span>Кривая идеального алгоритма проходит через точку </span><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-19-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 118%; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mo stretchy=&quot;false&quot;>(</mo><mn>1</mn><mo>,</mo><mn>0</mn><mo stretchy=&quot;false&quot;>)</mo><mo>.</mo></math>" role="presentation"><span id="MJXc-Node-215" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-216" class="mjx-mrow"><span id="MJXc-Node-217" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.479em; padding-bottom: 0.585em;">(</span></span><span id="MJXc-Node-218" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.373em; padding-bottom: 0.32em;">1</span></span><span id="MJXc-Node-219" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="margin-top: -0.156em; padding-bottom: 0.532em;">,</span></span><span id="MJXc-Node-220" class="mjx-mn MJXc-space1"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.373em; padding-bottom: 0.373em;">0</span></span><span id="MJXc-Node-221" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.479em; padding-bottom: 0.585em;">)</span></span><span id="MJXc-Node-222" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="margin-top: -0.156em; padding-bottom: 0.32em;">.</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo stretchy="false">(</mo><mn>1</mn><mo>,</mo><mn>0</mn><mo stretchy="false">)</mo><mo>.</mo></math></span></span><script type="math/tex" id="MathJax-Element-19">(1, 0).</script></span></li>
<li><span>Диагональ от </span><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-20-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 118%; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mo stretchy=&quot;false&quot;>(</mo><mn>0</mn><mo>,</mo><mn>0</mn><mo stretchy=&quot;false&quot;>)</mo></math>" role="presentation"><span id="MJXc-Node-223" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-224" class="mjx-mrow"><span id="MJXc-Node-225" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.479em; padding-bottom: 0.585em;">(</span></span><span id="MJXc-Node-226" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.373em; padding-bottom: 0.373em;">0</span></span><span id="MJXc-Node-227" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="margin-top: -0.156em; padding-bottom: 0.532em;">,</span></span><span id="MJXc-Node-228" class="mjx-mn MJXc-space1"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.373em; padding-bottom: 0.373em;">0</span></span><span id="MJXc-Node-229" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.479em; padding-bottom: 0.585em;">)</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo stretchy="false">(</mo><mn>0</mn><mo>,</mo><mn>0</mn><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-20">(0, 0)</script></span><span> к </span><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-21-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 118%; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mo stretchy=&quot;false&quot;>(</mo><mn>0</mn><mo>,</mo><mn>1</mn><mo stretchy=&quot;false&quot;>)</mo></math>" role="presentation"><span id="MJXc-Node-230" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-231" class="mjx-mrow"><span id="MJXc-Node-232" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.479em; padding-bottom: 0.585em;">(</span></span><span id="MJXc-Node-233" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.373em; padding-bottom: 0.373em;">0</span></span><span id="MJXc-Node-234" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="margin-top: -0.156em; padding-bottom: 0.532em;">,</span></span><span id="MJXc-Node-235" class="mjx-mn MJXc-space1"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.373em; padding-bottom: 0.32em;">1</span></span><span id="MJXc-Node-236" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.479em; padding-bottom: 0.585em;">)</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo stretchy="false">(</mo><mn>0</mn><mo>,</mo><mn>1</mn><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-21">(0, 1)</script></span><span> — кривая для случайной модели. Соответственно, кривая разумного алгоритма всегда будет лежать выше диагонали.</span></li>
</ul>
</li>
<li><strong><span>ROC-AUC</span></strong><span> — площадь под ROC кривой. Также является метрикой качества (т.к. чем выше кривая, тем лучше алгоритм и тем больше площадь)</span>
<ul>
<li><span>Значение AUC−ROC имеет смысл вероятности того, что если были выбраны случайный положительный и случайный отрицаельный объекты выборки, положительный объект получит оценку принадлежности выше, чем отрицательный объект.</span></li>
</ul>
</li>
<li><span>Пример ROC-кривой:</span><br>
<img src="https://scikit-learn.org/stable/_images/sphx_glr_plot_roc_001.png" alt=""></li>
</ul>
</li>
<li><strong><span>PR-curve</span></strong><span> — график в осях Precision (ось </span><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-22-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 118%; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>y</mi></math>" role="presentation"><span id="MJXc-Node-237" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-238" class="mjx-mrow"><span id="MJXc-Node-239" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.215em; padding-bottom: 0.479em; padding-right: 0.006em;">y</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>y</mi></math></span></span><script type="math/tex" id="MathJax-Element-22">y</script></span><span>) и Recall(ось </span><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-23-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 118%; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>x</mi></math>" role="presentation"><span id="MJXc-Node-240" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-241" class="mjx-mrow"><span id="MJXc-Node-242" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.215em; padding-bottom: 0.267em;">x</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>x</mi></math></span></span><script type="math/tex" id="MathJax-Element-23">x</script></span><span>).</span>
<ul>
<li><span>Строится аналогично ROC-кривой, с помощью перемещения границы.</span></li>
<li><span>Свойства:</span>
<ul>
<li><span>Всегда идёт из точки </span><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-24-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 118%; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mo stretchy=&quot;false&quot;>(</mo><mn>0</mn><mo>,</mo><mn>1</mn><mo stretchy=&quot;false&quot;>)</mo></math>" role="presentation"><span id="MJXc-Node-243" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-244" class="mjx-mrow"><span id="MJXc-Node-245" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.479em; padding-bottom: 0.585em;">(</span></span><span id="MJXc-Node-246" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.373em; padding-bottom: 0.373em;">0</span></span><span id="MJXc-Node-247" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="margin-top: -0.156em; padding-bottom: 0.532em;">,</span></span><span id="MJXc-Node-248" class="mjx-mn MJXc-space1"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.373em; padding-bottom: 0.32em;">1</span></span><span id="MJXc-Node-249" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.479em; padding-bottom: 0.585em;">)</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo stretchy="false">(</mo><mn>0</mn><mo>,</mo><mn>1</mn><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-24">(0, 1)</script></span><span> в точку </span><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-25-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 118%; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mo stretchy=&quot;false&quot;>(</mo><mn>1</mn><mo>,</mo><mi>r</mi><mo stretchy=&quot;false&quot;>)</mo><mo>,</mo></math>" role="presentation"><span id="MJXc-Node-250" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-251" class="mjx-mrow"><span id="MJXc-Node-252" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.479em; padding-bottom: 0.585em;">(</span></span><span id="MJXc-Node-253" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.373em; padding-bottom: 0.32em;">1</span></span><span id="MJXc-Node-254" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="margin-top: -0.156em; padding-bottom: 0.532em;">,</span></span><span id="MJXc-Node-255" class="mjx-mi MJXc-space1"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.215em; padding-bottom: 0.267em;">r</span></span><span id="MJXc-Node-256" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.479em; padding-bottom: 0.585em;">)</span></span><span id="MJXc-Node-257" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="margin-top: -0.156em; padding-bottom: 0.532em;">,</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo stretchy="false">(</mo><mn>1</mn><mo>,</mo><mi>r</mi><mo stretchy="false">)</mo><mo>,</mo></math></span></span><script type="math/tex" id="MathJax-Element-25">(1, r),</script></span><span> где </span><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-26-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 118%; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>r</mi></math>" role="presentation"><span id="MJXc-Node-258" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-259" class="mjx-mrow"><span id="MJXc-Node-260" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.215em; padding-bottom: 0.267em;">r</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>r</mi></math></span></span><script type="math/tex" id="MathJax-Element-26">r</script></span><span> — доля объектов позитивного класса.</span></li>
<li><span>PR-кривая случайной модели лежит на оси </span><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-27-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 118%; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>x</mi></math>" role="presentation"><span id="MJXc-Node-261" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-262" class="mjx-mrow"><span id="MJXc-Node-263" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.215em; padding-bottom: 0.267em;">x</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>x</mi></math></span></span><script type="math/tex" id="MathJax-Element-27">x</script></span><span>.</span></li>
<li><span>Чем выше кривая тем лучше модель</span></li>
<li><span>Идеальная модель проходит через точку </span><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-28-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 118%; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mo stretchy=&quot;false&quot;>(</mo><mn>1</mn><mo>,</mo><mn>1.</mn><mo stretchy=&quot;false&quot;>)</mo></math>" role="presentation"><span id="MJXc-Node-264" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-265" class="mjx-mrow"><span id="MJXc-Node-266" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.479em; padding-bottom: 0.585em;">(</span></span><span id="MJXc-Node-267" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.373em; padding-bottom: 0.32em;">1</span></span><span id="MJXc-Node-268" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="margin-top: -0.156em; padding-bottom: 0.532em;">,</span></span><span id="MJXc-Node-269" class="mjx-mn MJXc-space1"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.373em; padding-bottom: 0.32em;">1.</span></span><span id="MJXc-Node-270" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.479em; padding-bottom: 0.585em;">)</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo stretchy="false">(</mo><mn>1</mn><mo>,</mo><mn>1.</mn><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-28">(1, 1.)</script></span></li>
</ul>
</li>
<li><strong><span>PR-AUC</span></strong><span> — площадь под PR-кривой.</span></li>
<li><span>Пример PR-кривой:</span><br>
<img src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2020/01/Precision-Recall-Curve-of-a-Logistic-Regression-Model-and-a-No-Skill-Classifier2.png" alt=""></li>
</ul>
</li>
</ul><h3 id="2-Метрики-качества-регрессии-MSE-MAE-R2-другие" data-id="2-Метрики-качества-регрессии-MSE-MAE-R2-другие"><a class="anchor hidden-xs" href="#2-Метрики-качества-регрессии-MSE-MAE-R2-другие" title="2-Метрики-качества-регрессии-MSE-MAE-R2-другие"><span class="octicon octicon-link"></span></a><span>2. Метрики качества регрессии: MSE, MAE, R</span><sup><span>2</span></sup><span>, другие.</span></h3><p><span>Здесь </span><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-29-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 118%; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mover><mi>Y</mi><mo stretchy=&quot;false&quot;>&amp;#x005E;</mo></mover></mrow></math>" role="presentation"><span id="MJXc-Node-271" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-272" class="mjx-mrow"><span id="MJXc-Node-273" class="mjx-texatom"><span id="MJXc-Node-274" class="mjx-mrow"><span id="MJXc-Node-275" class="mjx-munderover"><span class="mjx-stack"><span class="mjx-over" style="height: 0.213em; padding-bottom: 0.06em; padding-left: 0.275em;"><span id="MJXc-Node-277" class="mjx-mo" style="vertical-align: top;"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.426em; padding-bottom: 0.32em;">^</span></span></span><span class="mjx-op"><span id="MJXc-Node-276" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.267em; padding-right: 0.182em;">Y</span></span></span></span></span></span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow class="MJX-TeXAtom-ORD"><mover><mi>Y</mi><mo stretchy="false">^</mo></mover></mrow></math></span></span><script type="math/tex" id="MathJax-Element-29">\hat{Y}</script></span><span> и </span><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-30-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 118%; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mover><mi>y</mi><mo stretchy=&quot;false&quot;>&amp;#x005E;</mo></mover></mrow></math>" role="presentation"><span id="MJXc-Node-278" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-279" class="mjx-mrow"><span id="MJXc-Node-280" class="mjx-texatom"><span id="MJXc-Node-281" class="mjx-mrow"><span id="MJXc-Node-282" class="mjx-munderover"><span class="mjx-stack"><span class="mjx-over" style="height: 0.213em; padding-bottom: 0.06em; padding-left: 0.083em;"><span id="MJXc-Node-284" class="mjx-mo" style="vertical-align: top;"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.426em; padding-bottom: 0.32em;">^</span></span></span><span class="mjx-op"><span id="MJXc-Node-283" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.215em; padding-bottom: 0.479em; padding-right: 0.006em;">y</span></span></span></span></span></span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow class="MJX-TeXAtom-ORD"><mover><mi>y</mi><mo stretchy="false">^</mo></mover></mrow></math></span></span><script type="math/tex" id="MathJax-Element-30">\hat{y}</script></span><span> — предсказанные значения таргета, </span><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-31-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 118%; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>Y</mi></math>" role="presentation"><span id="MJXc-Node-285" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-286" class="mjx-mrow"><span id="MJXc-Node-287" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.267em; padding-right: 0.182em;">Y</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>Y</mi></math></span></span><script type="math/tex" id="MathJax-Element-31">Y</script></span><span> и </span><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-32-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 118%; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>y</mi></math>" role="presentation"><span id="MJXc-Node-288" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-289" class="mjx-mrow"><span id="MJXc-Node-290" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.215em; padding-bottom: 0.479em; padding-right: 0.006em;">y</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>y</mi></math></span></span><script type="math/tex" id="MathJax-Element-32">y</script></span><span> — истинные значения таргета.</span></p><ul>
<li><span>MSE (Mean Squared Error): </span><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-33-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 118%; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mfrac><mn>1</mn><mi>n</mi></mfrac><munderover><mo movablelimits=&quot;false&quot;>&amp;#x2211;</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>n</mi></munderover><mo stretchy=&quot;false&quot;>(</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mover><msub><mi>y</mi><mi>i</mi></msub><mo stretchy=&quot;false&quot;>&amp;#x005E;</mo></mover></mrow><mo>&amp;#x2212;</mo><msub><mi>y</mi><mi>i</mi></msub><msup><mo stretchy=&quot;false&quot;>)</mo><mn>2</mn></msup><mo>=</mo><mfrac><mn>1</mn><mi>n</mi></mfrac><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>|</mo></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>|</mo></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mover><mi>Y</mi><mo stretchy=&quot;false&quot;>&amp;#x005E;</mo></mover></mrow><mo>&amp;#x2212;</mo><mi>Y</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>|</mo></mrow><msubsup><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>|</mo></mrow><mn>2</mn><mn>2</mn></msubsup></math>" role="presentation"><span id="MJXc-Node-291" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-292" class="mjx-mrow"><span id="MJXc-Node-293" class="mjx-mfrac"><span class="mjx-box MJXc-stacked" style="width: 0.566em; padding: 0px 0.12em;"><span class="mjx-numerator" style="font-size: 70.7%; width: 0.8em; top: -1.299em;"><span id="MJXc-Node-294" class="mjx-mn" style=""><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.373em; padding-bottom: 0.32em;">1</span></span></span><span class="mjx-denominator" style="font-size: 70.7%; width: 0.8em; bottom: -0.524em;"><span id="MJXc-Node-295" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.215em; padding-bottom: 0.267em;">n</span></span></span><span style="border-bottom-width: 1.3px; border-bottom-style: solid; top: -0.283em; width: 0.566em;" class="mjx-line"></span></span><span style="height: 1.289em; vertical-align: -0.37em;" class="mjx-vsize"></span></span><span id="MJXc-Node-296" class="mjx-munderover MJXc-space1"><span class="mjx-itable"><span class="mjx-row"><span class="mjx-cell"><span class="mjx-stack"><span class="mjx-over" style="font-size: 70.7%; padding-bottom: 0.247em; padding-top: 0.141em; padding-left: 0.512em;"><span id="MJXc-Node-303" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.215em; padding-bottom: 0.267em;">n</span></span></span><span class="mjx-op" style="padding-left: 0.046em;"><span id="MJXc-Node-297" class="mjx-mo"><span class="mjx-char MJXc-TeX-size1-R" style="padding-top: 0.532em; padding-bottom: 0.532em;">∑</span></span></span></span></span></span><span class="mjx-row"><span class="mjx-under" style="font-size: 70.7%; padding-top: 0.236em; padding-bottom: 0.141em;"><span id="MJXc-Node-298" class="mjx-texatom" style=""><span id="MJXc-Node-299" class="mjx-mrow"><span id="MJXc-Node-300" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.426em; padding-bottom: 0.267em;">i</span></span><span id="MJXc-Node-301" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.056em; padding-bottom: 0.32em;">=</span></span><span id="MJXc-Node-302" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.373em; padding-bottom: 0.32em;">1</span></span></span></span></span></span></span></span><span id="MJXc-Node-304" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.479em; padding-bottom: 0.585em;">(</span></span><span id="MJXc-Node-305" class="mjx-texatom"><span id="MJXc-Node-306" class="mjx-mrow"><span id="MJXc-Node-307" class="mjx-munderover"><span class="mjx-stack"><span class="mjx-over" style="height: 0.213em; padding-bottom: 0.06em; padding-left: 0.135em;"><span id="MJXc-Node-311" class="mjx-mo" style="vertical-align: top;"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.426em; padding-bottom: 0.32em;">^</span></span></span><span class="mjx-op"><span id="MJXc-Node-308" class="mjx-msubsup"><span class="mjx-base" style="margin-right: -0.006em;"><span id="MJXc-Node-309" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.215em; padding-bottom: 0.479em; padding-right: 0.006em;">y</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-310" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.426em; padding-bottom: 0.267em;">i</span></span></span></span></span></span></span></span></span><span id="MJXc-Node-312" class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.32em; padding-bottom: 0.426em;">−</span></span><span id="MJXc-Node-313" class="mjx-msubsup MJXc-space2"><span class="mjx-base" style="margin-right: -0.006em;"><span id="MJXc-Node-314" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.215em; padding-bottom: 0.479em; padding-right: 0.006em;">y</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-315" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.426em; padding-bottom: 0.267em;">i</span></span></span></span><span id="MJXc-Node-316" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-317" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.479em; padding-bottom: 0.585em;">)</span></span></span><span class="mjx-sup" style="font-size: 70.7%; vertical-align: 0.513em; padding-left: 0px; padding-right: 0.071em;"><span id="MJXc-Node-318" class="mjx-mn" style=""><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.373em; padding-bottom: 0.32em;">2</span></span></span></span><span id="MJXc-Node-319" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.056em; padding-bottom: 0.32em;">=</span></span><span id="MJXc-Node-320" class="mjx-mfrac MJXc-space3"><span class="mjx-box MJXc-stacked" style="width: 0.566em; padding: 0px 0.12em;"><span class="mjx-numerator" style="font-size: 70.7%; width: 0.8em; top: -1.299em;"><span id="MJXc-Node-321" class="mjx-mn" style=""><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.373em; padding-bottom: 0.32em;">1</span></span></span><span class="mjx-denominator" style="font-size: 70.7%; width: 0.8em; bottom: -0.524em;"><span id="MJXc-Node-322" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.215em; padding-bottom: 0.267em;">n</span></span></span><span style="border-bottom-width: 1.3px; border-bottom-style: solid; top: -0.283em; width: 0.566em;" class="mjx-line"></span></span><span style="height: 1.289em; vertical-align: -0.37em;" class="mjx-vsize"></span></span><span id="MJXc-Node-323" class="mjx-texatom"><span id="MJXc-Node-324" class="mjx-mrow"><span id="MJXc-Node-325" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.479em; padding-bottom: 0.585em;">|</span></span></span></span><span id="MJXc-Node-326" class="mjx-texatom"><span id="MJXc-Node-327" class="mjx-mrow"><span id="MJXc-Node-328" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.479em; padding-bottom: 0.585em;">|</span></span></span></span><span id="MJXc-Node-329" class="mjx-texatom"><span id="MJXc-Node-330" class="mjx-mrow"><span id="MJXc-Node-331" class="mjx-munderover"><span class="mjx-stack"><span class="mjx-over" style="height: 0.213em; padding-bottom: 0.06em; padding-left: 0.275em;"><span id="MJXc-Node-333" class="mjx-mo" style="vertical-align: top;"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.426em; padding-bottom: 0.32em;">^</span></span></span><span class="mjx-op"><span id="MJXc-Node-332" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.267em; padding-right: 0.182em;">Y</span></span></span></span></span></span></span><span id="MJXc-Node-334" class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.32em; padding-bottom: 0.426em;">−</span></span><span id="MJXc-Node-335" class="mjx-mi MJXc-space2"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.267em; padding-right: 0.182em;">Y</span></span><span id="MJXc-Node-336" class="mjx-texatom"><span id="MJXc-Node-337" class="mjx-mrow"><span id="MJXc-Node-338" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.479em; padding-bottom: 0.585em;">|</span></span></span></span><span id="MJXc-Node-339" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-340" class="mjx-texatom"><span id="MJXc-Node-341" class="mjx-mrow"><span id="MJXc-Node-342" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.479em; padding-bottom: 0.585em;">|</span></span></span></span></span><span class="mjx-stack" style="vertical-align: -0.309em;"><span class="mjx-sup" style="font-size: 70.7%; padding-bottom: 0.431em; padding-left: 0px; padding-right: 0.071em;"><span id="MJXc-Node-344" class="mjx-mn" style=""><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.373em; padding-bottom: 0.32em;">2</span></span></span><span class="mjx-sub" style="font-size: 70.7%; padding-right: 0.071em;"><span id="MJXc-Node-343" class="mjx-mn" style=""><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.373em; padding-bottom: 0.32em;">2</span></span></span></span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mfrac><mn>1</mn><mi>n</mi></mfrac><munderover><mo movablelimits="false">∑</mo><mrow class="MJX-TeXAtom-ORD"><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>n</mi></munderover><mo stretchy="false">(</mo><mrow class="MJX-TeXAtom-ORD"><mover><msub><mi>y</mi><mi>i</mi></msub><mo stretchy="false">^</mo></mover></mrow><mo>−</mo><msub><mi>y</mi><mi>i</mi></msub><msup><mo stretchy="false">)</mo><mn>2</mn></msup><mo>=</mo><mfrac><mn>1</mn><mi>n</mi></mfrac><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><mrow class="MJX-TeXAtom-ORD"><mover><mi>Y</mi><mo stretchy="false">^</mo></mover></mrow><mo>−</mo><mi>Y</mi><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><msubsup><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><mn>2</mn><mn>2</mn></msubsup></math></span></span><script type="math/tex" id="MathJax-Element-33">\frac{1}{n}\sum\limits_{i = 1}^n(\hat{y_i} - y_i)^2 = \frac{1}{n}||\hat{Y} - Y||_2^2</script></span></li>
<li><span>MAE (Mean Absoulte Error): </span><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-34-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 118%; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mfrac><mn>1</mn><mi>n</mi></mfrac><munderover><mo movablelimits=&quot;false&quot;>&amp;#x2211;</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>n</mi></munderover><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>|</mo></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mover><msub><mi>y</mi><mi>i</mi></msub><mo stretchy=&quot;false&quot;>&amp;#x005E;</mo></mover></mrow><mo>&amp;#x2212;</mo><msub><mi>y</mi><mi>i</mi></msub><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>|</mo></mrow><mo>=</mo><mfrac><mn>1</mn><mi>n</mi></mfrac><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>|</mo></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>|</mo></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mover><mi>Y</mi><mo stretchy=&quot;false&quot;>&amp;#x005E;</mo></mover></mrow><mo>&amp;#x2212;</mo><mi>Y</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>|</mo></mrow><msub><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>|</mo></mrow><mn>1</mn></msub></math>" role="presentation"><span id="MJXc-Node-345" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-346" class="mjx-mrow"><span id="MJXc-Node-347" class="mjx-mfrac"><span class="mjx-box MJXc-stacked" style="width: 0.566em; padding: 0px 0.12em;"><span class="mjx-numerator" style="font-size: 70.7%; width: 0.8em; top: -1.299em;"><span id="MJXc-Node-348" class="mjx-mn" style=""><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.373em; padding-bottom: 0.32em;">1</span></span></span><span class="mjx-denominator" style="font-size: 70.7%; width: 0.8em; bottom: -0.524em;"><span id="MJXc-Node-349" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.215em; padding-bottom: 0.267em;">n</span></span></span><span style="border-bottom-width: 1.3px; border-bottom-style: solid; top: -0.283em; width: 0.566em;" class="mjx-line"></span></span><span style="height: 1.289em; vertical-align: -0.37em;" class="mjx-vsize"></span></span><span id="MJXc-Node-350" class="mjx-munderover MJXc-space1"><span class="mjx-itable"><span class="mjx-row"><span class="mjx-cell"><span class="mjx-stack"><span class="mjx-over" style="font-size: 70.7%; padding-bottom: 0.247em; padding-top: 0.141em; padding-left: 0.512em;"><span id="MJXc-Node-357" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.215em; padding-bottom: 0.267em;">n</span></span></span><span class="mjx-op" style="padding-left: 0.046em;"><span id="MJXc-Node-351" class="mjx-mo"><span class="mjx-char MJXc-TeX-size1-R" style="padding-top: 0.532em; padding-bottom: 0.532em;">∑</span></span></span></span></span></span><span class="mjx-row"><span class="mjx-under" style="font-size: 70.7%; padding-top: 0.236em; padding-bottom: 0.141em;"><span id="MJXc-Node-352" class="mjx-texatom" style=""><span id="MJXc-Node-353" class="mjx-mrow"><span id="MJXc-Node-354" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.426em; padding-bottom: 0.267em;">i</span></span><span id="MJXc-Node-355" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.056em; padding-bottom: 0.32em;">=</span></span><span id="MJXc-Node-356" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.373em; padding-bottom: 0.32em;">1</span></span></span></span></span></span></span></span><span id="MJXc-Node-358" class="mjx-texatom MJXc-space1"><span id="MJXc-Node-359" class="mjx-mrow"><span id="MJXc-Node-360" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.479em; padding-bottom: 0.585em;">|</span></span></span></span><span id="MJXc-Node-361" class="mjx-texatom"><span id="MJXc-Node-362" class="mjx-mrow"><span id="MJXc-Node-363" class="mjx-munderover"><span class="mjx-stack"><span class="mjx-over" style="height: 0.213em; padding-bottom: 0.06em; padding-left: 0.135em;"><span id="MJXc-Node-367" class="mjx-mo" style="vertical-align: top;"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.426em; padding-bottom: 0.32em;">^</span></span></span><span class="mjx-op"><span id="MJXc-Node-364" class="mjx-msubsup"><span class="mjx-base" style="margin-right: -0.006em;"><span id="MJXc-Node-365" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.215em; padding-bottom: 0.479em; padding-right: 0.006em;">y</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-366" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.426em; padding-bottom: 0.267em;">i</span></span></span></span></span></span></span></span></span><span id="MJXc-Node-368" class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.32em; padding-bottom: 0.426em;">−</span></span><span id="MJXc-Node-369" class="mjx-msubsup MJXc-space2"><span class="mjx-base" style="margin-right: -0.006em;"><span id="MJXc-Node-370" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.215em; padding-bottom: 0.479em; padding-right: 0.006em;">y</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-371" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.426em; padding-bottom: 0.267em;">i</span></span></span></span><span id="MJXc-Node-372" class="mjx-texatom"><span id="MJXc-Node-373" class="mjx-mrow"><span id="MJXc-Node-374" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.479em; padding-bottom: 0.585em;">|</span></span></span></span><span id="MJXc-Node-375" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.056em; padding-bottom: 0.32em;">=</span></span><span id="MJXc-Node-376" class="mjx-mfrac MJXc-space3"><span class="mjx-box MJXc-stacked" style="width: 0.566em; padding: 0px 0.12em;"><span class="mjx-numerator" style="font-size: 70.7%; width: 0.8em; top: -1.299em;"><span id="MJXc-Node-377" class="mjx-mn" style=""><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.373em; padding-bottom: 0.32em;">1</span></span></span><span class="mjx-denominator" style="font-size: 70.7%; width: 0.8em; bottom: -0.524em;"><span id="MJXc-Node-378" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.215em; padding-bottom: 0.267em;">n</span></span></span><span style="border-bottom-width: 1.3px; border-bottom-style: solid; top: -0.283em; width: 0.566em;" class="mjx-line"></span></span><span style="height: 1.289em; vertical-align: -0.37em;" class="mjx-vsize"></span></span><span id="MJXc-Node-379" class="mjx-texatom"><span id="MJXc-Node-380" class="mjx-mrow"><span id="MJXc-Node-381" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.479em; padding-bottom: 0.585em;">|</span></span></span></span><span id="MJXc-Node-382" class="mjx-texatom"><span id="MJXc-Node-383" class="mjx-mrow"><span id="MJXc-Node-384" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.479em; padding-bottom: 0.585em;">|</span></span></span></span><span id="MJXc-Node-385" class="mjx-texatom"><span id="MJXc-Node-386" class="mjx-mrow"><span id="MJXc-Node-387" class="mjx-munderover"><span class="mjx-stack"><span class="mjx-over" style="height: 0.213em; padding-bottom: 0.06em; padding-left: 0.275em;"><span id="MJXc-Node-389" class="mjx-mo" style="vertical-align: top;"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.426em; padding-bottom: 0.32em;">^</span></span></span><span class="mjx-op"><span id="MJXc-Node-388" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.267em; padding-right: 0.182em;">Y</span></span></span></span></span></span></span><span id="MJXc-Node-390" class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.32em; padding-bottom: 0.426em;">−</span></span><span id="MJXc-Node-391" class="mjx-mi MJXc-space2"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.267em; padding-right: 0.182em;">Y</span></span><span id="MJXc-Node-392" class="mjx-texatom"><span id="MJXc-Node-393" class="mjx-mrow"><span id="MJXc-Node-394" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.479em; padding-bottom: 0.585em;">|</span></span></span></span><span id="MJXc-Node-395" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-396" class="mjx-texatom"><span id="MJXc-Node-397" class="mjx-mrow"><span id="MJXc-Node-398" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.479em; padding-bottom: 0.585em;">|</span></span></span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.437em; padding-right: 0.071em;"><span id="MJXc-Node-399" class="mjx-mn" style=""><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.373em; padding-bottom: 0.32em;">1</span></span></span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mfrac><mn>1</mn><mi>n</mi></mfrac><munderover><mo movablelimits="false">∑</mo><mrow class="MJX-TeXAtom-ORD"><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>n</mi></munderover><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><mrow class="MJX-TeXAtom-ORD"><mover><msub><mi>y</mi><mi>i</mi></msub><mo stretchy="false">^</mo></mover></mrow><mo>−</mo><msub><mi>y</mi><mi>i</mi></msub><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><mo>=</mo><mfrac><mn>1</mn><mi>n</mi></mfrac><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><mrow class="MJX-TeXAtom-ORD"><mover><mi>Y</mi><mo stretchy="false">^</mo></mover></mrow><mo>−</mo><mi>Y</mi><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><msub><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><mn>1</mn></msub></math></span></span><script type="math/tex" id="MathJax-Element-34">\frac{1}{n}\sum\limits_{i = 1}^n|\hat{y_i} - y_i| = \frac{1}{n}||\hat{Y} - Y||_1</script></span></li>
<li><span>RMSE (Rooted MSE): </span><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-35-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 118%; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msqrt><mtext>MSE</mtext></msqrt><mo>=</mo><msqrt><mfrac><mn>1</mn><mi>n</mi></mfrac><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>|</mo></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>|</mo></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mover><mi>Y</mi><mo stretchy=&quot;false&quot;>&amp;#x005E;</mo></mover></mrow><mo>&amp;#x2212;</mo><mi>Y</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>|</mo></mrow><msubsup><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>|</mo></mrow><mn>2</mn><mn>2</mn></msubsup></msqrt></math>" role="presentation"><span id="MJXc-Node-400" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-401" class="mjx-mrow"><span id="MJXc-Node-402" class="mjx-msqrt"><span class="mjx-box" style="padding-top: 0.045em;"><span class="mjx-surd"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.532em; padding-bottom: 0.532em;">√</span></span><span class="mjx-box" style="padding-top: 0.099em; border-top-width: 1.4px; border-top-style: solid;"><span id="MJXc-Node-403" class="mjx-mrow"><span id="MJXc-Node-404" class="mjx-mtext"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.426em; padding-bottom: 0.373em;">MSE</span></span></span></span></span></span><span id="MJXc-Node-405" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.056em; padding-bottom: 0.32em;">=</span></span><span id="MJXc-Node-406" class="mjx-msqrt MJXc-space3"><span class="mjx-box" style="padding-top: 0.045em;"><span class="mjx-surd"><span class="mjx-char MJXc-TeX-size2-R" style="padding-top: 0.903em; padding-bottom: 0.903em;">√</span></span><span class="mjx-box" style="padding-top: 0.207em; border-top-width: 1.4px; border-top-style: solid;"><span id="MJXc-Node-407" class="mjx-mrow"><span id="MJXc-Node-408" class="mjx-mfrac"><span class="mjx-box MJXc-stacked" style="width: 0.566em; padding: 0px 0.12em;"><span class="mjx-numerator" style="font-size: 70.7%; width: 0.8em; top: -1.299em;"><span id="MJXc-Node-409" class="mjx-mn" style=""><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.373em; padding-bottom: 0.32em;">1</span></span></span><span class="mjx-denominator" style="font-size: 70.7%; width: 0.8em; bottom: -0.524em;"><span id="MJXc-Node-410" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.215em; padding-bottom: 0.267em;">n</span></span></span><span style="border-bottom-width: 1.3px; border-bottom-style: solid; top: -0.283em; width: 0.566em;" class="mjx-line"></span></span><span style="height: 1.289em; vertical-align: -0.37em;" class="mjx-vsize"></span></span><span id="MJXc-Node-411" class="mjx-texatom"><span id="MJXc-Node-412" class="mjx-mrow"><span id="MJXc-Node-413" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.479em; padding-bottom: 0.585em;">|</span></span></span></span><span id="MJXc-Node-414" class="mjx-texatom"><span id="MJXc-Node-415" class="mjx-mrow"><span id="MJXc-Node-416" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.479em; padding-bottom: 0.585em;">|</span></span></span></span><span id="MJXc-Node-417" class="mjx-texatom"><span id="MJXc-Node-418" class="mjx-mrow"><span id="MJXc-Node-419" class="mjx-munderover"><span class="mjx-stack"><span class="mjx-over" style="height: 0.213em; padding-bottom: 0.06em; padding-left: 0.275em;"><span id="MJXc-Node-421" class="mjx-mo" style="vertical-align: top;"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.426em; padding-bottom: 0.32em;">^</span></span></span><span class="mjx-op"><span id="MJXc-Node-420" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.267em; padding-right: 0.182em;">Y</span></span></span></span></span></span></span><span id="MJXc-Node-422" class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.32em; padding-bottom: 0.426em;">−</span></span><span id="MJXc-Node-423" class="mjx-mi MJXc-space2"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.267em; padding-right: 0.182em;">Y</span></span><span id="MJXc-Node-424" class="mjx-texatom"><span id="MJXc-Node-425" class="mjx-mrow"><span id="MJXc-Node-426" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.479em; padding-bottom: 0.585em;">|</span></span></span></span><span id="MJXc-Node-427" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-428" class="mjx-texatom"><span id="MJXc-Node-429" class="mjx-mrow"><span id="MJXc-Node-430" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.479em; padding-bottom: 0.585em;">|</span></span></span></span></span><span class="mjx-stack" style="vertical-align: -0.309em;"><span class="mjx-sup" style="font-size: 70.7%; padding-bottom: 0.431em; padding-left: 0px; padding-right: 0.071em;"><span id="MJXc-Node-432" class="mjx-mn" style=""><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.373em; padding-bottom: 0.32em;">2</span></span></span><span class="mjx-sub" style="font-size: 70.7%; padding-right: 0.071em;"><span id="MJXc-Node-431" class="mjx-mn" style=""><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.373em; padding-bottom: 0.32em;">2</span></span></span></span></span></span></span></span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msqrt><mtext>MSE</mtext></msqrt><mo>=</mo><msqrt><mfrac><mn>1</mn><mi>n</mi></mfrac><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><mrow class="MJX-TeXAtom-ORD"><mover><mi>Y</mi><mo stretchy="false">^</mo></mover></mrow><mo>−</mo><mi>Y</mi><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><msubsup><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><mn>2</mn><mn>2</mn></msubsup></msqrt></math></span></span><script type="math/tex" id="MathJax-Element-35">\sqrt{\text{MSE}} = \sqrt{\frac{1}{n}||\hat{Y} - Y||_2^2}</script></span></li>
<li><span>MAPE (Mean Average Percentage Error): </span><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-36-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 118%; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mfrac><mn>1</mn><mi>n</mi></mfrac><munderover><mo movablelimits=&quot;false&quot;>&amp;#x2211;</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>n</mi></munderover><mrow><mo>|</mo><mfrac><mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mover><msub><mi>y</mi><mi>i</mi></msub><mo stretchy=&quot;false&quot;>&amp;#x005E;</mo></mover></mrow><mo>&amp;#x2212;</mo><msub><mi>y</mi><mi>i</mi></msub></mrow><msub><mi>y</mi><mi>i</mi></msub></mfrac><mo>|</mo></mrow></math>" role="presentation"><span id="MJXc-Node-433" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-434" class="mjx-mrow"><span id="MJXc-Node-435" class="mjx-mfrac"><span class="mjx-box MJXc-stacked" style="width: 0.566em; padding: 0px 0.12em;"><span class="mjx-numerator" style="font-size: 70.7%; width: 0.8em; top: -1.299em;"><span id="MJXc-Node-436" class="mjx-mn" style=""><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.373em; padding-bottom: 0.32em;">1</span></span></span><span class="mjx-denominator" style="font-size: 70.7%; width: 0.8em; bottom: -0.524em;"><span id="MJXc-Node-437" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.215em; padding-bottom: 0.267em;">n</span></span></span><span style="border-bottom-width: 1.3px; border-bottom-style: solid; top: -0.283em; width: 0.566em;" class="mjx-line"></span></span><span style="height: 1.289em; vertical-align: -0.37em;" class="mjx-vsize"></span></span><span id="MJXc-Node-438" class="mjx-munderover MJXc-space1"><span class="mjx-itable"><span class="mjx-row"><span class="mjx-cell"><span class="mjx-stack"><span class="mjx-over" style="font-size: 70.7%; padding-bottom: 0.247em; padding-top: 0.141em; padding-left: 0.512em;"><span id="MJXc-Node-445" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.215em; padding-bottom: 0.267em;">n</span></span></span><span class="mjx-op" style="padding-left: 0.046em;"><span id="MJXc-Node-439" class="mjx-mo"><span class="mjx-char MJXc-TeX-size1-R" style="padding-top: 0.532em; padding-bottom: 0.532em;">∑</span></span></span></span></span></span><span class="mjx-row"><span class="mjx-under" style="font-size: 70.7%; padding-top: 0.236em; padding-bottom: 0.141em;"><span id="MJXc-Node-440" class="mjx-texatom" style=""><span id="MJXc-Node-441" class="mjx-mrow"><span id="MJXc-Node-442" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.426em; padding-bottom: 0.267em;">i</span></span><span id="MJXc-Node-443" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.056em; padding-bottom: 0.32em;">=</span></span><span id="MJXc-Node-444" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.373em; padding-bottom: 0.32em;">1</span></span></span></span></span></span></span></span><span id="MJXc-Node-446" class="mjx-mrow MJXc-space1"><span id="MJXc-Node-447" class="mjx-mo" style="vertical-align: -0.324em;"><span class="mjx-delim-v"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.479em; padding-bottom: 0.585em; margin-bottom: -0.401em;">∣</span><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.479em; padding-bottom: 0.585em; margin-top: -0.401em;">∣</span></span></span><span id="MJXc-Node-448" class="mjx-mfrac"><span class="mjx-box MJXc-stacked" style="width: 1.78em; padding: 0px 0.12em;"><span class="mjx-numerator" style="font-size: 70.7%; width: 2.517em; top: -1.553em;"><span id="MJXc-Node-449" class="mjx-mrow" style=""><span id="MJXc-Node-450" class="mjx-texatom"><span id="MJXc-Node-451" class="mjx-mrow"><span id="MJXc-Node-452" class="mjx-munderover"><span class="mjx-stack"><span class="mjx-over" style="height: 0.213em; padding-bottom: 0.06em; padding-left: 0.135em;"><span id="MJXc-Node-456" class="mjx-mo" style="vertical-align: top;"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.426em; padding-bottom: 0.32em;">^</span></span></span><span class="mjx-op"><span id="MJXc-Node-453" class="mjx-msubsup"><span class="mjx-base" style="margin-right: -0.006em;"><span id="MJXc-Node-454" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.215em; padding-bottom: 0.479em; padding-right: 0.006em;">y</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-455" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.426em; padding-bottom: 0.267em;">i</span></span></span></span></span></span></span></span></span><span id="MJXc-Node-457" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.32em; padding-bottom: 0.426em;">−</span></span><span id="MJXc-Node-458" class="mjx-msubsup"><span class="mjx-base" style="margin-right: -0.006em;"><span id="MJXc-Node-459" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.215em; padding-bottom: 0.479em; padding-right: 0.006em;">y</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-460" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.426em; padding-bottom: 0.267em;">i</span></span></span></span></span></span><span class="mjx-denominator" style="font-size: 70.7%; width: 2.517em; bottom: -0.718em;"><span id="MJXc-Node-461" class="mjx-msubsup" style=""><span class="mjx-base" style="margin-right: -0.006em;"><span id="MJXc-Node-462" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.215em; padding-bottom: 0.479em; padding-right: 0.006em;">y</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-463" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.426em; padding-bottom: 0.267em;">i</span></span></span></span></span><span style="border-bottom-width: 1.3px; border-bottom-style: solid; top: -0.283em; width: 1.78em;" class="mjx-line"></span></span><span style="height: 1.606em; vertical-align: -0.507em;" class="mjx-vsize"></span></span><span id="MJXc-Node-464" class="mjx-mo" style="vertical-align: -0.324em;"><span class="mjx-delim-v"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.479em; padding-bottom: 0.585em; margin-bottom: -0.401em;">∣</span><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.479em; padding-bottom: 0.585em; margin-top: -0.401em;">∣</span></span></span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mfrac><mn>1</mn><mi>n</mi></mfrac><munderover><mo movablelimits="false">∑</mo><mrow class="MJX-TeXAtom-ORD"><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>n</mi></munderover><mrow><mo>|</mo><mfrac><mrow><mrow class="MJX-TeXAtom-ORD"><mover><msub><mi>y</mi><mi>i</mi></msub><mo stretchy="false">^</mo></mover></mrow><mo>−</mo><msub><mi>y</mi><mi>i</mi></msub></mrow><msub><mi>y</mi><mi>i</mi></msub></mfrac><mo>|</mo></mrow></math></span></span><script type="math/tex" id="MathJax-Element-36">\frac{1}{n}\sum\limits_{i = 1}^n\left|\frac{\hat{y_i} - y_i}{y_i}\right|</script></span>
<ul>
<li><span>Используется, чтобы учитывать масштаб целевой переменной. Т.е. мы минимизируем </span><em><span>процент</span></em><span> на который наша модель ошибается.</span></li>
</ul>
</li>
<li><span>SMAPE (Symmetric MAPE): </span><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-37-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 118%; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mfrac><mn>1</mn><mi>n</mi></mfrac><munderover><mo movablelimits=&quot;false&quot;>&amp;#x2211;</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>n</mi></munderover><mfrac><mrow><mn>2</mn><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>|</mo></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mover><msub><mi>y</mi><mi>i</mi></msub><mo stretchy=&quot;false&quot;>&amp;#x005E;</mo></mover></mrow><mo>&amp;#x2212;</mo><msub><mi>y</mi><mi>i</mi></msub><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>|</mo></mrow></mrow><mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>|</mo></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mover><msub><mi>y</mi><mi>i</mi></msub><mo stretchy=&quot;false&quot;>&amp;#x005E;</mo></mover></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>|</mo></mrow><mo>+</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>|</mo></mrow><msub><mi>y</mi><mi>i</mi></msub><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>|</mo></mrow></mrow></mfrac></math>" role="presentation"><span id="MJXc-Node-465" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-466" class="mjx-mrow"><span id="MJXc-Node-467" class="mjx-mfrac"><span class="mjx-box MJXc-stacked" style="width: 0.566em; padding: 0px 0.12em;"><span class="mjx-numerator" style="font-size: 70.7%; width: 0.8em; top: -1.299em;"><span id="MJXc-Node-468" class="mjx-mn" style=""><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.373em; padding-bottom: 0.32em;">1</span></span></span><span class="mjx-denominator" style="font-size: 70.7%; width: 0.8em; bottom: -0.524em;"><span id="MJXc-Node-469" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.215em; padding-bottom: 0.267em;">n</span></span></span><span style="border-bottom-width: 1.3px; border-bottom-style: solid; top: -0.283em; width: 0.566em;" class="mjx-line"></span></span><span style="height: 1.289em; vertical-align: -0.37em;" class="mjx-vsize"></span></span><span id="MJXc-Node-470" class="mjx-munderover MJXc-space1"><span class="mjx-itable"><span class="mjx-row"><span class="mjx-cell"><span class="mjx-stack"><span class="mjx-over" style="font-size: 70.7%; padding-bottom: 0.247em; padding-top: 0.141em; padding-left: 0.512em;"><span id="MJXc-Node-477" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.215em; padding-bottom: 0.267em;">n</span></span></span><span class="mjx-op" style="padding-left: 0.046em;"><span id="MJXc-Node-471" class="mjx-mo"><span class="mjx-char MJXc-TeX-size1-R" style="padding-top: 0.532em; padding-bottom: 0.532em;">∑</span></span></span></span></span></span><span class="mjx-row"><span class="mjx-under" style="font-size: 70.7%; padding-top: 0.236em; padding-bottom: 0.141em;"><span id="MJXc-Node-472" class="mjx-texatom" style=""><span id="MJXc-Node-473" class="mjx-mrow"><span id="MJXc-Node-474" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.426em; padding-bottom: 0.267em;">i</span></span><span id="MJXc-Node-475" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.056em; padding-bottom: 0.32em;">=</span></span><span id="MJXc-Node-476" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.373em; padding-bottom: 0.32em;">1</span></span></span></span></span></span></span></span><span id="MJXc-Node-478" class="mjx-mfrac MJXc-space1"><span class="mjx-box MJXc-stacked" style="width: 2.566em; padding: 0px 0.12em;"><span class="mjx-numerator" style="font-size: 70.7%; width: 3.629em; top: -1.632em;"><span id="MJXc-Node-479" class="mjx-mrow" style=""><span id="MJXc-Node-480" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.373em; padding-bottom: 0.32em;">2</span></span><span id="MJXc-Node-481" class="mjx-texatom"><span id="MJXc-Node-482" class="mjx-mrow"><span id="MJXc-Node-483" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.479em; padding-bottom: 0.585em;">|</span></span></span></span><span id="MJXc-Node-484" class="mjx-texatom"><span id="MJXc-Node-485" class="mjx-mrow"><span id="MJXc-Node-486" class="mjx-munderover"><span class="mjx-stack"><span class="mjx-over" style="height: 0.213em; padding-bottom: 0.06em; padding-left: 0.135em;"><span id="MJXc-Node-490" class="mjx-mo" style="vertical-align: top;"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.426em; padding-bottom: 0.32em;">^</span></span></span><span class="mjx-op"><span id="MJXc-Node-487" class="mjx-msubsup"><span class="mjx-base" style="margin-right: -0.006em;"><span id="MJXc-Node-488" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.215em; padding-bottom: 0.479em; padding-right: 0.006em;">y</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-489" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.426em; padding-bottom: 0.267em;">i</span></span></span></span></span></span></span></span></span><span id="MJXc-Node-491" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.32em; padding-bottom: 0.426em;">−</span></span><span id="MJXc-Node-492" class="mjx-msubsup"><span class="mjx-base" style="margin-right: -0.006em;"><span id="MJXc-Node-493" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.215em; padding-bottom: 0.479em; padding-right: 0.006em;">y</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-494" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.426em; padding-bottom: 0.267em;">i</span></span></span></span><span id="MJXc-Node-495" class="mjx-texatom"><span id="MJXc-Node-496" class="mjx-mrow"><span id="MJXc-Node-497" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.479em; padding-bottom: 0.585em;">|</span></span></span></span></span></span><span class="mjx-denominator" style="font-size: 70.7%; width: 3.629em; bottom: -0.925em;"><span id="MJXc-Node-498" class="mjx-mrow" style=""><span id="MJXc-Node-499" class="mjx-texatom"><span id="MJXc-Node-500" class="mjx-mrow"><span id="MJXc-Node-501" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.479em; padding-bottom: 0.585em;">|</span></span></span></span><span id="MJXc-Node-502" class="mjx-texatom"><span id="MJXc-Node-503" class="mjx-mrow"><span id="MJXc-Node-504" class="mjx-munderover"><span class="mjx-stack"><span class="mjx-over" style="height: 0.213em; padding-bottom: 0.06em; padding-left: 0.135em;"><span id="MJXc-Node-508" class="mjx-mo" style="vertical-align: top;"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.426em; padding-bottom: 0.32em;">^</span></span></span><span class="mjx-op"><span id="MJXc-Node-505" class="mjx-msubsup"><span class="mjx-base" style="margin-right: -0.006em;"><span id="MJXc-Node-506" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.215em; padding-bottom: 0.479em; padding-right: 0.006em;">y</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-507" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.426em; padding-bottom: 0.267em;">i</span></span></span></span></span></span></span></span></span><span id="MJXc-Node-509" class="mjx-texatom"><span id="MJXc-Node-510" class="mjx-mrow"><span id="MJXc-Node-511" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.479em; padding-bottom: 0.585em;">|</span></span></span></span><span id="MJXc-Node-512" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.32em; padding-bottom: 0.426em;">+</span></span><span id="MJXc-Node-513" class="mjx-texatom"><span id="MJXc-Node-514" class="mjx-mrow"><span id="MJXc-Node-515" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.479em; padding-bottom: 0.585em;">|</span></span></span></span><span id="MJXc-Node-516" class="mjx-msubsup"><span class="mjx-base" style="margin-right: -0.006em;"><span id="MJXc-Node-517" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.215em; padding-bottom: 0.479em; padding-right: 0.006em;">y</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-518" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.426em; padding-bottom: 0.267em;">i</span></span></span></span><span id="MJXc-Node-519" class="mjx-texatom"><span id="MJXc-Node-520" class="mjx-mrow"><span id="MJXc-Node-521" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.479em; padding-bottom: 0.585em;">|</span></span></span></span></span></span><span style="border-bottom-width: 1.3px; border-bottom-style: solid; top: -0.283em; width: 2.566em;" class="mjx-line"></span></span><span style="height: 1.808em; vertical-align: -0.654em;" class="mjx-vsize"></span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mfrac><mn>1</mn><mi>n</mi></mfrac><munderover><mo movablelimits="false">∑</mo><mrow class="MJX-TeXAtom-ORD"><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>n</mi></munderover><mfrac><mrow><mn>2</mn><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><mrow class="MJX-TeXAtom-ORD"><mover><msub><mi>y</mi><mi>i</mi></msub><mo stretchy="false">^</mo></mover></mrow><mo>−</mo><msub><mi>y</mi><mi>i</mi></msub><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow></mrow><mrow><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><mrow class="MJX-TeXAtom-ORD"><mover><msub><mi>y</mi><mi>i</mi></msub><mo stretchy="false">^</mo></mover></mrow><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><mo>+</mo><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><msub><mi>y</mi><mi>i</mi></msub><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow></mrow></mfrac></math></span></span><script type="math/tex" id="MathJax-Element-37">\frac{1}{n}\sum\limits_{i = 1}^n\frac{2|\hat{y_i} - y_i|}{|\hat{y_i}| + |y_i|}</script></span>
<ul>
<li><span>Та же идея, что в MAPE с учётом масштаба предсказаний модели.</span></li>
</ul>
</li>
<li><span>R</span><sup><span>2</span></sup><span> (коэффициент детерминации): </span><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-38-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 118%; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mn>1</mn><mo>&amp;#x2212;</mo><mfrac><mrow><munderover><mo movablelimits=&quot;false&quot;>&amp;#x2211;</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>n</mi></munderover><mo stretchy=&quot;false&quot;>(</mo><msub><mi>y</mi><mi>i</mi></msub><mo>&amp;#x2212;</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mover><msub><mi>y</mi><mi>i</mi></msub><mo stretchy=&quot;false&quot;>&amp;#x005E;</mo></mover></mrow><msup><mo stretchy=&quot;false&quot;>)</mo><mn>2</mn></msup></mrow><mrow><munderover><mo movablelimits=&quot;false&quot;>&amp;#x2211;</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>n</mi></munderover><mo stretchy=&quot;false&quot;>(</mo><msub><mi>y</mi><mi>i</mi></msub><mo>&amp;#x2212;</mo><mover><msub><mi>y</mi><mi>i</mi></msub><mo accent=&quot;false&quot;>&amp;#x00AF;</mo></mover><msup><mo stretchy=&quot;false&quot;>)</mo><mn>2</mn></msup></mrow></mfrac></math>" role="presentation"><span id="MJXc-Node-522" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-523" class="mjx-mrow"><span id="MJXc-Node-524" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.373em; padding-bottom: 0.32em;">1</span></span><span id="MJXc-Node-525" class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.32em; padding-bottom: 0.426em;">−</span></span><span id="MJXc-Node-526" class="mjx-mfrac MJXc-space2"><span class="mjx-box MJXc-stacked" style="width: 3.416em; padding: 0px 0.12em;"><span class="mjx-numerator" style="font-size: 70.7%; width: 4.831em; top: -3.044em;"><span id="MJXc-Node-527" class="mjx-mrow" style=""><span id="MJXc-Node-528" class="mjx-munderover"><span class="mjx-itable"><span class="mjx-row"><span class="mjx-cell"><span class="mjx-stack"><span class="mjx-over" style="font-size: 70.7%; padding-bottom: 0.247em; padding-top: 0.141em; padding-left: 0.512em;"><span id="MJXc-Node-535" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.215em; padding-bottom: 0.267em;">n</span></span></span><span class="mjx-op" style="padding-left: 0.046em;"><span id="MJXc-Node-529" class="mjx-mo"><span class="mjx-char MJXc-TeX-size1-R" style="padding-top: 0.532em; padding-bottom: 0.532em;">∑</span></span></span></span></span></span><span class="mjx-row"><span class="mjx-under" style="font-size: 70.7%; padding-top: 0.236em; padding-bottom: 0.141em;"><span id="MJXc-Node-530" class="mjx-texatom" style=""><span id="MJXc-Node-531" class="mjx-mrow"><span id="MJXc-Node-532" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.426em; padding-bottom: 0.267em;">i</span></span><span id="MJXc-Node-533" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.056em; padding-bottom: 0.32em;">=</span></span><span id="MJXc-Node-534" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.373em; padding-bottom: 0.32em;">1</span></span></span></span></span></span></span></span><span id="MJXc-Node-536" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.479em; padding-bottom: 0.585em;">(</span></span><span id="MJXc-Node-537" class="mjx-msubsup"><span class="mjx-base" style="margin-right: -0.006em;"><span id="MJXc-Node-538" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.215em; padding-bottom: 0.479em; padding-right: 0.006em;">y</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-539" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.426em; padding-bottom: 0.267em;">i</span></span></span></span><span id="MJXc-Node-540" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.32em; padding-bottom: 0.426em;">−</span></span><span id="MJXc-Node-541" class="mjx-texatom"><span id="MJXc-Node-542" class="mjx-mrow"><span id="MJXc-Node-543" class="mjx-munderover"><span class="mjx-stack"><span class="mjx-over" style="height: 0.213em; padding-bottom: 0.06em; padding-left: 0.135em;"><span id="MJXc-Node-547" class="mjx-mo" style="vertical-align: top;"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.426em; padding-bottom: 0.32em;">^</span></span></span><span class="mjx-op"><span id="MJXc-Node-544" class="mjx-msubsup"><span class="mjx-base" style="margin-right: -0.006em;"><span id="MJXc-Node-545" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.215em; padding-bottom: 0.479em; padding-right: 0.006em;">y</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-546" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.426em; padding-bottom: 0.267em;">i</span></span></span></span></span></span></span></span></span><span id="MJXc-Node-548" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-549" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.479em; padding-bottom: 0.585em;">)</span></span></span><span class="mjx-sup" style="font-size: 70.7%; vertical-align: 0.513em; padding-left: 0px; padding-right: 0.071em;"><span id="MJXc-Node-550" class="mjx-mn" style=""><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.373em; padding-bottom: 0.32em;">2</span></span></span></span></span></span><span class="mjx-denominator" style="font-size: 70.7%; width: 4.831em; bottom: -2.337em;"><span id="MJXc-Node-551" class="mjx-mrow" style=""><span id="MJXc-Node-552" class="mjx-munderover"><span class="mjx-itable"><span class="mjx-row"><span class="mjx-cell"><span class="mjx-stack"><span class="mjx-over" style="font-size: 70.7%; padding-bottom: 0.247em; padding-top: 0.141em; padding-left: 0.512em;"><span id="MJXc-Node-559" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.215em; padding-bottom: 0.267em;">n</span></span></span><span class="mjx-op" style="padding-left: 0.046em;"><span id="MJXc-Node-553" class="mjx-mo"><span class="mjx-char MJXc-TeX-size1-R" style="padding-top: 0.532em; padding-bottom: 0.532em;">∑</span></span></span></span></span></span><span class="mjx-row"><span class="mjx-under" style="font-size: 70.7%; padding-top: 0.236em; padding-bottom: 0.141em;"><span id="MJXc-Node-554" class="mjx-texatom" style=""><span id="MJXc-Node-555" class="mjx-mrow"><span id="MJXc-Node-556" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.426em; padding-bottom: 0.267em;">i</span></span><span id="MJXc-Node-557" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.056em; padding-bottom: 0.32em;">=</span></span><span id="MJXc-Node-558" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.373em; padding-bottom: 0.32em;">1</span></span></span></span></span></span></span></span><span id="MJXc-Node-560" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.479em; padding-bottom: 0.585em;">(</span></span><span id="MJXc-Node-561" class="mjx-msubsup"><span class="mjx-base" style="margin-right: -0.006em;"><span id="MJXc-Node-562" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.215em; padding-bottom: 0.479em; padding-right: 0.006em;">y</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-563" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.426em; padding-bottom: 0.267em;">i</span></span></span></span><span id="MJXc-Node-564" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.32em; padding-bottom: 0.426em;">−</span></span><span id="MJXc-Node-565" class="mjx-munderover"><span class="mjx-stack"><span class="mjx-over" style="font-size: 70.7%; height: 0.096em; padding-bottom: 0.283em; padding-top: 0.141em;"><span id="MJXc-Node-569" class="mjx-mo" style="vertical-align: top;"><span class="mjx-delim-h"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.301em; padding-bottom: 0.833em; margin: 0px -0.07em 0px -0.069em;">¯</span><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.301em; padding-bottom: 0.833em; margin: 0px 0.044em 0px -0.183em; letter-spacing: -0.267em;">¯¯</span><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.301em; padding-bottom: 0.833em; margin-right: -0.07em; margin-bottom: 0px; margin-top: 0px;">¯</span></span></span></span><span class="mjx-op"><span id="MJXc-Node-566" class="mjx-msubsup"><span class="mjx-base" style="margin-right: -0.006em;"><span id="MJXc-Node-567" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.215em; padding-bottom: 0.479em; padding-right: 0.006em;">y</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-568" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.426em; padding-bottom: 0.267em;">i</span></span></span></span></span></span></span><span id="MJXc-Node-570" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-571" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.479em; padding-bottom: 0.585em;">)</span></span></span><span class="mjx-sup" style="font-size: 70.7%; vertical-align: 0.409em; padding-left: 0px; padding-right: 0.071em;"><span id="MJXc-Node-572" class="mjx-mn" style=""><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.373em; padding-bottom: 0.32em;">2</span></span></span></span></span></span><span style="border-bottom-width: 1.3px; border-bottom-style: solid; top: -0.283em; width: 3.416em;" class="mjx-line"></span></span><span style="height: 3.805em; vertical-align: -1.653em;" class="mjx-vsize"></span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mn>1</mn><mo>−</mo><mfrac><mrow><munderover><mo movablelimits="false">∑</mo><mrow class="MJX-TeXAtom-ORD"><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>n</mi></munderover><mo stretchy="false">(</mo><msub><mi>y</mi><mi>i</mi></msub><mo>−</mo><mrow class="MJX-TeXAtom-ORD"><mover><msub><mi>y</mi><mi>i</mi></msub><mo stretchy="false">^</mo></mover></mrow><msup><mo stretchy="false">)</mo><mn>2</mn></msup></mrow><mrow><munderover><mo movablelimits="false">∑</mo><mrow class="MJX-TeXAtom-ORD"><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>n</mi></munderover><mo stretchy="false">(</mo><msub><mi>y</mi><mi>i</mi></msub><mo>−</mo><mover><msub><mi>y</mi><mi>i</mi></msub><mo accent="false">¯</mo></mover><msup><mo stretchy="false">)</mo><mn>2</mn></msup></mrow></mfrac></math></span></span><script type="math/tex" id="MathJax-Element-38">1 - \frac{\sum\limits_{i = 1}^n(y_i - \hat{y_i})^2}{\sum\limits_{i = 1}^n(y_i - \overline{y_i})^2}</script></span>
<ul>
<li><span>Заметим, что дробь в формуле можно понимать как отношение дисперсии </span><em><span>объясняемой моделью</span></em><span> к дисперсии выборки (</span><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-39-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 118%; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mo stretchy=&quot;false&quot;>&amp;#x21D4;</mo></math>" role="presentation"><span id="MJXc-Node-573" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-574" class="mjx-mrow"><span id="MJXc-Node-575" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.215em; padding-bottom: 0.373em;">⇔</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo stretchy="false">⇔</mo></math></span></span><script type="math/tex" id="MathJax-Element-39">\Leftrightarrow</script></span><span> дисперсии константной модели, которая всегда предсказывает выборочное среднее).</span></li>
<li><span>В отличие от других метрик, эту мы стремимся максимизировать при обучении модели, т.к. она максимальна при MSE = 0, например.</span></li>
<li><span>Значение R</span><sup><span>2</span></sup><span> меньше 0 означает что рассматриваемая модели </span><em><span>хуже</span></em><span> константой.</span></li>
</ul>
</li>
</ul><h3 id="3-Линейная-регрессия-Постановка-задачи-Аналитическое-решение-МНК-оптимальность-оценки-теорема-Гаусса-Маркова-формулировка-Градиентное-решение-задачи" data-id="3-Линейная-регрессия-Постановка-задачи-Аналитическое-решение-МНК-оптимальность-оценки-теорема-Гаусса-Маркова-формулировка-Градиентное-решение-задачи"><a class="anchor hidden-xs" href="#3-Линейная-регрессия-Постановка-задачи-Аналитическое-решение-МНК-оптимальность-оценки-теорема-Гаусса-Маркова-формулировка-Градиентное-решение-задачи" title="3-Линейная-регрессия-Постановка-задачи-Аналитическое-решение-МНК-оптимальность-оценки-теорема-Гаусса-Маркова-формулировка-Градиентное-решение-задачи"><span class="octicon octicon-link"></span></a><span>3. Линейная регрессия. Постановка задачи. Аналитическое решение МНК, оптимальность оценки, теорема Гаусса-Маркова (формулировка). Градиентное решение задачи.</span></h3><ul>
<li><strong><span>Линейная регрессия</span></strong><span>: решение задачи регрессии с помощью линейной функции:</span><br>
<span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span class="mjx-chtml MJXc-display" style="text-align: center;"><span id="MathJax-Element-40-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 118%; text-align: center; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi mathvariant=&quot;double-struck&quot;>E</mi></mrow><mo stretchy=&quot;false&quot;>(</mo><mi>Y</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>|</mo></mrow><mi>X</mi><mo stretchy=&quot;false&quot;>)</mo><mo>=</mo><mi>f</mi><mo stretchy=&quot;false&quot;>(</mo><mi>X</mi><mo stretchy=&quot;false&quot;>)</mo><mo stretchy=&quot;false&quot;>&amp;#x21D2;</mo><mi>Y</mi><mo>=</mo><mi>f</mi><mo stretchy=&quot;false&quot;>(</mo><mi>X</mi><mo stretchy=&quot;false&quot;>)</mo><mo>+</mo><mi>&amp;#x03B5;</mi></math>" role="presentation"><span id="MJXc-Node-576" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-577" class="mjx-mrow"><span id="MJXc-Node-578" class="mjx-texatom"><span id="MJXc-Node-579" class="mjx-mrow"><span id="MJXc-Node-580" class="mjx-mi"><span class="mjx-char MJXc-TeX-ams-R" style="padding-top: 0.426em; padding-bottom: 0.32em;">E</span></span></span></span><span id="MJXc-Node-581" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.479em; padding-bottom: 0.585em;">(</span></span><span id="MJXc-Node-582" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.267em; padding-right: 0.182em;">Y</span></span><span id="MJXc-Node-583" class="mjx-texatom"><span id="MJXc-Node-584" class="mjx-mrow"><span id="MJXc-Node-585" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.479em; padding-bottom: 0.585em;">|</span></span></span></span><span id="MJXc-Node-586" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.267em; padding-right: 0.024em;">X</span></span><span id="MJXc-Node-587" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.479em; padding-bottom: 0.585em;">)</span></span><span id="MJXc-Node-588" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.056em; padding-bottom: 0.32em;">=</span></span><span id="MJXc-Node-589" class="mjx-mi MJXc-space3"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.479em; padding-right: 0.06em;">f</span></span><span id="MJXc-Node-590" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.479em; padding-bottom: 0.585em;">(</span></span><span id="MJXc-Node-591" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.267em; padding-right: 0.024em;">X</span></span><span id="MJXc-Node-592" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.479em; padding-bottom: 0.585em;">)</span></span><span id="MJXc-Node-593" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.215em; padding-bottom: 0.373em;">⇒</span></span><span id="MJXc-Node-594" class="mjx-mi MJXc-space3"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.267em; padding-right: 0.182em;">Y</span></span><span id="MJXc-Node-595" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.056em; padding-bottom: 0.32em;">=</span></span><span id="MJXc-Node-596" class="mjx-mi MJXc-space3"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.479em; padding-right: 0.06em;">f</span></span><span id="MJXc-Node-597" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.479em; padding-bottom: 0.585em;">(</span></span><span id="MJXc-Node-598" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.267em; padding-right: 0.024em;">X</span></span><span id="MJXc-Node-599" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.479em; padding-bottom: 0.585em;">)</span></span><span id="MJXc-Node-600" class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.32em; padding-bottom: 0.426em;">+</span></span><span id="MJXc-Node-601" class="mjx-mi MJXc-space2"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.215em; padding-bottom: 0.32em;">ε</span></span></span></span><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="double-struck">E</mi></mrow><mo stretchy="false">(</mo><mi>Y</mi><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><mi>X</mi><mo stretchy="false">)</mo><mo>=</mo><mi>f</mi><mo stretchy="false">(</mo><mi>X</mi><mo stretchy="false">)</mo><mo stretchy="false">⇒</mo><mi>Y</mi><mo>=</mo><mi>f</mi><mo stretchy="false">(</mo><mi>X</mi><mo stretchy="false">)</mo><mo>+</mo><mi>ε</mi></math></span></span></span><script type="math/tex; mode=display" id="MathJax-Element-40">
 \mathbb{E}(Y|X) = f(X) \Rightarrow Y = f(X) + \varepsilon
</script></span><br>
<span>где </span><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-41-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 118%; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>Y</mi></math>" role="presentation"><span id="MJXc-Node-602" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-603" class="mjx-mrow"><span id="MJXc-Node-604" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.267em; padding-right: 0.182em;">Y</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>Y</mi></math></span></span><script type="math/tex" id="MathJax-Element-41">Y</script></span><span> — целевая переменная, </span><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-42-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 118%; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>X</mi></math>" role="presentation"><span id="MJXc-Node-605" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-606" class="mjx-mrow"><span id="MJXc-Node-607" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.267em; padding-right: 0.024em;">X</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>X</mi></math></span></span><script type="math/tex" id="MathJax-Element-42">X</script></span><span> — матрица объекты-признаки, </span><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-43-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 118%; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>&amp;#x03B5;</mi></math>" role="presentation"><span id="MJXc-Node-608" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-609" class="mjx-mrow"><span id="MJXc-Node-610" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.215em; padding-bottom: 0.32em;">ε</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>ε</mi></math></span></span><script type="math/tex" id="MathJax-Element-43">\varepsilon</script></span><span> — некоторый шум, а функция </span><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-44-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 118%; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>f</mi></math>" role="presentation"><span id="MJXc-Node-611" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-612" class="mjx-mrow"><span id="MJXc-Node-613" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.479em; padding-right: 0.06em;">f</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>f</mi></math></span></span><script type="math/tex" id="MathJax-Element-44">f</script></span><span> должна быть линейной:</span><br>
<span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span class="mjx-chtml MJXc-display" style="text-align: center;"><span id="MathJax-Element-45-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 118%; text-align: center; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><mi>f</mi><mo stretchy=&quot;false&quot;>(</mo><mi>x</mi><mo stretchy=&quot;false&quot;>)</mo><mo>=</mo><msub><mi>w</mi><mn>0</mn></msub><mo>+</mo><munderover><mo movablelimits=&quot;false&quot;>&amp;#x2211;</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>p</mi></munderover><msub><mi>w</mi><mi>i</mi></msub><msub><mi>x</mi><mi>i</mi></msub><mo>=</mo><msup><mi>w</mi><mi>T</mi></msup><mi>x</mi><mo stretchy=&quot;false&quot;>&amp;#x21D2;</mo><mi>f</mi><mo stretchy=&quot;false&quot;>(</mo><mi>X</mi><mo stretchy=&quot;false&quot;>)</mo><mo>=</mo><mi>X</mi><mi>w</mi></math>" role="presentation"><span id="MJXc-Node-614" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-615" class="mjx-mrow"><span id="MJXc-Node-616" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.479em; padding-right: 0.06em;">f</span></span><span id="MJXc-Node-617" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.479em; padding-bottom: 0.585em;">(</span></span><span id="MJXc-Node-618" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.215em; padding-bottom: 0.267em;">x</span></span><span id="MJXc-Node-619" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.479em; padding-bottom: 0.585em;">)</span></span><span id="MJXc-Node-620" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.056em; padding-bottom: 0.32em;">=</span></span><span id="MJXc-Node-621" class="mjx-msubsup MJXc-space3"><span class="mjx-base"><span id="MJXc-Node-622" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.215em; padding-bottom: 0.267em;">w</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-623" class="mjx-mn" style=""><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.373em; padding-bottom: 0.373em;">0</span></span></span></span><span id="MJXc-Node-624" class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.32em; padding-bottom: 0.426em;">+</span></span><span id="MJXc-Node-625" class="mjx-munderover MJXc-space2"><span class="mjx-itable"><span class="mjx-row"><span class="mjx-cell"><span class="mjx-stack"><span class="mjx-over" style="font-size: 70.7%; padding-bottom: 0.157em; padding-top: 0.141em; padding-left: 0.77em;"><span id="MJXc-Node-632" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.215em; padding-bottom: 0.479em;">p</span></span></span><span class="mjx-op"><span id="MJXc-Node-626" class="mjx-mo"><span class="mjx-char MJXc-TeX-size2-R" style="padding-top: 0.744em; padding-bottom: 0.744em;">∑</span></span></span></span></span></span><span class="mjx-row"><span class="mjx-under" style="font-size: 70.7%; padding-top: 0.236em; padding-bottom: 0.141em; padding-left: 0.21em;"><span id="MJXc-Node-627" class="mjx-texatom" style=""><span id="MJXc-Node-628" class="mjx-mrow"><span id="MJXc-Node-629" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.426em; padding-bottom: 0.267em;">i</span></span><span id="MJXc-Node-630" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.056em; padding-bottom: 0.32em;">=</span></span><span id="MJXc-Node-631" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.373em; padding-bottom: 0.32em;">1</span></span></span></span></span></span></span></span><span id="MJXc-Node-633" class="mjx-msubsup MJXc-space1"><span class="mjx-base"><span id="MJXc-Node-634" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.215em; padding-bottom: 0.267em;">w</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-635" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.426em; padding-bottom: 0.267em;">i</span></span></span></span><span id="MJXc-Node-636" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-637" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.215em; padding-bottom: 0.267em;">x</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-638" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.426em; padding-bottom: 0.267em;">i</span></span></span></span><span id="MJXc-Node-639" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.056em; padding-bottom: 0.32em;">=</span></span><span id="MJXc-Node-640" class="mjx-msubsup MJXc-space3"><span class="mjx-base"><span id="MJXc-Node-641" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.215em; padding-bottom: 0.267em;">w</span></span></span><span class="mjx-sup" style="font-size: 70.7%; vertical-align: 0.584em; padding-left: 0px; padding-right: 0.071em;"><span id="MJXc-Node-642" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.267em; padding-right: 0.12em;">T</span></span></span></span><span id="MJXc-Node-643" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.215em; padding-bottom: 0.267em;">x</span></span><span id="MJXc-Node-644" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.215em; padding-bottom: 0.373em;">⇒</span></span><span id="MJXc-Node-645" class="mjx-mi MJXc-space3"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.479em; padding-right: 0.06em;">f</span></span><span id="MJXc-Node-646" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.479em; padding-bottom: 0.585em;">(</span></span><span id="MJXc-Node-647" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.267em; padding-right: 0.024em;">X</span></span><span id="MJXc-Node-648" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.479em; padding-bottom: 0.585em;">)</span></span><span id="MJXc-Node-649" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.056em; padding-bottom: 0.32em;">=</span></span><span id="MJXc-Node-650" class="mjx-mi MJXc-space3"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.267em; padding-right: 0.024em;">X</span></span><span id="MJXc-Node-651" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.215em; padding-bottom: 0.267em;">w</span></span></span></span><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mi>f</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mo>=</mo><msub><mi>w</mi><mn>0</mn></msub><mo>+</mo><munderover><mo movablelimits="false">∑</mo><mrow class="MJX-TeXAtom-ORD"><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>p</mi></munderover><msub><mi>w</mi><mi>i</mi></msub><msub><mi>x</mi><mi>i</mi></msub><mo>=</mo><msup><mi>w</mi><mi>T</mi></msup><mi>x</mi><mo stretchy="false">⇒</mo><mi>f</mi><mo stretchy="false">(</mo><mi>X</mi><mo stretchy="false">)</mo><mo>=</mo><mi>X</mi><mi>w</mi></math></span></span></span><script type="math/tex; mode=display" id="MathJax-Element-45">
 f(x) = w_0 + \sum\limits_{i = 1}^p w_ix_i = w^Tx \Rightarrow f(X) = Xw
</script></span><br>
<span>где </span><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-46-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 118%; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>p</mi></math>" role="presentation"><span id="MJXc-Node-652" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-653" class="mjx-mrow"><span id="MJXc-Node-654" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.215em; padding-bottom: 0.479em;">p</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>p</mi></math></span></span><script type="math/tex" id="MathJax-Element-46">p</script></span><span> — количество признаков и считается, что в матрице X есть фиктивный признак равный 1 на каждом объекте.</span>
<ul>
<li><span>Он называется </span><em><span>bias</span></em><span> и добавляется для смещённости модели. Без него гиперплоскость которую определяет наша линейная модель всегда будет проходить через точку 0, то есть мы не сможем обобщить абсолютно любую линейную зависимость.</span></li>
</ul>
</li>
<li><strong><span>Постановка задачи</span></strong>
<ul>
<li><span>Дано: обучающая выборка </span><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-47-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 118%; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mo stretchy=&quot;false&quot;>(</mo><mi>X</mi><mo>,</mo><mi>Y</mi><mo stretchy=&quot;false&quot;>)</mo><mo>,</mo><mi>X</mi><mo>&amp;#x2208;</mo><msup><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi mathvariant=&quot;double-struck&quot;>R</mi></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>n</mi><mo>&amp;#x00D7;</mo><mi>p</mi></mrow></msup><mo>,</mo><mi>Y</mi><mo>&amp;#x2208;</mo><msup><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi mathvariant=&quot;double-struck&quot;>R</mi></mrow><mi>n</mi></msup><mo>.</mo></math>" role="presentation"><span id="MJXc-Node-655" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-656" class="mjx-mrow"><span id="MJXc-Node-657" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.479em; padding-bottom: 0.585em;">(</span></span><span id="MJXc-Node-658" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.267em; padding-right: 0.024em;">X</span></span><span id="MJXc-Node-659" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="margin-top: -0.156em; padding-bottom: 0.532em;">,</span></span><span id="MJXc-Node-660" class="mjx-mi MJXc-space1"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.267em; padding-right: 0.182em;">Y</span></span><span id="MJXc-Node-661" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.479em; padding-bottom: 0.585em;">)</span></span><span id="MJXc-Node-662" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="margin-top: -0.156em; padding-bottom: 0.532em;">,</span></span><span id="MJXc-Node-663" class="mjx-mi MJXc-space1"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.267em; padding-right: 0.024em;">X</span></span><span id="MJXc-Node-664" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.267em; padding-bottom: 0.373em;">∈</span></span><span id="MJXc-Node-665" class="mjx-msubsup MJXc-space3"><span class="mjx-base"><span id="MJXc-Node-666" class="mjx-texatom"><span id="MJXc-Node-667" class="mjx-mrow"><span id="MJXc-Node-668" class="mjx-mi"><span class="mjx-char MJXc-TeX-ams-R" style="padding-top: 0.426em; padding-bottom: 0.32em;">R</span></span></span></span></span><span class="mjx-sup" style="font-size: 70.7%; vertical-align: 0.615em; padding-left: 0px; padding-right: 0.071em;"><span id="MJXc-Node-669" class="mjx-texatom" style=""><span id="MJXc-Node-670" class="mjx-mrow"><span id="MJXc-Node-671" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.215em; padding-bottom: 0.267em;">n</span></span><span id="MJXc-Node-672" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.215em; padding-bottom: 0.32em;">×</span></span><span id="MJXc-Node-673" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.215em; padding-bottom: 0.479em;">p</span></span></span></span></span></span><span id="MJXc-Node-674" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="margin-top: -0.156em; padding-bottom: 0.532em;">,</span></span><span id="MJXc-Node-675" class="mjx-mi MJXc-space1"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.267em; padding-right: 0.182em;">Y</span></span><span id="MJXc-Node-676" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.267em; padding-bottom: 0.373em;">∈</span></span><span id="MJXc-Node-677" class="mjx-msubsup MJXc-space3"><span class="mjx-base"><span id="MJXc-Node-678" class="mjx-texatom"><span id="MJXc-Node-679" class="mjx-mrow"><span id="MJXc-Node-680" class="mjx-mi"><span class="mjx-char MJXc-TeX-ams-R" style="padding-top: 0.426em; padding-bottom: 0.32em;">R</span></span></span></span></span><span class="mjx-sup" style="font-size: 70.7%; vertical-align: 0.615em; padding-left: 0px; padding-right: 0.071em;"><span id="MJXc-Node-681" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.215em; padding-bottom: 0.267em;">n</span></span></span></span><span id="MJXc-Node-682" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="margin-top: -0.156em; padding-bottom: 0.32em;">.</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo stretchy="false">(</mo><mi>X</mi><mo>,</mo><mi>Y</mi><mo stretchy="false">)</mo><mo>,</mo><mi>X</mi><mo>∈</mo><msup><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="double-struck">R</mi></mrow><mrow class="MJX-TeXAtom-ORD"><mi>n</mi><mo>×</mo><mi>p</mi></mrow></msup><mo>,</mo><mi>Y</mi><mo>∈</mo><msup><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="double-struck">R</mi></mrow><mi>n</mi></msup><mo>.</mo></math></span></span><script type="math/tex" id="MathJax-Element-47">(X, Y), X \in \mathbb{R}^{n \times p}, Y \in \mathbb{R}^n.</script></span></li>
<li><span>Найти: вектор весов </span><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-48-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 118%; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>w</mi><mo>&amp;#x2208;</mo><msup><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi mathvariant=&quot;double-struck&quot;>R</mi></mrow><mi>p</mi></msup><mo>,</mo></math>" role="presentation"><span id="MJXc-Node-683" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-684" class="mjx-mrow"><span id="MJXc-Node-685" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.215em; padding-bottom: 0.267em;">w</span></span><span id="MJXc-Node-686" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.267em; padding-bottom: 0.373em;">∈</span></span><span id="MJXc-Node-687" class="mjx-msubsup MJXc-space3"><span class="mjx-base"><span id="MJXc-Node-688" class="mjx-texatom"><span id="MJXc-Node-689" class="mjx-mrow"><span id="MJXc-Node-690" class="mjx-mi"><span class="mjx-char MJXc-TeX-ams-R" style="padding-top: 0.426em; padding-bottom: 0.32em;">R</span></span></span></span></span><span class="mjx-sup" style="font-size: 70.7%; vertical-align: 0.615em; padding-left: 0px; padding-right: 0.071em;"><span id="MJXc-Node-691" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.215em; padding-bottom: 0.479em;">p</span></span></span></span><span id="MJXc-Node-692" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="margin-top: -0.156em; padding-bottom: 0.532em;">,</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>w</mi><mo>∈</mo><msup><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="double-struck">R</mi></mrow><mi>p</mi></msup><mo>,</mo></math></span></span><script type="math/tex" id="MathJax-Element-48">w \in \mathbb{R}^p,</script></span><span> удовлетворяющий условию:</span><br>
<span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span class="mjx-chtml MJXc-display" style="text-align: center;"><span id="MathJax-Element-49-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 118%; text-align: center; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><mi>w</mi><mo>=</mo><mtext>arg</mtext><munder><mo movablelimits=&quot;true&quot; form=&quot;prefix&quot;>min</mo><mi>w</mi></munder><mi>L</mi><mo stretchy=&quot;false&quot;>(</mo><mi>X</mi><mo>,</mo><mi>Y</mi><mo>,</mo><mi>f</mi><mo stretchy=&quot;false&quot;>(</mo><mi>X</mi><mo stretchy=&quot;false&quot;>)</mo><mo stretchy=&quot;false&quot;>)</mo></math>" role="presentation"><span id="MJXc-Node-693" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-694" class="mjx-mrow"><span id="MJXc-Node-695" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.215em; padding-bottom: 0.267em;">w</span></span><span id="MJXc-Node-696" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.056em; padding-bottom: 0.32em;">=</span></span><span id="MJXc-Node-697" class="mjx-mtext MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.162em; padding-bottom: 0.532em;">arg</span></span><span id="MJXc-Node-698" class="mjx-munderover MJXc-space1"><span class="mjx-itable"><span class="mjx-row"><span class="mjx-cell"><span class="mjx-op"><span id="MJXc-Node-699" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.373em; padding-bottom: 0.32em;">min</span></span></span></span></span><span class="mjx-row"><span class="mjx-under" style="font-size: 70.7%; padding-top: 0.236em; padding-bottom: 0.141em; padding-left: 0.821em;"><span id="MJXc-Node-700" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.215em; padding-bottom: 0.267em;">w</span></span></span></span></span></span><span id="MJXc-Node-701" class="mjx-mi MJXc-space1"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.267em;">L</span></span><span id="MJXc-Node-702" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.479em; padding-bottom: 0.585em;">(</span></span><span id="MJXc-Node-703" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.267em; padding-right: 0.024em;">X</span></span><span id="MJXc-Node-704" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="margin-top: -0.156em; padding-bottom: 0.532em;">,</span></span><span id="MJXc-Node-705" class="mjx-mi MJXc-space1"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.267em; padding-right: 0.182em;">Y</span></span><span id="MJXc-Node-706" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="margin-top: -0.156em; padding-bottom: 0.532em;">,</span></span><span id="MJXc-Node-707" class="mjx-mi MJXc-space1"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.479em; padding-right: 0.06em;">f</span></span><span id="MJXc-Node-708" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.479em; padding-bottom: 0.585em;">(</span></span><span id="MJXc-Node-709" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.267em; padding-right: 0.024em;">X</span></span><span id="MJXc-Node-710" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.479em; padding-bottom: 0.585em;">)</span></span><span id="MJXc-Node-711" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.479em; padding-bottom: 0.585em;">)</span></span></span></span><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mi>w</mi><mo>=</mo><mtext>arg</mtext><munder><mo movablelimits="true" form="prefix">min</mo><mi>w</mi></munder><mi>L</mi><mo stretchy="false">(</mo><mi>X</mi><mo>,</mo><mi>Y</mi><mo>,</mo><mi>f</mi><mo stretchy="false">(</mo><mi>X</mi><mo stretchy="false">)</mo><mo stretchy="false">)</mo></math></span></span></span><script type="math/tex; mode=display" id="MathJax-Element-49">\begin{equation}
w = \text{arg}\min_w L(X, Y, f(X))
\end{equation}</script></span><br>
<span>где </span><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-50-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 118%; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>f</mi><mo stretchy=&quot;false&quot;>(</mo><mi>X</mi><mo stretchy=&quot;false&quot;>)</mo><mo>=</mo><mi>X</mi><mi>w</mi><mo>,</mo></math>" role="presentation"><span id="MJXc-Node-712" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-713" class="mjx-mrow"><span id="MJXc-Node-714" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.479em; padding-right: 0.06em;">f</span></span><span id="MJXc-Node-715" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.479em; padding-bottom: 0.585em;">(</span></span><span id="MJXc-Node-716" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.267em; padding-right: 0.024em;">X</span></span><span id="MJXc-Node-717" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.479em; padding-bottom: 0.585em;">)</span></span><span id="MJXc-Node-718" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.056em; padding-bottom: 0.32em;">=</span></span><span id="MJXc-Node-719" class="mjx-mi MJXc-space3"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.267em; padding-right: 0.024em;">X</span></span><span id="MJXc-Node-720" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.215em; padding-bottom: 0.267em;">w</span></span><span id="MJXc-Node-721" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="margin-top: -0.156em; padding-bottom: 0.532em;">,</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>f</mi><mo stretchy="false">(</mo><mi>X</mi><mo stretchy="false">)</mo><mo>=</mo><mi>X</mi><mi>w</mi><mo>,</mo></math></span></span><script type="math/tex" id="MathJax-Element-50">f(X) = Xw,</script></span><span> а </span><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-51-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 118%; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>L</mi><mo stretchy=&quot;false&quot;>(</mo><mi>X</mi><mo>,</mo><mi>Y</mi><mo>,</mo><mi>f</mi><mo stretchy=&quot;false&quot;>(</mo><mi>X</mi><mo stretchy=&quot;false&quot;>)</mo><mo stretchy=&quot;false&quot;>)</mo></math>" role="presentation"><span id="MJXc-Node-722" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-723" class="mjx-mrow"><span id="MJXc-Node-724" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.267em;">L</span></span><span id="MJXc-Node-725" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.479em; padding-bottom: 0.585em;">(</span></span><span id="MJXc-Node-726" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.267em; padding-right: 0.024em;">X</span></span><span id="MJXc-Node-727" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="margin-top: -0.156em; padding-bottom: 0.532em;">,</span></span><span id="MJXc-Node-728" class="mjx-mi MJXc-space1"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.267em; padding-right: 0.182em;">Y</span></span><span id="MJXc-Node-729" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="margin-top: -0.156em; padding-bottom: 0.532em;">,</span></span><span id="MJXc-Node-730" class="mjx-mi MJXc-space1"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.479em; padding-right: 0.06em;">f</span></span><span id="MJXc-Node-731" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.479em; padding-bottom: 0.585em;">(</span></span><span id="MJXc-Node-732" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.267em; padding-right: 0.024em;">X</span></span><span id="MJXc-Node-733" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.479em; padding-bottom: 0.585em;">)</span></span><span id="MJXc-Node-734" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.479em; padding-bottom: 0.585em;">)</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>L</mi><mo stretchy="false">(</mo><mi>X</mi><mo>,</mo><mi>Y</mi><mo>,</mo><mi>f</mi><mo stretchy="false">(</mo><mi>X</mi><mo stretchy="false">)</mo><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-51">L(X, Y, f(X))</script></span><span> — некоторый функционал ошибки.</span></li>
<li><span>Примеры функционалов ошибки, использующихся в линейной регрессии:</span>
<ul>
<li><span>MSE (Mean Squared Error): </span><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-52-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 118%; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>L</mi><mo>=</mo><mfrac><mn>1</mn><mi>n</mi></mfrac><munderover><mo movablelimits=&quot;false&quot;>&amp;#x2211;</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>n</mi></munderover><mo stretchy=&quot;false&quot;>(</mo><mi>f</mi><mo stretchy=&quot;false&quot;>(</mo><msub><mi>x</mi><mi>i</mi></msub><mo stretchy=&quot;false&quot;>)</mo><mo>&amp;#x2212;</mo><msub><mi>y</mi><mi>i</mi></msub><msup><mo stretchy=&quot;false&quot;>)</mo><mn>2</mn></msup><mo>=</mo><mfrac><mn>1</mn><mi>n</mi></mfrac><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>|</mo></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>|</mo></mrow><mi>f</mi><mo stretchy=&quot;false&quot;>(</mo><mi>X</mi><mo stretchy=&quot;false&quot;>)</mo><mo>&amp;#x2212;</mo><mi>Y</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>|</mo></mrow><msubsup><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>|</mo></mrow><mn>2</mn><mn>2</mn></msubsup></math>" role="presentation"><span id="MJXc-Node-735" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-736" class="mjx-mrow"><span id="MJXc-Node-737" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.267em;">L</span></span><span id="MJXc-Node-738" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.056em; padding-bottom: 0.32em;">=</span></span><span id="MJXc-Node-739" class="mjx-mfrac MJXc-space3"><span class="mjx-box MJXc-stacked" style="width: 0.566em; padding: 0px 0.12em;"><span class="mjx-numerator" style="font-size: 70.7%; width: 0.8em; top: -1.299em;"><span id="MJXc-Node-740" class="mjx-mn" style=""><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.373em; padding-bottom: 0.32em;">1</span></span></span><span class="mjx-denominator" style="font-size: 70.7%; width: 0.8em; bottom: -0.524em;"><span id="MJXc-Node-741" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.215em; padding-bottom: 0.267em;">n</span></span></span><span style="border-bottom-width: 1.3px; border-bottom-style: solid; top: -0.283em; width: 0.566em;" class="mjx-line"></span></span><span style="height: 1.289em; vertical-align: -0.37em;" class="mjx-vsize"></span></span><span id="MJXc-Node-742" class="mjx-munderover MJXc-space1"><span class="mjx-itable"><span class="mjx-row"><span class="mjx-cell"><span class="mjx-stack"><span class="mjx-over" style="font-size: 70.7%; padding-bottom: 0.247em; padding-top: 0.141em; padding-left: 0.512em;"><span id="MJXc-Node-749" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.215em; padding-bottom: 0.267em;">n</span></span></span><span class="mjx-op" style="padding-left: 0.046em;"><span id="MJXc-Node-743" class="mjx-mo"><span class="mjx-char MJXc-TeX-size1-R" style="padding-top: 0.532em; padding-bottom: 0.532em;">∑</span></span></span></span></span></span><span class="mjx-row"><span class="mjx-under" style="font-size: 70.7%; padding-top: 0.236em; padding-bottom: 0.141em;"><span id="MJXc-Node-744" class="mjx-texatom" style=""><span id="MJXc-Node-745" class="mjx-mrow"><span id="MJXc-Node-746" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.426em; padding-bottom: 0.267em;">i</span></span><span id="MJXc-Node-747" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.056em; padding-bottom: 0.32em;">=</span></span><span id="MJXc-Node-748" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.373em; padding-bottom: 0.32em;">1</span></span></span></span></span></span></span></span><span id="MJXc-Node-750" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.479em; padding-bottom: 0.585em;">(</span></span><span id="MJXc-Node-751" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.479em; padding-right: 0.06em;">f</span></span><span id="MJXc-Node-752" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.479em; padding-bottom: 0.585em;">(</span></span><span id="MJXc-Node-753" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-754" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.215em; padding-bottom: 0.267em;">x</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-755" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.426em; padding-bottom: 0.267em;">i</span></span></span></span><span id="MJXc-Node-756" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.479em; padding-bottom: 0.585em;">)</span></span><span id="MJXc-Node-757" class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.32em; padding-bottom: 0.426em;">−</span></span><span id="MJXc-Node-758" class="mjx-msubsup MJXc-space2"><span class="mjx-base" style="margin-right: -0.006em;"><span id="MJXc-Node-759" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.215em; padding-bottom: 0.479em; padding-right: 0.006em;">y</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-760" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.426em; padding-bottom: 0.267em;">i</span></span></span></span><span id="MJXc-Node-761" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-762" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.479em; padding-bottom: 0.585em;">)</span></span></span><span class="mjx-sup" style="font-size: 70.7%; vertical-align: 0.513em; padding-left: 0px; padding-right: 0.071em;"><span id="MJXc-Node-763" class="mjx-mn" style=""><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.373em; padding-bottom: 0.32em;">2</span></span></span></span><span id="MJXc-Node-764" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.056em; padding-bottom: 0.32em;">=</span></span><span id="MJXc-Node-765" class="mjx-mfrac MJXc-space3"><span class="mjx-box MJXc-stacked" style="width: 0.566em; padding: 0px 0.12em;"><span class="mjx-numerator" style="font-size: 70.7%; width: 0.8em; top: -1.299em;"><span id="MJXc-Node-766" class="mjx-mn" style=""><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.373em; padding-bottom: 0.32em;">1</span></span></span><span class="mjx-denominator" style="font-size: 70.7%; width: 0.8em; bottom: -0.524em;"><span id="MJXc-Node-767" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.215em; padding-bottom: 0.267em;">n</span></span></span><span style="border-bottom-width: 1.3px; border-bottom-style: solid; top: -0.283em; width: 0.566em;" class="mjx-line"></span></span><span style="height: 1.289em; vertical-align: -0.37em;" class="mjx-vsize"></span></span><span id="MJXc-Node-768" class="mjx-texatom"><span id="MJXc-Node-769" class="mjx-mrow"><span id="MJXc-Node-770" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.479em; padding-bottom: 0.585em;">|</span></span></span></span><span id="MJXc-Node-771" class="mjx-texatom"><span id="MJXc-Node-772" class="mjx-mrow"><span id="MJXc-Node-773" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.479em; padding-bottom: 0.585em;">|</span></span></span></span><span id="MJXc-Node-774" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.479em; padding-right: 0.06em;">f</span></span><span id="MJXc-Node-775" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.479em; padding-bottom: 0.585em;">(</span></span><span id="MJXc-Node-776" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.267em; padding-right: 0.024em;">X</span></span><span id="MJXc-Node-777" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.479em; padding-bottom: 0.585em;">)</span></span><span id="MJXc-Node-778" class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.32em; padding-bottom: 0.426em;">−</span></span><span id="MJXc-Node-779" class="mjx-mi MJXc-space2"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.267em; padding-right: 0.182em;">Y</span></span><span id="MJXc-Node-780" class="mjx-texatom"><span id="MJXc-Node-781" class="mjx-mrow"><span id="MJXc-Node-782" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.479em; padding-bottom: 0.585em;">|</span></span></span></span><span id="MJXc-Node-783" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-784" class="mjx-texatom"><span id="MJXc-Node-785" class="mjx-mrow"><span id="MJXc-Node-786" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.479em; padding-bottom: 0.585em;">|</span></span></span></span></span><span class="mjx-stack" style="vertical-align: -0.309em;"><span class="mjx-sup" style="font-size: 70.7%; padding-bottom: 0.431em; padding-left: 0px; padding-right: 0.071em;"><span id="MJXc-Node-788" class="mjx-mn" style=""><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.373em; padding-bottom: 0.32em;">2</span></span></span><span class="mjx-sub" style="font-size: 70.7%; padding-right: 0.071em;"><span id="MJXc-Node-787" class="mjx-mn" style=""><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.373em; padding-bottom: 0.32em;">2</span></span></span></span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>L</mi><mo>=</mo><mfrac><mn>1</mn><mi>n</mi></mfrac><munderover><mo movablelimits="false">∑</mo><mrow class="MJX-TeXAtom-ORD"><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>n</mi></munderover><mo stretchy="false">(</mo><mi>f</mi><mo stretchy="false">(</mo><msub><mi>x</mi><mi>i</mi></msub><mo stretchy="false">)</mo><mo>−</mo><msub><mi>y</mi><mi>i</mi></msub><msup><mo stretchy="false">)</mo><mn>2</mn></msup><mo>=</mo><mfrac><mn>1</mn><mi>n</mi></mfrac><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><mi>f</mi><mo stretchy="false">(</mo><mi>X</mi><mo stretchy="false">)</mo><mo>−</mo><mi>Y</mi><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><msubsup><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><mn>2</mn><mn>2</mn></msubsup></math></span></span><script type="math/tex" id="MathJax-Element-52">L = \frac{1}{n}\sum\limits_{i = 1}^n(f(x_i) - y_i)^2 = \frac{1}{n}||f(X) - Y||_2^2</script></span></li>
<li><span>MAE (Mean Absolute Error): </span><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-53-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 118%; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>L</mi><mo>=</mo><mfrac><mn>1</mn><mi>n</mi></mfrac><munderover><mo movablelimits=&quot;false&quot;>&amp;#x2211;</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>n</mi></munderover><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>|</mo></mrow><mi>f</mi><mo stretchy=&quot;false&quot;>(</mo><msub><mi>x</mi><mi>i</mi></msub><mo stretchy=&quot;false&quot;>)</mo><mo>&amp;#x2212;</mo><msub><mi>y</mi><mi>i</mi></msub><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>|</mo></mrow><mo>=</mo><mfrac><mn>1</mn><mi>n</mi></mfrac><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>|</mo></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>|</mo></mrow><mi>f</mi><mo stretchy=&quot;false&quot;>(</mo><mi>X</mi><mo stretchy=&quot;false&quot;>)</mo><mo>&amp;#x2212;</mo><mi>Y</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>|</mo></mrow><msub><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>|</mo></mrow><mn>1</mn></msub></math>" role="presentation"><span id="MJXc-Node-789" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-790" class="mjx-mrow"><span id="MJXc-Node-791" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.267em;">L</span></span><span id="MJXc-Node-792" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.056em; padding-bottom: 0.32em;">=</span></span><span id="MJXc-Node-793" class="mjx-mfrac MJXc-space3"><span class="mjx-box MJXc-stacked" style="width: 0.566em; padding: 0px 0.12em;"><span class="mjx-numerator" style="font-size: 70.7%; width: 0.8em; top: -1.299em;"><span id="MJXc-Node-794" class="mjx-mn" style=""><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.373em; padding-bottom: 0.32em;">1</span></span></span><span class="mjx-denominator" style="font-size: 70.7%; width: 0.8em; bottom: -0.524em;"><span id="MJXc-Node-795" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.215em; padding-bottom: 0.267em;">n</span></span></span><span style="border-bottom-width: 1.3px; border-bottom-style: solid; top: -0.283em; width: 0.566em;" class="mjx-line"></span></span><span style="height: 1.289em; vertical-align: -0.37em;" class="mjx-vsize"></span></span><span id="MJXc-Node-796" class="mjx-munderover MJXc-space1"><span class="mjx-itable"><span class="mjx-row"><span class="mjx-cell"><span class="mjx-stack"><span class="mjx-over" style="font-size: 70.7%; padding-bottom: 0.247em; padding-top: 0.141em; padding-left: 0.512em;"><span id="MJXc-Node-803" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.215em; padding-bottom: 0.267em;">n</span></span></span><span class="mjx-op" style="padding-left: 0.046em;"><span id="MJXc-Node-797" class="mjx-mo"><span class="mjx-char MJXc-TeX-size1-R" style="padding-top: 0.532em; padding-bottom: 0.532em;">∑</span></span></span></span></span></span><span class="mjx-row"><span class="mjx-under" style="font-size: 70.7%; padding-top: 0.236em; padding-bottom: 0.141em;"><span id="MJXc-Node-798" class="mjx-texatom" style=""><span id="MJXc-Node-799" class="mjx-mrow"><span id="MJXc-Node-800" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.426em; padding-bottom: 0.267em;">i</span></span><span id="MJXc-Node-801" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.056em; padding-bottom: 0.32em;">=</span></span><span id="MJXc-Node-802" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.373em; padding-bottom: 0.32em;">1</span></span></span></span></span></span></span></span><span id="MJXc-Node-804" class="mjx-texatom MJXc-space1"><span id="MJXc-Node-805" class="mjx-mrow"><span id="MJXc-Node-806" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.479em; padding-bottom: 0.585em;">|</span></span></span></span><span id="MJXc-Node-807" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.479em; padding-right: 0.06em;">f</span></span><span id="MJXc-Node-808" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.479em; padding-bottom: 0.585em;">(</span></span><span id="MJXc-Node-809" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-810" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.215em; padding-bottom: 0.267em;">x</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-811" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.426em; padding-bottom: 0.267em;">i</span></span></span></span><span id="MJXc-Node-812" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.479em; padding-bottom: 0.585em;">)</span></span><span id="MJXc-Node-813" class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.32em; padding-bottom: 0.426em;">−</span></span><span id="MJXc-Node-814" class="mjx-msubsup MJXc-space2"><span class="mjx-base" style="margin-right: -0.006em;"><span id="MJXc-Node-815" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.215em; padding-bottom: 0.479em; padding-right: 0.006em;">y</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-816" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.426em; padding-bottom: 0.267em;">i</span></span></span></span><span id="MJXc-Node-817" class="mjx-texatom"><span id="MJXc-Node-818" class="mjx-mrow"><span id="MJXc-Node-819" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.479em; padding-bottom: 0.585em;">|</span></span></span></span><span id="MJXc-Node-820" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.056em; padding-bottom: 0.32em;">=</span></span><span id="MJXc-Node-821" class="mjx-mfrac MJXc-space3"><span class="mjx-box MJXc-stacked" style="width: 0.566em; padding: 0px 0.12em;"><span class="mjx-numerator" style="font-size: 70.7%; width: 0.8em; top: -1.299em;"><span id="MJXc-Node-822" class="mjx-mn" style=""><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.373em; padding-bottom: 0.32em;">1</span></span></span><span class="mjx-denominator" style="font-size: 70.7%; width: 0.8em; bottom: -0.524em;"><span id="MJXc-Node-823" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.215em; padding-bottom: 0.267em;">n</span></span></span><span style="border-bottom-width: 1.3px; border-bottom-style: solid; top: -0.283em; width: 0.566em;" class="mjx-line"></span></span><span style="height: 1.289em; vertical-align: -0.37em;" class="mjx-vsize"></span></span><span id="MJXc-Node-824" class="mjx-texatom"><span id="MJXc-Node-825" class="mjx-mrow"><span id="MJXc-Node-826" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.479em; padding-bottom: 0.585em;">|</span></span></span></span><span id="MJXc-Node-827" class="mjx-texatom"><span id="MJXc-Node-828" class="mjx-mrow"><span id="MJXc-Node-829" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.479em; padding-bottom: 0.585em;">|</span></span></span></span><span id="MJXc-Node-830" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.479em; padding-right: 0.06em;">f</span></span><span id="MJXc-Node-831" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.479em; padding-bottom: 0.585em;">(</span></span><span id="MJXc-Node-832" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.267em; padding-right: 0.024em;">X</span></span><span id="MJXc-Node-833" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.479em; padding-bottom: 0.585em;">)</span></span><span id="MJXc-Node-834" class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.32em; padding-bottom: 0.426em;">−</span></span><span id="MJXc-Node-835" class="mjx-mi MJXc-space2"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.267em; padding-right: 0.182em;">Y</span></span><span id="MJXc-Node-836" class="mjx-texatom"><span id="MJXc-Node-837" class="mjx-mrow"><span id="MJXc-Node-838" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.479em; padding-bottom: 0.585em;">|</span></span></span></span><span id="MJXc-Node-839" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-840" class="mjx-texatom"><span id="MJXc-Node-841" class="mjx-mrow"><span id="MJXc-Node-842" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.479em; padding-bottom: 0.585em;">|</span></span></span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.437em; padding-right: 0.071em;"><span id="MJXc-Node-843" class="mjx-mn" style=""><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.373em; padding-bottom: 0.32em;">1</span></span></span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>L</mi><mo>=</mo><mfrac><mn>1</mn><mi>n</mi></mfrac><munderover><mo movablelimits="false">∑</mo><mrow class="MJX-TeXAtom-ORD"><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>n</mi></munderover><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><mi>f</mi><mo stretchy="false">(</mo><msub><mi>x</mi><mi>i</mi></msub><mo stretchy="false">)</mo><mo>−</mo><msub><mi>y</mi><mi>i</mi></msub><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><mo>=</mo><mfrac><mn>1</mn><mi>n</mi></mfrac><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><mi>f</mi><mo stretchy="false">(</mo><mi>X</mi><mo stretchy="false">)</mo><mo>−</mo><mi>Y</mi><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><msub><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><mn>1</mn></msub></math></span></span><script type="math/tex" id="MathJax-Element-53">L = \frac{1}{n}\sum\limits_{i = 1}^n|f(x_i) - y_i| = \frac{1}{n}||f(X) - Y||_1</script></span></li>
</ul>
</li>
</ul>
</li>
<li><strong><span>Аналитическое решение:</span></strong><span> </span><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-54-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 118%; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msup><mi>w</mi><mo>&amp;#x2217;</mo></msup><mo>=</mo><mo stretchy=&quot;false&quot;>(</mo><msup><mi>X</mi><mi>T</mi></msup><mi>X</mi><msup><mo stretchy=&quot;false&quot;>)</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo>&amp;#x2212;</mo><mn>1</mn></mrow></msup><msup><mi>X</mi><mi>T</mi></msup><mi>Y</mi></math>" role="presentation"><span id="MJXc-Node-844" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-845" class="mjx-mrow"><span id="MJXc-Node-846" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-847" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.215em; padding-bottom: 0.267em;">w</span></span></span><span class="mjx-sup" style="font-size: 70.7%; vertical-align: 0.513em; padding-left: 0px; padding-right: 0.071em;"><span id="MJXc-Node-848" class="mjx-mo" style=""><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.162em; padding-bottom: 0.32em;">∗</span></span></span></span><span id="MJXc-Node-849" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.056em; padding-bottom: 0.32em;">=</span></span><span id="MJXc-Node-850" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.479em; padding-bottom: 0.585em;">(</span></span><span id="MJXc-Node-851" class="mjx-msubsup"><span class="mjx-base" style="margin-right: -0.024em;"><span id="MJXc-Node-852" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.267em; padding-right: 0.024em;">X</span></span></span><span class="mjx-sup" style="font-size: 70.7%; vertical-align: 0.513em; padding-left: 0.115em; padding-right: 0.071em;"><span id="MJXc-Node-853" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.267em; padding-right: 0.12em;">T</span></span></span></span><span id="MJXc-Node-854" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.267em; padding-right: 0.024em;">X</span></span><span id="MJXc-Node-855" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-856" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.479em; padding-bottom: 0.585em;">)</span></span></span><span class="mjx-sup" style="font-size: 70.7%; vertical-align: 0.513em; padding-left: 0px; padding-right: 0.071em;"><span id="MJXc-Node-857" class="mjx-texatom" style=""><span id="MJXc-Node-858" class="mjx-mrow"><span id="MJXc-Node-859" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.32em; padding-bottom: 0.426em;">−</span></span><span id="MJXc-Node-860" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.373em; padding-bottom: 0.32em;">1</span></span></span></span></span></span><span id="MJXc-Node-861" class="mjx-msubsup"><span class="mjx-base" style="margin-right: -0.024em;"><span id="MJXc-Node-862" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.267em; padding-right: 0.024em;">X</span></span></span><span class="mjx-sup" style="font-size: 70.7%; vertical-align: 0.513em; padding-left: 0.115em; padding-right: 0.071em;"><span id="MJXc-Node-863" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.267em; padding-right: 0.12em;">T</span></span></span></span><span id="MJXc-Node-864" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.267em; padding-right: 0.182em;">Y</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msup><mi>w</mi><mo>∗</mo></msup><mo>=</mo><mo stretchy="false">(</mo><msup><mi>X</mi><mi>T</mi></msup><mi>X</mi><msup><mo stretchy="false">)</mo><mrow class="MJX-TeXAtom-ORD"><mo>−</mo><mn>1</mn></mrow></msup><msup><mi>X</mi><mi>T</mi></msup><mi>Y</mi></math></span></span><script type="math/tex" id="MathJax-Element-54">w^* = (X^TX)^{-1}X^TY</script></span>
<ul>
<li><span>Вывод (через приравнивание производной к нулю):</span><br>
<span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span class="mjx-chtml MJXc-display" style="text-align: center;"><span id="MathJax-Element-55-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 118%; text-align: center; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><mtable rowspacing=&quot;3pt&quot; columnspacing=&quot;1em&quot; displaystyle=&quot;true&quot;><mtr><mtd><mi>L</mi><mo>=</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>|</mo></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>|</mo></mrow><mi>X</mi><mi>w</mi><mo>&amp;#x2212;</mo><mi>Y</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>|</mo></mrow><msup><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>|</mo></mrow><mn>2</mn></msup><mo>=</mo><mo stretchy=&quot;false&quot;>(</mo><mi>X</mi><mi>w</mi><mo>&amp;#x2212;</mo><mi>Y</mi><msup><mo stretchy=&quot;false&quot;>)</mo><mi>T</mi></msup><mo stretchy=&quot;false&quot;>(</mo><mi>X</mi><mi>w</mi><mo>&amp;#x2212;</mo><mi>Y</mi><mo stretchy=&quot;false&quot;>)</mo><mo>=</mo><mo stretchy=&quot;false&quot;>(</mo><mi>X</mi><mi>w</mi><msup><mo stretchy=&quot;false&quot;>)</mo><mi>T</mi></msup><mi>X</mi><mi>w</mi><mo>&amp;#x2212;</mo><mn>2</mn><mo stretchy=&quot;false&quot;>(</mo><mi>X</mi><mi>w</mi><msup><mo stretchy=&quot;false&quot;>)</mo><mi>T</mi></msup><mi>Y</mi><mo>+</mo><msup><mi>Y</mi><mi>T</mi></msup><mi>Y</mi><mo>=</mo></mtd></mtr><mtr><mtd><mo>=</mo><msup><mi>w</mi><mi>T</mi></msup><msup><mi>X</mi><mi>T</mi></msup><mi>X</mi><mi>w</mi><mo>&amp;#x2212;</mo><mn>2</mn><msup><mi>w</mi><mi>T</mi></msup><msup><mi>X</mi><mi>T</mi></msup><mi>Y</mi><mo>+</mo><msup><mi>Y</mi><mi>T</mi></msup><mi>Y</mi></mtd></mtr><mtr><mtd><mfrac><mrow><mi mathvariant=&quot;normal&quot;>&amp;#x2202;</mi><mi>L</mi></mrow><mrow><mi mathvariant=&quot;normal&quot;>&amp;#x2202;</mi><mi>w</mi></mrow></mfrac><mo>=</mo><msup><mi>X</mi><mi>T</mi></msup><mi>X</mi><mi>w</mi><mo>+</mo><msup><mi>X</mi><mi>T</mi></msup><mi>X</mi><mi>w</mi><mo>&amp;#x2212;</mo><mn>2</mn><msup><mi>X</mi><mi>T</mi></msup><mi>Y</mi><mo>=</mo><mn>0</mn></mtd></mtr><mtr><mtd><msup><mi>w</mi><mo>&amp;#x2217;</mo></msup><mo>=</mo><mo stretchy=&quot;false&quot;>(</mo><msup><mi>X</mi><mi>T</mi></msup><mi>X</mi><msup><mo stretchy=&quot;false&quot;>)</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo>&amp;#x2212;</mo><mn>1</mn></mrow></msup><msup><mi>X</mi><mi>T</mi></msup><mi>Y</mi></mtd></mtr></mtable></math>" role="presentation"><span id="MJXc-Node-865" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-866" class="mjx-mrow"><span id="MJXc-Node-867" class="mjx-mtable" style="vertical-align: -3.069em; padding: 0px 0.167em;"><span class="mjx-table"><span id="MJXc-Node-868" class="mjx-mtr" style="height: 1.416em;"><span id="MJXc-Node-869" class="mjx-mtd" style="padding: 0px; width: 33.186em;"><span id="MJXc-Node-870" class="mjx-mrow" style="margin-top: -0.009em;"><span id="MJXc-Node-871" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.267em;">L</span></span><span id="MJXc-Node-872" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.056em; padding-bottom: 0.32em;">=</span></span><span id="MJXc-Node-873" class="mjx-texatom MJXc-space3"><span id="MJXc-Node-874" class="mjx-mrow"><span id="MJXc-Node-875" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.479em; padding-bottom: 0.585em;">|</span></span></span></span><span id="MJXc-Node-876" class="mjx-texatom"><span id="MJXc-Node-877" class="mjx-mrow"><span id="MJXc-Node-878" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.479em; padding-bottom: 0.585em;">|</span></span></span></span><span id="MJXc-Node-879" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.267em; padding-right: 0.024em;">X</span></span><span id="MJXc-Node-880" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.215em; padding-bottom: 0.267em;">w</span></span><span id="MJXc-Node-881" class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.32em; padding-bottom: 0.426em;">−</span></span><span id="MJXc-Node-882" class="mjx-mi MJXc-space2"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.267em; padding-right: 0.182em;">Y</span></span><span id="MJXc-Node-883" class="mjx-texatom"><span id="MJXc-Node-884" class="mjx-mrow"><span id="MJXc-Node-885" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.479em; padding-bottom: 0.585em;">|</span></span></span></span><span id="MJXc-Node-886" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-887" class="mjx-texatom"><span id="MJXc-Node-888" class="mjx-mrow"><span id="MJXc-Node-889" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.479em; padding-bottom: 0.585em;">|</span></span></span></span></span><span class="mjx-sup" style="font-size: 70.7%; vertical-align: 0.71em; padding-left: 0px; padding-right: 0.071em;"><span id="MJXc-Node-890" class="mjx-mn" style=""><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.373em; padding-bottom: 0.32em;">2</span></span></span></span><span id="MJXc-Node-891" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.056em; padding-bottom: 0.32em;">=</span></span><span id="MJXc-Node-892" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.479em; padding-bottom: 0.585em;">(</span></span><span id="MJXc-Node-893" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.267em; padding-right: 0.024em;">X</span></span><span id="MJXc-Node-894" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.215em; padding-bottom: 0.267em;">w</span></span><span id="MJXc-Node-895" class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.32em; padding-bottom: 0.426em;">−</span></span><span id="MJXc-Node-896" class="mjx-mi MJXc-space2"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.267em; padding-right: 0.182em;">Y</span></span><span id="MJXc-Node-897" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-898" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.479em; padding-bottom: 0.585em;">)</span></span></span><span class="mjx-sup" style="font-size: 70.7%; vertical-align: 0.584em; padding-left: 0px; padding-right: 0.071em;"><span id="MJXc-Node-899" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.267em; padding-right: 0.12em;">T</span></span></span></span><span id="MJXc-Node-900" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.479em; padding-bottom: 0.585em;">(</span></span><span id="MJXc-Node-901" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.267em; padding-right: 0.024em;">X</span></span><span id="MJXc-Node-902" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.215em; padding-bottom: 0.267em;">w</span></span><span id="MJXc-Node-903" class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.32em; padding-bottom: 0.426em;">−</span></span><span id="MJXc-Node-904" class="mjx-mi MJXc-space2"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.267em; padding-right: 0.182em;">Y</span></span><span id="MJXc-Node-905" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.479em; padding-bottom: 0.585em;">)</span></span><span id="MJXc-Node-906" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.056em; padding-bottom: 0.32em;">=</span></span><span id="MJXc-Node-907" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.479em; padding-bottom: 0.585em;">(</span></span><span id="MJXc-Node-908" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.267em; padding-right: 0.024em;">X</span></span><span id="MJXc-Node-909" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.215em; padding-bottom: 0.267em;">w</span></span><span id="MJXc-Node-910" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-911" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.479em; padding-bottom: 0.585em;">)</span></span></span><span class="mjx-sup" style="font-size: 70.7%; vertical-align: 0.584em; padding-left: 0px; padding-right: 0.071em;"><span id="MJXc-Node-912" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.267em; padding-right: 0.12em;">T</span></span></span></span><span id="MJXc-Node-913" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.267em; padding-right: 0.024em;">X</span></span><span id="MJXc-Node-914" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.215em; padding-bottom: 0.267em;">w</span></span><span id="MJXc-Node-915" class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.32em; padding-bottom: 0.426em;">−</span></span><span id="MJXc-Node-916" class="mjx-mn MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.373em; padding-bottom: 0.32em;">2</span></span><span id="MJXc-Node-917" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.479em; padding-bottom: 0.585em;">(</span></span><span id="MJXc-Node-918" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.267em; padding-right: 0.024em;">X</span></span><span id="MJXc-Node-919" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.215em; padding-bottom: 0.267em;">w</span></span><span id="MJXc-Node-920" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-921" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.479em; padding-bottom: 0.585em;">)</span></span></span><span class="mjx-sup" style="font-size: 70.7%; vertical-align: 0.584em; padding-left: 0px; padding-right: 0.071em;"><span id="MJXc-Node-922" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.267em; padding-right: 0.12em;">T</span></span></span></span><span id="MJXc-Node-923" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.267em; padding-right: 0.182em;">Y</span></span><span id="MJXc-Node-924" class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.32em; padding-bottom: 0.426em;">+</span></span><span id="MJXc-Node-925" class="mjx-msubsup MJXc-space2"><span class="mjx-base" style="margin-right: -0.182em;"><span id="MJXc-Node-926" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.267em; padding-right: 0.182em;">Y</span></span></span><span class="mjx-sup" style="font-size: 70.7%; vertical-align: 0.584em; padding-left: 0.405em; padding-right: 0.071em;"><span id="MJXc-Node-927" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.267em; padding-right: 0.12em;">T</span></span></span></span><span id="MJXc-Node-928" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.267em; padding-right: 0.182em;">Y</span></span><span id="MJXc-Node-929" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.056em; padding-bottom: 0.32em;">=</span></span><span class="mjx-strut"></span></span></span></span><span id="MJXc-Node-930" class="mjx-mtr" style="height: 1.409em;"><span id="MJXc-Node-931" class="mjx-mtd" style="padding: 0.15em 0px 0px;"><span id="MJXc-Node-932" class="mjx-mrow" style="margin-top: -0.091em;"><span id="MJXc-Node-933" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.056em; padding-bottom: 0.32em;">=</span></span><span id="MJXc-Node-934" class="mjx-msubsup MJXc-space3"><span class="mjx-base"><span id="MJXc-Node-935" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.215em; padding-bottom: 0.267em;">w</span></span></span><span class="mjx-sup" style="font-size: 70.7%; vertical-align: 0.584em; padding-left: 0px; padding-right: 0.071em;"><span id="MJXc-Node-936" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.267em; padding-right: 0.12em;">T</span></span></span></span><span id="MJXc-Node-937" class="mjx-msubsup"><span class="mjx-base" style="margin-right: -0.024em;"><span id="MJXc-Node-938" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.267em; padding-right: 0.024em;">X</span></span></span><span class="mjx-sup" style="font-size: 70.7%; vertical-align: 0.584em; padding-left: 0.115em; padding-right: 0.071em;"><span id="MJXc-Node-939" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.267em; padding-right: 0.12em;">T</span></span></span></span><span id="MJXc-Node-940" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.267em; padding-right: 0.024em;">X</span></span><span id="MJXc-Node-941" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.215em; padding-bottom: 0.267em;">w</span></span><span id="MJXc-Node-942" class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.32em; padding-bottom: 0.426em;">−</span></span><span id="MJXc-Node-943" class="mjx-mn MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.373em; padding-bottom: 0.32em;">2</span></span><span id="MJXc-Node-944" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-945" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.215em; padding-bottom: 0.267em;">w</span></span></span><span class="mjx-sup" style="font-size: 70.7%; vertical-align: 0.584em; padding-left: 0px; padding-right: 0.071em;"><span id="MJXc-Node-946" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.267em; padding-right: 0.12em;">T</span></span></span></span><span id="MJXc-Node-947" class="mjx-msubsup"><span class="mjx-base" style="margin-right: -0.024em;"><span id="MJXc-Node-948" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.267em; padding-right: 0.024em;">X</span></span></span><span class="mjx-sup" style="font-size: 70.7%; vertical-align: 0.584em; padding-left: 0.115em; padding-right: 0.071em;"><span id="MJXc-Node-949" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.267em; padding-right: 0.12em;">T</span></span></span></span><span id="MJXc-Node-950" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.267em; padding-right: 0.182em;">Y</span></span><span id="MJXc-Node-951" class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.32em; padding-bottom: 0.426em;">+</span></span><span id="MJXc-Node-952" class="mjx-msubsup MJXc-space2"><span class="mjx-base" style="margin-right: -0.182em;"><span id="MJXc-Node-953" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.267em; padding-right: 0.182em;">Y</span></span></span><span class="mjx-sup" style="font-size: 70.7%; vertical-align: 0.584em; padding-left: 0.405em; padding-right: 0.071em;"><span id="MJXc-Node-954" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.267em; padding-right: 0.12em;">T</span></span></span></span><span id="MJXc-Node-955" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.267em; padding-right: 0.182em;">Y</span></span><span class="mjx-strut"></span></span></span></span><span id="MJXc-Node-956" class="mjx-mtr" style="height: 2.479em;"><span id="MJXc-Node-957" class="mjx-mtd" style="padding: 0.15em 0px 0px;"><span id="MJXc-Node-958" class="mjx-mrow"><span id="MJXc-Node-959" class="mjx-mfrac"><span class="mjx-box MJXc-stacked" style="width: 1.482em; padding: 0px 0.12em;"><span class="mjx-numerator" style="width: 1.482em; top: -1.417em;"><span id="MJXc-Node-960" class="mjx-mrow"><span id="MJXc-Node-961" class="mjx-mi"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.426em; padding-bottom: 0.373em; padding-right: 0.035em;">∂</span></span><span id="MJXc-Node-962" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.267em;">L</span></span></span></span><span class="mjx-denominator" style="width: 1.482em; bottom: -0.763em;"><span id="MJXc-Node-963" class="mjx-mrow"><span id="MJXc-Node-964" class="mjx-mi"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.426em; padding-bottom: 0.373em; padding-right: 0.035em;">∂</span></span><span id="MJXc-Node-965" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.215em; padding-bottom: 0.267em;">w</span></span></span></span><span style="border-bottom-width: 1.3px; border-bottom-style: solid; top: -0.283em; width: 1.482em;" class="mjx-line"></span></span><span style="height: 2.179em; vertical-align: -0.763em;" class="mjx-vsize"></span></span><span id="MJXc-Node-966" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.056em; padding-bottom: 0.32em;">=</span></span><span id="MJXc-Node-967" class="mjx-msubsup MJXc-space3"><span class="mjx-base" style="margin-right: -0.024em;"><span id="MJXc-Node-968" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.267em; padding-right: 0.024em;">X</span></span></span><span class="mjx-sup" style="font-size: 70.7%; vertical-align: 0.584em; padding-left: 0.115em; padding-right: 0.071em;"><span id="MJXc-Node-969" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.267em; padding-right: 0.12em;">T</span></span></span></span><span id="MJXc-Node-970" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.267em; padding-right: 0.024em;">X</span></span><span id="MJXc-Node-971" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.215em; padding-bottom: 0.267em;">w</span></span><span id="MJXc-Node-972" class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.32em; padding-bottom: 0.426em;">+</span></span><span id="MJXc-Node-973" class="mjx-msubsup MJXc-space2"><span class="mjx-base" style="margin-right: -0.024em;"><span id="MJXc-Node-974" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.267em; padding-right: 0.024em;">X</span></span></span><span class="mjx-sup" style="font-size: 70.7%; vertical-align: 0.584em; padding-left: 0.115em; padding-right: 0.071em;"><span id="MJXc-Node-975" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.267em; padding-right: 0.12em;">T</span></span></span></span><span id="MJXc-Node-976" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.267em; padding-right: 0.024em;">X</span></span><span id="MJXc-Node-977" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.215em; padding-bottom: 0.267em;">w</span></span><span id="MJXc-Node-978" class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.32em; padding-bottom: 0.426em;">−</span></span><span id="MJXc-Node-979" class="mjx-mn MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.373em; padding-bottom: 0.32em;">2</span></span><span id="MJXc-Node-980" class="mjx-msubsup"><span class="mjx-base" style="margin-right: -0.024em;"><span id="MJXc-Node-981" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.267em; padding-right: 0.024em;">X</span></span></span><span class="mjx-sup" style="font-size: 70.7%; vertical-align: 0.584em; padding-left: 0.115em; padding-right: 0.071em;"><span id="MJXc-Node-982" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.267em; padding-right: 0.12em;">T</span></span></span></span><span id="MJXc-Node-983" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.267em; padding-right: 0.182em;">Y</span></span><span id="MJXc-Node-984" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.056em; padding-bottom: 0.32em;">=</span></span><span id="MJXc-Node-985" class="mjx-mn MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.373em; padding-bottom: 0.373em;">0</span></span><span class="mjx-strut"></span></span></span></span><span id="MJXc-Node-986" class="mjx-mtr" style="height: 1.334em;"><span id="MJXc-Node-987" class="mjx-mtd" style="padding: 0.15em 0px 0px;"><span id="MJXc-Node-988" class="mjx-mrow" style="margin-top: -0.091em;"><span id="MJXc-Node-989" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-990" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.215em; padding-bottom: 0.267em;">w</span></span></span><span class="mjx-sup" style="font-size: 70.7%; vertical-align: 0.584em; padding-left: 0px; padding-right: 0.071em;"><span id="MJXc-Node-991" class="mjx-mo" style=""><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.162em; padding-bottom: 0.32em;">∗</span></span></span></span><span id="MJXc-Node-992" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.056em; padding-bottom: 0.32em;">=</span></span><span id="MJXc-Node-993" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.479em; padding-bottom: 0.585em;">(</span></span><span id="MJXc-Node-994" class="mjx-msubsup"><span class="mjx-base" style="margin-right: -0.024em;"><span id="MJXc-Node-995" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.267em; padding-right: 0.024em;">X</span></span></span><span class="mjx-sup" style="font-size: 70.7%; vertical-align: 0.584em; padding-left: 0.115em; padding-right: 0.071em;"><span id="MJXc-Node-996" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.267em; padding-right: 0.12em;">T</span></span></span></span><span id="MJXc-Node-997" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.267em; padding-right: 0.024em;">X</span></span><span id="MJXc-Node-998" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-999" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.479em; padding-bottom: 0.585em;">)</span></span></span><span class="mjx-sup" style="font-size: 70.7%; vertical-align: 0.584em; padding-left: 0px; padding-right: 0.071em;"><span id="MJXc-Node-1000" class="mjx-texatom" style=""><span id="MJXc-Node-1001" class="mjx-mrow"><span id="MJXc-Node-1002" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.32em; padding-bottom: 0.426em;">−</span></span><span id="MJXc-Node-1003" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.373em; padding-bottom: 0.32em;">1</span></span></span></span></span></span><span id="MJXc-Node-1004" class="mjx-msubsup"><span class="mjx-base" style="margin-right: -0.024em;"><span id="MJXc-Node-1005" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.267em; padding-right: 0.024em;">X</span></span></span><span class="mjx-sup" style="font-size: 70.7%; vertical-align: 0.584em; padding-left: 0.115em; padding-right: 0.071em;"><span id="MJXc-Node-1006" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.267em; padding-right: 0.12em;">T</span></span></span></span><span id="MJXc-Node-1007" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.267em; padding-right: 0.182em;">Y</span></span><span class="mjx-strut"></span></span></span></span></span></span></span></span><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mtable rowspacing="3pt" columnspacing="1em" displaystyle="true"><mtr><mtd><mi>L</mi><mo>=</mo><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><mi>X</mi><mi>w</mi><mo>−</mo><mi>Y</mi><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><msup><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><mn>2</mn></msup><mo>=</mo><mo stretchy="false">(</mo><mi>X</mi><mi>w</mi><mo>−</mo><mi>Y</mi><msup><mo stretchy="false">)</mo><mi>T</mi></msup><mo stretchy="false">(</mo><mi>X</mi><mi>w</mi><mo>−</mo><mi>Y</mi><mo stretchy="false">)</mo><mo>=</mo><mo stretchy="false">(</mo><mi>X</mi><mi>w</mi><msup><mo stretchy="false">)</mo><mi>T</mi></msup><mi>X</mi><mi>w</mi><mo>−</mo><mn>2</mn><mo stretchy="false">(</mo><mi>X</mi><mi>w</mi><msup><mo stretchy="false">)</mo><mi>T</mi></msup><mi>Y</mi><mo>+</mo><msup><mi>Y</mi><mi>T</mi></msup><mi>Y</mi><mo>=</mo></mtd></mtr><mtr><mtd><mo>=</mo><msup><mi>w</mi><mi>T</mi></msup><msup><mi>X</mi><mi>T</mi></msup><mi>X</mi><mi>w</mi><mo>−</mo><mn>2</mn><msup><mi>w</mi><mi>T</mi></msup><msup><mi>X</mi><mi>T</mi></msup><mi>Y</mi><mo>+</mo><msup><mi>Y</mi><mi>T</mi></msup><mi>Y</mi></mtd></mtr><mtr><mtd><mfrac><mrow><mi mathvariant="normal">∂</mi><mi>L</mi></mrow><mrow><mi mathvariant="normal">∂</mi><mi>w</mi></mrow></mfrac><mo>=</mo><msup><mi>X</mi><mi>T</mi></msup><mi>X</mi><mi>w</mi><mo>+</mo><msup><mi>X</mi><mi>T</mi></msup><mi>X</mi><mi>w</mi><mo>−</mo><mn>2</mn><msup><mi>X</mi><mi>T</mi></msup><mi>Y</mi><mo>=</mo><mn>0</mn></mtd></mtr><mtr><mtd><msup><mi>w</mi><mo>∗</mo></msup><mo>=</mo><mo stretchy="false">(</mo><msup><mi>X</mi><mi>T</mi></msup><mi>X</mi><msup><mo stretchy="false">)</mo><mrow class="MJX-TeXAtom-ORD"><mo>−</mo><mn>1</mn></mrow></msup><msup><mi>X</mi><mi>T</mi></msup><mi>Y</mi></mtd></mtr></mtable></math></span></span></span><script type="math/tex; mode=display" id="MathJax-Element-55"> 
\begin{gather}
L = ||Xw - Y||^2 = (Xw - Y)^T(Xw - Y) = (Xw)^TXw - 2(Xw)^TY + Y^TY = \\
= w^TX^TXw - 2w^TX^TY + Y^TY \\
\frac{\partial L}{\partial w} = X^TXw + X^TXw - 2X^TY = 0 \\
w^* = (X^TX)^{-1}X^TY
\end{gather}
</script></span></li>
<li><span>Заметим, что аналитическое решение </span><em><span>нестабильно</span></em><span> для вычислений. Т.е. если матрица вырождена то её обращение, вообще говоря, невозможно. К тому же, обращение матриц само по себе является дорогой операцией в смысле сложности вычислений.</span></li>
</ul>
</li>
<li><strong><span>Теорема Гаусса-Маркова:</span></strong><span> Пусть </span><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-56-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 118%; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>Y</mi><mo>=</mo><mi>f</mi><mo stretchy=&quot;false&quot;>(</mo><mi>X</mi><mo stretchy=&quot;false&quot;>)</mo><mo>+</mo><mi>&amp;#x03B5;</mi><mo>,</mo></math>" role="presentation"><span id="MJXc-Node-1008" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-1009" class="mjx-mrow"><span id="MJXc-Node-1010" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.267em; padding-right: 0.182em;">Y</span></span><span id="MJXc-Node-1011" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.056em; padding-bottom: 0.32em;">=</span></span><span id="MJXc-Node-1012" class="mjx-mi MJXc-space3"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.479em; padding-right: 0.06em;">f</span></span><span id="MJXc-Node-1013" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.479em; padding-bottom: 0.585em;">(</span></span><span id="MJXc-Node-1014" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.267em; padding-right: 0.024em;">X</span></span><span id="MJXc-Node-1015" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.479em; padding-bottom: 0.585em;">)</span></span><span id="MJXc-Node-1016" class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.32em; padding-bottom: 0.426em;">+</span></span><span id="MJXc-Node-1017" class="mjx-mi MJXc-space2"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.215em; padding-bottom: 0.32em;">ε</span></span><span id="MJXc-Node-1018" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="margin-top: -0.156em; padding-bottom: 0.532em;">,</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>Y</mi><mo>=</mo><mi>f</mi><mo stretchy="false">(</mo><mi>X</mi><mo stretchy="false">)</mo><mo>+</mo><mi>ε</mi><mo>,</mo></math></span></span><script type="math/tex" id="MathJax-Element-56">Y = f(X) + \varepsilon,</script></span><span> где </span><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-57-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 118%; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>f</mi><mo stretchy=&quot;false&quot;>(</mo><mi>X</mi><mo stretchy=&quot;false&quot;>)</mo><mo>=</mo><mi>X</mi><mi>w</mi></math>" role="presentation"><span id="MJXc-Node-1019" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-1020" class="mjx-mrow"><span id="MJXc-Node-1021" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.479em; padding-right: 0.06em;">f</span></span><span id="MJXc-Node-1022" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.479em; padding-bottom: 0.585em;">(</span></span><span id="MJXc-Node-1023" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.267em; padding-right: 0.024em;">X</span></span><span id="MJXc-Node-1024" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.479em; padding-bottom: 0.585em;">)</span></span><span id="MJXc-Node-1025" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.056em; padding-bottom: 0.32em;">=</span></span><span id="MJXc-Node-1026" class="mjx-mi MJXc-space3"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.267em; padding-right: 0.024em;">X</span></span><span id="MJXc-Node-1027" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.215em; padding-bottom: 0.267em;">w</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>f</mi><mo stretchy="false">(</mo><mi>X</mi><mo stretchy="false">)</mo><mo>=</mo><mi>X</mi><mi>w</mi></math></span></span><script type="math/tex" id="MathJax-Element-57">f(X) = Xw</script></span><span> — линейная и выполнены следующие условия:</span><br>
<span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span class="mjx-chtml MJXc-display" style="text-align: center;"><span id="MathJax-Element-58-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 118%; text-align: center; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><mtable rowspacing=&quot;3pt&quot; columnspacing=&quot;1em&quot; displaystyle=&quot;true&quot;><mtr><mtd><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi mathvariant=&quot;double-struck&quot;>E</mi></mrow><msub><mi>&amp;#x03B5;</mi><mi>i</mi></msub><mo>=</mo><mn>0</mn><mo>,</mo><mi mathvariant=&quot;normal&quot;>&amp;#x2200;</mi><mi>i</mi></mtd></mtr><mtr><mtd><mtext>Var</mtext><mo stretchy=&quot;false&quot;>(</mo><msub><mi>&amp;#x03B5;</mi><mi>i</mi></msub><mo stretchy=&quot;false&quot;>)</mo><mo>=</mo><msup><mi>&amp;#x03C3;</mi><mn>2</mn></msup><mo>,</mo><mi mathvariant=&quot;normal&quot;>&amp;#x2200;</mi><mi>i</mi></mtd></mtr><mtr><mtd><mtext>Cov</mtext><mo stretchy=&quot;false&quot;>(</mo><msub><mi>&amp;#x03B5;</mi><mi>i</mi></msub><mo>,</mo><msub><mi>&amp;#x03B5;</mi><mi>j</mi></msub><mo stretchy=&quot;false&quot;>)</mo><mo>=</mo><mn>0</mn><mo>,</mo><mi mathvariant=&quot;normal&quot;>&amp;#x2200;</mi><mi>i</mi><mo>&amp;#x2260;</mo><mi>j</mi></mtd></mtr></mtable></math>" role="presentation"><span id="MJXc-Node-1028" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-1029" class="mjx-mrow"><span id="MJXc-Node-1030" class="mjx-mtable" style="vertical-align: -1.704em; padding: 0px 0.167em;"><span class="mjx-table"><span id="MJXc-Node-1031" class="mjx-mtr" style="height: 1.169em;"><span id="MJXc-Node-1032" class="mjx-mtd" style="padding: 0px; width: 9.435em;"><span id="MJXc-Node-1033" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-1034" class="mjx-texatom"><span id="MJXc-Node-1035" class="mjx-mrow"><span id="MJXc-Node-1036" class="mjx-mi"><span class="mjx-char MJXc-TeX-ams-R" style="padding-top: 0.426em; padding-bottom: 0.32em;">E</span></span></span></span><span id="MJXc-Node-1037" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-1038" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.215em; padding-bottom: 0.32em;">ε</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-1039" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.426em; padding-bottom: 0.267em;">i</span></span></span></span><span id="MJXc-Node-1040" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.056em; padding-bottom: 0.32em;">=</span></span><span id="MJXc-Node-1041" class="mjx-mn MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.373em; padding-bottom: 0.373em;">0</span></span><span id="MJXc-Node-1042" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="margin-top: -0.156em; padding-bottom: 0.532em;">,</span></span><span id="MJXc-Node-1043" class="mjx-mi MJXc-space1"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.426em; padding-bottom: 0.373em;">∀</span></span><span id="MJXc-Node-1044" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.426em; padding-bottom: 0.267em;">i</span></span><span class="mjx-strut"></span></span></span></span><span id="MJXc-Node-1045" class="mjx-mtr" style="height: 1.477em;"><span id="MJXc-Node-1046" class="mjx-mtd" style="padding: 0.15em 0px 0px;"><span id="MJXc-Node-1047" class="mjx-mrow" style="margin-top: -0.098em;"><span id="MJXc-Node-1048" class="mjx-mtext"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.373em; padding-bottom: 0.373em;">Var</span></span><span id="MJXc-Node-1049" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.479em; padding-bottom: 0.585em;">(</span></span><span id="MJXc-Node-1050" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-1051" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.215em; padding-bottom: 0.32em;">ε</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-1052" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.426em; padding-bottom: 0.267em;">i</span></span></span></span><span id="MJXc-Node-1053" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.479em; padding-bottom: 0.585em;">)</span></span><span id="MJXc-Node-1054" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.056em; padding-bottom: 0.32em;">=</span></span><span id="MJXc-Node-1055" class="mjx-msubsup MJXc-space3"><span class="mjx-base" style="margin-right: -0.001em;"><span id="MJXc-Node-1056" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.215em; padding-bottom: 0.267em; padding-right: 0.001em;">σ</span></span></span><span class="mjx-sup" style="font-size: 70.7%; vertical-align: 0.584em; padding-left: 0.073em; padding-right: 0.071em;"><span id="MJXc-Node-1057" class="mjx-mn" style=""><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.373em; padding-bottom: 0.32em;">2</span></span></span></span><span id="MJXc-Node-1058" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="margin-top: -0.156em; padding-bottom: 0.532em;">,</span></span><span id="MJXc-Node-1059" class="mjx-mi MJXc-space1"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.426em; padding-bottom: 0.373em;">∀</span></span><span id="MJXc-Node-1060" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.426em; padding-bottom: 0.267em;">i</span></span><span class="mjx-strut"></span></span></span></span><span id="MJXc-Node-1061" class="mjx-mtr" style="height: 1.262em;"><span id="MJXc-Node-1062" class="mjx-mtd" style="padding: 0.15em 0px 0px;"><span id="MJXc-Node-1063" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-1064" class="mjx-mtext"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.426em; padding-bottom: 0.373em;">Cov</span></span><span id="MJXc-Node-1065" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.479em; padding-bottom: 0.585em;">(</span></span><span id="MJXc-Node-1066" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-1067" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.215em; padding-bottom: 0.32em;">ε</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-1068" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.426em; padding-bottom: 0.267em;">i</span></span></span></span><span id="MJXc-Node-1069" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="margin-top: -0.156em; padding-bottom: 0.532em;">,</span></span><span id="MJXc-Node-1070" class="mjx-msubsup MJXc-space1"><span class="mjx-base"><span id="MJXc-Node-1071" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.215em; padding-bottom: 0.32em;">ε</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-1072" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.426em; padding-bottom: 0.479em;">j</span></span></span></span><span id="MJXc-Node-1073" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.479em; padding-bottom: 0.585em;">)</span></span><span id="MJXc-Node-1074" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.056em; padding-bottom: 0.32em;">=</span></span><span id="MJXc-Node-1075" class="mjx-mn MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.373em; padding-bottom: 0.373em;">0</span></span><span id="MJXc-Node-1076" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="margin-top: -0.156em; padding-bottom: 0.532em;">,</span></span><span id="MJXc-Node-1077" class="mjx-mi MJXc-space1"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.426em; padding-bottom: 0.373em;">∀</span></span><span id="MJXc-Node-1078" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.426em; padding-bottom: 0.267em;">i</span></span><span id="MJXc-Node-1079" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.426em; padding-bottom: 0.532em;">≠</span></span><span id="MJXc-Node-1080" class="mjx-mi MJXc-space3"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.426em; padding-bottom: 0.479em;">j</span></span><span class="mjx-strut"></span></span></span></span></span></span></span></span><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mtable rowspacing="3pt" columnspacing="1em" displaystyle="true"><mtr><mtd><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="double-struck">E</mi></mrow><msub><mi>ε</mi><mi>i</mi></msub><mo>=</mo><mn>0</mn><mo>,</mo><mi mathvariant="normal">∀</mi><mi>i</mi></mtd></mtr><mtr><mtd><mtext>Var</mtext><mo stretchy="false">(</mo><msub><mi>ε</mi><mi>i</mi></msub><mo stretchy="false">)</mo><mo>=</mo><msup><mi>σ</mi><mn>2</mn></msup><mo>,</mo><mi mathvariant="normal">∀</mi><mi>i</mi></mtd></mtr><mtr><mtd><mtext>Cov</mtext><mo stretchy="false">(</mo><msub><mi>ε</mi><mi>i</mi></msub><mo>,</mo><msub><mi>ε</mi><mi>j</mi></msub><mo stretchy="false">)</mo><mo>=</mo><mn>0</mn><mo>,</mo><mi mathvariant="normal">∀</mi><mi>i</mi><mo>≠</mo><mi>j</mi></mtd></mtr></mtable></math></span></span></span><script type="math/tex; mode=display" id="MathJax-Element-58">
\begin{gather}
 \mathbb{E}\varepsilon_i = 0, \forall i \\
 \text{Var}(\varepsilon_i) = \sigma^2, \forall i \\
 \text{Cov}(\varepsilon_i, \varepsilon_j) = 0, \forall i \neq j
\end{gather}
</script></span><br>
<span>Тогда аналитическое решение является </span><strong><span>лучшей несмещённой линейной оценкой (Best Linear Unbiased Estimator — BLUE)</span></strong><span> функции </span><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-59-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 118%; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>f</mi><mo stretchy=&quot;false&quot;>(</mo><mi>X</mi><mo stretchy=&quot;false&quot;>)</mo></math>" role="presentation"><span id="MJXc-Node-1081" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-1082" class="mjx-mrow"><span id="MJXc-Node-1083" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.479em; padding-right: 0.06em;">f</span></span><span id="MJXc-Node-1084" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.479em; padding-bottom: 0.585em;">(</span></span><span id="MJXc-Node-1085" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.267em; padding-right: 0.024em;">X</span></span><span id="MJXc-Node-1086" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.479em; padding-bottom: 0.585em;">)</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>f</mi><mo stretchy="false">(</mo><mi>X</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-59">f(X)</script></span><span> (т.е. вектора весов </span><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-60-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 118%; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>w</mi></math>" role="presentation"><span id="MJXc-Node-1087" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-1088" class="mjx-mrow"><span id="MJXc-Node-1089" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.215em; padding-bottom: 0.267em;">w</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>w</mi></math></span></span><script type="math/tex" id="MathJax-Element-60">w</script></span><span>)</span>
<ul>
<li><span>Отметим, что смысл теоремы заключается в том, что, предполагая зависимость таргета от признаков линейной, при выполнении указанных выше условий, аналитическое решение является </span><em><span>оптимальной оценкой</span></em><span>  в смысле статистики, т.е. имеет </span><strong><span>наимешьшую дисперсию</span></strong><span> в классе линейных несмещённых оценок.</span></li>
<li><strong><span>Несмещённость:</span></strong><span> математическое ожидание нашей оценки совпадает с истинной линейной зависимостью:</span><br>
<span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span class="mjx-chtml MJXc-display" style="text-align: center;"><span id="MathJax-Element-61-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 118%; text-align: center; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi mathvariant=&quot;double-struck&quot;>E</mi></mrow><msup><mi>w</mi><mo>&amp;#x2217;</mo></msup><mo>=</mo><msub><mi>w</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>t</mi><mi>r</mi><mi>u</mi><mi>e</mi></mrow></msub></math>" role="presentation"><span id="MJXc-Node-1090" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-1091" class="mjx-mrow"><span id="MJXc-Node-1092" class="mjx-texatom"><span id="MJXc-Node-1093" class="mjx-mrow"><span id="MJXc-Node-1094" class="mjx-mi"><span class="mjx-char MJXc-TeX-ams-R" style="padding-top: 0.426em; padding-bottom: 0.32em;">E</span></span></span></span><span id="MJXc-Node-1095" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-1096" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.215em; padding-bottom: 0.267em;">w</span></span></span><span class="mjx-sup" style="font-size: 70.7%; vertical-align: 0.584em; padding-left: 0px; padding-right: 0.071em;"><span id="MJXc-Node-1097" class="mjx-mo" style=""><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.162em; padding-bottom: 0.32em;">∗</span></span></span></span><span id="MJXc-Node-1098" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.056em; padding-bottom: 0.32em;">=</span></span><span id="MJXc-Node-1099" class="mjx-msubsup MJXc-space3"><span class="mjx-base"><span id="MJXc-Node-1100" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.215em; padding-bottom: 0.267em;">w</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-1101" class="mjx-texatom" style=""><span id="MJXc-Node-1102" class="mjx-mrow"><span id="MJXc-Node-1103" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.426em; padding-bottom: 0.267em;">t</span></span><span id="MJXc-Node-1104" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.215em; padding-bottom: 0.267em;">r</span></span><span id="MJXc-Node-1105" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.215em; padding-bottom: 0.267em;">u</span></span><span id="MJXc-Node-1106" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.215em; padding-bottom: 0.267em;">e</span></span></span></span></span></span></span></span><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="double-struck">E</mi></mrow><msup><mi>w</mi><mo>∗</mo></msup><mo>=</mo><msub><mi>w</mi><mrow class="MJX-TeXAtom-ORD"><mi>t</mi><mi>r</mi><mi>u</mi><mi>e</mi></mrow></msub></math></span></span></span><script type="math/tex; mode=display" id="MathJax-Element-61">
\mathbb{E}w^* = w_{true}
</script></span></li>
</ul>
</li>
<li><strong><span>Градиентное решение</span></strong><span> задачи линейной регресии (градиентный спуск).</span><br>
<span>Другой способ найти решение задачи </span><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-62-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 118%; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><munder><mo form=&quot;prefix&quot;>min</mo><mi>w</mi></munder><mi>Q</mi><mo stretchy=&quot;false&quot;>(</mo><mi>&amp;#x03C9;</mi><mo>,</mo><mi>X</mi><mo stretchy=&quot;false&quot;>)</mo></math>" role="presentation"><span id="MJXc-Node-1107" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-1108" class="mjx-mrow"><span id="MJXc-Node-1109" class="mjx-munderover"><span class="mjx-itable"><span class="mjx-row"><span class="mjx-cell"><span class="mjx-op"><span id="MJXc-Node-1110" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.373em; padding-bottom: 0.32em;">min</span></span></span></span></span><span class="mjx-row"><span class="mjx-under" style="font-size: 70.7%; padding-top: 0.236em; padding-bottom: 0.141em; padding-left: 0.821em;"><span id="MJXc-Node-1111" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.215em; padding-bottom: 0.267em;">w</span></span></span></span></span></span><span id="MJXc-Node-1112" class="mjx-mi MJXc-space1"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.479em;">Q</span></span><span id="MJXc-Node-1113" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.479em; padding-bottom: 0.585em;">(</span></span><span id="MJXc-Node-1114" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.215em; padding-bottom: 0.267em;">ω</span></span><span id="MJXc-Node-1115" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="margin-top: -0.156em; padding-bottom: 0.532em;">,</span></span><span id="MJXc-Node-1116" class="mjx-mi MJXc-space1"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.267em; padding-right: 0.024em;">X</span></span><span id="MJXc-Node-1117" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.479em; padding-bottom: 0.585em;">)</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><munder><mo form="prefix">min</mo><mi>w</mi></munder><mi>Q</mi><mo stretchy="false">(</mo><mi>ω</mi><mo>,</mo><mi>X</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-62">\min\limits_w Q(\omega, X)</script></span><span> — использовать метод оптимизации, например SGD. Его суть заключается в том, чтобы итеративно двигать вектор весов модели в сторону антиградиента, тем самым уменьшая значение функционала ошибки.</span>
<ul>
<li><span>Инициализруем веса (например </span><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-63-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 118%; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msup><mi>&amp;#x03C9;</mi><mn>0</mn></msup><mo>=</mo><mn>0</mn></math>" role="presentation"><span id="MJXc-Node-1118" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-1119" class="mjx-mrow"><span id="MJXc-Node-1120" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-1121" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.215em; padding-bottom: 0.267em;">ω</span></span></span><span class="mjx-sup" style="font-size: 70.7%; vertical-align: 0.513em; padding-left: 0px; padding-right: 0.071em;"><span id="MJXc-Node-1122" class="mjx-mn" style=""><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.373em; padding-bottom: 0.373em;">0</span></span></span></span><span id="MJXc-Node-1123" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.056em; padding-bottom: 0.32em;">=</span></span><span id="MJXc-Node-1124" class="mjx-mn MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.373em; padding-bottom: 0.373em;">0</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msup><mi>ω</mi><mn>0</mn></msup><mo>=</mo><mn>0</mn></math></span></span><script type="math/tex" id="MathJax-Element-63">\omega^0 = 0</script></span><span>).</span></li>
<li><span>Делаем “градиентый шаг”:</span><br>
<span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span class="mjx-chtml MJXc-display" style="text-align: center;"><span id="MathJax-Element-64-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 118%; text-align: center; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><msup><mi>&amp;#x03C9;</mi><mi>t</mi></msup><mo>=</mo><msup><mi>&amp;#x03C9;</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>t</mi><mo>&amp;#x2212;</mo><mn>1</mn></mrow></msup><mo>&amp;#x2212;</mo><msub><mi>&amp;#x03B7;</mi><mi>t</mi></msub><mi mathvariant=&quot;normal&quot;>&amp;#x2207;</mi><mi>Q</mi><mo stretchy=&quot;false&quot;>(</mo><msup><mi>&amp;#x03C9;</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>t</mi><mo>&amp;#x2212;</mo><mn>1</mn></mrow></msup><mo>,</mo><mi>X</mi><mo stretchy=&quot;false&quot;>)</mo></math>" role="presentation"><span id="MJXc-Node-1125" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-1126" class="mjx-mrow"><span id="MJXc-Node-1127" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-1128" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.215em; padding-bottom: 0.267em;">ω</span></span></span><span class="mjx-sup" style="font-size: 70.7%; vertical-align: 0.584em; padding-left: 0px; padding-right: 0.071em;"><span id="MJXc-Node-1129" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.426em; padding-bottom: 0.267em;">t</span></span></span></span><span id="MJXc-Node-1130" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.056em; padding-bottom: 0.32em;">=</span></span><span id="MJXc-Node-1131" class="mjx-msubsup MJXc-space3"><span class="mjx-base"><span id="MJXc-Node-1132" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.215em; padding-bottom: 0.267em;">ω</span></span></span><span class="mjx-sup" style="font-size: 70.7%; vertical-align: 0.584em; padding-left: 0px; padding-right: 0.071em;"><span id="MJXc-Node-1133" class="mjx-texatom" style=""><span id="MJXc-Node-1134" class="mjx-mrow"><span id="MJXc-Node-1135" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.426em; padding-bottom: 0.267em;">t</span></span><span id="MJXc-Node-1136" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.32em; padding-bottom: 0.426em;">−</span></span><span id="MJXc-Node-1137" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.373em; padding-bottom: 0.32em;">1</span></span></span></span></span></span><span id="MJXc-Node-1138" class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.32em; padding-bottom: 0.426em;">−</span></span><span id="MJXc-Node-1139" class="mjx-msubsup MJXc-space2"><span class="mjx-base" style="margin-right: -0.006em;"><span id="MJXc-Node-1140" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.215em; padding-bottom: 0.479em; padding-right: 0.006em;">η</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-1141" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.426em; padding-bottom: 0.267em;">t</span></span></span></span><span id="MJXc-Node-1142" class="mjx-mi"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.373em; padding-bottom: 0.373em;">∇</span></span><span id="MJXc-Node-1143" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.479em;">Q</span></span><span id="MJXc-Node-1144" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.479em; padding-bottom: 0.585em;">(</span></span><span id="MJXc-Node-1145" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-1146" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.215em; padding-bottom: 0.267em;">ω</span></span></span><span class="mjx-sup" style="font-size: 70.7%; vertical-align: 0.584em; padding-left: 0px; padding-right: 0.071em;"><span id="MJXc-Node-1147" class="mjx-texatom" style=""><span id="MJXc-Node-1148" class="mjx-mrow"><span id="MJXc-Node-1149" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.426em; padding-bottom: 0.267em;">t</span></span><span id="MJXc-Node-1150" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.32em; padding-bottom: 0.426em;">−</span></span><span id="MJXc-Node-1151" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.373em; padding-bottom: 0.32em;">1</span></span></span></span></span></span><span id="MJXc-Node-1152" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="margin-top: -0.156em; padding-bottom: 0.532em;">,</span></span><span id="MJXc-Node-1153" class="mjx-mi MJXc-space1"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.267em; padding-right: 0.024em;">X</span></span><span id="MJXc-Node-1154" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.479em; padding-bottom: 0.585em;">)</span></span></span></span><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><msup><mi>ω</mi><mi>t</mi></msup><mo>=</mo><msup><mi>ω</mi><mrow class="MJX-TeXAtom-ORD"><mi>t</mi><mo>−</mo><mn>1</mn></mrow></msup><mo>−</mo><msub><mi>η</mi><mi>t</mi></msub><mi mathvariant="normal">∇</mi><mi>Q</mi><mo stretchy="false">(</mo><msup><mi>ω</mi><mrow class="MJX-TeXAtom-ORD"><mi>t</mi><mo>−</mo><mn>1</mn></mrow></msup><mo>,</mo><mi>X</mi><mo stretchy="false">)</mo></math></span></span></span><script type="math/tex; mode=display" id="MathJax-Element-64">
\omega^t = \omega^{t - 1} - \eta_t \nabla Q(\omega^{t-1}, X)
</script></span><br>
<span>здесь </span><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-65-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 118%; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>&amp;#x03B7;</mi><mi>t</mi></msub></math>" role="presentation"><span id="MJXc-Node-1155" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-1156" class="mjx-mrow"><span id="MJXc-Node-1157" class="mjx-msubsup"><span class="mjx-base" style="margin-right: -0.006em;"><span id="MJXc-Node-1158" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.215em; padding-bottom: 0.479em; padding-right: 0.006em;">η</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-1159" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.426em; padding-bottom: 0.267em;">t</span></span></span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>η</mi><mi>t</mi></msub></math></span></span><script type="math/tex" id="MathJax-Element-65">\eta_t</script></span><span> — learning rate, параметр алгоритма градиентного спуска.</span><br>
<span>В случае MSE: </span><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-66-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 118%; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi mathvariant=&quot;normal&quot;>&amp;#x2207;</mi><mi>Q</mi><mo stretchy=&quot;false&quot;>(</mo><msup><mi>&amp;#x03C9;</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>t</mi><mo>&amp;#x2212;</mo><mn>1</mn></mrow></msup><mo>,</mo><mi>X</mi><mo stretchy=&quot;false&quot;>)</mo><mo>=</mo><mstyle displaystyle=&quot;true&quot; scriptlevel=&quot;0&quot;><mfrac><mn>2</mn><mi>l</mi></mfrac></mstyle><msup><mi>X</mi><mi>T</mi></msup><mo stretchy=&quot;false&quot;>(</mo><mi>X</mi><mi>&amp;#x03C9;</mi><mo>&amp;#x2212;</mo><mi>y</mi><mo stretchy=&quot;false&quot;>)</mo></math>" role="presentation"><span id="MJXc-Node-1160" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-1161" class="mjx-mrow"><span id="MJXc-Node-1162" class="mjx-mi"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.373em; padding-bottom: 0.373em;">∇</span></span><span id="MJXc-Node-1163" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.479em;">Q</span></span><span id="MJXc-Node-1164" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.479em; padding-bottom: 0.585em;">(</span></span><span id="MJXc-Node-1165" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-1166" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.215em; padding-bottom: 0.267em;">ω</span></span></span><span class="mjx-sup" style="font-size: 70.7%; vertical-align: 0.513em; padding-left: 0px; padding-right: 0.071em;"><span id="MJXc-Node-1167" class="mjx-texatom" style=""><span id="MJXc-Node-1168" class="mjx-mrow"><span id="MJXc-Node-1169" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.426em; padding-bottom: 0.267em;">t</span></span><span id="MJXc-Node-1170" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.32em; padding-bottom: 0.426em;">−</span></span><span id="MJXc-Node-1171" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.373em; padding-bottom: 0.32em;">1</span></span></span></span></span></span><span id="MJXc-Node-1172" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="margin-top: -0.156em; padding-bottom: 0.532em;">,</span></span><span id="MJXc-Node-1173" class="mjx-mi MJXc-space1"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.267em; padding-right: 0.024em;">X</span></span><span id="MJXc-Node-1174" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.479em; padding-bottom: 0.585em;">)</span></span><span id="MJXc-Node-1175" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.056em; padding-bottom: 0.32em;">=</span></span><span id="MJXc-Node-1176" class="mjx-mstyle MJXc-space3"><span id="MJXc-Node-1177" class="mjx-mrow"><span id="MJXc-Node-1178" class="mjx-mfrac"><span class="mjx-box MJXc-stacked" style="width: 0.7em; padding: 0px 0.12em;"><span class="mjx-numerator" style="width: 0.7em; top: -1.368em;"><span id="MJXc-Node-1179" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.373em; padding-bottom: 0.32em;">2</span></span></span><span class="mjx-denominator" style="width: 0.7em; bottom: -0.731em;"><span id="MJXc-Node-1180" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.267em;">l</span></span></span><span style="border-bottom-width: 1.3px; border-bottom-style: solid; top: -0.283em; width: 0.7em;" class="mjx-line"></span></span><span style="height: 2.098em; vertical-align: -0.731em;" class="mjx-vsize"></span></span></span></span><span id="MJXc-Node-1181" class="mjx-msubsup"><span class="mjx-base" style="margin-right: -0.024em;"><span id="MJXc-Node-1182" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.267em; padding-right: 0.024em;">X</span></span></span><span class="mjx-sup" style="font-size: 70.7%; vertical-align: 0.513em; padding-left: 0.115em; padding-right: 0.071em;"><span id="MJXc-Node-1183" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.267em; padding-right: 0.12em;">T</span></span></span></span><span id="MJXc-Node-1184" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.479em; padding-bottom: 0.585em;">(</span></span><span id="MJXc-Node-1185" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.267em; padding-right: 0.024em;">X</span></span><span id="MJXc-Node-1186" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.215em; padding-bottom: 0.267em;">ω</span></span><span id="MJXc-Node-1187" class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.32em; padding-bottom: 0.426em;">−</span></span><span id="MJXc-Node-1188" class="mjx-mi MJXc-space2"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.215em; padding-bottom: 0.479em; padding-right: 0.006em;">y</span></span><span id="MJXc-Node-1189" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.479em; padding-bottom: 0.585em;">)</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi mathvariant="normal">∇</mi><mi>Q</mi><mo stretchy="false">(</mo><msup><mi>ω</mi><mrow class="MJX-TeXAtom-ORD"><mi>t</mi><mo>−</mo><mn>1</mn></mrow></msup><mo>,</mo><mi>X</mi><mo stretchy="false">)</mo><mo>=</mo><mstyle displaystyle="true" scriptlevel="0"><mfrac><mn>2</mn><mi>l</mi></mfrac></mstyle><msup><mi>X</mi><mi>T</mi></msup><mo stretchy="false">(</mo><mi>X</mi><mi>ω</mi><mo>−</mo><mi>y</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-66">\nabla Q(\omega^{t-1}, X) = \dfrac{2}{l}X^T(X\omega - y)</script></span></li>
<li><span>Останавливем итерации, если наступает сходимость, то есть:</span><br>
<span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span class="mjx-chtml MJXc-display" style="text-align: center;"><span id="MathJax-Element-67-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 118%; text-align: center; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><mo fence=&quot;false&quot; stretchy=&quot;false&quot;>&amp;#x2016;</mo><msup><mi>&amp;#x03C9;</mi><mi>t</mi></msup><mo>&amp;#x2212;</mo><msup><mi>&amp;#x03C9;</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>t</mi><mo>&amp;#x2212;</mo><mn>1</mn></mrow></msup><mo>&amp;lt;</mo><mi>&amp;#x03B5;</mi><mo fence=&quot;false&quot; stretchy=&quot;false&quot;>&amp;#x2016;</mo></math>" role="presentation"><span id="MJXc-Node-1190" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-1191" class="mjx-mrow"><span id="MJXc-Node-1192" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.479em; padding-bottom: 0.585em;">∥</span></span><span id="MJXc-Node-1193" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-1194" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.215em; padding-bottom: 0.267em;">ω</span></span></span><span class="mjx-sup" style="font-size: 70.7%; vertical-align: 0.584em; padding-left: 0px; padding-right: 0.071em;"><span id="MJXc-Node-1195" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.426em; padding-bottom: 0.267em;">t</span></span></span></span><span id="MJXc-Node-1196" class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.32em; padding-bottom: 0.426em;">−</span></span><span id="MJXc-Node-1197" class="mjx-msubsup MJXc-space2"><span class="mjx-base"><span id="MJXc-Node-1198" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.215em; padding-bottom: 0.267em;">ω</span></span></span><span class="mjx-sup" style="font-size: 70.7%; vertical-align: 0.584em; padding-left: 0px; padding-right: 0.071em;"><span id="MJXc-Node-1199" class="mjx-texatom" style=""><span id="MJXc-Node-1200" class="mjx-mrow"><span id="MJXc-Node-1201" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.426em; padding-bottom: 0.267em;">t</span></span><span id="MJXc-Node-1202" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.32em; padding-bottom: 0.426em;">−</span></span><span id="MJXc-Node-1203" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.373em; padding-bottom: 0.32em;">1</span></span></span></span></span></span><span id="MJXc-Node-1204" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.267em; padding-bottom: 0.373em;">&lt;</span></span><span id="MJXc-Node-1205" class="mjx-mi MJXc-space3"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.215em; padding-bottom: 0.32em;">ε</span></span><span id="MJXc-Node-1206" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.479em; padding-bottom: 0.585em;">∥</span></span></span></span><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mo fence="false" stretchy="false">‖</mo><msup><mi>ω</mi><mi>t</mi></msup><mo>−</mo><msup><mi>ω</mi><mrow class="MJX-TeXAtom-ORD"><mi>t</mi><mo>−</mo><mn>1</mn></mrow></msup><mo>&lt;</mo><mi>ε</mi><mo fence="false" stretchy="false">‖</mo></math></span></span></span><script type="math/tex; mode=display" id="MathJax-Element-67">
\| \omega^t - \omega^{t - 1} < \varepsilon\|
</script></span></li>
<li><em><span>Главный недостаток:</span></em><span> в случае большой выборки одна итерация будет работать очень медленно (асимптотика </span><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-68-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 118%; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>O</mi><mo stretchy=&quot;false&quot;>(</mo><msup><mi>n</mi><mn>2</mn></msup><mo stretchy=&quot;false&quot;>)</mo></math>" role="presentation"><span id="MJXc-Node-1207" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-1208" class="mjx-mrow"><span id="MJXc-Node-1209" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.32em;">O</span></span><span id="MJXc-Node-1210" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.479em; padding-bottom: 0.585em;">(</span></span><span id="MJXc-Node-1211" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-1212" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.215em; padding-bottom: 0.267em;">n</span></span></span><span class="mjx-sup" style="font-size: 70.7%; vertical-align: 0.513em; padding-left: 0px; padding-right: 0.071em;"><span id="MJXc-Node-1213" class="mjx-mn" style=""><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.373em; padding-bottom: 0.32em;">2</span></span></span></span><span id="MJXc-Node-1214" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.479em; padding-bottom: 0.585em;">)</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>O</mi><mo stretchy="false">(</mo><msup><mi>n</mi><mn>2</mn></msup><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-68">O(n^2)</script></span><span>).</span></li>
</ul>
</li>
</ul><h3 id="4-Логистическая-регрессия-Эквивалентность-решений-полученных-методом-максимального-правдоподобия-и-минимизации-логистической-функции-потерь" data-id="4-Логистическая-регрессия-Эквивалентность-решений-полученных-методом-максимального-правдоподобия-и-минимизации-логистической-функции-потерь"><a class="anchor hidden-xs" href="#4-Логистическая-регрессия-Эквивалентность-решений-полученных-методом-максимального-правдоподобия-и-минимизации-логистической-функции-потерь" title="4-Логистическая-регрессия-Эквивалентность-решений-полученных-методом-максимального-правдоподобия-и-минимизации-логистической-функции-потерь"><span class="octicon octicon-link"></span></a><span>4. Логистическая регрессия. Эквивалентность решений полученных методом максимального правдоподобия и минимизации логистической функции потерь.</span></h3><ul>
<li><strong><span>Логистическая регрессия</span></strong><span> — алгоритм бинарной классификации (с метками </span><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-69-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 118%; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo>&amp;#x2212;</mo><mn>1</mn><mo>,</mo><mo>+</mo><mn>1</mn></mrow></math>" role="presentation"><span id="MJXc-Node-1215" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-1216" class="mjx-mrow"><span id="MJXc-Node-1217" class="mjx-texatom"><span id="MJXc-Node-1218" class="mjx-mrow"><span id="MJXc-Node-1219" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.32em; padding-bottom: 0.426em;">−</span></span><span id="MJXc-Node-1220" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.373em; padding-bottom: 0.32em;">1</span></span><span id="MJXc-Node-1221" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="margin-top: -0.156em; padding-bottom: 0.532em;">,</span></span><span id="MJXc-Node-1222" class="mjx-mo MJXc-space1"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.32em; padding-bottom: 0.426em;">+</span></span><span id="MJXc-Node-1223" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.373em; padding-bottom: 0.32em;">1</span></span></span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow class="MJX-TeXAtom-ORD"><mo>−</mo><mn>1</mn><mo>,</mo><mo>+</mo><mn>1</mn></mrow></math></span></span><script type="math/tex" id="MathJax-Element-69">{-1, +1}</script></span><span>). Принцип заключается в том, что мы переводим предсказания обычной линейной модели из </span><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-70-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 118%; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi mathvariant=&quot;double-struck&quot;>R</mi></mrow></math>" role="presentation"><span id="MJXc-Node-1224" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-1225" class="mjx-mrow"><span id="MJXc-Node-1226" class="mjx-texatom"><span id="MJXc-Node-1227" class="mjx-mrow"><span id="MJXc-Node-1228" class="mjx-mi"><span class="mjx-char MJXc-TeX-ams-R" style="padding-top: 0.426em; padding-bottom: 0.32em;">R</span></span></span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="double-struck">R</mi></mrow></math></span></span><script type="math/tex" id="MathJax-Element-70">\mathbb{R}</script></span><span> в </span><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-71-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 118%; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mo stretchy=&quot;false&quot;>[</mo><mn>0</mn><mo>,</mo><mn>1</mn><mo stretchy=&quot;false&quot;>]</mo></math>" role="presentation"><span id="MJXc-Node-1229" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-1230" class="mjx-mrow"><span id="MJXc-Node-1231" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.479em; padding-bottom: 0.585em;">[</span></span><span id="MJXc-Node-1232" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.373em; padding-bottom: 0.373em;">0</span></span><span id="MJXc-Node-1233" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="margin-top: -0.156em; padding-bottom: 0.532em;">,</span></span><span id="MJXc-Node-1234" class="mjx-mn MJXc-space1"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.373em; padding-bottom: 0.32em;">1</span></span><span id="MJXc-Node-1235" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.479em; padding-bottom: 0.585em;">]</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo stretchy="false">[</mo><mn>0</mn><mo>,</mo><mn>1</mn><mo stretchy="false">]</mo></math></span></span><script type="math/tex" id="MathJax-Element-71">[0, 1]</script></span><span> с помощью сигмоидной функции и интерпретируем их как вероятность того, что объект принадлежит положительному </span><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-72-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 118%; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mo stretchy=&quot;false&quot;>(</mo><mo>+</mo><mn>1</mn><mo stretchy=&quot;false&quot;>)</mo></math>" role="presentation"><span id="MJXc-Node-1236" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-1237" class="mjx-mrow"><span id="MJXc-Node-1238" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.479em; padding-bottom: 0.585em;">(</span></span><span id="MJXc-Node-1239" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.32em; padding-bottom: 0.426em;">+</span></span><span id="MJXc-Node-1240" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.373em; padding-bottom: 0.32em;">1</span></span><span id="MJXc-Node-1241" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.479em; padding-bottom: 0.585em;">)</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo stretchy="false">(</mo><mo>+</mo><mn>1</mn><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-72">(+1)</script></span><span> классу.</span><br>
<span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span class="mjx-chtml MJXc-display" style="text-align: center;"><span id="MathJax-Element-73-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 118%; text-align: center; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><mi>f</mi><mo stretchy=&quot;false&quot;>(</mo><mi>x</mi><mo stretchy=&quot;false&quot;>)</mo><mo>=</mo><mi>&amp;#x03C3;</mi><mo stretchy=&quot;false&quot;>(</mo><msup><mi>w</mi><mi>T</mi></msup><mi>x</mi><mo stretchy=&quot;false&quot;>)</mo><mo>=</mo><mfrac><mn>1</mn><mrow><mn>1</mn><mo>+</mo><mi>exp</mi><mo>&amp;#x2061;</mo><mo stretchy=&quot;false&quot;>(</mo><mo>&amp;#x2212;</mo><msup><mi>w</mi><mi>T</mi></msup><mi>x</mi><mo stretchy=&quot;false&quot;>)</mo></mrow></mfrac></math>" role="presentation"><span id="MJXc-Node-1242" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-1243" class="mjx-mrow"><span id="MJXc-Node-1244" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.479em; padding-right: 0.06em;">f</span></span><span id="MJXc-Node-1245" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.479em; padding-bottom: 0.585em;">(</span></span><span id="MJXc-Node-1246" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.215em; padding-bottom: 0.267em;">x</span></span><span id="MJXc-Node-1247" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.479em; padding-bottom: 0.585em;">)</span></span><span id="MJXc-Node-1248" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.056em; padding-bottom: 0.32em;">=</span></span><span id="MJXc-Node-1249" class="mjx-mi MJXc-space3"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.215em; padding-bottom: 0.267em; padding-right: 0.001em;">σ</span></span><span id="MJXc-Node-1250" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.479em; padding-bottom: 0.585em;">(</span></span><span id="MJXc-Node-1251" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-1252" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.215em; padding-bottom: 0.267em;">w</span></span></span><span class="mjx-sup" style="font-size: 70.7%; vertical-align: 0.584em; padding-left: 0px; padding-right: 0.071em;"><span id="MJXc-Node-1253" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.267em; padding-right: 0.12em;">T</span></span></span></span><span id="MJXc-Node-1254" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.215em; padding-bottom: 0.267em;">x</span></span><span id="MJXc-Node-1255" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.479em; padding-bottom: 0.585em;">)</span></span><span id="MJXc-Node-1256" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.056em; padding-bottom: 0.32em;">=</span></span><span id="MJXc-Node-1257" class="mjx-mfrac MJXc-space3"><span class="mjx-box MJXc-stacked" style="width: 6.828em; padding: 0px 0.12em;"><span class="mjx-numerator" style="width: 6.828em; top: -1.368em;"><span id="MJXc-Node-1258" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.373em; padding-bottom: 0.32em;">1</span></span></span><span class="mjx-denominator" style="width: 6.828em; bottom: -1.036em;"><span id="MJXc-Node-1259" class="mjx-mrow"><span id="MJXc-Node-1260" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.373em; padding-bottom: 0.32em;">1</span></span><span id="MJXc-Node-1261" class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.32em; padding-bottom: 0.426em;">+</span></span><span id="MJXc-Node-1262" class="mjx-mi MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.162em; padding-bottom: 0.532em;">exp</span></span><span id="MJXc-Node-1263" class="mjx-mo"><span class="mjx-char"></span></span><span id="MJXc-Node-1264" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.479em; padding-bottom: 0.585em;">(</span></span><span id="MJXc-Node-1265" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.32em; padding-bottom: 0.426em;">−</span></span><span id="MJXc-Node-1266" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-1267" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.215em; padding-bottom: 0.267em;">w</span></span></span><span class="mjx-sup" style="font-size: 70.7%; vertical-align: 0.409em; padding-left: 0px; padding-right: 0.071em;"><span id="MJXc-Node-1268" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.267em; padding-right: 0.12em;">T</span></span></span></span><span id="MJXc-Node-1269" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.215em; padding-bottom: 0.267em;">x</span></span><span id="MJXc-Node-1270" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.479em; padding-bottom: 0.585em;">)</span></span></span></span><span style="border-bottom-width: 1.3px; border-bottom-style: solid; top: -0.283em; width: 6.828em;" class="mjx-line"></span></span><span style="height: 2.403em; vertical-align: -1.036em;" class="mjx-vsize"></span></span></span></span><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mi>f</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mo>=</mo><mi>σ</mi><mo stretchy="false">(</mo><msup><mi>w</mi><mi>T</mi></msup><mi>x</mi><mo stretchy="false">)</mo><mo>=</mo><mfrac><mn>1</mn><mrow><mn>1</mn><mo>+</mo><mi>exp</mi><mo>⁡</mo><mo stretchy="false">(</mo><mo>−</mo><msup><mi>w</mi><mi>T</mi></msup><mi>x</mi><mo stretchy="false">)</mo></mrow></mfrac></math></span></span></span><script type="math/tex; mode=display" id="MathJax-Element-73">
 f(x) = \sigma(w^Tx) = \frac{1}{1 + \exp(-w^Tx)}
</script></span></li>
<li><span>При обучении логистической регрессии используется конкретная функция потерь: </span><strong><span>LogLoss</span></strong><span> (логистическая функция потерь), она же кросс-энтропия:</span><br>
<span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span class="mjx-chtml MJXc-display" style="text-align: center;"><span id="MathJax-Element-74-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 118%; text-align: center; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><mi>L</mi><mo>=</mo><munderover><mo movablelimits=&quot;false&quot;>&amp;#x2211;</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>n</mi></munderover><mi>log</mi><mo>&amp;#x2061;</mo><mo stretchy=&quot;false&quot;>(</mo><mn>1</mn><mo>+</mo><mi>exp</mi><mo>&amp;#x2061;</mo><mo stretchy=&quot;false&quot;>(</mo><mo>&amp;#x2212;</mo><msub><mi>y</mi><mi>i</mi></msub><mo>&amp;#x22C5;</mo><msup><mi>w</mi><mi>T</mi></msup><msub><mi>x</mi><mi>i</mi></msub><mo stretchy=&quot;false&quot;>)</mo><mo stretchy=&quot;false&quot;>)</mo></math>" role="presentation"><span id="MJXc-Node-1271" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-1272" class="mjx-mrow"><span id="MJXc-Node-1273" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.267em;">L</span></span><span id="MJXc-Node-1274" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.056em; padding-bottom: 0.32em;">=</span></span><span id="MJXc-Node-1275" class="mjx-munderover MJXc-space3"><span class="mjx-itable"><span class="mjx-row"><span class="mjx-cell"><span class="mjx-stack"><span class="mjx-over" style="font-size: 70.7%; padding-bottom: 0.247em; padding-top: 0.141em; padding-left: 0.721em;"><span id="MJXc-Node-1282" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.215em; padding-bottom: 0.267em;">n</span></span></span><span class="mjx-op"><span id="MJXc-Node-1276" class="mjx-mo"><span class="mjx-char MJXc-TeX-size2-R" style="padding-top: 0.744em; padding-bottom: 0.744em;">∑</span></span></span></span></span></span><span class="mjx-row"><span class="mjx-under" style="font-size: 70.7%; padding-top: 0.236em; padding-bottom: 0.141em; padding-left: 0.21em;"><span id="MJXc-Node-1277" class="mjx-texatom" style=""><span id="MJXc-Node-1278" class="mjx-mrow"><span id="MJXc-Node-1279" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.426em; padding-bottom: 0.267em;">i</span></span><span id="MJXc-Node-1280" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.056em; padding-bottom: 0.32em;">=</span></span><span id="MJXc-Node-1281" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.373em; padding-bottom: 0.32em;">1</span></span></span></span></span></span></span></span><span id="MJXc-Node-1283" class="mjx-mi MJXc-space1"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.426em; padding-bottom: 0.532em;">log</span></span><span id="MJXc-Node-1284" class="mjx-mo"><span class="mjx-char"></span></span><span id="MJXc-Node-1285" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.479em; padding-bottom: 0.585em;">(</span></span><span id="MJXc-Node-1286" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.373em; padding-bottom: 0.32em;">1</span></span><span id="MJXc-Node-1287" class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.32em; padding-bottom: 0.426em;">+</span></span><span id="MJXc-Node-1288" class="mjx-mi MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.162em; padding-bottom: 0.532em;">exp</span></span><span id="MJXc-Node-1289" class="mjx-mo"><span class="mjx-char"></span></span><span id="MJXc-Node-1290" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.479em; padding-bottom: 0.585em;">(</span></span><span id="MJXc-Node-1291" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.32em; padding-bottom: 0.426em;">−</span></span><span id="MJXc-Node-1292" class="mjx-msubsup"><span class="mjx-base" style="margin-right: -0.006em;"><span id="MJXc-Node-1293" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.215em; padding-bottom: 0.479em; padding-right: 0.006em;">y</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-1294" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.426em; padding-bottom: 0.267em;">i</span></span></span></span><span id="MJXc-Node-1295" class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.003em; padding-bottom: 0.32em;">⋅</span></span><span id="MJXc-Node-1296" class="mjx-msubsup MJXc-space2"><span class="mjx-base"><span id="MJXc-Node-1297" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.215em; padding-bottom: 0.267em;">w</span></span></span><span class="mjx-sup" style="font-size: 70.7%; vertical-align: 0.584em; padding-left: 0px; padding-right: 0.071em;"><span id="MJXc-Node-1298" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.267em; padding-right: 0.12em;">T</span></span></span></span><span id="MJXc-Node-1299" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-1300" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.215em; padding-bottom: 0.267em;">x</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-1301" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.426em; padding-bottom: 0.267em;">i</span></span></span></span><span id="MJXc-Node-1302" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.479em; padding-bottom: 0.585em;">)</span></span><span id="MJXc-Node-1303" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.479em; padding-bottom: 0.585em;">)</span></span></span></span><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mi>L</mi><mo>=</mo><munderover><mo movablelimits="false">∑</mo><mrow class="MJX-TeXAtom-ORD"><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>n</mi></munderover><mi>log</mi><mo>⁡</mo><mo stretchy="false">(</mo><mn>1</mn><mo>+</mo><mi>exp</mi><mo>⁡</mo><mo stretchy="false">(</mo><mo>−</mo><msub><mi>y</mi><mi>i</mi></msub><mo>⋅</mo><msup><mi>w</mi><mi>T</mi></msup><msub><mi>x</mi><mi>i</mi></msub><mo stretchy="false">)</mo><mo stretchy="false">)</mo></math></span></span></span><script type="math/tex; mode=display" id="MathJax-Element-74">
 L = \sum\limits_{i = 1}^n\log(1 + \exp(-y_i\cdot w^Tx_i))
</script></span></li>
<li><span>Эта функция потерь появляется из задачи </span><strong><span>максимизации правдоподобия</span></strong><span>:</span><br>
<span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span class="mjx-chtml MJXc-display" style="text-align: center;"><span id="MathJax-Element-75-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 118%; text-align: center; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><mtable rowspacing=&quot;3pt&quot; columnspacing=&quot;1em&quot; displaystyle=&quot;true&quot;><mtr><mtd><mtext>Likelihood</mtext><mo>=</mo><munderover><mo movablelimits=&quot;false&quot;>&amp;#x220F;</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>n</mi></munderover><mi>P</mi><mo stretchy=&quot;false&quot;>(</mo><msub><mi>x</mi><mi>i</mi></msub><mspace width=&quot;thickmathspace&quot; /><mtext>&amp;#x43F;&amp;#x440;&amp;#x438;&amp;#x43D;&amp;#x430;&amp;#x434;&amp;#x43B;&amp;#x435;&amp;#x436;&amp;#x438;&amp;#x442; &amp;#x43A;&amp;#x43B;&amp;#x430;&amp;#x441;&amp;#x441;&amp;#x443;</mtext><mspace width=&quot;thickmathspace&quot; /><msub><mi>y</mi><mi>i</mi></msub><mo stretchy=&quot;false&quot;>)</mo></mtd></mtr><mtr><mtd><mtext>&amp;#x415;&amp;#x441;&amp;#x43B;&amp;#x438;&amp;#xA0;</mtext><msub><mi>y</mi><mi>i</mi></msub><mo>=</mo><mn>1</mn><mtext>, &amp;#x442;&amp;#x43E;&amp;#xA0;</mtext><mi>P</mi><mo stretchy=&quot;false&quot;>(</mo><msub><mi>x</mi><mi>i</mi></msub><mspace width=&quot;thickmathspace&quot; /><mtext>&amp;#x43F;&amp;#x440;&amp;#x438;&amp;#x43D;&amp;#x430;&amp;#x434;&amp;#x43B;&amp;#x435;&amp;#x436;&amp;#x438;&amp;#x442; &amp;#x43A;&amp;#x43B;&amp;#x430;&amp;#x441;&amp;#x441;&amp;#x443;</mtext><mspace width=&quot;thickmathspace&quot; /><msub><mi>y</mi><mi>i</mi></msub><mo stretchy=&quot;false&quot;>)</mo><mo>=</mo><mi>&amp;#x03C3;</mi><mo stretchy=&quot;false&quot;>(</mo><msup><mi>w</mi><mi>T</mi></msup><mi>x</mi><mo stretchy=&quot;false&quot;>)</mo><mo>=</mo><mfrac><mn>1</mn><mrow><mn>1</mn><mo>+</mo><mi>exp</mi><mo>&amp;#x2061;</mo><mo stretchy=&quot;false&quot;>(</mo><mo>&amp;#x2212;</mo><msup><mi>w</mi><mi>T</mi></msup><mi>x</mi><mo stretchy=&quot;false&quot;>)</mo></mrow></mfrac></mtd></mtr><mtr><mtd><mtext>&amp;#x415;&amp;#x441;&amp;#x43B;&amp;#x438;&amp;#xA0;</mtext><msub><mi>y</mi><mi>i</mi></msub><mo>=</mo><mo>&amp;#x2212;</mo><mn>1</mn><mtext>, &amp;#x442;&amp;#x43E;&amp;#xA0;</mtext><mi>P</mi><mo stretchy=&quot;false&quot;>(</mo><msub><mi>x</mi><mi>i</mi></msub><mspace width=&quot;thickmathspace&quot; /><mtext>&amp;#x43F;&amp;#x440;&amp;#x438;&amp;#x43D;&amp;#x430;&amp;#x434;&amp;#x43B;&amp;#x435;&amp;#x436;&amp;#x438;&amp;#x442; &amp;#x43A;&amp;#x43B;&amp;#x430;&amp;#x441;&amp;#x441;&amp;#x443;</mtext><mspace width=&quot;thickmathspace&quot; /><msub><mi>y</mi><mi>i</mi></msub><mo stretchy=&quot;false&quot;>)</mo><mo>=</mo><mn>1</mn><mo>&amp;#x2212;</mo><mi>&amp;#x03C3;</mi><mo stretchy=&quot;false&quot;>(</mo><msup><mi>w</mi><mi>T</mi></msup><mi>x</mi><mo stretchy=&quot;false&quot;>)</mo><mo>=</mo><mi>&amp;#x03C3;</mi><mo stretchy=&quot;false&quot;>(</mo><mo>&amp;#x2212;</mo><msup><mi>w</mi><mi>T</mi></msup><mi>x</mi><mo stretchy=&quot;false&quot;>)</mo><mo>=</mo><mfrac><mn>1</mn><mrow><mn>1</mn><mo>+</mo><mi>exp</mi><mo>&amp;#x2061;</mo><mo stretchy=&quot;false&quot;>(</mo><msup><mi>w</mi><mi>T</mi></msup><mi>x</mi><mo stretchy=&quot;false&quot;>)</mo></mrow></mfrac></mtd></mtr></mtable></math>" role="presentation"><span id="MJXc-Node-1304" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-1305" class="mjx-mrow"><span id="MJXc-Node-1306" class="mjx-mtable" style="vertical-align: -3.884em; padding: 0px 0.167em;"><span class="mjx-table"><span id="MJXc-Node-1307" class="mjx-mtr" style="height: 3.011em;"><span id="MJXc-Node-1308" class="mjx-mtd" style="padding: 0px; width: 38.97em;"><span id="MJXc-Node-1309" class="mjx-mrow"><span id="MJXc-Node-1310" class="mjx-mtext"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.426em; padding-bottom: 0.373em;">Likelihood</span></span><span id="MJXc-Node-1311" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.056em; padding-bottom: 0.32em;">=</span></span><span id="MJXc-Node-1312" class="mjx-munderover MJXc-space3"><span class="mjx-itable"><span class="mjx-row"><span class="mjx-cell"><span class="mjx-stack"><span class="mjx-over" style="font-size: 70.7%; padding-bottom: 0.247em; padding-top: 0.141em; padding-left: 0.604em;"><span id="MJXc-Node-1319" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.215em; padding-bottom: 0.267em;">n</span></span></span><span class="mjx-op"><span id="MJXc-Node-1313" class="mjx-mo"><span class="mjx-char MJXc-TeX-size2-R" style="padding-top: 0.744em; padding-bottom: 0.744em;">∏</span></span></span></span></span></span><span class="mjx-row"><span class="mjx-under" style="font-size: 70.7%; padding-top: 0.236em; padding-bottom: 0.141em; padding-left: 0.092em;"><span id="MJXc-Node-1314" class="mjx-texatom" style=""><span id="MJXc-Node-1315" class="mjx-mrow"><span id="MJXc-Node-1316" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.426em; padding-bottom: 0.267em;">i</span></span><span id="MJXc-Node-1317" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.056em; padding-bottom: 0.32em;">=</span></span><span id="MJXc-Node-1318" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.373em; padding-bottom: 0.32em;">1</span></span></span></span></span></span></span></span><span id="MJXc-Node-1320" class="mjx-mi MJXc-space1"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.267em; padding-right: 0.109em;">P</span></span><span id="MJXc-Node-1321" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.479em; padding-bottom: 0.585em;">(</span></span><span id="MJXc-Node-1322" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-1323" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.215em; padding-bottom: 0.267em;">x</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-1324" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.426em; padding-bottom: 0.267em;">i</span></span></span></span><span id="MJXc-Node-1325" class="mjx-mspace" style="width: 0.278em; height: 0px;"></span><span id="MJXc-Node-1326" class="mjx-mtext"><span class="mjx-char" style="padding-top: 0.532em; padding-bottom: 0.215em;"><span class="mjx-charbox MJXc-TeX-unknown-R" style="padding-bottom: 0.297em; width: 0.519em;">п</span><span class="mjx-charbox MJXc-TeX-unknown-R" style="padding-bottom: 0.297em; width: 0.498em;">р</span><span class="mjx-charbox MJXc-TeX-unknown-R" style="padding-bottom: 0.297em; width: 0.519em;">и</span><span class="mjx-charbox MJXc-TeX-unknown-R" style="padding-bottom: 0.297em; width: 0.519em;">н</span><span class="mjx-charbox MJXc-TeX-unknown-R" style="padding-bottom: 0.297em; width: 0.445em;">а</span><span class="mjx-charbox MJXc-TeX-unknown-R" style="padding-bottom: 0.297em; width: 0.456em;">д</span><span class="mjx-charbox MJXc-TeX-unknown-R" style="padding-bottom: 0.297em; width: 0.498em;">л</span><span class="mjx-charbox MJXc-TeX-unknown-R" style="padding-bottom: 0.297em; width: 0.466em;">е</span><span class="mjx-charbox MJXc-TeX-unknown-R" style="padding-bottom: 0.297em; width: 0.72em;">ж</span><span class="mjx-charbox MJXc-TeX-unknown-R" style="padding-bottom: 0.297em; width: 0.519em;">и</span><span class="mjx-charbox MJXc-TeX-unknown-R" style="padding-bottom: 0.297em; width: 0.434em;">т</span><span class="mjx-charbox MJXc-TeX-main-R" style="padding-bottom: 0.314em;"> </span><span class="mjx-charbox MJXc-TeX-unknown-R" style="padding-bottom: 0.297em; width: 0.498em;">к</span><span class="mjx-charbox MJXc-TeX-unknown-R" style="padding-bottom: 0.297em; width: 0.498em;">л</span><span class="mjx-charbox MJXc-TeX-unknown-R" style="padding-bottom: 0.297em; width: 0.445em;">а</span><span class="mjx-charbox MJXc-TeX-unknown-R" style="padding-bottom: 0.297em; width: 0.456em;">с</span><span class="mjx-charbox MJXc-TeX-unknown-R" style="padding-bottom: 0.297em; width: 0.456em;">с</span><span class="mjx-charbox MJXc-TeX-unknown-R" style="padding-bottom: 0.297em; width: 0.487em;">у</span></span></span><span id="MJXc-Node-1327" class="mjx-mspace" style="width: 0.278em; height: 0px;"></span><span id="MJXc-Node-1328" class="mjx-msubsup"><span class="mjx-base" style="margin-right: -0.006em;"><span id="MJXc-Node-1329" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.215em; padding-bottom: 0.479em; padding-right: 0.006em;">y</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-1330" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.426em; padding-bottom: 0.267em;">i</span></span></span></span><span id="MJXc-Node-1331" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.479em; padding-bottom: 0.585em;">)</span></span><span class="mjx-strut"></span></span></span></span><span id="MJXc-Node-1332" class="mjx-mtr" style="height: 2.703em;"><span id="MJXc-Node-1333" class="mjx-mtd" style="padding: 0.15em 0px 0px;"><span id="MJXc-Node-1334" class="mjx-mrow"><span id="MJXc-Node-1335" class="mjx-mtext"><span class="mjx-char" style="padding-top: 0.532em; padding-bottom: 0.215em;"><span class="mjx-charbox MJXc-TeX-unknown-R" style="padding-bottom: 0.297em; width: 0.625em;">Е</span><span class="mjx-charbox MJXc-TeX-unknown-R" style="padding-bottom: 0.297em; width: 0.456em;">с</span><span class="mjx-charbox MJXc-TeX-unknown-R" style="padding-bottom: 0.297em; width: 0.498em;">л</span><span class="mjx-charbox MJXc-TeX-unknown-R" style="padding-bottom: 0.297em; width: 0.519em;">и</span><span class="mjx-charbox MJXc-TeX-main-R" style="padding-bottom: 0.314em;">&nbsp;</span></span></span><span id="MJXc-Node-1336" class="mjx-msubsup"><span class="mjx-base" style="margin-right: -0.006em;"><span id="MJXc-Node-1337" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.215em; padding-bottom: 0.479em; padding-right: 0.006em;">y</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-1338" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.426em; padding-bottom: 0.267em;">i</span></span></span></span><span id="MJXc-Node-1339" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.056em; padding-bottom: 0.32em;">=</span></span><span id="MJXc-Node-1340" class="mjx-mn MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.373em; padding-bottom: 0.32em;">1</span></span><span id="MJXc-Node-1341" class="mjx-mtext"><span class="mjx-char" style="padding-top: 0.532em; padding-bottom: 0.215em;"><span class="mjx-charbox MJXc-TeX-main-R" style="padding-bottom: 0.314em;">, </span><span class="mjx-charbox MJXc-TeX-unknown-R" style="padding-bottom: 0.297em; width: 0.434em;">т</span><span class="mjx-charbox MJXc-TeX-unknown-R" style="padding-bottom: 0.297em; width: 0.508em;">о</span><span class="mjx-charbox MJXc-TeX-main-R" style="padding-bottom: 0.314em;">&nbsp;</span></span></span><span id="MJXc-Node-1342" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.267em; padding-right: 0.109em;">P</span></span><span id="MJXc-Node-1343" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.479em; padding-bottom: 0.585em;">(</span></span><span id="MJXc-Node-1344" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-1345" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.215em; padding-bottom: 0.267em;">x</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-1346" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.426em; padding-bottom: 0.267em;">i</span></span></span></span><span id="MJXc-Node-1347" class="mjx-mspace" style="width: 0.278em; height: 0px;"></span><span id="MJXc-Node-1348" class="mjx-mtext"><span class="mjx-char" style="padding-top: 0.532em; padding-bottom: 0.215em;"><span class="mjx-charbox MJXc-TeX-unknown-R" style="padding-bottom: 0.297em; width: 0.519em;">п</span><span class="mjx-charbox MJXc-TeX-unknown-R" style="padding-bottom: 0.297em; width: 0.498em;">р</span><span class="mjx-charbox MJXc-TeX-unknown-R" style="padding-bottom: 0.297em; width: 0.519em;">и</span><span class="mjx-charbox MJXc-TeX-unknown-R" style="padding-bottom: 0.297em; width: 0.519em;">н</span><span class="mjx-charbox MJXc-TeX-unknown-R" style="padding-bottom: 0.297em; width: 0.445em;">а</span><span class="mjx-charbox MJXc-TeX-unknown-R" style="padding-bottom: 0.297em; width: 0.456em;">д</span><span class="mjx-charbox MJXc-TeX-unknown-R" style="padding-bottom: 0.297em; width: 0.498em;">л</span><span class="mjx-charbox MJXc-TeX-unknown-R" style="padding-bottom: 0.297em; width: 0.466em;">е</span><span class="mjx-charbox MJXc-TeX-unknown-R" style="padding-bottom: 0.297em; width: 0.72em;">ж</span><span class="mjx-charbox MJXc-TeX-unknown-R" style="padding-bottom: 0.297em; width: 0.519em;">и</span><span class="mjx-charbox MJXc-TeX-unknown-R" style="padding-bottom: 0.297em; width: 0.434em;">т</span><span class="mjx-charbox MJXc-TeX-main-R" style="padding-bottom: 0.314em;"> </span><span class="mjx-charbox MJXc-TeX-unknown-R" style="padding-bottom: 0.297em; width: 0.498em;">к</span><span class="mjx-charbox MJXc-TeX-unknown-R" style="padding-bottom: 0.297em; width: 0.498em;">л</span><span class="mjx-charbox MJXc-TeX-unknown-R" style="padding-bottom: 0.297em; width: 0.445em;">а</span><span class="mjx-charbox MJXc-TeX-unknown-R" style="padding-bottom: 0.297em; width: 0.456em;">с</span><span class="mjx-charbox MJXc-TeX-unknown-R" style="padding-bottom: 0.297em; width: 0.456em;">с</span><span class="mjx-charbox MJXc-TeX-unknown-R" style="padding-bottom: 0.297em; width: 0.487em;">у</span></span></span><span id="MJXc-Node-1349" class="mjx-mspace" style="width: 0.278em; height: 0px;"></span><span id="MJXc-Node-1350" class="mjx-msubsup"><span class="mjx-base" style="margin-right: -0.006em;"><span id="MJXc-Node-1351" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.215em; padding-bottom: 0.479em; padding-right: 0.006em;">y</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-1352" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.426em; padding-bottom: 0.267em;">i</span></span></span></span><span id="MJXc-Node-1353" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.479em; padding-bottom: 0.585em;">)</span></span><span id="MJXc-Node-1354" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.056em; padding-bottom: 0.32em;">=</span></span><span id="MJXc-Node-1355" class="mjx-mi MJXc-space3"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.215em; padding-bottom: 0.267em; padding-right: 0.001em;">σ</span></span><span id="MJXc-Node-1356" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.479em; padding-bottom: 0.585em;">(</span></span><span id="MJXc-Node-1357" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-1358" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.215em; padding-bottom: 0.267em;">w</span></span></span><span class="mjx-sup" style="font-size: 70.7%; vertical-align: 0.584em; padding-left: 0px; padding-right: 0.071em;"><span id="MJXc-Node-1359" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.267em; padding-right: 0.12em;">T</span></span></span></span><span id="MJXc-Node-1360" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.215em; padding-bottom: 0.267em;">x</span></span><span id="MJXc-Node-1361" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.479em; padding-bottom: 0.585em;">)</span></span><span id="MJXc-Node-1362" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.056em; padding-bottom: 0.32em;">=</span></span><span id="MJXc-Node-1363" class="mjx-mfrac MJXc-space3"><span class="mjx-box MJXc-stacked" style="width: 6.828em; padding: 0px 0.12em;"><span class="mjx-numerator" style="width: 6.828em; top: -1.368em;"><span id="MJXc-Node-1364" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.373em; padding-bottom: 0.32em;">1</span></span></span><span class="mjx-denominator" style="width: 6.828em; bottom: -1.036em;"><span id="MJXc-Node-1365" class="mjx-mrow"><span id="MJXc-Node-1366" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.373em; padding-bottom: 0.32em;">1</span></span><span id="MJXc-Node-1367" class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.32em; padding-bottom: 0.426em;">+</span></span><span id="MJXc-Node-1368" class="mjx-mi MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.162em; padding-bottom: 0.532em;">exp</span></span><span id="MJXc-Node-1369" class="mjx-mo"><span class="mjx-char"></span></span><span id="MJXc-Node-1370" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.479em; padding-bottom: 0.585em;">(</span></span><span id="MJXc-Node-1371" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.32em; padding-bottom: 0.426em;">−</span></span><span id="MJXc-Node-1372" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-1373" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.215em; padding-bottom: 0.267em;">w</span></span></span><span class="mjx-sup" style="font-size: 70.7%; vertical-align: 0.409em; padding-left: 0px; padding-right: 0.071em;"><span id="MJXc-Node-1374" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.267em; padding-right: 0.12em;">T</span></span></span></span><span id="MJXc-Node-1375" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.215em; padding-bottom: 0.267em;">x</span></span><span id="MJXc-Node-1376" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.479em; padding-bottom: 0.585em;">)</span></span></span></span><span style="border-bottom-width: 1.3px; border-bottom-style: solid; top: -0.283em; width: 6.828em;" class="mjx-line"></span></span><span style="height: 2.403em; vertical-align: -1.036em;" class="mjx-vsize"></span></span><span class="mjx-strut"></span></span></span></span><span id="MJXc-Node-1377" class="mjx-mtr" style="height: 2.553em;"><span id="MJXc-Node-1378" class="mjx-mtd" style="padding: 0.15em 0px 0px;"><span id="MJXc-Node-1379" class="mjx-mrow"><span id="MJXc-Node-1380" class="mjx-mtext"><span class="mjx-char" style="padding-top: 0.532em; padding-bottom: 0.215em;"><span class="mjx-charbox MJXc-TeX-unknown-R" style="padding-bottom: 0.297em; width: 0.625em;">Е</span><span class="mjx-charbox MJXc-TeX-unknown-R" style="padding-bottom: 0.297em; width: 0.456em;">с</span><span class="mjx-charbox MJXc-TeX-unknown-R" style="padding-bottom: 0.297em; width: 0.498em;">л</span><span class="mjx-charbox MJXc-TeX-unknown-R" style="padding-bottom: 0.297em; width: 0.519em;">и</span><span class="mjx-charbox MJXc-TeX-main-R" style="padding-bottom: 0.314em;">&nbsp;</span></span></span><span id="MJXc-Node-1381" class="mjx-msubsup"><span class="mjx-base" style="margin-right: -0.006em;"><span id="MJXc-Node-1382" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.215em; padding-bottom: 0.479em; padding-right: 0.006em;">y</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-1383" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.426em; padding-bottom: 0.267em;">i</span></span></span></span><span id="MJXc-Node-1384" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.056em; padding-bottom: 0.32em;">=</span></span><span id="MJXc-Node-1385" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.32em; padding-bottom: 0.426em;">−</span></span><span id="MJXc-Node-1386" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.373em; padding-bottom: 0.32em;">1</span></span><span id="MJXc-Node-1387" class="mjx-mtext"><span class="mjx-char" style="padding-top: 0.532em; padding-bottom: 0.215em;"><span class="mjx-charbox MJXc-TeX-main-R" style="padding-bottom: 0.314em;">, </span><span class="mjx-charbox MJXc-TeX-unknown-R" style="padding-bottom: 0.297em; width: 0.434em;">т</span><span class="mjx-charbox MJXc-TeX-unknown-R" style="padding-bottom: 0.297em; width: 0.508em;">о</span><span class="mjx-charbox MJXc-TeX-main-R" style="padding-bottom: 0.314em;">&nbsp;</span></span></span><span id="MJXc-Node-1388" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.267em; padding-right: 0.109em;">P</span></span><span id="MJXc-Node-1389" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.479em; padding-bottom: 0.585em;">(</span></span><span id="MJXc-Node-1390" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-1391" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.215em; padding-bottom: 0.267em;">x</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-1392" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.426em; padding-bottom: 0.267em;">i</span></span></span></span><span id="MJXc-Node-1393" class="mjx-mspace" style="width: 0.278em; height: 0px;"></span><span id="MJXc-Node-1394" class="mjx-mtext"><span class="mjx-char" style="padding-top: 0.532em; padding-bottom: 0.215em;"><span class="mjx-charbox MJXc-TeX-unknown-R" style="padding-bottom: 0.297em; width: 0.519em;">п</span><span class="mjx-charbox MJXc-TeX-unknown-R" style="padding-bottom: 0.297em; width: 0.498em;">р</span><span class="mjx-charbox MJXc-TeX-unknown-R" style="padding-bottom: 0.297em; width: 0.519em;">и</span><span class="mjx-charbox MJXc-TeX-unknown-R" style="padding-bottom: 0.297em; width: 0.519em;">н</span><span class="mjx-charbox MJXc-TeX-unknown-R" style="padding-bottom: 0.297em; width: 0.445em;">а</span><span class="mjx-charbox MJXc-TeX-unknown-R" style="padding-bottom: 0.297em; width: 0.456em;">д</span><span class="mjx-charbox MJXc-TeX-unknown-R" style="padding-bottom: 0.297em; width: 0.498em;">л</span><span class="mjx-charbox MJXc-TeX-unknown-R" style="padding-bottom: 0.297em; width: 0.466em;">е</span><span class="mjx-charbox MJXc-TeX-unknown-R" style="padding-bottom: 0.297em; width: 0.72em;">ж</span><span class="mjx-charbox MJXc-TeX-unknown-R" style="padding-bottom: 0.297em; width: 0.519em;">и</span><span class="mjx-charbox MJXc-TeX-unknown-R" style="padding-bottom: 0.297em; width: 0.434em;">т</span><span class="mjx-charbox MJXc-TeX-main-R" style="padding-bottom: 0.314em;"> </span><span class="mjx-charbox MJXc-TeX-unknown-R" style="padding-bottom: 0.297em; width: 0.498em;">к</span><span class="mjx-charbox MJXc-TeX-unknown-R" style="padding-bottom: 0.297em; width: 0.498em;">л</span><span class="mjx-charbox MJXc-TeX-unknown-R" style="padding-bottom: 0.297em; width: 0.445em;">а</span><span class="mjx-charbox MJXc-TeX-unknown-R" style="padding-bottom: 0.297em; width: 0.456em;">с</span><span class="mjx-charbox MJXc-TeX-unknown-R" style="padding-bottom: 0.297em; width: 0.456em;">с</span><span class="mjx-charbox MJXc-TeX-unknown-R" style="padding-bottom: 0.297em; width: 0.487em;">у</span></span></span><span id="MJXc-Node-1395" class="mjx-mspace" style="width: 0.278em; height: 0px;"></span><span id="MJXc-Node-1396" class="mjx-msubsup"><span class="mjx-base" style="margin-right: -0.006em;"><span id="MJXc-Node-1397" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.215em; padding-bottom: 0.479em; padding-right: 0.006em;">y</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-1398" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.426em; padding-bottom: 0.267em;">i</span></span></span></span><span id="MJXc-Node-1399" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.479em; padding-bottom: 0.585em;">)</span></span><span id="MJXc-Node-1400" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.056em; padding-bottom: 0.32em;">=</span></span><span id="MJXc-Node-1401" class="mjx-mn MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.373em; padding-bottom: 0.32em;">1</span></span><span id="MJXc-Node-1402" class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.32em; padding-bottom: 0.426em;">−</span></span><span id="MJXc-Node-1403" class="mjx-mi MJXc-space2"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.215em; padding-bottom: 0.267em; padding-right: 0.001em;">σ</span></span><span id="MJXc-Node-1404" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.479em; padding-bottom: 0.585em;">(</span></span><span id="MJXc-Node-1405" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-1406" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.215em; padding-bottom: 0.267em;">w</span></span></span><span class="mjx-sup" style="font-size: 70.7%; vertical-align: 0.584em; padding-left: 0px; padding-right: 0.071em;"><span id="MJXc-Node-1407" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.267em; padding-right: 0.12em;">T</span></span></span></span><span id="MJXc-Node-1408" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.215em; padding-bottom: 0.267em;">x</span></span><span id="MJXc-Node-1409" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.479em; padding-bottom: 0.585em;">)</span></span><span id="MJXc-Node-1410" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.056em; padding-bottom: 0.32em;">=</span></span><span id="MJXc-Node-1411" class="mjx-mi MJXc-space3"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.215em; padding-bottom: 0.267em; padding-right: 0.001em;">σ</span></span><span id="MJXc-Node-1412" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.479em; padding-bottom: 0.585em;">(</span></span><span id="MJXc-Node-1413" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.32em; padding-bottom: 0.426em;">−</span></span><span id="MJXc-Node-1414" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-1415" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.215em; padding-bottom: 0.267em;">w</span></span></span><span class="mjx-sup" style="font-size: 70.7%; vertical-align: 0.584em; padding-left: 0px; padding-right: 0.071em;"><span id="MJXc-Node-1416" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.267em; padding-right: 0.12em;">T</span></span></span></span><span id="MJXc-Node-1417" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.215em; padding-bottom: 0.267em;">x</span></span><span id="MJXc-Node-1418" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.479em; padding-bottom: 0.585em;">)</span></span><span id="MJXc-Node-1419" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.056em; padding-bottom: 0.32em;">=</span></span><span id="MJXc-Node-1420" class="mjx-mfrac MJXc-space3"><span class="mjx-box MJXc-stacked" style="width: 6.05em; padding: 0px 0.12em;"><span class="mjx-numerator" style="width: 6.05em; top: -1.368em;"><span id="MJXc-Node-1421" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.373em; padding-bottom: 0.32em;">1</span></span></span><span class="mjx-denominator" style="width: 6.05em; bottom: -1.036em;"><span id="MJXc-Node-1422" class="mjx-mrow"><span id="MJXc-Node-1423" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.373em; padding-bottom: 0.32em;">1</span></span><span id="MJXc-Node-1424" class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.32em; padding-bottom: 0.426em;">+</span></span><span id="MJXc-Node-1425" class="mjx-mi MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.162em; padding-bottom: 0.532em;">exp</span></span><span id="MJXc-Node-1426" class="mjx-mo"><span class="mjx-char"></span></span><span id="MJXc-Node-1427" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.479em; padding-bottom: 0.585em;">(</span></span><span id="MJXc-Node-1428" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-1429" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.215em; padding-bottom: 0.267em;">w</span></span></span><span class="mjx-sup" style="font-size: 70.7%; vertical-align: 0.409em; padding-left: 0px; padding-right: 0.071em;"><span id="MJXc-Node-1430" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.267em; padding-right: 0.12em;">T</span></span></span></span><span id="MJXc-Node-1431" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.215em; padding-bottom: 0.267em;">x</span></span><span id="MJXc-Node-1432" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.479em; padding-bottom: 0.585em;">)</span></span></span></span><span style="border-bottom-width: 1.3px; border-bottom-style: solid; top: -0.283em; width: 6.05em;" class="mjx-line"></span></span><span style="height: 2.403em; vertical-align: -1.036em;" class="mjx-vsize"></span></span><span class="mjx-strut"></span></span></span></span></span></span></span></span><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mtable rowspacing="3pt" columnspacing="1em" displaystyle="true"><mtr><mtd><mtext>Likelihood</mtext><mo>=</mo><munderover><mo movablelimits="false">∏</mo><mrow class="MJX-TeXAtom-ORD"><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>n</mi></munderover><mi>P</mi><mo stretchy="false">(</mo><msub><mi>x</mi><mi>i</mi></msub><mspace width="thickmathspace"></mspace><mtext>принадлежит классу</mtext><mspace width="thickmathspace"></mspace><msub><mi>y</mi><mi>i</mi></msub><mo stretchy="false">)</mo></mtd></mtr><mtr><mtd><mtext>Если&nbsp;</mtext><msub><mi>y</mi><mi>i</mi></msub><mo>=</mo><mn>1</mn><mtext>, то&nbsp;</mtext><mi>P</mi><mo stretchy="false">(</mo><msub><mi>x</mi><mi>i</mi></msub><mspace width="thickmathspace"></mspace><mtext>принадлежит классу</mtext><mspace width="thickmathspace"></mspace><msub><mi>y</mi><mi>i</mi></msub><mo stretchy="false">)</mo><mo>=</mo><mi>σ</mi><mo stretchy="false">(</mo><msup><mi>w</mi><mi>T</mi></msup><mi>x</mi><mo stretchy="false">)</mo><mo>=</mo><mfrac><mn>1</mn><mrow><mn>1</mn><mo>+</mo><mi>exp</mi><mo>⁡</mo><mo stretchy="false">(</mo><mo>−</mo><msup><mi>w</mi><mi>T</mi></msup><mi>x</mi><mo stretchy="false">)</mo></mrow></mfrac></mtd></mtr><mtr><mtd><mtext>Если&nbsp;</mtext><msub><mi>y</mi><mi>i</mi></msub><mo>=</mo><mo>−</mo><mn>1</mn><mtext>, то&nbsp;</mtext><mi>P</mi><mo stretchy="false">(</mo><msub><mi>x</mi><mi>i</mi></msub><mspace width="thickmathspace"></mspace><mtext>принадлежит классу</mtext><mspace width="thickmathspace"></mspace><msub><mi>y</mi><mi>i</mi></msub><mo stretchy="false">)</mo><mo>=</mo><mn>1</mn><mo>−</mo><mi>σ</mi><mo stretchy="false">(</mo><msup><mi>w</mi><mi>T</mi></msup><mi>x</mi><mo stretchy="false">)</mo><mo>=</mo><mi>σ</mi><mo stretchy="false">(</mo><mo>−</mo><msup><mi>w</mi><mi>T</mi></msup><mi>x</mi><mo stretchy="false">)</mo><mo>=</mo><mfrac><mn>1</mn><mrow><mn>1</mn><mo>+</mo><mi>exp</mi><mo>⁡</mo><mo stretchy="false">(</mo><msup><mi>w</mi><mi>T</mi></msup><mi>x</mi><mo stretchy="false">)</mo></mrow></mfrac></mtd></mtr></mtable></math></span></span></span><script type="math/tex; mode=display" id="MathJax-Element-75">
\begin{gather}
 \text{Likelihood} = \prod\limits_{i = 1}^n P(x_i\;\text{принадлежит классу}\;y_i) \\
 \text{Если } y_i = 1 \text{, то } P(x_i\;\text{принадлежит классу}\;y_i) = \sigma(w^Tx) = \frac{1}{1 + \exp(-w^Tx)} \\
 \text{Если } y_i = -1 \text{, то } P(x_i\;\text{принадлежит классу}\;y_i) = 1 - \sigma(w^Tx) = \sigma(-w^Tx) = \frac{1}{1 + \exp(w^Tx)}
\end{gather}
</script></span><br>
<span>Здесь мы вопспользовались свойством сигмоиды: </span><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-76-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 118%; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mn>1</mn><mo>&amp;#x2212;</mo><mi>&amp;#x03C3;</mi><mo stretchy=&quot;false&quot;>(</mo><mi>x</mi><mo stretchy=&quot;false&quot;>)</mo><mo>=</mo><mi>&amp;#x03C3;</mi><mo stretchy=&quot;false&quot;>(</mo><mo>&amp;#x2212;</mo><mi>x</mi><mo stretchy=&quot;false&quot;>)</mo><mo>.</mo></math>" role="presentation"><span id="MJXc-Node-1433" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-1434" class="mjx-mrow"><span id="MJXc-Node-1435" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.373em; padding-bottom: 0.32em;">1</span></span><span id="MJXc-Node-1436" class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.32em; padding-bottom: 0.426em;">−</span></span><span id="MJXc-Node-1437" class="mjx-mi MJXc-space2"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.215em; padding-bottom: 0.267em; padding-right: 0.001em;">σ</span></span><span id="MJXc-Node-1438" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.479em; padding-bottom: 0.585em;">(</span></span><span id="MJXc-Node-1439" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.215em; padding-bottom: 0.267em;">x</span></span><span id="MJXc-Node-1440" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.479em; padding-bottom: 0.585em;">)</span></span><span id="MJXc-Node-1441" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.056em; padding-bottom: 0.32em;">=</span></span><span id="MJXc-Node-1442" class="mjx-mi MJXc-space3"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.215em; padding-bottom: 0.267em; padding-right: 0.001em;">σ</span></span><span id="MJXc-Node-1443" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.479em; padding-bottom: 0.585em;">(</span></span><span id="MJXc-Node-1444" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.32em; padding-bottom: 0.426em;">−</span></span><span id="MJXc-Node-1445" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.215em; padding-bottom: 0.267em;">x</span></span><span id="MJXc-Node-1446" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.479em; padding-bottom: 0.585em;">)</span></span><span id="MJXc-Node-1447" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="margin-top: -0.156em; padding-bottom: 0.32em;">.</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mn>1</mn><mo>−</mo><mi>σ</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mo>=</mo><mi>σ</mi><mo stretchy="false">(</mo><mo>−</mo><mi>x</mi><mo stretchy="false">)</mo><mo>.</mo></math></span></span><script type="math/tex" id="MathJax-Element-76">1 - \sigma(x) = \sigma(-x).</script></span><br>
<span>Если вспомнить определение отступа: </span><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-77-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 118%; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>M</mi><mi>i</mi></msub><mo>=</mo><msub><mi>y</mi><mi>i</mi></msub><mo>&amp;#x22C5;</mo><msup><mi>w</mi><mi>T</mi></msup><mi>x</mi></math>" role="presentation"><span id="MJXc-Node-1448" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-1449" class="mjx-mrow"><span id="MJXc-Node-1450" class="mjx-msubsup"><span class="mjx-base" style="margin-right: -0.081em;"><span id="MJXc-Node-1451" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.267em; padding-right: 0.081em;">M</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-1452" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.426em; padding-bottom: 0.267em;">i</span></span></span></span><span id="MJXc-Node-1453" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.056em; padding-bottom: 0.32em;">=</span></span><span id="MJXc-Node-1454" class="mjx-msubsup MJXc-space3"><span class="mjx-base" style="margin-right: -0.006em;"><span id="MJXc-Node-1455" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.215em; padding-bottom: 0.479em; padding-right: 0.006em;">y</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-1456" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.426em; padding-bottom: 0.267em;">i</span></span></span></span><span id="MJXc-Node-1457" class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.003em; padding-bottom: 0.32em;">⋅</span></span><span id="MJXc-Node-1458" class="mjx-msubsup MJXc-space2"><span class="mjx-base"><span id="MJXc-Node-1459" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.215em; padding-bottom: 0.267em;">w</span></span></span><span class="mjx-sup" style="font-size: 70.7%; vertical-align: 0.513em; padding-left: 0px; padding-right: 0.071em;"><span id="MJXc-Node-1460" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.267em; padding-right: 0.12em;">T</span></span></span></span><span id="MJXc-Node-1461" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.215em; padding-bottom: 0.267em;">x</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>M</mi><mi>i</mi></msub><mo>=</mo><msub><mi>y</mi><mi>i</mi></msub><mo>⋅</mo><msup><mi>w</mi><mi>T</mi></msup><mi>x</mi></math></span></span><script type="math/tex" id="MathJax-Element-77">M_i = y_i\cdot w^Tx</script></span><br>
<span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span class="mjx-chtml MJXc-display" style="text-align: center;"><span id="MathJax-Element-78-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 118%; text-align: center; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><mtable rowspacing=&quot;3pt&quot; columnspacing=&quot;1em&quot; displaystyle=&quot;true&quot;><mtr><mtd><mi>P</mi><mo stretchy=&quot;false&quot;>(</mo><msub><mi>x</mi><mi>i</mi></msub><mspace width=&quot;thickmathspace&quot; /><mtext>&amp;#x43F;&amp;#x440;&amp;#x438;&amp;#x43D;&amp;#x430;&amp;#x434;&amp;#x43B;&amp;#x435;&amp;#x436;&amp;#x438;&amp;#x442; &amp;#x43A;&amp;#x43B;&amp;#x430;&amp;#x441;&amp;#x441;&amp;#x443;</mtext><mspace width=&quot;thickmathspace&quot; /><mn>1</mn><mo stretchy=&quot;false&quot;>)</mo><mo>=</mo><mi>&amp;#x03C3;</mi><mo stretchy=&quot;false&quot;>(</mo><msub><mi>M</mi><mi>i</mi></msub><mo stretchy=&quot;false&quot;>)</mo></mtd></mtr><mtr><mtd><mi>P</mi><mo stretchy=&quot;false&quot;>(</mo><msub><mi>x</mi><mi>i</mi></msub><mspace width=&quot;thickmathspace&quot; /><mtext>&amp;#x43F;&amp;#x440;&amp;#x438;&amp;#x43D;&amp;#x430;&amp;#x434;&amp;#x43B;&amp;#x435;&amp;#x436;&amp;#x438;&amp;#x442; &amp;#x43A;&amp;#x43B;&amp;#x430;&amp;#x441;&amp;#x441;&amp;#x443;</mtext><mspace width=&quot;thickmathspace&quot; /><mo>&amp;#x2212;</mo><mn>1</mn><mo stretchy=&quot;false&quot;>)</mo><mo>=</mo><mi>&amp;#x03C3;</mi><mo stretchy=&quot;false&quot;>(</mo><msub><mi>M</mi><mi>i</mi></msub><mo stretchy=&quot;false&quot;>)</mo></mtd></mtr><mtr><mtd><mtext>Likelihood</mtext><mo>=</mo><munderover><mo movablelimits=&quot;false&quot;>&amp;#x220F;</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>n</mi></munderover><mi>P</mi><mo stretchy=&quot;false&quot;>(</mo><msub><mi>x</mi><mi>i</mi></msub><mspace width=&quot;thickmathspace&quot; /><mtext>&amp;#x43F;&amp;#x440;&amp;#x438;&amp;#x43D;&amp;#x430;&amp;#x434;&amp;#x43B;&amp;#x435;&amp;#x436;&amp;#x438;&amp;#x442; &amp;#x43A;&amp;#x43B;&amp;#x430;&amp;#x441;&amp;#x441;&amp;#x443;</mtext><mspace width=&quot;thickmathspace&quot; /><msub><mi>y</mi><mi>i</mi></msub><mo stretchy=&quot;false&quot;>)</mo><mo>=</mo><mfrac><mn>1</mn><mrow><munderover><mo movablelimits=&quot;false&quot;>&amp;#x220F;</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>n</mi></munderover><mo stretchy=&quot;false&quot;>(</mo><mn>1</mn><mo>+</mo><mi>exp</mi><mo>&amp;#x2061;</mo><mo stretchy=&quot;false&quot;>(</mo><mo>&amp;#x2212;</mo><msub><mi>M</mi><mi>i</mi></msub><mo stretchy=&quot;false&quot;>)</mo><mo stretchy=&quot;false&quot;>)</mo></mrow></mfrac></mtd></mtr><mtr><mtd><mi>log</mi><mo>&amp;#x2061;</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mtext>(Likelihood)</mtext></mrow><mo>=</mo><mo>&amp;#x2212;</mo><munderover><mo movablelimits=&quot;false&quot;>&amp;#x2211;</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>n</mi></munderover><mo stretchy=&quot;false&quot;>(</mo><mn>1</mn><mo>+</mo><mi>exp</mi><mo>&amp;#x2061;</mo><mo stretchy=&quot;false&quot;>(</mo><mo>&amp;#x2212;</mo><msub><mi>M</mi><mi>i</mi></msub><mo stretchy=&quot;false&quot;>)</mo><mo stretchy=&quot;false&quot;>)</mo></mtd></mtr></mtable></math>" role="presentation"><span id="MJXc-Node-1462" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-1463" class="mjx-mrow"><span id="MJXc-Node-1464" class="mjx-mtable" style="vertical-align: -4.751em; padding: 0px 0.167em;"><span class="mjx-table"><span id="MJXc-Node-1465" class="mjx-mtr" style="height: 1.25em;"><span id="MJXc-Node-1466" class="mjx-mtd" style="padding: 0px; width: 29.186em;"><span id="MJXc-Node-1467" class="mjx-mrow" style="margin-top: -0.175em;"><span id="MJXc-Node-1468" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.267em; padding-right: 0.109em;">P</span></span><span id="MJXc-Node-1469" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.479em; padding-bottom: 0.585em;">(</span></span><span id="MJXc-Node-1470" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-1471" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.215em; padding-bottom: 0.267em;">x</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-1472" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.426em; padding-bottom: 0.267em;">i</span></span></span></span><span id="MJXc-Node-1473" class="mjx-mspace" style="width: 0.278em; height: 0px;"></span><span id="MJXc-Node-1474" class="mjx-mtext"><span class="mjx-char" style="padding-top: 0.532em; padding-bottom: 0.215em;"><span class="mjx-charbox MJXc-TeX-unknown-R" style="padding-bottom: 0.297em; width: 0.519em;">п</span><span class="mjx-charbox MJXc-TeX-unknown-R" style="padding-bottom: 0.297em; width: 0.498em;">р</span><span class="mjx-charbox MJXc-TeX-unknown-R" style="padding-bottom: 0.297em; width: 0.519em;">и</span><span class="mjx-charbox MJXc-TeX-unknown-R" style="padding-bottom: 0.297em; width: 0.519em;">н</span><span class="mjx-charbox MJXc-TeX-unknown-R" style="padding-bottom: 0.297em; width: 0.445em;">а</span><span class="mjx-charbox MJXc-TeX-unknown-R" style="padding-bottom: 0.297em; width: 0.456em;">д</span><span class="mjx-charbox MJXc-TeX-unknown-R" style="padding-bottom: 0.297em; width: 0.498em;">л</span><span class="mjx-charbox MJXc-TeX-unknown-R" style="padding-bottom: 0.297em; width: 0.466em;">е</span><span class="mjx-charbox MJXc-TeX-unknown-R" style="padding-bottom: 0.297em; width: 0.72em;">ж</span><span class="mjx-charbox MJXc-TeX-unknown-R" style="padding-bottom: 0.297em; width: 0.519em;">и</span><span class="mjx-charbox MJXc-TeX-unknown-R" style="padding-bottom: 0.297em; width: 0.434em;">т</span><span class="mjx-charbox MJXc-TeX-main-R" style="padding-bottom: 0.314em;"> </span><span class="mjx-charbox MJXc-TeX-unknown-R" style="padding-bottom: 0.297em; width: 0.498em;">к</span><span class="mjx-charbox MJXc-TeX-unknown-R" style="padding-bottom: 0.297em; width: 0.498em;">л</span><span class="mjx-charbox MJXc-TeX-unknown-R" style="padding-bottom: 0.297em; width: 0.445em;">а</span><span class="mjx-charbox MJXc-TeX-unknown-R" style="padding-bottom: 0.297em; width: 0.456em;">с</span><span class="mjx-charbox MJXc-TeX-unknown-R" style="padding-bottom: 0.297em; width: 0.456em;">с</span><span class="mjx-charbox MJXc-TeX-unknown-R" style="padding-bottom: 0.297em; width: 0.487em;">у</span></span></span><span id="MJXc-Node-1475" class="mjx-mspace" style="width: 0.278em; height: 0px;"></span><span id="MJXc-Node-1476" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.373em; padding-bottom: 0.32em;">1</span></span><span id="MJXc-Node-1477" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.479em; padding-bottom: 0.585em;">)</span></span><span id="MJXc-Node-1478" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.056em; padding-bottom: 0.32em;">=</span></span><span id="MJXc-Node-1479" class="mjx-mi MJXc-space3"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.215em; padding-bottom: 0.267em; padding-right: 0.001em;">σ</span></span><span id="MJXc-Node-1480" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.479em; padding-bottom: 0.585em;">(</span></span><span id="MJXc-Node-1481" class="mjx-msubsup"><span class="mjx-base" style="margin-right: -0.081em;"><span id="MJXc-Node-1482" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.267em; padding-right: 0.081em;">M</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-1483" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.426em; padding-bottom: 0.267em;">i</span></span></span></span><span id="MJXc-Node-1484" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.479em; padding-bottom: 0.585em;">)</span></span><span class="mjx-strut"></span></span></span></span><span id="MJXc-Node-1485" class="mjx-mtr" style="height: 1.4em;"><span id="MJXc-Node-1486" class="mjx-mtd" style="padding: 0.15em 0px 0px;"><span id="MJXc-Node-1487" class="mjx-mrow" style="margin-top: -0.175em;"><span id="MJXc-Node-1488" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.267em; padding-right: 0.109em;">P</span></span><span id="MJXc-Node-1489" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.479em; padding-bottom: 0.585em;">(</span></span><span id="MJXc-Node-1490" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-1491" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.215em; padding-bottom: 0.267em;">x</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-1492" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.426em; padding-bottom: 0.267em;">i</span></span></span></span><span id="MJXc-Node-1493" class="mjx-mspace" style="width: 0.278em; height: 0px;"></span><span id="MJXc-Node-1494" class="mjx-mtext"><span class="mjx-char" style="padding-top: 0.532em; padding-bottom: 0.215em;"><span class="mjx-charbox MJXc-TeX-unknown-R" style="padding-bottom: 0.297em; width: 0.519em;">п</span><span class="mjx-charbox MJXc-TeX-unknown-R" style="padding-bottom: 0.297em; width: 0.498em;">р</span><span class="mjx-charbox MJXc-TeX-unknown-R" style="padding-bottom: 0.297em; width: 0.519em;">и</span><span class="mjx-charbox MJXc-TeX-unknown-R" style="padding-bottom: 0.297em; width: 0.519em;">н</span><span class="mjx-charbox MJXc-TeX-unknown-R" style="padding-bottom: 0.297em; width: 0.445em;">а</span><span class="mjx-charbox MJXc-TeX-unknown-R" style="padding-bottom: 0.297em; width: 0.456em;">д</span><span class="mjx-charbox MJXc-TeX-unknown-R" style="padding-bottom: 0.297em; width: 0.498em;">л</span><span class="mjx-charbox MJXc-TeX-unknown-R" style="padding-bottom: 0.297em; width: 0.466em;">е</span><span class="mjx-charbox MJXc-TeX-unknown-R" style="padding-bottom: 0.297em; width: 0.72em;">ж</span><span class="mjx-charbox MJXc-TeX-unknown-R" style="padding-bottom: 0.297em; width: 0.519em;">и</span><span class="mjx-charbox MJXc-TeX-unknown-R" style="padding-bottom: 0.297em; width: 0.434em;">т</span><span class="mjx-charbox MJXc-TeX-main-R" style="padding-bottom: 0.314em;"> </span><span class="mjx-charbox MJXc-TeX-unknown-R" style="padding-bottom: 0.297em; width: 0.498em;">к</span><span class="mjx-charbox MJXc-TeX-unknown-R" style="padding-bottom: 0.297em; width: 0.498em;">л</span><span class="mjx-charbox MJXc-TeX-unknown-R" style="padding-bottom: 0.297em; width: 0.445em;">а</span><span class="mjx-charbox MJXc-TeX-unknown-R" style="padding-bottom: 0.297em; width: 0.456em;">с</span><span class="mjx-charbox MJXc-TeX-unknown-R" style="padding-bottom: 0.297em; width: 0.456em;">с</span><span class="mjx-charbox MJXc-TeX-unknown-R" style="padding-bottom: 0.297em; width: 0.487em;">у</span></span></span><span id="MJXc-Node-1495" class="mjx-mspace" style="width: 0.278em; height: 0px;"></span><span id="MJXc-Node-1496" class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.32em; padding-bottom: 0.426em;">−</span></span><span id="MJXc-Node-1497" class="mjx-mn MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.373em; padding-bottom: 0.32em;">1</span></span><span id="MJXc-Node-1498" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.479em; padding-bottom: 0.585em;">)</span></span><span id="MJXc-Node-1499" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.056em; padding-bottom: 0.32em;">=</span></span><span id="MJXc-Node-1500" class="mjx-mi MJXc-space3"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.215em; padding-bottom: 0.267em; padding-right: 0.001em;">σ</span></span><span id="MJXc-Node-1501" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.479em; padding-bottom: 0.585em;">(</span></span><span id="MJXc-Node-1502" class="mjx-msubsup"><span class="mjx-base" style="margin-right: -0.081em;"><span id="MJXc-Node-1503" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.267em; padding-right: 0.081em;">M</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-1504" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.426em; padding-bottom: 0.267em;">i</span></span></span></span><span id="MJXc-Node-1505" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.479em; padding-bottom: 0.585em;">)</span></span><span class="mjx-strut"></span></span></span></span><span id="MJXc-Node-1506" class="mjx-mtr" style="height: 4.342em;"><span id="MJXc-Node-1507" class="mjx-mtd" style="padding: 0.15em 0px 0px;"><span id="MJXc-Node-1508" class="mjx-mrow"><span id="MJXc-Node-1509" class="mjx-mtext"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.426em; padding-bottom: 0.373em;">Likelihood</span></span><span id="MJXc-Node-1510" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.056em; padding-bottom: 0.32em;">=</span></span><span id="MJXc-Node-1511" class="mjx-munderover MJXc-space3"><span class="mjx-itable"><span class="mjx-row"><span class="mjx-cell"><span class="mjx-stack"><span class="mjx-over" style="font-size: 70.7%; padding-bottom: 0.247em; padding-top: 0.141em; padding-left: 0.604em;"><span id="MJXc-Node-1518" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.215em; padding-bottom: 0.267em;">n</span></span></span><span class="mjx-op"><span id="MJXc-Node-1512" class="mjx-mo"><span class="mjx-char MJXc-TeX-size2-R" style="padding-top: 0.744em; padding-bottom: 0.744em;">∏</span></span></span></span></span></span><span class="mjx-row"><span class="mjx-under" style="font-size: 70.7%; padding-top: 0.236em; padding-bottom: 0.141em; padding-left: 0.092em;"><span id="MJXc-Node-1513" class="mjx-texatom" style=""><span id="MJXc-Node-1514" class="mjx-mrow"><span id="MJXc-Node-1515" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.426em; padding-bottom: 0.267em;">i</span></span><span id="MJXc-Node-1516" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.056em; padding-bottom: 0.32em;">=</span></span><span id="MJXc-Node-1517" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.373em; padding-bottom: 0.32em;">1</span></span></span></span></span></span></span></span><span id="MJXc-Node-1519" class="mjx-mi MJXc-space1"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.267em; padding-right: 0.109em;">P</span></span><span id="MJXc-Node-1520" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.479em; padding-bottom: 0.585em;">(</span></span><span id="MJXc-Node-1521" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-1522" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.215em; padding-bottom: 0.267em;">x</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-1523" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.426em; padding-bottom: 0.267em;">i</span></span></span></span><span id="MJXc-Node-1524" class="mjx-mspace" style="width: 0.278em; height: 0px;"></span><span id="MJXc-Node-1525" class="mjx-mtext"><span class="mjx-char" style="padding-top: 0.532em; padding-bottom: 0.215em;"><span class="mjx-charbox MJXc-TeX-unknown-R" style="padding-bottom: 0.297em; width: 0.519em;">п</span><span class="mjx-charbox MJXc-TeX-unknown-R" style="padding-bottom: 0.297em; width: 0.498em;">р</span><span class="mjx-charbox MJXc-TeX-unknown-R" style="padding-bottom: 0.297em; width: 0.519em;">и</span><span class="mjx-charbox MJXc-TeX-unknown-R" style="padding-bottom: 0.297em; width: 0.519em;">н</span><span class="mjx-charbox MJXc-TeX-unknown-R" style="padding-bottom: 0.297em; width: 0.445em;">а</span><span class="mjx-charbox MJXc-TeX-unknown-R" style="padding-bottom: 0.297em; width: 0.456em;">д</span><span class="mjx-charbox MJXc-TeX-unknown-R" style="padding-bottom: 0.297em; width: 0.498em;">л</span><span class="mjx-charbox MJXc-TeX-unknown-R" style="padding-bottom: 0.297em; width: 0.466em;">е</span><span class="mjx-charbox MJXc-TeX-unknown-R" style="padding-bottom: 0.297em; width: 0.72em;">ж</span><span class="mjx-charbox MJXc-TeX-unknown-R" style="padding-bottom: 0.297em; width: 0.519em;">и</span><span class="mjx-charbox MJXc-TeX-unknown-R" style="padding-bottom: 0.297em; width: 0.434em;">т</span><span class="mjx-charbox MJXc-TeX-main-R" style="padding-bottom: 0.314em;"> </span><span class="mjx-charbox MJXc-TeX-unknown-R" style="padding-bottom: 0.297em; width: 0.498em;">к</span><span class="mjx-charbox MJXc-TeX-unknown-R" style="padding-bottom: 0.297em; width: 0.498em;">л</span><span class="mjx-charbox MJXc-TeX-unknown-R" style="padding-bottom: 0.297em; width: 0.445em;">а</span><span class="mjx-charbox MJXc-TeX-unknown-R" style="padding-bottom: 0.297em; width: 0.456em;">с</span><span class="mjx-charbox MJXc-TeX-unknown-R" style="padding-bottom: 0.297em; width: 0.456em;">с</span><span class="mjx-charbox MJXc-TeX-unknown-R" style="padding-bottom: 0.297em; width: 0.487em;">у</span></span></span><span id="MJXc-Node-1526" class="mjx-mspace" style="width: 0.278em; height: 0px;"></span><span id="MJXc-Node-1527" class="mjx-msubsup"><span class="mjx-base" style="margin-right: -0.006em;"><span id="MJXc-Node-1528" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.215em; padding-bottom: 0.479em; padding-right: 0.006em;">y</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-1529" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.426em; padding-bottom: 0.267em;">i</span></span></span></span><span id="MJXc-Node-1530" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.479em; padding-bottom: 0.585em;">)</span></span><span id="MJXc-Node-1531" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.056em; padding-bottom: 0.32em;">=</span></span><span id="MJXc-Node-1532" class="mjx-mfrac MJXc-space3"><span class="mjx-box MJXc-stacked" style="width: 8.181em; padding: 0px 0.12em;"><span class="mjx-numerator" style="width: 8.181em; top: -1.368em;"><span id="MJXc-Node-1533" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.373em; padding-bottom: 0.32em;">1</span></span></span><span class="mjx-denominator" style="width: 8.181em; bottom: -2.436em;"><span id="MJXc-Node-1534" class="mjx-mrow"><span id="MJXc-Node-1535" class="mjx-munderover"><span class="mjx-itable"><span class="mjx-row"><span class="mjx-cell"><span class="mjx-stack"><span class="mjx-over" style="font-size: 70.7%; padding-bottom: 0.247em; padding-top: 0.141em; padding-left: 0.512em;"><span id="MJXc-Node-1542" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.215em; padding-bottom: 0.267em;">n</span></span></span><span class="mjx-op" style="padding-left: 0.102em;"><span id="MJXc-Node-1536" class="mjx-mo"><span class="mjx-char MJXc-TeX-size1-R" style="padding-top: 0.532em; padding-bottom: 0.532em;">∏</span></span></span></span></span></span><span class="mjx-row"><span class="mjx-under" style="font-size: 70.7%; padding-top: 0.236em; padding-bottom: 0.141em;"><span id="MJXc-Node-1537" class="mjx-texatom" style=""><span id="MJXc-Node-1538" class="mjx-mrow"><span id="MJXc-Node-1539" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.426em; padding-bottom: 0.267em;">i</span></span><span id="MJXc-Node-1540" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.056em; padding-bottom: 0.32em;">=</span></span><span id="MJXc-Node-1541" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.373em; padding-bottom: 0.32em;">1</span></span></span></span></span></span></span></span><span id="MJXc-Node-1543" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.479em; padding-bottom: 0.585em;">(</span></span><span id="MJXc-Node-1544" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.373em; padding-bottom: 0.32em;">1</span></span><span id="MJXc-Node-1545" class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.32em; padding-bottom: 0.426em;">+</span></span><span id="MJXc-Node-1546" class="mjx-mi MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.162em; padding-bottom: 0.532em;">exp</span></span><span id="MJXc-Node-1547" class="mjx-mo"><span class="mjx-char"></span></span><span id="MJXc-Node-1548" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.479em; padding-bottom: 0.585em;">(</span></span><span id="MJXc-Node-1549" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.32em; padding-bottom: 0.426em;">−</span></span><span id="MJXc-Node-1550" class="mjx-msubsup"><span class="mjx-base" style="margin-right: -0.081em;"><span id="MJXc-Node-1551" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.267em; padding-right: 0.081em;">M</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-1552" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.426em; padding-bottom: 0.267em;">i</span></span></span></span><span id="MJXc-Node-1553" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.479em; padding-bottom: 0.585em;">)</span></span><span id="MJXc-Node-1554" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.479em; padding-bottom: 0.585em;">)</span></span></span></span><span style="border-bottom-width: 1.3px; border-bottom-style: solid; top: -0.283em; width: 8.181em;" class="mjx-line"></span></span><span style="height: 3.804em; vertical-align: -2.436em;" class="mjx-vsize"></span></span><span class="mjx-strut"></span></span></span></span><span id="MJXc-Node-1555" class="mjx-mtr" style="height: 3.011em;"><span id="MJXc-Node-1556" class="mjx-mtd" style="padding: 0.15em 0px 0px;"><span id="MJXc-Node-1557" class="mjx-mrow"><span id="MJXc-Node-1558" class="mjx-mi"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.426em; padding-bottom: 0.532em;">log</span></span><span id="MJXc-Node-1559" class="mjx-mo"><span class="mjx-char"></span></span><span id="MJXc-Node-1560" class="mjx-texatom MJXc-space1"><span id="MJXc-Node-1561" class="mjx-mrow"><span id="MJXc-Node-1562" class="mjx-mtext"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.479em; padding-bottom: 0.585em;">(Likelihood)</span></span></span></span><span id="MJXc-Node-1563" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.056em; padding-bottom: 0.32em;">=</span></span><span id="MJXc-Node-1564" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.32em; padding-bottom: 0.426em;">−</span></span><span id="MJXc-Node-1565" class="mjx-munderover MJXc-space1"><span class="mjx-itable"><span class="mjx-row"><span class="mjx-cell"><span class="mjx-stack"><span class="mjx-over" style="font-size: 70.7%; padding-bottom: 0.247em; padding-top: 0.141em; padding-left: 0.721em;"><span id="MJXc-Node-1572" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.215em; padding-bottom: 0.267em;">n</span></span></span><span class="mjx-op"><span id="MJXc-Node-1566" class="mjx-mo"><span class="mjx-char MJXc-TeX-size2-R" style="padding-top: 0.744em; padding-bottom: 0.744em;">∑</span></span></span></span></span></span><span class="mjx-row"><span class="mjx-under" style="font-size: 70.7%; padding-top: 0.236em; padding-bottom: 0.141em; padding-left: 0.21em;"><span id="MJXc-Node-1567" class="mjx-texatom" style=""><span id="MJXc-Node-1568" class="mjx-mrow"><span id="MJXc-Node-1569" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.426em; padding-bottom: 0.267em;">i</span></span><span id="MJXc-Node-1570" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.056em; padding-bottom: 0.32em;">=</span></span><span id="MJXc-Node-1571" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.373em; padding-bottom: 0.32em;">1</span></span></span></span></span></span></span></span><span id="MJXc-Node-1573" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.479em; padding-bottom: 0.585em;">(</span></span><span id="MJXc-Node-1574" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.373em; padding-bottom: 0.32em;">1</span></span><span id="MJXc-Node-1575" class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.32em; padding-bottom: 0.426em;">+</span></span><span id="MJXc-Node-1576" class="mjx-mi MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.162em; padding-bottom: 0.532em;">exp</span></span><span id="MJXc-Node-1577" class="mjx-mo"><span class="mjx-char"></span></span><span id="MJXc-Node-1578" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.479em; padding-bottom: 0.585em;">(</span></span><span id="MJXc-Node-1579" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.32em; padding-bottom: 0.426em;">−</span></span><span id="MJXc-Node-1580" class="mjx-msubsup"><span class="mjx-base" style="margin-right: -0.081em;"><span id="MJXc-Node-1581" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.267em; padding-right: 0.081em;">M</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-1582" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.426em; padding-bottom: 0.267em;">i</span></span></span></span><span id="MJXc-Node-1583" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.479em; padding-bottom: 0.585em;">)</span></span><span id="MJXc-Node-1584" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.479em; padding-bottom: 0.585em;">)</span></span><span class="mjx-strut"></span></span></span></span></span></span></span></span><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mtable rowspacing="3pt" columnspacing="1em" displaystyle="true"><mtr><mtd><mi>P</mi><mo stretchy="false">(</mo><msub><mi>x</mi><mi>i</mi></msub><mspace width="thickmathspace"></mspace><mtext>принадлежит классу</mtext><mspace width="thickmathspace"></mspace><mn>1</mn><mo stretchy="false">)</mo><mo>=</mo><mi>σ</mi><mo stretchy="false">(</mo><msub><mi>M</mi><mi>i</mi></msub><mo stretchy="false">)</mo></mtd></mtr><mtr><mtd><mi>P</mi><mo stretchy="false">(</mo><msub><mi>x</mi><mi>i</mi></msub><mspace width="thickmathspace"></mspace><mtext>принадлежит классу</mtext><mspace width="thickmathspace"></mspace><mo>−</mo><mn>1</mn><mo stretchy="false">)</mo><mo>=</mo><mi>σ</mi><mo stretchy="false">(</mo><msub><mi>M</mi><mi>i</mi></msub><mo stretchy="false">)</mo></mtd></mtr><mtr><mtd><mtext>Likelihood</mtext><mo>=</mo><munderover><mo movablelimits="false">∏</mo><mrow class="MJX-TeXAtom-ORD"><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>n</mi></munderover><mi>P</mi><mo stretchy="false">(</mo><msub><mi>x</mi><mi>i</mi></msub><mspace width="thickmathspace"></mspace><mtext>принадлежит классу</mtext><mspace width="thickmathspace"></mspace><msub><mi>y</mi><mi>i</mi></msub><mo stretchy="false">)</mo><mo>=</mo><mfrac><mn>1</mn><mrow><munderover><mo movablelimits="false">∏</mo><mrow class="MJX-TeXAtom-ORD"><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>n</mi></munderover><mo stretchy="false">(</mo><mn>1</mn><mo>+</mo><mi>exp</mi><mo>⁡</mo><mo stretchy="false">(</mo><mo>−</mo><msub><mi>M</mi><mi>i</mi></msub><mo stretchy="false">)</mo><mo stretchy="false">)</mo></mrow></mfrac></mtd></mtr><mtr><mtd><mi>log</mi><mo>⁡</mo><mrow class="MJX-TeXAtom-ORD"><mtext>(Likelihood)</mtext></mrow><mo>=</mo><mo>−</mo><munderover><mo movablelimits="false">∑</mo><mrow class="MJX-TeXAtom-ORD"><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>n</mi></munderover><mo stretchy="false">(</mo><mn>1</mn><mo>+</mo><mi>exp</mi><mo>⁡</mo><mo stretchy="false">(</mo><mo>−</mo><msub><mi>M</mi><mi>i</mi></msub><mo stretchy="false">)</mo><mo stretchy="false">)</mo></mtd></mtr></mtable></math></span></span></span><script type="math/tex; mode=display" id="MathJax-Element-78">
\begin{gather}
 P(x_i\;\text{принадлежит классу}\;1) = \sigma(M_i) \\
 P(x_i\;\text{принадлежит классу}\;-1) = \sigma(M_i) \\
 \text{Likelihood} = \prod\limits_{i = 1}^n P(x_i\;\text{принадлежит классу}\;y_i) = 
 \frac{1}{\prod\limits_{i = 1}^n(1 + \exp(-M_i))} \\
 \log{\text{(Likelihood)}} = -\sum\limits_{i = 1}^n (1 + \exp(-M_i))
\end{gather}
</script></span><br>
<span>Соответственно при макисимзации правдоподобия мы минимизируем функционал ошибки (так как они отличается только знаком).</span>
<ul>
<li><span>Заметим, что функционал логистической функции ошибки можно использовать для обучения любого алгоритма, предасказывающего вероятности принадлежности классам. В общем случае он определяется следующим образом:</span><br>
<span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span class="mjx-chtml MJXc-display" style="text-align: center;"><span id="MathJax-Element-79-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 118%; text-align: center; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><mi>L</mi><mo>=</mo><mo>&amp;#x2212;</mo><munderover><mo movablelimits=&quot;false&quot;>&amp;#x2211;</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>n</mi></munderover><munderover><mo movablelimits=&quot;false&quot;>&amp;#x2211;</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>k</mi><mo>=</mo><mn>1</mn></mrow><mi>C</mi></munderover><mo stretchy=&quot;false&quot;>[</mo><msub><mi>y</mi><mi>i</mi></msub><mo>=</mo><mi>k</mi><mo stretchy=&quot;false&quot;>]</mo><mi>log</mi><mo>&amp;#x2061;</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>P</mi><mo stretchy=&quot;false&quot;>(</mo><msub><mi>x</mi><mi>i</mi></msub><mspace width=&quot;thickmathspace&quot; /><mtext>&amp;#x43F;&amp;#x440;&amp;#x438;&amp;#x43D;&amp;#x430;&amp;#x434;&amp;#x43B;&amp;#x435;&amp;#x436;&amp;#x438;&amp;#x442; &amp;#x43A;&amp;#x43B;&amp;#x430;&amp;#x441;&amp;#x441;&amp;#x443;</mtext><mspace width=&quot;thickmathspace&quot; /><mi>k</mi><mo stretchy=&quot;false&quot;>)</mo></mrow></math>" role="presentation"><span id="MJXc-Node-1585" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-1586" class="mjx-mrow"><span id="MJXc-Node-1587" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.267em;">L</span></span><span id="MJXc-Node-1588" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.056em; padding-bottom: 0.32em;">=</span></span><span id="MJXc-Node-1589" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.32em; padding-bottom: 0.426em;">−</span></span><span id="MJXc-Node-1590" class="mjx-munderover MJXc-space1"><span class="mjx-itable"><span class="mjx-row"><span class="mjx-cell"><span class="mjx-stack"><span class="mjx-over" style="font-size: 70.7%; padding-bottom: 0.247em; padding-top: 0.141em; padding-left: 0.721em;"><span id="MJXc-Node-1597" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.215em; padding-bottom: 0.267em;">n</span></span></span><span class="mjx-op"><span id="MJXc-Node-1591" class="mjx-mo"><span class="mjx-char MJXc-TeX-size2-R" style="padding-top: 0.744em; padding-bottom: 0.744em;">∑</span></span></span></span></span></span><span class="mjx-row"><span class="mjx-under" style="font-size: 70.7%; padding-top: 0.236em; padding-bottom: 0.141em; padding-left: 0.21em;"><span id="MJXc-Node-1592" class="mjx-texatom" style=""><span id="MJXc-Node-1593" class="mjx-mrow"><span id="MJXc-Node-1594" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.426em; padding-bottom: 0.267em;">i</span></span><span id="MJXc-Node-1595" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.056em; padding-bottom: 0.32em;">=</span></span><span id="MJXc-Node-1596" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.373em; padding-bottom: 0.32em;">1</span></span></span></span></span></span></span></span><span id="MJXc-Node-1598" class="mjx-munderover MJXc-space1"><span class="mjx-itable"><span class="mjx-row"><span class="mjx-cell"><span class="mjx-stack"><span class="mjx-over" style="font-size: 70.7%; padding-bottom: 0.236em; padding-top: 0.141em; padding-left: 0.641em;"><span id="MJXc-Node-1605" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.32em; padding-right: 0.045em;">C</span></span></span><span class="mjx-op"><span id="MJXc-Node-1599" class="mjx-mo"><span class="mjx-char MJXc-TeX-size2-R" style="padding-top: 0.744em; padding-bottom: 0.744em;">∑</span></span></span></span></span></span><span class="mjx-row"><span class="mjx-under" style="font-size: 70.7%; padding-top: 0.236em; padding-bottom: 0.141em; padding-left: 0.122em;"><span id="MJXc-Node-1600" class="mjx-texatom" style=""><span id="MJXc-Node-1601" class="mjx-mrow"><span id="MJXc-Node-1602" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.267em;">k</span></span><span id="MJXc-Node-1603" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.056em; padding-bottom: 0.32em;">=</span></span><span id="MJXc-Node-1604" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.373em; padding-bottom: 0.32em;">1</span></span></span></span></span></span></span></span><span id="MJXc-Node-1606" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.479em; padding-bottom: 0.585em;">[</span></span><span id="MJXc-Node-1607" class="mjx-msubsup"><span class="mjx-base" style="margin-right: -0.006em;"><span id="MJXc-Node-1608" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.215em; padding-bottom: 0.479em; padding-right: 0.006em;">y</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-1609" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.426em; padding-bottom: 0.267em;">i</span></span></span></span><span id="MJXc-Node-1610" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.056em; padding-bottom: 0.32em;">=</span></span><span id="MJXc-Node-1611" class="mjx-mi MJXc-space3"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.267em;">k</span></span><span id="MJXc-Node-1612" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.479em; padding-bottom: 0.585em;">]</span></span><span id="MJXc-Node-1613" class="mjx-mi MJXc-space1"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.426em; padding-bottom: 0.532em;">log</span></span><span id="MJXc-Node-1614" class="mjx-mo"><span class="mjx-char"></span></span><span id="MJXc-Node-1615" class="mjx-texatom MJXc-space1"><span id="MJXc-Node-1616" class="mjx-mrow"><span id="MJXc-Node-1617" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.267em; padding-right: 0.109em;">P</span></span><span id="MJXc-Node-1618" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.479em; padding-bottom: 0.585em;">(</span></span><span id="MJXc-Node-1619" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-1620" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.215em; padding-bottom: 0.267em;">x</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-1621" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.426em; padding-bottom: 0.267em;">i</span></span></span></span><span id="MJXc-Node-1622" class="mjx-mspace" style="width: 0.278em; height: 0px;"></span><span id="MJXc-Node-1623" class="mjx-mtext"><span class="mjx-char" style="padding-top: 0.532em; padding-bottom: 0.215em;"><span class="mjx-charbox MJXc-TeX-unknown-R" style="padding-bottom: 0.297em; width: 0.519em;">п</span><span class="mjx-charbox MJXc-TeX-unknown-R" style="padding-bottom: 0.297em; width: 0.498em;">р</span><span class="mjx-charbox MJXc-TeX-unknown-R" style="padding-bottom: 0.297em; width: 0.519em;">и</span><span class="mjx-charbox MJXc-TeX-unknown-R" style="padding-bottom: 0.297em; width: 0.519em;">н</span><span class="mjx-charbox MJXc-TeX-unknown-R" style="padding-bottom: 0.297em; width: 0.445em;">а</span><span class="mjx-charbox MJXc-TeX-unknown-R" style="padding-bottom: 0.297em; width: 0.456em;">д</span><span class="mjx-charbox MJXc-TeX-unknown-R" style="padding-bottom: 0.297em; width: 0.498em;">л</span><span class="mjx-charbox MJXc-TeX-unknown-R" style="padding-bottom: 0.297em; width: 0.466em;">е</span><span class="mjx-charbox MJXc-TeX-unknown-R" style="padding-bottom: 0.297em; width: 0.72em;">ж</span><span class="mjx-charbox MJXc-TeX-unknown-R" style="padding-bottom: 0.297em; width: 0.519em;">и</span><span class="mjx-charbox MJXc-TeX-unknown-R" style="padding-bottom: 0.297em; width: 0.434em;">т</span><span class="mjx-charbox MJXc-TeX-main-R" style="padding-bottom: 0.314em;"> </span><span class="mjx-charbox MJXc-TeX-unknown-R" style="padding-bottom: 0.297em; width: 0.498em;">к</span><span class="mjx-charbox MJXc-TeX-unknown-R" style="padding-bottom: 0.297em; width: 0.498em;">л</span><span class="mjx-charbox MJXc-TeX-unknown-R" style="padding-bottom: 0.297em; width: 0.445em;">а</span><span class="mjx-charbox MJXc-TeX-unknown-R" style="padding-bottom: 0.297em; width: 0.456em;">с</span><span class="mjx-charbox MJXc-TeX-unknown-R" style="padding-bottom: 0.297em; width: 0.456em;">с</span><span class="mjx-charbox MJXc-TeX-unknown-R" style="padding-bottom: 0.297em; width: 0.487em;">у</span></span></span><span id="MJXc-Node-1624" class="mjx-mspace" style="width: 0.278em; height: 0px;"></span><span id="MJXc-Node-1625" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.267em;">k</span></span><span id="MJXc-Node-1626" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.479em; padding-bottom: 0.585em;">)</span></span></span></span></span></span><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mi>L</mi><mo>=</mo><mo>−</mo><munderover><mo movablelimits="false">∑</mo><mrow class="MJX-TeXAtom-ORD"><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>n</mi></munderover><munderover><mo movablelimits="false">∑</mo><mrow class="MJX-TeXAtom-ORD"><mi>k</mi><mo>=</mo><mn>1</mn></mrow><mi>C</mi></munderover><mo stretchy="false">[</mo><msub><mi>y</mi><mi>i</mi></msub><mo>=</mo><mi>k</mi><mo stretchy="false">]</mo><mi>log</mi><mo>⁡</mo><mrow class="MJX-TeXAtom-ORD"><mi>P</mi><mo stretchy="false">(</mo><msub><mi>x</mi><mi>i</mi></msub><mspace width="thickmathspace"></mspace><mtext>принадлежит классу</mtext><mspace width="thickmathspace"></mspace><mi>k</mi><mo stretchy="false">)</mo></mrow></math></span></span></span><script type="math/tex; mode=display" id="MathJax-Element-79">
L = -\sum\limits_{i = 1}^n\sum\limits_{k = 1}^C [y_i = k]\log{P(x_i\;\text{принадлежит классу}\;k)}
</script></span><br>
<span>Здесь </span><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-80-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 118%; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>C</mi></math>" role="presentation"><span id="MJXc-Node-1627" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-1628" class="mjx-mrow"><span id="MJXc-Node-1629" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.32em; padding-right: 0.045em;">C</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>C</mi></math></span></span><script type="math/tex" id="MathJax-Element-80">C</script></span><span> — количество классов, </span><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-81-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 118%; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>k</mi></math>" role="presentation"><span id="MJXc-Node-1630" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-1631" class="mjx-mrow"><span id="MJXc-Node-1632" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.267em;">k</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>k</mi></math></span></span><script type="math/tex" id="MathJax-Element-81">k</script></span><span> — метки классов, </span><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-82-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 118%; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>y</mi><mi>i</mi></msub></math>" role="presentation"><span id="MJXc-Node-1633" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-1634" class="mjx-mrow"><span id="MJXc-Node-1635" class="mjx-msubsup"><span class="mjx-base" style="margin-right: -0.006em;"><span id="MJXc-Node-1636" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.215em; padding-bottom: 0.479em; padding-right: 0.006em;">y</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-1637" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.426em; padding-bottom: 0.267em;">i</span></span></span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>y</mi><mi>i</mi></msub></math></span></span><script type="math/tex" id="MathJax-Element-82">y_i</script></span><span> – истинные метки классов.</span><br>
<span>То есть это сумма логарифмов вероятностей принадлежать истинным классам.</span><br>
<span>В бинарном случае (метки </span><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-83-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 118%; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mo fence=&quot;false&quot; stretchy=&quot;false&quot;>{</mo><mn>0</mn><mo>,</mo><mn>1</mn><mo fence=&quot;false&quot; stretchy=&quot;false&quot;>}</mo></math>" role="presentation"><span id="MJXc-Node-1638" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-1639" class="mjx-mrow"><span id="MJXc-Node-1640" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.479em; padding-bottom: 0.585em;">{</span></span><span id="MJXc-Node-1641" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.373em; padding-bottom: 0.373em;">0</span></span><span id="MJXc-Node-1642" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="margin-top: -0.156em; padding-bottom: 0.532em;">,</span></span><span id="MJXc-Node-1643" class="mjx-mn MJXc-space1"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.373em; padding-bottom: 0.32em;">1</span></span><span id="MJXc-Node-1644" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.479em; padding-bottom: 0.585em;">}</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo fence="false" stretchy="false">{</mo><mn>0</mn><mo>,</mo><mn>1</mn><mo fence="false" stretchy="false">}</mo></math></span></span><script type="math/tex" id="MathJax-Element-83">\{0, 1\}</script></span><span>):</span><br>
<span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span class="mjx-chtml MJXc-display" style="text-align: center;"><span id="MathJax-Element-84-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 118%; text-align: center; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><mi>L</mi><mo>=</mo><mo>&amp;#x2212;</mo><msub><mi>y</mi><mi>i</mi></msub><mi>log</mi><mo>&amp;#x2061;</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>P</mi><mo stretchy=&quot;false&quot;>(</mo><msub><mi>x</mi><mi>i</mi></msub><mspace width=&quot;thickmathspace&quot; /><mtext>&amp;#x43F;&amp;#x440;&amp;#x438;&amp;#x43D;&amp;#x430;&amp;#x434;&amp;#x43B;&amp;#x435;&amp;#x436;&amp;#x438;&amp;#x442; &amp;#x43A;&amp;#x43B;&amp;#x430;&amp;#x441;&amp;#x441;&amp;#x443;</mtext><mspace width=&quot;thickmathspace&quot; /><mn>1</mn><mo stretchy=&quot;false&quot;>)</mo></mrow><mo>&amp;#x2212;</mo><mo stretchy=&quot;false&quot;>(</mo><mn>1</mn><mo>&amp;#x2212;</mo><msub><mi>y</mi><mi>i</mi></msub><mo stretchy=&quot;false&quot;>)</mo><mi>log</mi><mo>&amp;#x2061;</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>P</mi><mo stretchy=&quot;false&quot;>(</mo><msub><mi>x</mi><mi>i</mi></msub><mspace width=&quot;thickmathspace&quot; /><mtext>&amp;#x43F;&amp;#x440;&amp;#x438;&amp;#x43D;&amp;#x430;&amp;#x434;&amp;#x43B;&amp;#x435;&amp;#x436;&amp;#x438;&amp;#x442; &amp;#x43A;&amp;#x43B;&amp;#x430;&amp;#x441;&amp;#x441;&amp;#x443;</mtext><mspace width=&quot;thickmathspace&quot; /><mn>0</mn><mo stretchy=&quot;false&quot;>)</mo></mrow></math>" role="presentation"><span id="MJXc-Node-1645" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-1646" class="mjx-mrow"><span id="MJXc-Node-1647" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.267em;">L</span></span><span id="MJXc-Node-1648" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.056em; padding-bottom: 0.32em;">=</span></span><span id="MJXc-Node-1649" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.32em; padding-bottom: 0.426em;">−</span></span><span id="MJXc-Node-1650" class="mjx-msubsup"><span class="mjx-base" style="margin-right: -0.006em;"><span id="MJXc-Node-1651" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.215em; padding-bottom: 0.479em; padding-right: 0.006em;">y</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-1652" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.426em; padding-bottom: 0.267em;">i</span></span></span></span><span id="MJXc-Node-1653" class="mjx-mi MJXc-space1"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.426em; padding-bottom: 0.532em;">log</span></span><span id="MJXc-Node-1654" class="mjx-mo"><span class="mjx-char"></span></span><span id="MJXc-Node-1655" class="mjx-texatom MJXc-space1"><span id="MJXc-Node-1656" class="mjx-mrow"><span id="MJXc-Node-1657" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.267em; padding-right: 0.109em;">P</span></span><span id="MJXc-Node-1658" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.479em; padding-bottom: 0.585em;">(</span></span><span id="MJXc-Node-1659" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-1660" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.215em; padding-bottom: 0.267em;">x</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-1661" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.426em; padding-bottom: 0.267em;">i</span></span></span></span><span id="MJXc-Node-1662" class="mjx-mspace" style="width: 0.278em; height: 0px;"></span><span id="MJXc-Node-1663" class="mjx-mtext"><span class="mjx-char" style="padding-top: 0.532em; padding-bottom: 0.215em;"><span class="mjx-charbox MJXc-TeX-unknown-R" style="padding-bottom: 0.297em; width: 0.519em;">п</span><span class="mjx-charbox MJXc-TeX-unknown-R" style="padding-bottom: 0.297em; width: 0.498em;">р</span><span class="mjx-charbox MJXc-TeX-unknown-R" style="padding-bottom: 0.297em; width: 0.519em;">и</span><span class="mjx-charbox MJXc-TeX-unknown-R" style="padding-bottom: 0.297em; width: 0.519em;">н</span><span class="mjx-charbox MJXc-TeX-unknown-R" style="padding-bottom: 0.297em; width: 0.445em;">а</span><span class="mjx-charbox MJXc-TeX-unknown-R" style="padding-bottom: 0.297em; width: 0.456em;">д</span><span class="mjx-charbox MJXc-TeX-unknown-R" style="padding-bottom: 0.297em; width: 0.498em;">л</span><span class="mjx-charbox MJXc-TeX-unknown-R" style="padding-bottom: 0.297em; width: 0.466em;">е</span><span class="mjx-charbox MJXc-TeX-unknown-R" style="padding-bottom: 0.297em; width: 0.72em;">ж</span><span class="mjx-charbox MJXc-TeX-unknown-R" style="padding-bottom: 0.297em; width: 0.519em;">и</span><span class="mjx-charbox MJXc-TeX-unknown-R" style="padding-bottom: 0.297em; width: 0.434em;">т</span><span class="mjx-charbox MJXc-TeX-main-R" style="padding-bottom: 0.314em;"> </span><span class="mjx-charbox MJXc-TeX-unknown-R" style="padding-bottom: 0.297em; width: 0.498em;">к</span><span class="mjx-charbox MJXc-TeX-unknown-R" style="padding-bottom: 0.297em; width: 0.498em;">л</span><span class="mjx-charbox MJXc-TeX-unknown-R" style="padding-bottom: 0.297em; width: 0.445em;">а</span><span class="mjx-charbox MJXc-TeX-unknown-R" style="padding-bottom: 0.297em; width: 0.456em;">с</span><span class="mjx-charbox MJXc-TeX-unknown-R" style="padding-bottom: 0.297em; width: 0.456em;">с</span><span class="mjx-charbox MJXc-TeX-unknown-R" style="padding-bottom: 0.297em; width: 0.487em;">у</span></span></span><span id="MJXc-Node-1664" class="mjx-mspace" style="width: 0.278em; height: 0px;"></span><span id="MJXc-Node-1665" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.373em; padding-bottom: 0.32em;">1</span></span><span id="MJXc-Node-1666" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.479em; padding-bottom: 0.585em;">)</span></span></span></span><span id="MJXc-Node-1667" class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.32em; padding-bottom: 0.426em;">−</span></span><span id="MJXc-Node-1668" class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.479em; padding-bottom: 0.585em;">(</span></span><span id="MJXc-Node-1669" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.373em; padding-bottom: 0.32em;">1</span></span><span id="MJXc-Node-1670" class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.32em; padding-bottom: 0.426em;">−</span></span><span id="MJXc-Node-1671" class="mjx-msubsup MJXc-space2"><span class="mjx-base" style="margin-right: -0.006em;"><span id="MJXc-Node-1672" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.215em; padding-bottom: 0.479em; padding-right: 0.006em;">y</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-1673" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.426em; padding-bottom: 0.267em;">i</span></span></span></span><span id="MJXc-Node-1674" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.479em; padding-bottom: 0.585em;">)</span></span><span id="MJXc-Node-1675" class="mjx-mi MJXc-space1"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.426em; padding-bottom: 0.532em;">log</span></span><span id="MJXc-Node-1676" class="mjx-mo"><span class="mjx-char"></span></span><span id="MJXc-Node-1677" class="mjx-texatom MJXc-space1"><span id="MJXc-Node-1678" class="mjx-mrow"><span id="MJXc-Node-1679" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.267em; padding-right: 0.109em;">P</span></span><span id="MJXc-Node-1680" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.479em; padding-bottom: 0.585em;">(</span></span><span id="MJXc-Node-1681" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-1682" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.215em; padding-bottom: 0.267em;">x</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-1683" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.426em; padding-bottom: 0.267em;">i</span></span></span></span><span id="MJXc-Node-1684" class="mjx-mspace" style="width: 0.278em; height: 0px;"></span><span id="MJXc-Node-1685" class="mjx-mtext"><span class="mjx-char" style="padding-top: 0.532em; padding-bottom: 0.215em;"><span class="mjx-charbox MJXc-TeX-unknown-R" style="padding-bottom: 0.297em; width: 0.519em;">п</span><span class="mjx-charbox MJXc-TeX-unknown-R" style="padding-bottom: 0.297em; width: 0.498em;">р</span><span class="mjx-charbox MJXc-TeX-unknown-R" style="padding-bottom: 0.297em; width: 0.519em;">и</span><span class="mjx-charbox MJXc-TeX-unknown-R" style="padding-bottom: 0.297em; width: 0.519em;">н</span><span class="mjx-charbox MJXc-TeX-unknown-R" style="padding-bottom: 0.297em; width: 0.445em;">а</span><span class="mjx-charbox MJXc-TeX-unknown-R" style="padding-bottom: 0.297em; width: 0.456em;">д</span><span class="mjx-charbox MJXc-TeX-unknown-R" style="padding-bottom: 0.297em; width: 0.498em;">л</span><span class="mjx-charbox MJXc-TeX-unknown-R" style="padding-bottom: 0.297em; width: 0.466em;">е</span><span class="mjx-charbox MJXc-TeX-unknown-R" style="padding-bottom: 0.297em; width: 0.72em;">ж</span><span class="mjx-charbox MJXc-TeX-unknown-R" style="padding-bottom: 0.297em; width: 0.519em;">и</span><span class="mjx-charbox MJXc-TeX-unknown-R" style="padding-bottom: 0.297em; width: 0.434em;">т</span><span class="mjx-charbox MJXc-TeX-main-R" style="padding-bottom: 0.314em;"> </span><span class="mjx-charbox MJXc-TeX-unknown-R" style="padding-bottom: 0.297em; width: 0.498em;">к</span><span class="mjx-charbox MJXc-TeX-unknown-R" style="padding-bottom: 0.297em; width: 0.498em;">л</span><span class="mjx-charbox MJXc-TeX-unknown-R" style="padding-bottom: 0.297em; width: 0.445em;">а</span><span class="mjx-charbox MJXc-TeX-unknown-R" style="padding-bottom: 0.297em; width: 0.456em;">с</span><span class="mjx-charbox MJXc-TeX-unknown-R" style="padding-bottom: 0.297em; width: 0.456em;">с</span><span class="mjx-charbox MJXc-TeX-unknown-R" style="padding-bottom: 0.297em; width: 0.487em;">у</span></span></span><span id="MJXc-Node-1686" class="mjx-mspace" style="width: 0.278em; height: 0px;"></span><span id="MJXc-Node-1687" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.373em; padding-bottom: 0.373em;">0</span></span><span id="MJXc-Node-1688" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.479em; padding-bottom: 0.585em;">)</span></span></span></span></span></span><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mi>L</mi><mo>=</mo><mo>−</mo><msub><mi>y</mi><mi>i</mi></msub><mi>log</mi><mo>⁡</mo><mrow class="MJX-TeXAtom-ORD"><mi>P</mi><mo stretchy="false">(</mo><msub><mi>x</mi><mi>i</mi></msub><mspace width="thickmathspace"></mspace><mtext>принадлежит классу</mtext><mspace width="thickmathspace"></mspace><mn>1</mn><mo stretchy="false">)</mo></mrow><mo>−</mo><mo stretchy="false">(</mo><mn>1</mn><mo>−</mo><msub><mi>y</mi><mi>i</mi></msub><mo stretchy="false">)</mo><mi>log</mi><mo>⁡</mo><mrow class="MJX-TeXAtom-ORD"><mi>P</mi><mo stretchy="false">(</mo><msub><mi>x</mi><mi>i</mi></msub><mspace width="thickmathspace"></mspace><mtext>принадлежит классу</mtext><mspace width="thickmathspace"></mspace><mn>0</mn><mo stretchy="false">)</mo></mrow></math></span></span></span><script type="math/tex; mode=display" id="MathJax-Element-84">
L = -y_i\log{P(x_i\;\text{принадлежит классу}\;1)} - (1-y_i)\log{P(x_i\;\text{принадлежит классу}\;0)}
</script></span></li>
</ul>
</li>
</ul><h3 id="5-Bias-Variance-tradeoff" data-id="5-Bias-Variance-tradeoff"><a class="anchor hidden-xs" href="#5-Bias-Variance-tradeoff" title="5-Bias-Variance-tradeoff"><span class="octicon octicon-link"></span></a><span>5. Bias-Variance tradeoff.</span></h3><p><span>Ошибка любого алгоритма машинного обучения состоит из трёх компонент:</span></p><ul>
<li>
<p><strong><span>Bias</span></strong><span> (смещение) — отражает насколько предложенная модель совпадает с “реальной” зависимостью таргета от данных. Чем проще модель, тем выше смещение, т.к. реальные зависимости могут быть слишком сложными для них.</span></p>
</li>
<li>
<p><strong><span>Variance</span></strong><span> (разброс) — отражает чувствительность модели к обучающей выборке (как сильно изменится модель при небольшом изменении выборки). Чем сложнее алгоритм, тем выше его разброс, т.к. он легко переобучается под данную выборку и если немного её изменить, то модель изменится сильно (например, скачок в весах линейной регрессии). Если же у модели низкий разброс, то на разных подвыборках из одинакового распределения (т.е. при разных наборах данных с одинаковой природой) обученные модели будут достаточно похожи.</span><img src="https://i.imgur.com/8YExb2w.png" alt=""></p>
</li>
<li>
<p><strong><span>Шум в данных</span></strong><span> — данные всегда измеряются с некоторой ошибкой и не подчиняются какой-либо строгой зависимости, поэтому даже идеальный алгоритм может ошибаться.</span></p>
<ul>
<li><span>Например, неглубокое решающее дерево — простая модель, поэтому у неё будет высокое смещение, но низкий разброс. Глубокое же дерево легко переобучается, поэтому оно имеет высокий разброс, но низкое смещение.</span><br>
<img src="https://i.imgur.com/00HHq2x.png" alt=""></li>
</ul>
</li>
</ul><h3 id="6-Проблема-несбалансированных-классов" data-id="6-Проблема-несбалансированных-классов"><a class="anchor hidden-xs" href="#6-Проблема-несбалансированных-классов" title="6-Проблема-несбалансированных-классов"><span class="octicon octicon-link"></span></a><span>6. Проблема несбалансированных классов.</span></h3><p><em><span>Не акцентировалось внимание на лекциях.</span></em></p><ul>
<li><strong><span>Несбалансированная выборка</span></strong><span> — выборка, в которой объектов какого-то класса гораздо больше (или гораздо меньше, чем других).</span></li>
<li><span>Примеры задач с несбалансированной выборкой:</span>
<ul>
<li><span>Скачки курса валют — промежутков времени с резкими скачками гораздо меньше, чем с постепенным изменением.</span></li>
<li><span>Медицина — как правило, больных пациентов существуенно меньше чем здоровых.</span></li>
<li><span>Мошеннические транзакции — обычных транзакций гораздо больше чем “подозрительных”.</span></li>
</ul>
</li>
<li><strong><span>Основная проблема</span></strong><span> несбалансированных выборок: алгоритм, который относит все объекты к наибольшему классу уже является достаточно хорошим (с точки зрения функционала ошибки в том числе). Поэтому обычный подход к таким задачами обладает крайне низкими точностью или полнотой.</span></li>
<li><span>Другая проблема несбалансированных выборок — при делении выборки на блоки для кросс-валидации или на обучение-валидацию-тест, в одну из частей могут совсем не попасть представители меньшего класса. Поэтому необходимо использовать </span><em><span>стратификацию</span></em><span> — поддерживать в блоках такое же соотношение классов как в исходной выборке.</span></li>
<li><span>Методы работы с несбалансированной выборкой:</span>
<ul>
<li><span>Undersampling — “выбрасывание” части больших классов, чтобы убрать их преобладание. Минус этого подхода: появляется новый гиперпараметр — количество выбрасываемых объектов. Также мы сознательно уменьшаем размер нашей выборки, что весьма печально.</span></li>
<li><span>Oversampling — мы несколько раз копируем объекты меньшего класса и добавляем их в выборку, опять же, чтобы уравновесить соотношение классов. Минус этого подхода: мы, очевидно, теряем свойство </span><em><span>i.i.d.</span></em><span> выборки, что делает нашу модель менее устойчивой.</span></li>
</ul>
</li>
</ul><h3 id="7-Задача-снижения-размерности-Алгоритм-PCA-Связь-с-SVD-теорема-Эккарта-Янга-формулировка" data-id="7-Задача-снижения-размерности-Алгоритм-PCA-Связь-с-SVD-теорема-Эккарта-Янга-формулировка"><a class="anchor hidden-xs" href="#7-Задача-снижения-размерности-Алгоритм-PCA-Связь-с-SVD-теорема-Эккарта-Янга-формулировка" title="7-Задача-снижения-размерности-Алгоритм-PCA-Связь-с-SVD-теорема-Эккарта-Янга-формулировка"><span class="octicon octicon-link"></span></a><span>7. Задача снижения размерности. Алгоритм PCA. Связь с SVD, теорема Эккарта-Янга (формулировка).</span></h3><ul>
<li><strong><span>Задача снижения размерности</span></strong><span> (dimensionality reduction). Зачастую объекты в обучающей выборке имеют очень много признаков (сотни, тысячи и даже десятки тысяч). Большое количество признаков сильно замедляет обучение, его невозможно визуализировать и это может негативно влиять на качество модели. К тому же чем больше признаков, тем больше вероятность того, что какие-то из них будут сильно скоррелированы. Поэтому часто в машинном обучении используются разные приёмы для снижения размерности.</span></li>
<li><span>Одним из таких приёмов является </span><strong><span>PCA</span></strong><span> (Principal Component Analysis). Этот алгоритм работает на основе </span><strong><span>SVD</span></strong><span> (сингулярное разложение). Пусть </span><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-85-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 118%; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>X</mi></math>" role="presentation"><span id="MJXc-Node-1689" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-1690" class="mjx-mrow"><span id="MJXc-Node-1691" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.267em; padding-right: 0.024em;">X</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>X</mi></math></span></span><script type="math/tex" id="MathJax-Element-85">X</script></span><span> — матрица признаков и мы хотим оставить в ней только </span><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-86-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 118%; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>k</mi></math>" role="presentation"><span id="MJXc-Node-1692" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-1693" class="mjx-mrow"><span id="MJXc-Node-1694" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.267em;">k</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>k</mi></math></span></span><script type="math/tex" id="MathJax-Element-86">k</script></span><span> признаков:</span><br>
<span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span class="mjx-chtml MJXc-display" style="text-align: center;"><span id="MathJax-Element-87-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 118%; text-align: center; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><mtable rowspacing=&quot;3pt&quot; columnspacing=&quot;1em&quot; displaystyle=&quot;true&quot;><mtr><mtd><mi mathvariant=&quot;normal&quot;>&amp;#x2200;</mi><mi>X</mi><mspace width=&quot;mediummathspace&quot; /><mi mathvariant=&quot;normal&quot;>&amp;#x2203;</mi><mi>U</mi><mo>,</mo><mi mathvariant=&quot;normal&quot;>&amp;#x03A3;</mi><mo>,</mo><mi>V</mi><mspace width=&quot;thickmathspace&quot; /><mi>s</mi><mo>.</mo><mi>t</mi><mo>.</mo><mi>X</mi><mo>=</mo><mi>U</mi><mi mathvariant=&quot;normal&quot;>&amp;#x03A3;</mi><msup><mi>V</mi><mi>T</mi></msup><mo>,</mo></mtd></mtr><mtr><mtd><mi>U</mi><msup><mi>U</mi><mi>T</mi></msup><mo>=</mo><mi>E</mi><mo>,</mo><mspace width=&quot;thickmathspace&quot; /><mi>V</mi><msup><mi>V</mi><mi>T</mi></msup><mo>=</mo><mi>E</mi><mo>,</mo><mspace width=&quot;thickmathspace&quot; /><mi mathvariant=&quot;normal&quot;>&amp;#x03A3;</mi><mo>=</mo><mi>d</mi><mi>i</mi><mi>a</mi><mi>g</mi><mo stretchy=&quot;false&quot;>(</mo><msub><mi>&amp;#x03C3;</mi><mn>1</mn></msub><mo>,</mo><msub><mi>&amp;#x03C3;</mi><mn>2</mn></msub><mo>,</mo><mo>.</mo><mo>.</mo><mo>.</mo><msub><mi>&amp;#x03C3;</mi><mi>&amp;#x03C4;</mi></msub><mo stretchy=&quot;false&quot;>)</mo><mo>,</mo><mi>&amp;#x03C4;</mi><mo>=</mo><mtext>rank</mtext><mo stretchy=&quot;false&quot;>(</mo><mi>X</mi><mo stretchy=&quot;false&quot;>)</mo></mtd></mtr><mtr><mtd><msub><mi>X</mi><mi>k</mi></msub><mo>=</mo><mo stretchy=&quot;false&quot;>(</mo><msub><mi>U</mi><mi>k</mi></msub><msub><mi mathvariant=&quot;normal&quot;>&amp;#x03A3;</mi><mi>k</mi></msub><mo stretchy=&quot;false&quot;>)</mo><msubsup><mi>V</mi><mi>k</mi><mi>T</mi></msubsup></mtd></mtr></mtable></math>" role="presentation"><span id="MJXc-Node-1695" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-1696" class="mjx-mrow"><span id="MJXc-Node-1697" class="mjx-mtable" style="vertical-align: -1.82em; padding: 0px 0.167em;"><span class="mjx-table"><span id="MJXc-Node-1698" class="mjx-mtr" style="height: 1.278em;"><span id="MJXc-Node-1699" class="mjx-mtd" style="padding: 0px; width: 25.686em;"><span id="MJXc-Node-1700" class="mjx-mrow" style="margin-top: -0.091em;"><span id="MJXc-Node-1701" class="mjx-mi"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.426em; padding-bottom: 0.373em;">∀</span></span><span id="MJXc-Node-1702" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.267em; padding-right: 0.024em;">X</span></span><span id="MJXc-Node-1703" class="mjx-mspace" style="width: 0.222em; height: 0px;"></span><span id="MJXc-Node-1704" class="mjx-mi"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.426em; padding-bottom: 0.32em;">∃</span></span><span id="MJXc-Node-1705" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.32em; padding-right: 0.084em;">U</span></span><span id="MJXc-Node-1706" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="margin-top: -0.156em; padding-bottom: 0.532em;">,</span></span><span id="MJXc-Node-1707" class="mjx-mi MJXc-space1"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.373em; padding-bottom: 0.32em;">Σ</span></span><span id="MJXc-Node-1708" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="margin-top: -0.156em; padding-bottom: 0.532em;">,</span></span><span id="MJXc-Node-1709" class="mjx-mi MJXc-space1"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.32em; padding-right: 0.186em;">V</span></span><span id="MJXc-Node-1710" class="mjx-mspace" style="width: 0.278em; height: 0px;"></span><span id="MJXc-Node-1711" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.215em; padding-bottom: 0.267em;">s</span></span><span id="MJXc-Node-1712" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="margin-top: -0.156em; padding-bottom: 0.32em;">.</span></span><span id="MJXc-Node-1713" class="mjx-mi MJXc-space1"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.426em; padding-bottom: 0.267em;">t</span></span><span id="MJXc-Node-1714" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="margin-top: -0.156em; padding-bottom: 0.32em;">.</span></span><span id="MJXc-Node-1715" class="mjx-mi MJXc-space1"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.267em; padding-right: 0.024em;">X</span></span><span id="MJXc-Node-1716" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.056em; padding-bottom: 0.32em;">=</span></span><span id="MJXc-Node-1717" class="mjx-mi MJXc-space3"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.32em; padding-right: 0.084em;">U</span></span><span id="MJXc-Node-1718" class="mjx-mi"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.373em; padding-bottom: 0.32em;">Σ</span></span><span id="MJXc-Node-1719" class="mjx-msubsup"><span class="mjx-base" style="margin-right: -0.186em;"><span id="MJXc-Node-1720" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.32em; padding-right: 0.186em;">V</span></span></span><span class="mjx-sup" style="font-size: 70.7%; vertical-align: 0.584em; padding-left: 0.413em; padding-right: 0.071em;"><span id="MJXc-Node-1721" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.267em; padding-right: 0.12em;">T</span></span></span></span><span id="MJXc-Node-1722" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="margin-top: -0.156em; padding-bottom: 0.532em;">,</span></span><span class="mjx-strut"></span></span></span></span><span id="MJXc-Node-1723" class="mjx-mtr" style="height: 1.484em;"><span id="MJXc-Node-1724" class="mjx-mtd" style="padding: 0.15em 0px 0px;"><span id="MJXc-Node-1725" class="mjx-mrow" style="margin-top: -0.091em;"><span id="MJXc-Node-1726" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.32em; padding-right: 0.084em;">U</span></span><span id="MJXc-Node-1727" class="mjx-msubsup"><span class="mjx-base" style="margin-right: -0.084em;"><span id="MJXc-Node-1728" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.32em; padding-right: 0.084em;">U</span></span></span><span class="mjx-sup" style="font-size: 70.7%; vertical-align: 0.584em; padding-left: 0.225em; padding-right: 0.071em;"><span id="MJXc-Node-1729" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.267em; padding-right: 0.12em;">T</span></span></span></span><span id="MJXc-Node-1730" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.056em; padding-bottom: 0.32em;">=</span></span><span id="MJXc-Node-1731" class="mjx-mi MJXc-space3"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.267em; padding-right: 0.026em;">E</span></span><span id="MJXc-Node-1732" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="margin-top: -0.156em; padding-bottom: 0.532em;">,</span></span><span id="MJXc-Node-1733" class="mjx-mspace" style="width: 0.278em; height: 0px;"></span><span id="MJXc-Node-1734" class="mjx-mi MJXc-space1"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.32em; padding-right: 0.186em;">V</span></span><span id="MJXc-Node-1735" class="mjx-msubsup"><span class="mjx-base" style="margin-right: -0.186em;"><span id="MJXc-Node-1736" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.32em; padding-right: 0.186em;">V</span></span></span><span class="mjx-sup" style="font-size: 70.7%; vertical-align: 0.584em; padding-left: 0.413em; padding-right: 0.071em;"><span id="MJXc-Node-1737" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.267em; padding-right: 0.12em;">T</span></span></span></span><span id="MJXc-Node-1738" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.056em; padding-bottom: 0.32em;">=</span></span><span id="MJXc-Node-1739" class="mjx-mi MJXc-space3"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.267em; padding-right: 0.026em;">E</span></span><span id="MJXc-Node-1740" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="margin-top: -0.156em; padding-bottom: 0.532em;">,</span></span><span id="MJXc-Node-1741" class="mjx-mspace" style="width: 0.278em; height: 0px;"></span><span id="MJXc-Node-1742" class="mjx-mi MJXc-space1"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.373em; padding-bottom: 0.32em;">Σ</span></span><span id="MJXc-Node-1743" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.056em; padding-bottom: 0.32em;">=</span></span><span id="MJXc-Node-1744" class="mjx-mi MJXc-space3"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.267em; padding-right: 0.003em;">d</span></span><span id="MJXc-Node-1745" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.426em; padding-bottom: 0.267em;">i</span></span><span id="MJXc-Node-1746" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.215em; padding-bottom: 0.267em;">a</span></span><span id="MJXc-Node-1747" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.215em; padding-bottom: 0.479em; padding-right: 0.003em;">g</span></span><span id="MJXc-Node-1748" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.479em; padding-bottom: 0.585em;">(</span></span><span id="MJXc-Node-1749" class="mjx-msubsup"><span class="mjx-base" style="margin-right: -0.001em;"><span id="MJXc-Node-1750" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.215em; padding-bottom: 0.267em; padding-right: 0.001em;">σ</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-1751" class="mjx-mn" style=""><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.373em; padding-bottom: 0.32em;">1</span></span></span></span><span id="MJXc-Node-1752" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="margin-top: -0.156em; padding-bottom: 0.532em;">,</span></span><span id="MJXc-Node-1753" class="mjx-msubsup MJXc-space1"><span class="mjx-base" style="margin-right: -0.001em;"><span id="MJXc-Node-1754" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.215em; padding-bottom: 0.267em; padding-right: 0.001em;">σ</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-1755" class="mjx-mn" style=""><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.373em; padding-bottom: 0.32em;">2</span></span></span></span><span id="MJXc-Node-1756" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="margin-top: -0.156em; padding-bottom: 0.532em;">,</span></span><span id="MJXc-Node-1757" class="mjx-mo MJXc-space1"><span class="mjx-char MJXc-TeX-main-R" style="margin-top: -0.156em; padding-bottom: 0.32em;">.</span></span><span id="MJXc-Node-1758" class="mjx-mo MJXc-space1"><span class="mjx-char MJXc-TeX-main-R" style="margin-top: -0.156em; padding-bottom: 0.32em;">.</span></span><span id="MJXc-Node-1759" class="mjx-mo MJXc-space1"><span class="mjx-char MJXc-TeX-main-R" style="margin-top: -0.156em; padding-bottom: 0.32em;">.</span></span><span id="MJXc-Node-1760" class="mjx-msubsup MJXc-space1"><span class="mjx-base" style="margin-right: -0.001em;"><span id="MJXc-Node-1761" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.215em; padding-bottom: 0.267em; padding-right: 0.001em;">σ</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-1762" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.215em; padding-bottom: 0.267em; padding-right: 0.08em;">τ</span></span></span></span><span id="MJXc-Node-1763" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.479em; padding-bottom: 0.585em;">)</span></span><span id="MJXc-Node-1764" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="margin-top: -0.156em; padding-bottom: 0.532em;">,</span></span><span id="MJXc-Node-1765" class="mjx-mi MJXc-space1"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.215em; padding-bottom: 0.267em; padding-right: 0.08em;">τ</span></span><span id="MJXc-Node-1766" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.056em; padding-bottom: 0.32em;">=</span></span><span id="MJXc-Node-1767" class="mjx-mtext MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.426em; padding-bottom: 0.373em;">rank</span></span><span id="MJXc-Node-1768" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.479em; padding-bottom: 0.585em;">(</span></span><span id="MJXc-Node-1769" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.267em; padding-right: 0.024em;">X</span></span><span id="MJXc-Node-1770" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.479em; padding-bottom: 0.585em;">)</span></span><span class="mjx-strut"></span></span></span></span><span id="MJXc-Node-1771" class="mjx-mtr" style="height: 1.378em;"><span id="MJXc-Node-1772" class="mjx-mtd" style="padding: 0.15em 0px 0px;"><span id="MJXc-Node-1773" class="mjx-mrow" style="margin-top: -0.132em;"><span id="MJXc-Node-1774" class="mjx-msubsup"><span class="mjx-base" style="margin-right: -0.024em;"><span id="MJXc-Node-1775" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.267em; padding-right: 0.024em;">X</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.219em; padding-right: 0.071em;"><span id="MJXc-Node-1776" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.267em;">k</span></span></span></span><span id="MJXc-Node-1777" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.056em; padding-bottom: 0.32em;">=</span></span><span id="MJXc-Node-1778" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.479em; padding-bottom: 0.585em;">(</span></span><span id="MJXc-Node-1779" class="mjx-msubsup"><span class="mjx-base" style="margin-right: -0.084em;"><span id="MJXc-Node-1780" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.32em; padding-right: 0.084em;">U</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.219em; padding-right: 0.071em;"><span id="MJXc-Node-1781" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.267em;">k</span></span></span></span><span id="MJXc-Node-1782" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-1783" class="mjx-mi"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.373em; padding-bottom: 0.32em;">Σ</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.219em; padding-right: 0.071em;"><span id="MJXc-Node-1784" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.267em;">k</span></span></span></span><span id="MJXc-Node-1785" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.479em; padding-bottom: 0.585em;">)</span></span><span id="MJXc-Node-1786" class="mjx-msubsup"><span class="mjx-base" style="margin-right: -0.186em;"><span id="MJXc-Node-1787" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.32em; padding-right: 0.186em;">V</span></span></span><span class="mjx-stack" style="vertical-align: -0.335em;"><span class="mjx-sup" style="font-size: 70.7%; padding-bottom: 0.255em; padding-left: 0.413em; padding-right: 0.071em;"><span id="MJXc-Node-1789" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.267em; padding-right: 0.12em;">T</span></span></span><span class="mjx-sub" style="font-size: 70.7%; padding-right: 0.071em;"><span id="MJXc-Node-1788" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.267em;">k</span></span></span></span></span><span class="mjx-strut"></span></span></span></span></span></span></span></span><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mtable rowspacing="3pt" columnspacing="1em" displaystyle="true"><mtr><mtd><mi mathvariant="normal">∀</mi><mi>X</mi><mspace width="mediummathspace"></mspace><mi mathvariant="normal">∃</mi><mi>U</mi><mo>,</mo><mi mathvariant="normal">Σ</mi><mo>,</mo><mi>V</mi><mspace width="thickmathspace"></mspace><mi>s</mi><mo>.</mo><mi>t</mi><mo>.</mo><mi>X</mi><mo>=</mo><mi>U</mi><mi mathvariant="normal">Σ</mi><msup><mi>V</mi><mi>T</mi></msup><mo>,</mo></mtd></mtr><mtr><mtd><mi>U</mi><msup><mi>U</mi><mi>T</mi></msup><mo>=</mo><mi>E</mi><mo>,</mo><mspace width="thickmathspace"></mspace><mi>V</mi><msup><mi>V</mi><mi>T</mi></msup><mo>=</mo><mi>E</mi><mo>,</mo><mspace width="thickmathspace"></mspace><mi mathvariant="normal">Σ</mi><mo>=</mo><mi>d</mi><mi>i</mi><mi>a</mi><mi>g</mi><mo stretchy="false">(</mo><msub><mi>σ</mi><mn>1</mn></msub><mo>,</mo><msub><mi>σ</mi><mn>2</mn></msub><mo>,</mo><mo>.</mo><mo>.</mo><mo>.</mo><msub><mi>σ</mi><mi>τ</mi></msub><mo stretchy="false">)</mo><mo>,</mo><mi>τ</mi><mo>=</mo><mtext>rank</mtext><mo stretchy="false">(</mo><mi>X</mi><mo stretchy="false">)</mo></mtd></mtr><mtr><mtd><msub><mi>X</mi><mi>k</mi></msub><mo>=</mo><mo stretchy="false">(</mo><msub><mi>U</mi><mi>k</mi></msub><msub><mi mathvariant="normal">Σ</mi><mi>k</mi></msub><mo stretchy="false">)</mo><msubsup><mi>V</mi><mi>k</mi><mi>T</mi></msubsup></mtd></mtr></mtable></math></span></span></span><script type="math/tex; mode=display" id="MathJax-Element-87">
\begin{gather}
 \forall X\: \exists U,\Sigma,V \; s.t. X = U\Sigma V^T, \\
 UU^T = E,\;VV^T = E,\;\Sigma = diag(\sigma_1, \sigma_2, ... \sigma_\tau), \tau = \text{rank}(X) \\
 X_k = (U_k\Sigma_k)V_k^T
\end{gather}
</script></span><br>
<span>Здесь </span><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-88-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 118%; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>X</mi><mi>k</mi></msub></math>" role="presentation"><span id="MJXc-Node-1790" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-1791" class="mjx-mrow"><span id="MJXc-Node-1792" class="mjx-msubsup"><span class="mjx-base" style="margin-right: -0.024em;"><span id="MJXc-Node-1793" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.267em; padding-right: 0.024em;">X</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.219em; padding-right: 0.071em;"><span id="MJXc-Node-1794" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.267em;">k</span></span></span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>X</mi><mi>k</mi></msub></math></span></span><script type="math/tex" id="MathJax-Element-88">X_k</script></span><span> — матрица ранга </span><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-89-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 118%; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>k</mi></math>" role="presentation"><span id="MJXc-Node-1795" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-1796" class="mjx-mrow"><span id="MJXc-Node-1797" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.267em;">k</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>k</mi></math></span></span><script type="math/tex" id="MathJax-Element-89">k</script></span><span>, приближающая исходную матрицу признаков. </span><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-90-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 118%; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msubsup><mi>V</mi><mi>k</mi><mi>T</mi></msubsup></math>" role="presentation"><span id="MJXc-Node-1798" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-1799" class="mjx-mrow"><span id="MJXc-Node-1800" class="mjx-msubsup"><span class="mjx-base" style="margin-right: -0.186em;"><span id="MJXc-Node-1801" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.32em; padding-right: 0.186em;">V</span></span></span><span class="mjx-stack" style="vertical-align: -0.335em;"><span class="mjx-sup" style="font-size: 70.7%; padding-bottom: 0.255em; padding-left: 0.413em; padding-right: 0.071em;"><span id="MJXc-Node-1803" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.267em; padding-right: 0.12em;">T</span></span></span><span class="mjx-sub" style="font-size: 70.7%; padding-right: 0.071em;"><span id="MJXc-Node-1802" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.267em;">k</span></span></span></span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msubsup><mi>V</mi><mi>k</mi><mi>T</mi></msubsup></math></span></span><script type="math/tex" id="MathJax-Element-90">V_k^T</script></span><span> — первые </span><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-91-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 118%; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>k</mi></math>" role="presentation"><span id="MJXc-Node-1804" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-1805" class="mjx-mrow"><span id="MJXc-Node-1806" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.267em;">k</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>k</mi></math></span></span><script type="math/tex" id="MathJax-Element-91">k</script></span><span> строк матрицы </span><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-92-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 118%; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msup><mi>V</mi><mi>T</mi></msup></math>" role="presentation"><span id="MJXc-Node-1807" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-1808" class="mjx-mrow"><span id="MJXc-Node-1809" class="mjx-msubsup"><span class="mjx-base" style="margin-right: -0.186em;"><span id="MJXc-Node-1810" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.32em; padding-right: 0.186em;">V</span></span></span><span class="mjx-sup" style="font-size: 70.7%; vertical-align: 0.513em; padding-left: 0.413em; padding-right: 0.071em;"><span id="MJXc-Node-1811" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.267em; padding-right: 0.12em;">T</span></span></span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msup><mi>V</mi><mi>T</mi></msup></math></span></span><script type="math/tex" id="MathJax-Element-92">V^T</script></span><span> (их мы используем в качестве нового базиса), </span><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-93-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 118%; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi mathvariant=&quot;normal&quot;>&amp;#x03A3;</mi><mi>k</mi></msub></math>" role="presentation"><span id="MJXc-Node-1812" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-1813" class="mjx-mrow"><span id="MJXc-Node-1814" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-1815" class="mjx-mi"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.373em; padding-bottom: 0.32em;">Σ</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.219em; padding-right: 0.071em;"><span id="MJXc-Node-1816" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.267em;">k</span></span></span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi mathvariant="normal">Σ</mi><mi>k</mi></msub></math></span></span><script type="math/tex" id="MathJax-Element-93">\Sigma_k</script></span><span> — квадратная подматрица </span><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-94-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 118%; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>k</mi><mo>&amp;#x00D7;</mo><mi>k</mi></math>" role="presentation"><span id="MJXc-Node-1817" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-1818" class="mjx-mrow"><span id="MJXc-Node-1819" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.267em;">k</span></span><span id="MJXc-Node-1820" class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.215em; padding-bottom: 0.32em;">×</span></span><span id="MJXc-Node-1821" class="mjx-mi MJXc-space2"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.267em;">k</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>k</mi><mo>×</mo><mi>k</mi></math></span></span><script type="math/tex" id="MathJax-Element-94">k \times k</script></span><span> из </span><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-95-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 118%; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi mathvariant=&quot;normal&quot;>&amp;#x03A3;</mi><mo>,</mo></math>" role="presentation"><span id="MJXc-Node-1822" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-1823" class="mjx-mrow"><span id="MJXc-Node-1824" class="mjx-mi"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.373em; padding-bottom: 0.32em;">Σ</span></span><span id="MJXc-Node-1825" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="margin-top: -0.156em; padding-bottom: 0.532em;">,</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi mathvariant="normal">Σ</mi><mo>,</mo></math></span></span><script type="math/tex" id="MathJax-Element-95">\Sigma,</script></span><span> </span><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-96-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 118%; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>U</mi><mi>k</mi></msub></math>" role="presentation"><span id="MJXc-Node-1826" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-1827" class="mjx-mrow"><span id="MJXc-Node-1828" class="mjx-msubsup"><span class="mjx-base" style="margin-right: -0.084em;"><span id="MJXc-Node-1829" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.32em; padding-right: 0.084em;">U</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.219em; padding-right: 0.071em;"><span id="MJXc-Node-1830" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.267em;">k</span></span></span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>U</mi><mi>k</mi></msub></math></span></span><script type="math/tex" id="MathJax-Element-96">U_k</script></span><span> — первые </span><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-97-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 118%; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>k</mi></math>" role="presentation"><span id="MJXc-Node-1831" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-1832" class="mjx-mrow"><span id="MJXc-Node-1833" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.267em;">k</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>k</mi></math></span></span><script type="math/tex" id="MathJax-Element-97">k</script></span><span> столбцов матрицы </span><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-98-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 118%; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>U</mi><mo>.</mo></math>" role="presentation"><span id="MJXc-Node-1834" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-1835" class="mjx-mrow"><span id="MJXc-Node-1836" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.32em; padding-right: 0.084em;">U</span></span><span id="MJXc-Node-1837" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="margin-top: -0.156em; padding-bottom: 0.32em;">.</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>U</mi><mo>.</mo></math></span></span><script type="math/tex" id="MathJax-Element-98">U.</script></span><span> Соответственно </span><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-99-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 118%; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>U</mi><mi>k</mi></msub><msub><mi mathvariant=&quot;normal&quot;>&amp;#x03A3;</mi><mi>k</mi></msub></math>" role="presentation"><span id="MJXc-Node-1838" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-1839" class="mjx-mrow"><span id="MJXc-Node-1840" class="mjx-msubsup"><span class="mjx-base" style="margin-right: -0.084em;"><span id="MJXc-Node-1841" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.32em; padding-right: 0.084em;">U</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.219em; padding-right: 0.071em;"><span id="MJXc-Node-1842" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.267em;">k</span></span></span></span><span id="MJXc-Node-1843" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-1844" class="mjx-mi"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.373em; padding-bottom: 0.32em;">Σ</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.219em; padding-right: 0.071em;"><span id="MJXc-Node-1845" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.267em;">k</span></span></span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>U</mi><mi>k</mi></msub><msub><mi mathvariant="normal">Σ</mi><mi>k</mi></msub></math></span></span><script type="math/tex" id="MathJax-Element-99">U_k\Sigma_k</script></span><span> — матрица перехода между новым и старым базисом. Такое преобразование называется </span><em><span>Truncated SVD,</span></em><span> и </span><strong><span>новой матрицей призаков</span></strong><span> будет матрица </span><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-100-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 118%; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msubsup><mi>U</mi><mi>k</mi><mi>T</mi></msubsup><msub><mi mathvariant=&quot;normal&quot;>&amp;#x03A3;</mi><mi>k</mi></msub></math>" role="presentation"><span id="MJXc-Node-1846" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-1847" class="mjx-mrow"><span id="MJXc-Node-1848" class="mjx-msubsup"><span class="mjx-base" style="margin-right: -0.084em;"><span id="MJXc-Node-1849" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.32em; padding-right: 0.084em;">U</span></span></span><span class="mjx-stack" style="vertical-align: -0.335em;"><span class="mjx-sup" style="font-size: 70.7%; padding-bottom: 0.255em; padding-left: 0.225em; padding-right: 0.071em;"><span id="MJXc-Node-1851" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.267em; padding-right: 0.12em;">T</span></span></span><span class="mjx-sub" style="font-size: 70.7%; padding-right: 0.071em;"><span id="MJXc-Node-1850" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.267em;">k</span></span></span></span></span><span id="MJXc-Node-1852" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-1853" class="mjx-mi"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.373em; padding-bottom: 0.32em;">Σ</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.219em; padding-right: 0.071em;"><span id="MJXc-Node-1854" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.267em;">k</span></span></span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msubsup><mi>U</mi><mi>k</mi><mi>T</mi></msubsup><msub><mi mathvariant="normal">Σ</mi><mi>k</mi></msub></math></span></span><script type="math/tex" id="MathJax-Element-100">U_k^T\Sigma_k</script></span><br>
<img src="https://i.imgur.com/TnVr692.png" alt=""></li>
<li><strong><span>Теорема Эккарта-Янга.</span></strong><br>
<span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span class="mjx-chtml MJXc-display" style="text-align: center;"><span id="MathJax-Element-101-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 118%; text-align: center; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><mtable rowspacing=&quot;3pt&quot; columnspacing=&quot;1em&quot; displaystyle=&quot;true&quot;><mtr><mtd><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>|</mo></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>|</mo></mrow><mi>X</mi><mo>&amp;#x2212;</mo><mo stretchy=&quot;false&quot;>(</mo><msub><mi>U</mi><mi>k</mi></msub><msub><mi mathvariant=&quot;normal&quot;>&amp;#x03A3;</mi><mi>k</mi></msub><mo stretchy=&quot;false&quot;>)</mo><msubsup><mi>V</mi><mi>k</mi><mi>T</mi></msubsup><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>|</mo></mrow><msub><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>|</mo></mrow><mi>F</mi></msub><mo>=</mo><munder><mo movablelimits=&quot;true&quot; form=&quot;prefix&quot;>min</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>B</mi><mspace width=&quot;mediummathspace&quot; /><mi>s</mi><mo>.</mo><mi>t</mi><mo>.</mo><mspace width=&quot;mediummathspace&quot; /><mtext>rank</mtext><mo stretchy=&quot;false&quot;>(</mo><mi>B</mi><mo stretchy=&quot;false&quot;>)</mo><mo>=</mo><mi>k</mi></mrow></munder><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>|</mo></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>|</mo></mrow><mi>X</mi><mo>&amp;#x2212;</mo><mi>B</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>|</mo></mrow><msub><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>|</mo></mrow><mi>F</mi></msub></mtd></mtr></mtable></math>" role="presentation"><span id="MJXc-Node-1855" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-1856" class="mjx-mrow"><span id="MJXc-Node-1857" class="mjx-mtable" style="vertical-align: -0.701em; padding: 0px 0.167em;"><span class="mjx-table"><span id="MJXc-Node-1858" class="mjx-mtr" style="height: 1.902em;"><span id="MJXc-Node-1859" class="mjx-mtd" style="padding: 0px; width: 19.247em;"><span id="MJXc-Node-1860" class="mjx-mrow" style="margin-top: -0.132em;"><span id="MJXc-Node-1861" class="mjx-texatom"><span id="MJXc-Node-1862" class="mjx-mrow"><span id="MJXc-Node-1863" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.479em; padding-bottom: 0.585em;">|</span></span></span></span><span id="MJXc-Node-1864" class="mjx-texatom"><span id="MJXc-Node-1865" class="mjx-mrow"><span id="MJXc-Node-1866" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.479em; padding-bottom: 0.585em;">|</span></span></span></span><span id="MJXc-Node-1867" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.267em; padding-right: 0.024em;">X</span></span><span id="MJXc-Node-1868" class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.32em; padding-bottom: 0.426em;">−</span></span><span id="MJXc-Node-1869" class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.479em; padding-bottom: 0.585em;">(</span></span><span id="MJXc-Node-1870" class="mjx-msubsup"><span class="mjx-base" style="margin-right: -0.084em;"><span id="MJXc-Node-1871" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.32em; padding-right: 0.084em;">U</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.219em; padding-right: 0.071em;"><span id="MJXc-Node-1872" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.267em;">k</span></span></span></span><span id="MJXc-Node-1873" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-1874" class="mjx-mi"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.373em; padding-bottom: 0.32em;">Σ</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.219em; padding-right: 0.071em;"><span id="MJXc-Node-1875" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.267em;">k</span></span></span></span><span id="MJXc-Node-1876" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.479em; padding-bottom: 0.585em;">)</span></span><span id="MJXc-Node-1877" class="mjx-msubsup"><span class="mjx-base" style="margin-right: -0.186em;"><span id="MJXc-Node-1878" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.32em; padding-right: 0.186em;">V</span></span></span><span class="mjx-stack" style="vertical-align: -0.335em;"><span class="mjx-sup" style="font-size: 70.7%; padding-bottom: 0.255em; padding-left: 0.413em; padding-right: 0.071em;"><span id="MJXc-Node-1880" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.267em; padding-right: 0.12em;">T</span></span></span><span class="mjx-sub" style="font-size: 70.7%; padding-right: 0.071em;"><span id="MJXc-Node-1879" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.267em;">k</span></span></span></span></span><span id="MJXc-Node-1881" class="mjx-texatom"><span id="MJXc-Node-1882" class="mjx-mrow"><span id="MJXc-Node-1883" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.479em; padding-bottom: 0.585em;">|</span></span></span></span><span id="MJXc-Node-1884" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-1885" class="mjx-texatom"><span id="MJXc-Node-1886" class="mjx-mrow"><span id="MJXc-Node-1887" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.479em; padding-bottom: 0.585em;">|</span></span></span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.437em; padding-right: 0.071em;"><span id="MJXc-Node-1888" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.267em; padding-right: 0.106em;">F</span></span></span></span><span id="MJXc-Node-1889" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.056em; padding-bottom: 0.32em;">=</span></span><span id="MJXc-Node-1890" class="mjx-munderover MJXc-space3"><span class="mjx-itable"><span class="mjx-row"><span class="mjx-cell"><span class="mjx-op" style="padding-left: 1.848em;"><span id="MJXc-Node-1891" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.373em; padding-bottom: 0.32em;">min</span></span></span></span></span><span class="mjx-row"><span class="mjx-under" style="font-size: 70.7%; padding-top: 0.236em; padding-bottom: 0.141em;"><span id="MJXc-Node-1892" class="mjx-texatom" style=""><span id="MJXc-Node-1893" class="mjx-mrow"><span id="MJXc-Node-1894" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.267em;">B</span></span><span id="MJXc-Node-1895" class="mjx-mspace" style="font-size: 141.4%; width: 0.222em; height: 0px;"></span><span id="MJXc-Node-1896" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.215em; padding-bottom: 0.267em;">s</span></span><span id="MJXc-Node-1897" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="margin-top: -0.156em; padding-bottom: 0.32em;">.</span></span><span id="MJXc-Node-1898" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.426em; padding-bottom: 0.267em;">t</span></span><span id="MJXc-Node-1899" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="margin-top: -0.156em; padding-bottom: 0.32em;">.</span></span><span id="MJXc-Node-1900" class="mjx-mspace" style="font-size: 141.4%; width: 0.222em; height: 0px;"></span><span id="MJXc-Node-1901" class="mjx-mtext"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.426em; padding-bottom: 0.373em;">rank</span></span><span id="MJXc-Node-1902" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.479em; padding-bottom: 0.585em;">(</span></span><span id="MJXc-Node-1903" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.267em;">B</span></span><span id="MJXc-Node-1904" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.479em; padding-bottom: 0.585em;">)</span></span><span id="MJXc-Node-1905" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.056em; padding-bottom: 0.32em;">=</span></span><span id="MJXc-Node-1906" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.267em;">k</span></span></span></span></span></span></span></span><span id="MJXc-Node-1907" class="mjx-texatom MJXc-space1"><span id="MJXc-Node-1908" class="mjx-mrow"><span id="MJXc-Node-1909" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.479em; padding-bottom: 0.585em;">|</span></span></span></span><span id="MJXc-Node-1910" class="mjx-texatom"><span id="MJXc-Node-1911" class="mjx-mrow"><span id="MJXc-Node-1912" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.479em; padding-bottom: 0.585em;">|</span></span></span></span><span id="MJXc-Node-1913" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.267em; padding-right: 0.024em;">X</span></span><span id="MJXc-Node-1914" class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.32em; padding-bottom: 0.426em;">−</span></span><span id="MJXc-Node-1915" class="mjx-mi MJXc-space2"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.267em;">B</span></span><span id="MJXc-Node-1916" class="mjx-texatom"><span id="MJXc-Node-1917" class="mjx-mrow"><span id="MJXc-Node-1918" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.479em; padding-bottom: 0.585em;">|</span></span></span></span><span id="MJXc-Node-1919" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-1920" class="mjx-texatom"><span id="MJXc-Node-1921" class="mjx-mrow"><span id="MJXc-Node-1922" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.479em; padding-bottom: 0.585em;">|</span></span></span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.437em; padding-right: 0.071em;"><span id="MJXc-Node-1923" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.267em; padding-right: 0.106em;">F</span></span></span></span><span class="mjx-strut"></span></span></span></span></span></span></span></span><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mtable rowspacing="3pt" columnspacing="1em" displaystyle="true"><mtr><mtd><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><mi>X</mi><mo>−</mo><mo stretchy="false">(</mo><msub><mi>U</mi><mi>k</mi></msub><msub><mi mathvariant="normal">Σ</mi><mi>k</mi></msub><mo stretchy="false">)</mo><msubsup><mi>V</mi><mi>k</mi><mi>T</mi></msubsup><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><msub><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><mi>F</mi></msub><mo>=</mo><munder><mo movablelimits="true" form="prefix">min</mo><mrow class="MJX-TeXAtom-ORD"><mi>B</mi><mspace width="mediummathspace"></mspace><mi>s</mi><mo>.</mo><mi>t</mi><mo>.</mo><mspace width="mediummathspace"></mspace><mtext>rank</mtext><mo stretchy="false">(</mo><mi>B</mi><mo stretchy="false">)</mo><mo>=</mo><mi>k</mi></mrow></munder><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><mi>X</mi><mo>−</mo><mi>B</mi><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><msub><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><mi>F</mi></msub></mtd></mtr></mtable></math></span></span></span><script type="math/tex; mode=display" id="MathJax-Element-101">
\begin{gather}
 ||X - (U_k\Sigma_k)V_k^T||_F = \min_{B\:s.t.\:\text{rank}(B) = k} ||X - B||_F
\end{gather}
</script></span><br>
<span>То есть truncated SVD даёт лучшее (в смысле нормы разности) приближение матрицы </span><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-102-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 118%; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>X</mi></math>" role="presentation"><span id="MJXc-Node-1924" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-1925" class="mjx-mrow"><span id="MJXc-Node-1926" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.267em; padding-right: 0.024em;">X</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>X</mi></math></span></span><script type="math/tex" id="MathJax-Element-102">X</script></span><span> матрицей ранга </span><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-103-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 118%; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>k</mi><mo>.</mo></math>" role="presentation"><span id="MJXc-Node-1927" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-1928" class="mjx-mrow"><span id="MJXc-Node-1929" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.267em;">k</span></span><span id="MJXc-Node-1930" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="margin-top: -0.156em; padding-bottom: 0.32em;">.</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>k</mi><mo>.</mo></math></span></span><script type="math/tex" id="MathJax-Element-103">k.</script></span>
<ul>
<li><span>Напоминание: </span><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-104-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 118%; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>|</mo></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>|</mo></mrow><mi>A</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>|</mo></mrow><msubsup><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>|</mo></mrow><mi>F</mi><mn>2</mn></msubsup><mo>=</mo><munderover><mo movablelimits=&quot;false&quot;>&amp;#x2211;</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>n</mi></munderover><munderover><mo movablelimits=&quot;false&quot;>&amp;#x2211;</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>j</mi><mo>=</mo><mn>1</mn></mrow><mi>m</mi></munderover><msubsup><mi>a</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>i</mi><mi>j</mi></mrow><mn>2</mn></msubsup></math>" role="presentation"><span id="MJXc-Node-1931" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-1932" class="mjx-mrow"><span id="MJXc-Node-1933" class="mjx-texatom"><span id="MJXc-Node-1934" class="mjx-mrow"><span id="MJXc-Node-1935" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.479em; padding-bottom: 0.585em;">|</span></span></span></span><span id="MJXc-Node-1936" class="mjx-texatom"><span id="MJXc-Node-1937" class="mjx-mrow"><span id="MJXc-Node-1938" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.479em; padding-bottom: 0.585em;">|</span></span></span></span><span id="MJXc-Node-1939" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.267em;">A</span></span><span id="MJXc-Node-1940" class="mjx-texatom"><span id="MJXc-Node-1941" class="mjx-mrow"><span id="MJXc-Node-1942" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.479em; padding-bottom: 0.585em;">|</span></span></span></span><span id="MJXc-Node-1943" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-1944" class="mjx-texatom"><span id="MJXc-Node-1945" class="mjx-mrow"><span id="MJXc-Node-1946" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.479em; padding-bottom: 0.585em;">|</span></span></span></span></span><span class="mjx-stack" style="vertical-align: -0.309em;"><span class="mjx-sup" style="font-size: 70.7%; padding-bottom: 0.417em; padding-left: 0px; padding-right: 0.071em;"><span id="MJXc-Node-1948" class="mjx-mn" style=""><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.373em; padding-bottom: 0.32em;">2</span></span></span><span class="mjx-sub" style="font-size: 70.7%; padding-right: 0.071em;"><span id="MJXc-Node-1947" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.267em; padding-right: 0.106em;">F</span></span></span></span></span><span id="MJXc-Node-1949" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.056em; padding-bottom: 0.32em;">=</span></span><span id="MJXc-Node-1950" class="mjx-munderover MJXc-space3"><span class="mjx-itable"><span class="mjx-row"><span class="mjx-cell"><span class="mjx-stack"><span class="mjx-over" style="font-size: 70.7%; padding-bottom: 0.247em; padding-top: 0.141em; padding-left: 0.512em;"><span id="MJXc-Node-1957" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.215em; padding-bottom: 0.267em;">n</span></span></span><span class="mjx-op" style="padding-left: 0.046em;"><span id="MJXc-Node-1951" class="mjx-mo"><span class="mjx-char MJXc-TeX-size1-R" style="padding-top: 0.532em; padding-bottom: 0.532em;">∑</span></span></span></span></span></span><span class="mjx-row"><span class="mjx-under" style="font-size: 70.7%; padding-top: 0.236em; padding-bottom: 0.141em;"><span id="MJXc-Node-1952" class="mjx-texatom" style=""><span id="MJXc-Node-1953" class="mjx-mrow"><span id="MJXc-Node-1954" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.426em; padding-bottom: 0.267em;">i</span></span><span id="MJXc-Node-1955" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.056em; padding-bottom: 0.32em;">=</span></span><span id="MJXc-Node-1956" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.373em; padding-bottom: 0.32em;">1</span></span></span></span></span></span></span></span><span id="MJXc-Node-1958" class="mjx-munderover MJXc-space1"><span class="mjx-itable"><span class="mjx-row"><span class="mjx-cell"><span class="mjx-stack"><span class="mjx-over" style="font-size: 70.7%; padding-bottom: 0.247em; padding-top: 0.141em; padding-left: 0.406em;"><span id="MJXc-Node-1965" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.215em; padding-bottom: 0.267em;">m</span></span></span><span class="mjx-op" style="padding-left: 0.07em;"><span id="MJXc-Node-1959" class="mjx-mo"><span class="mjx-char MJXc-TeX-size1-R" style="padding-top: 0.532em; padding-bottom: 0.532em;">∑</span></span></span></span></span></span><span class="mjx-row"><span class="mjx-under" style="font-size: 70.7%; padding-top: 0.236em; padding-bottom: 0.141em;"><span id="MJXc-Node-1960" class="mjx-texatom" style=""><span id="MJXc-Node-1961" class="mjx-mrow"><span id="MJXc-Node-1962" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.426em; padding-bottom: 0.479em;">j</span></span><span id="MJXc-Node-1963" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.056em; padding-bottom: 0.32em;">=</span></span><span id="MJXc-Node-1964" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.373em; padding-bottom: 0.32em;">1</span></span></span></span></span></span></span></span><span id="MJXc-Node-1966" class="mjx-msubsup MJXc-space1"><span class="mjx-base"><span id="MJXc-Node-1967" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.215em; padding-bottom: 0.267em;">a</span></span></span><span class="mjx-stack" style="vertical-align: -0.311em;"><span class="mjx-sup" style="font-size: 70.7%; padding-bottom: 0.255em; padding-left: 0px; padding-right: 0.071em;"><span id="MJXc-Node-1972" class="mjx-mn" style=""><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.373em; padding-bottom: 0.32em;">2</span></span></span><span class="mjx-sub" style="font-size: 70.7%; padding-right: 0.071em;"><span id="MJXc-Node-1968" class="mjx-texatom" style=""><span id="MJXc-Node-1969" class="mjx-mrow"><span id="MJXc-Node-1970" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.426em; padding-bottom: 0.267em;">i</span></span><span id="MJXc-Node-1971" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.426em; padding-bottom: 0.479em;">j</span></span></span></span></span></span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><mi>A</mi><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><msubsup><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><mi>F</mi><mn>2</mn></msubsup><mo>=</mo><munderover><mo movablelimits="false">∑</mo><mrow class="MJX-TeXAtom-ORD"><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>n</mi></munderover><munderover><mo movablelimits="false">∑</mo><mrow class="MJX-TeXAtom-ORD"><mi>j</mi><mo>=</mo><mn>1</mn></mrow><mi>m</mi></munderover><msubsup><mi>a</mi><mrow class="MJX-TeXAtom-ORD"><mi>i</mi><mi>j</mi></mrow><mn>2</mn></msubsup></math></span></span><script type="math/tex" id="MathJax-Element-104">||A||_F^2 = \sum\limits_{i = 1}^n\sum\limits_{j = 1}^m a_{ij}^2</script></span><span> - </span><em><span>норма Фробениуса</span></em></li>
</ul>
</li>
<li><span>Отметим, что столбцы матрицы </span><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-105-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 118%; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>U</mi><mi>k</mi></msub><msub><mi mathvariant=&quot;normal&quot;>&amp;#x03A3;</mi><mi>k</mi></msub></math>" role="presentation"><span id="MJXc-Node-1973" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-1974" class="mjx-mrow"><span id="MJXc-Node-1975" class="mjx-msubsup"><span class="mjx-base" style="margin-right: -0.084em;"><span id="MJXc-Node-1976" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.32em; padding-right: 0.084em;">U</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.219em; padding-right: 0.071em;"><span id="MJXc-Node-1977" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.267em;">k</span></span></span></span><span id="MJXc-Node-1978" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-1979" class="mjx-mi"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.373em; padding-bottom: 0.32em;">Σ</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.219em; padding-right: 0.071em;"><span id="MJXc-Node-1980" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.267em;">k</span></span></span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>U</mi><mi>k</mi></msub><msub><mi mathvariant="normal">Σ</mi><mi>k</mi></msub></math></span></span><script type="math/tex" id="MathJax-Element-105">U_k\Sigma_k</script></span><span> в этом случае называются </span><em><span>главными компонентами,</span></em><span> а столбцы матрицы </span><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-106-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 118%; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>V</mi><mi>k</mi></msub></math>" role="presentation"><span id="MJXc-Node-1981" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-1982" class="mjx-mrow"><span id="MJXc-Node-1983" class="mjx-msubsup"><span class="mjx-base" style="margin-right: -0.186em;"><span id="MJXc-Node-1984" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.32em; padding-right: 0.186em;">V</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.219em; padding-right: 0.071em;"><span id="MJXc-Node-1985" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.267em;">k</span></span></span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>V</mi><mi>k</mi></msub></math></span></span><script type="math/tex" id="MathJax-Element-106">V_k</script></span><span> — </span><em><span>главными направлениями.</span></em></li>
<li><span>В матрице </span><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-107-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 118%; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi mathvariant=&quot;normal&quot;>&amp;#x03A3;</mi></math>" role="presentation"><span id="MJXc-Node-1986" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-1987" class="mjx-mrow"><span id="MJXc-Node-1988" class="mjx-mi"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.373em; padding-bottom: 0.32em;">Σ</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi mathvariant="normal">Σ</mi></math></span></span><script type="math/tex" id="MathJax-Element-107">\Sigma</script></span><span> элементы на диагонали интерпретируются как </span><strong><span>дисперсия выборки</span></strong><span> вдоль соответствующего направления. Также эти элементы расположены по убыванию вдоль диагонали. Соответственно когда мы используем в разложении первые </span><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-108-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 118%; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>k</mi></math>" role="presentation"><span id="MJXc-Node-1989" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-1990" class="mjx-mrow"><span id="MJXc-Node-1991" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.267em;">k</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>k</mi></math></span></span><script type="math/tex" id="MathJax-Element-108">k</script></span><span> элементов этой матрицы, мы используем </span><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-109-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 118%; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>k</mi></math>" role="presentation"><span id="MJXc-Node-1992" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-1993" class="mjx-mrow"><span id="MJXc-Node-1994" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.267em;">k</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>k</mi></math></span></span><script type="math/tex" id="MathJax-Element-109">k</script></span><span> направлений, которые “объясняют” наибольшую часть дисперсии выборки.</span><br>
<img src="https://i.imgur.com/kMiq0an.png" alt=""></li>
<li><strong><span>Важное замечание:</span></strong><span> PCA можно использовать только после нормировки данных (вычесть среднее, поделить на дисперсию для каждого признака), чтобы признаки были в одном масштабе.</span></li>
</ul><h3 id="8-Понятие-информации-информационной-энтропии-Критерии-информативности-энтропийный-Джини" data-id="8-Понятие-информации-информационной-энтропии-Критерии-информативности-энтропийный-Джини"><a class="anchor hidden-xs" href="#8-Понятие-информации-информационной-энтропии-Критерии-информативности-энтропийный-Джини" title="8-Понятие-информации-информационной-энтропии-Критерии-информативности-энтропийный-Джини"><span class="octicon octicon-link"></span></a><span>8. Понятие информации, информационной энтропии. Критерии информативности: энтропийный, Джини.</span></h3><ul>
<li><span>Для построения деревьев используются критерии информативности </span><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-110-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 118%; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>H</mi><mo stretchy=&quot;false&quot;>(</mo><mi>X</mi><mo stretchy=&quot;false&quot;>)</mo><mo>.</mo></math>" role="presentation"><span id="MJXc-Node-1995" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-1996" class="mjx-mrow"><span id="MJXc-Node-1997" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.267em; padding-right: 0.057em;">H</span></span><span id="MJXc-Node-1998" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.479em; padding-bottom: 0.585em;">(</span></span><span id="MJXc-Node-1999" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.267em; padding-right: 0.024em;">X</span></span><span id="MJXc-Node-2000" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.479em; padding-bottom: 0.585em;">)</span></span><span id="MJXc-Node-2001" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="margin-top: -0.156em; padding-bottom: 0.32em;">.</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>H</mi><mo stretchy="false">(</mo><mi>X</mi><mo stretchy="false">)</mo><mo>.</mo></math></span></span><script type="math/tex" id="MathJax-Element-110">H(X).</script></span><span> Они показывают насколько “однородна” или “упорядочена” подвыборка </span><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-111-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 118%; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>X</mi><mo>.</mo></math>" role="presentation"><span id="MJXc-Node-2002" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-2003" class="mjx-mrow"><span id="MJXc-Node-2004" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.267em; padding-right: 0.024em;">X</span></span><span id="MJXc-Node-2005" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="margin-top: -0.156em; padding-bottom: 0.32em;">.</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>X</mi><mo>.</mo></math></span></span><script type="math/tex" id="MathJax-Element-111">X.</script></span><span> При выборе признака и границы в вершине дерева мы выбираем такие значения, чтобы взвешенная сумма значений критериев информативности была минимальной.</span></li>
<li><span>Энтропийный критерий: </span><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-112-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 118%; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>H</mi><mo stretchy=&quot;false&quot;>(</mo><mi>X</mi><mo stretchy=&quot;false&quot;>)</mo><mo>=</mo><mo>&amp;#x2212;</mo><munderover><mo movablelimits=&quot;false&quot;>&amp;#x2211;</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>k</mi><mo>=</mo><mn>1</mn></mrow><mi>K</mi></munderover><msub><mi>p</mi><mi>k</mi></msub><mi>log</mi><mo>&amp;#x2061;</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><msub><mi>p</mi><mi>k</mi></msub></mrow></math>" role="presentation"><span id="MJXc-Node-2006" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-2007" class="mjx-mrow"><span id="MJXc-Node-2008" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.267em; padding-right: 0.057em;">H</span></span><span id="MJXc-Node-2009" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.479em; padding-bottom: 0.585em;">(</span></span><span id="MJXc-Node-2010" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.267em; padding-right: 0.024em;">X</span></span><span id="MJXc-Node-2011" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.479em; padding-bottom: 0.585em;">)</span></span><span id="MJXc-Node-2012" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.056em; padding-bottom: 0.32em;">=</span></span><span id="MJXc-Node-2013" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.32em; padding-bottom: 0.426em;">−</span></span><span id="MJXc-Node-2014" class="mjx-munderover MJXc-space1"><span class="mjx-itable"><span class="mjx-row"><span class="mjx-cell"><span class="mjx-stack"><span class="mjx-over" style="font-size: 70.7%; padding-bottom: 0.258em; padding-top: 0.141em; padding-left: 0.455em;"><span id="MJXc-Node-2021" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.267em; padding-right: 0.04em;">K</span></span></span><span class="mjx-op" style="padding-left: 0.108em;"><span id="MJXc-Node-2015" class="mjx-mo"><span class="mjx-char MJXc-TeX-size1-R" style="padding-top: 0.532em; padding-bottom: 0.532em;">∑</span></span></span></span></span></span><span class="mjx-row"><span class="mjx-under" style="font-size: 70.7%; padding-top: 0.236em; padding-bottom: 0.141em;"><span id="MJXc-Node-2016" class="mjx-texatom" style=""><span id="MJXc-Node-2017" class="mjx-mrow"><span id="MJXc-Node-2018" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.267em;">k</span></span><span id="MJXc-Node-2019" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.056em; padding-bottom: 0.32em;">=</span></span><span id="MJXc-Node-2020" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.373em; padding-bottom: 0.32em;">1</span></span></span></span></span></span></span></span><span id="MJXc-Node-2022" class="mjx-msubsup MJXc-space1"><span class="mjx-base"><span id="MJXc-Node-2023" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.215em; padding-bottom: 0.479em;">p</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.219em; padding-right: 0.071em;"><span id="MJXc-Node-2024" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.267em;">k</span></span></span></span><span id="MJXc-Node-2025" class="mjx-mi MJXc-space1"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.426em; padding-bottom: 0.532em;">log</span></span><span id="MJXc-Node-2026" class="mjx-mo"><span class="mjx-char"></span></span><span id="MJXc-Node-2027" class="mjx-texatom MJXc-space1"><span id="MJXc-Node-2028" class="mjx-mrow"><span id="MJXc-Node-2029" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-2030" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.215em; padding-bottom: 0.479em;">p</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.219em; padding-right: 0.071em;"><span id="MJXc-Node-2031" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.267em;">k</span></span></span></span></span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>H</mi><mo stretchy="false">(</mo><mi>X</mi><mo stretchy="false">)</mo><mo>=</mo><mo>−</mo><munderover><mo movablelimits="false">∑</mo><mrow class="MJX-TeXAtom-ORD"><mi>k</mi><mo>=</mo><mn>1</mn></mrow><mi>K</mi></munderover><msub><mi>p</mi><mi>k</mi></msub><mi>log</mi><mo>⁡</mo><mrow class="MJX-TeXAtom-ORD"><msub><mi>p</mi><mi>k</mi></msub></mrow></math></span></span><script type="math/tex" id="MathJax-Element-112">H(X) = -\sum\limits_{k = 1}^Kp_k\log{p_k}</script></span>
<ul>
<li><span>Энтропию можно понимать как “меру информационного хаоса” в выборке.</span></li>
<li><span>Энтропия ограничена снизу нулём: </span><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-113-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 118%; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>S</mi><mo>&amp;#x2265;</mo><mn>0.</mn></math>" role="presentation"><span id="MJXc-Node-2032" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-2033" class="mjx-mrow"><span id="MJXc-Node-2034" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.32em; padding-right: 0.032em;">S</span></span><span id="MJXc-Node-2035" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.373em; padding-bottom: 0.479em;">≥</span></span><span id="MJXc-Node-2036" class="mjx-mn MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.373em; padding-bottom: 0.373em;">0.</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>S</mi><mo>≥</mo><mn>0.</mn></math></span></span><script type="math/tex" id="MathJax-Element-113">S \geq 0.</script></span></li>
<li><span>Энтропия равна нулю (т.е. в нашей выборке нет никакой неоднородности), когда некоторое </span><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-114-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 118%; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>p</mi><mi>k</mi></msub><mo>=</mo><mn>1</mn></math>" role="presentation"><span id="MJXc-Node-2037" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-2038" class="mjx-mrow"><span id="MJXc-Node-2039" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-2040" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.215em; padding-bottom: 0.479em;">p</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.219em; padding-right: 0.071em;"><span id="MJXc-Node-2041" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.267em;">k</span></span></span></span><span id="MJXc-Node-2042" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.056em; padding-bottom: 0.32em;">=</span></span><span id="MJXc-Node-2043" class="mjx-mn MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.373em; padding-bottom: 0.32em;">1</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>p</mi><mi>k</mi></msub><mo>=</mo><mn>1</mn></math></span></span><script type="math/tex" id="MathJax-Element-114">p_k = 1</script></span><span> (с учётом того, что </span><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-115-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 118%; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>p</mi><mi>k</mi></msub></math>" role="presentation"><span id="MJXc-Node-2044" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-2045" class="mjx-mrow"><span id="MJXc-Node-2046" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-2047" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.215em; padding-bottom: 0.479em;">p</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.219em; padding-right: 0.071em;"><span id="MJXc-Node-2048" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.267em;">k</span></span></span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>p</mi><mi>k</mi></msub></math></span></span><script type="math/tex" id="MathJax-Element-115">p_k</script></span><span> — выборочные вероятности).</span></li>
<li><span>Энтропия также ограничена сверху. Она достигает верхней границы в случае когда все </span><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-116-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 118%; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>p</mi><mi>k</mi></msub><mo>=</mo><mfrac><mn>1</mn><mi>K</mi></mfrac><mo>,</mo></math>" role="presentation"><span id="MJXc-Node-2049" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-2050" class="mjx-mrow"><span id="MJXc-Node-2051" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-2052" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.215em; padding-bottom: 0.479em;">p</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.219em; padding-right: 0.071em;"><span id="MJXc-Node-2053" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.267em;">k</span></span></span></span><span id="MJXc-Node-2054" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.056em; padding-bottom: 0.32em;">=</span></span><span id="MJXc-Node-2055" class="mjx-mfrac MJXc-space3"><span class="mjx-box MJXc-stacked" style="width: 0.77em; padding: 0px 0.12em;"><span class="mjx-numerator" style="font-size: 70.7%; width: 1.089em; top: -1.299em;"><span id="MJXc-Node-2056" class="mjx-mn" style=""><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.373em; padding-bottom: 0.32em;">1</span></span></span><span class="mjx-denominator" style="font-size: 70.7%; width: 1.089em; bottom: -0.609em;"><span id="MJXc-Node-2057" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.267em; padding-right: 0.04em;">K</span></span></span><span style="border-bottom-width: 1.3px; border-bottom-style: solid; top: -0.283em; width: 0.77em;" class="mjx-line"></span></span><span style="height: 1.349em; vertical-align: -0.431em;" class="mjx-vsize"></span></span><span id="MJXc-Node-2058" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="margin-top: -0.156em; padding-bottom: 0.532em;">,</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>p</mi><mi>k</mi></msub><mo>=</mo><mfrac><mn>1</mn><mi>K</mi></mfrac><mo>,</mo></math></span></span><script type="math/tex" id="MathJax-Element-116">p_k = \frac{1}{K},</script></span><span> т.е. распределение классов равномерное и наша выборка крайне неоднородная (т.к. нельзя выделить какой-то преобладающий класс или классы).</span>
<ul>
<li><span>Можно доказать формально, поставив задачу оптимизации с условием </span><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-117-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 118%; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><munderover><mo movablelimits=&quot;false&quot;>&amp;#x2211;</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>k</mi><mo>=</mo><mn>1</mn></mrow><mi>K</mi></munderover><msub><mi>p</mi><mi>k</mi></msub><mo>=</mo><mn>1.</mn></math>" role="presentation"><span id="MJXc-Node-2059" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-2060" class="mjx-mrow"><span id="MJXc-Node-2061" class="mjx-munderover"><span class="mjx-itable"><span class="mjx-row"><span class="mjx-cell"><span class="mjx-stack"><span class="mjx-over" style="font-size: 70.7%; padding-bottom: 0.258em; padding-top: 0.141em; padding-left: 0.455em;"><span id="MJXc-Node-2068" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.267em; padding-right: 0.04em;">K</span></span></span><span class="mjx-op" style="padding-left: 0.108em;"><span id="MJXc-Node-2062" class="mjx-mo"><span class="mjx-char MJXc-TeX-size1-R" style="padding-top: 0.532em; padding-bottom: 0.532em;">∑</span></span></span></span></span></span><span class="mjx-row"><span class="mjx-under" style="font-size: 70.7%; padding-top: 0.236em; padding-bottom: 0.141em;"><span id="MJXc-Node-2063" class="mjx-texatom" style=""><span id="MJXc-Node-2064" class="mjx-mrow"><span id="MJXc-Node-2065" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.267em;">k</span></span><span id="MJXc-Node-2066" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.056em; padding-bottom: 0.32em;">=</span></span><span id="MJXc-Node-2067" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.373em; padding-bottom: 0.32em;">1</span></span></span></span></span></span></span></span><span id="MJXc-Node-2069" class="mjx-msubsup MJXc-space1"><span class="mjx-base"><span id="MJXc-Node-2070" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.215em; padding-bottom: 0.479em;">p</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.219em; padding-right: 0.071em;"><span id="MJXc-Node-2071" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.267em;">k</span></span></span></span><span id="MJXc-Node-2072" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.056em; padding-bottom: 0.32em;">=</span></span><span id="MJXc-Node-2073" class="mjx-mn MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.373em; padding-bottom: 0.32em;">1.</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><munderover><mo movablelimits="false">∑</mo><mrow class="MJX-TeXAtom-ORD"><mi>k</mi><mo>=</mo><mn>1</mn></mrow><mi>K</mi></munderover><msub><mi>p</mi><mi>k</mi></msub><mo>=</mo><mn>1.</mn></math></span></span><script type="math/tex" id="MathJax-Element-117">\sum\limits_{k = 1}^Kp_k = 1.</script></span></li>
</ul>
</li>
</ul>
</li>
<li><span>Критерий Джини: </span><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-118-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 118%; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>H</mi><mo stretchy=&quot;false&quot;>(</mo><mi>X</mi><mo stretchy=&quot;false&quot;>)</mo><mo>=</mo><mn>1</mn><mo>&amp;#x2212;</mo><munderover><mo movablelimits=&quot;false&quot;>&amp;#x2211;</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>k</mi><mo>=</mo><mn>1</mn></mrow><mi>K</mi></munderover><msubsup><mi>p</mi><mi>k</mi><mn>2</mn></msubsup></math>" role="presentation"><span id="MJXc-Node-2074" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-2075" class="mjx-mrow"><span id="MJXc-Node-2076" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.267em; padding-right: 0.057em;">H</span></span><span id="MJXc-Node-2077" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.479em; padding-bottom: 0.585em;">(</span></span><span id="MJXc-Node-2078" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.267em; padding-right: 0.024em;">X</span></span><span id="MJXc-Node-2079" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.479em; padding-bottom: 0.585em;">)</span></span><span id="MJXc-Node-2080" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.056em; padding-bottom: 0.32em;">=</span></span><span id="MJXc-Node-2081" class="mjx-mn MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.373em; padding-bottom: 0.32em;">1</span></span><span id="MJXc-Node-2082" class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.32em; padding-bottom: 0.426em;">−</span></span><span id="MJXc-Node-2083" class="mjx-munderover MJXc-space2"><span class="mjx-itable"><span class="mjx-row"><span class="mjx-cell"><span class="mjx-stack"><span class="mjx-over" style="font-size: 70.7%; padding-bottom: 0.258em; padding-top: 0.141em; padding-left: 0.455em;"><span id="MJXc-Node-2090" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.267em; padding-right: 0.04em;">K</span></span></span><span class="mjx-op" style="padding-left: 0.108em;"><span id="MJXc-Node-2084" class="mjx-mo"><span class="mjx-char MJXc-TeX-size1-R" style="padding-top: 0.532em; padding-bottom: 0.532em;">∑</span></span></span></span></span></span><span class="mjx-row"><span class="mjx-under" style="font-size: 70.7%; padding-top: 0.236em; padding-bottom: 0.141em;"><span id="MJXc-Node-2085" class="mjx-texatom" style=""><span id="MJXc-Node-2086" class="mjx-mrow"><span id="MJXc-Node-2087" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.267em;">k</span></span><span id="MJXc-Node-2088" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.056em; padding-bottom: 0.32em;">=</span></span><span id="MJXc-Node-2089" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.373em; padding-bottom: 0.32em;">1</span></span></span></span></span></span></span></span><span id="MJXc-Node-2091" class="mjx-msubsup MJXc-space1"><span class="mjx-base"><span id="MJXc-Node-2092" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.215em; padding-bottom: 0.479em;">p</span></span></span><span class="mjx-stack" style="vertical-align: -0.335em;"><span class="mjx-sup" style="font-size: 70.7%; padding-bottom: 0.255em; padding-left: 0px; padding-right: 0.071em;"><span id="MJXc-Node-2094" class="mjx-mn" style=""><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.373em; padding-bottom: 0.32em;">2</span></span></span><span class="mjx-sub" style="font-size: 70.7%; padding-right: 0.071em;"><span id="MJXc-Node-2093" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.267em;">k</span></span></span></span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>H</mi><mo stretchy="false">(</mo><mi>X</mi><mo stretchy="false">)</mo><mo>=</mo><mn>1</mn><mo>−</mo><munderover><mo movablelimits="false">∑</mo><mrow class="MJX-TeXAtom-ORD"><mi>k</mi><mo>=</mo><mn>1</mn></mrow><mi>K</mi></munderover><msubsup><mi>p</mi><mi>k</mi><mn>2</mn></msubsup></math></span></span><script type="math/tex" id="MathJax-Element-118">H(X) = 1 - \sum\limits_{k = 1}^Kp_k^2</script></span>
<ul>
<li><span>Критерий Джини можно интепретировать как математическое ожидание вероятности ошибки (неправильной классификации): </span><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-119-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 118%; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><munderover><mo movablelimits=&quot;false&quot;>&amp;#x2211;</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>k</mi><mo>=</mo><mn>1</mn></mrow><mi>K</mi></munderover><msub><mi>p</mi><mi>k</mi></msub><mo stretchy=&quot;false&quot;>(</mo><mn>1</mn><mo>&amp;#x2212;</mo><msub><mi>p</mi><mi>k</mi></msub><mo stretchy=&quot;false&quot;>)</mo><mo>=</mo><mn>1</mn><mo>&amp;#x2212;</mo><munderover><mo movablelimits=&quot;false&quot;>&amp;#x2211;</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>k</mi><mo>=</mo><mn>1</mn></mrow><mi>K</mi></munderover><msubsup><mi>p</mi><mi>k</mi><mn>2</mn></msubsup></math>" role="presentation"><span id="MJXc-Node-2095" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-2096" class="mjx-mrow"><span id="MJXc-Node-2097" class="mjx-munderover"><span class="mjx-itable"><span class="mjx-row"><span class="mjx-cell"><span class="mjx-stack"><span class="mjx-over" style="font-size: 70.7%; padding-bottom: 0.258em; padding-top: 0.141em; padding-left: 0.455em;"><span id="MJXc-Node-2104" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.267em; padding-right: 0.04em;">K</span></span></span><span class="mjx-op" style="padding-left: 0.108em;"><span id="MJXc-Node-2098" class="mjx-mo"><span class="mjx-char MJXc-TeX-size1-R" style="padding-top: 0.532em; padding-bottom: 0.532em;">∑</span></span></span></span></span></span><span class="mjx-row"><span class="mjx-under" style="font-size: 70.7%; padding-top: 0.236em; padding-bottom: 0.141em;"><span id="MJXc-Node-2099" class="mjx-texatom" style=""><span id="MJXc-Node-2100" class="mjx-mrow"><span id="MJXc-Node-2101" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.267em;">k</span></span><span id="MJXc-Node-2102" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.056em; padding-bottom: 0.32em;">=</span></span><span id="MJXc-Node-2103" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.373em; padding-bottom: 0.32em;">1</span></span></span></span></span></span></span></span><span id="MJXc-Node-2105" class="mjx-msubsup MJXc-space1"><span class="mjx-base"><span id="MJXc-Node-2106" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.215em; padding-bottom: 0.479em;">p</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.219em; padding-right: 0.071em;"><span id="MJXc-Node-2107" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.267em;">k</span></span></span></span><span id="MJXc-Node-2108" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.479em; padding-bottom: 0.585em;">(</span></span><span id="MJXc-Node-2109" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.373em; padding-bottom: 0.32em;">1</span></span><span id="MJXc-Node-2110" class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.32em; padding-bottom: 0.426em;">−</span></span><span id="MJXc-Node-2111" class="mjx-msubsup MJXc-space2"><span class="mjx-base"><span id="MJXc-Node-2112" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.215em; padding-bottom: 0.479em;">p</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.219em; padding-right: 0.071em;"><span id="MJXc-Node-2113" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.267em;">k</span></span></span></span><span id="MJXc-Node-2114" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.479em; padding-bottom: 0.585em;">)</span></span><span id="MJXc-Node-2115" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.056em; padding-bottom: 0.32em;">=</span></span><span id="MJXc-Node-2116" class="mjx-mn MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.373em; padding-bottom: 0.32em;">1</span></span><span id="MJXc-Node-2117" class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.32em; padding-bottom: 0.426em;">−</span></span><span id="MJXc-Node-2118" class="mjx-munderover MJXc-space2"><span class="mjx-itable"><span class="mjx-row"><span class="mjx-cell"><span class="mjx-stack"><span class="mjx-over" style="font-size: 70.7%; padding-bottom: 0.258em; padding-top: 0.141em; padding-left: 0.455em;"><span id="MJXc-Node-2125" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.267em; padding-right: 0.04em;">K</span></span></span><span class="mjx-op" style="padding-left: 0.108em;"><span id="MJXc-Node-2119" class="mjx-mo"><span class="mjx-char MJXc-TeX-size1-R" style="padding-top: 0.532em; padding-bottom: 0.532em;">∑</span></span></span></span></span></span><span class="mjx-row"><span class="mjx-under" style="font-size: 70.7%; padding-top: 0.236em; padding-bottom: 0.141em;"><span id="MJXc-Node-2120" class="mjx-texatom" style=""><span id="MJXc-Node-2121" class="mjx-mrow"><span id="MJXc-Node-2122" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.267em;">k</span></span><span id="MJXc-Node-2123" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.056em; padding-bottom: 0.32em;">=</span></span><span id="MJXc-Node-2124" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.373em; padding-bottom: 0.32em;">1</span></span></span></span></span></span></span></span><span id="MJXc-Node-2126" class="mjx-msubsup MJXc-space1"><span class="mjx-base"><span id="MJXc-Node-2127" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.215em; padding-bottom: 0.479em;">p</span></span></span><span class="mjx-stack" style="vertical-align: -0.335em;"><span class="mjx-sup" style="font-size: 70.7%; padding-bottom: 0.255em; padding-left: 0px; padding-right: 0.071em;"><span id="MJXc-Node-2129" class="mjx-mn" style=""><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.373em; padding-bottom: 0.32em;">2</span></span></span><span class="mjx-sub" style="font-size: 70.7%; padding-right: 0.071em;"><span id="MJXc-Node-2128" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.267em;">k</span></span></span></span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><munderover><mo movablelimits="false">∑</mo><mrow class="MJX-TeXAtom-ORD"><mi>k</mi><mo>=</mo><mn>1</mn></mrow><mi>K</mi></munderover><msub><mi>p</mi><mi>k</mi></msub><mo stretchy="false">(</mo><mn>1</mn><mo>−</mo><msub><mi>p</mi><mi>k</mi></msub><mo stretchy="false">)</mo><mo>=</mo><mn>1</mn><mo>−</mo><munderover><mo movablelimits="false">∑</mo><mrow class="MJX-TeXAtom-ORD"><mi>k</mi><mo>=</mo><mn>1</mn></mrow><mi>K</mi></munderover><msubsup><mi>p</mi><mi>k</mi><mn>2</mn></msubsup></math></span></span><script type="math/tex" id="MathJax-Element-119">\sum\limits_{k = 1}^K p_k(1 - p_k) = 1 - \sum\limits_{k = 1}^Kp_k^2</script></span></li>
</ul>
</li>
</ul><h3 id="9-Процедура-bootstrap-Бэггинг-Метод-случайных-подпространств-Смесь-моделей-и-смесь-экспертов-декларативно" data-id="9-Процедура-bootstrap-Бэггинг-Метод-случайных-подпространств-Смесь-моделей-и-смесь-экспертов-декларативно"><a class="anchor hidden-xs" href="#9-Процедура-bootstrap-Бэггинг-Метод-случайных-подпространств-Смесь-моделей-и-смесь-экспертов-декларативно" title="9-Процедура-bootstrap-Бэггинг-Метод-случайных-подпространств-Смесь-моделей-и-смесь-экспертов-декларативно"><span class="octicon octicon-link"></span></a><span>9. Процедура bootstrap. Бэггинг. Метод случайных подпространств. Смесь моделей и смесь экспертов (декларативно).</span></h3><ul>
<li><strong><span>Bootstrap</span></strong><span> — метод генерации подвыборок, заключающийся в том, что мы случайно (равновероятно) берём объекты из выборки с возвращением (т.е. в нашу подвыборку может попасть один и тот же объект несколько раз), пока размер набираемого множества не станет равен размеру изначальной выборки.</span>
<ul>
<li><span>Можно доказать, что при генерации таким методом подвыборка будет содержать ~63% уникальных объектов оригинальной выборки.</span></li>
</ul>
</li>
<li><strong><span>Bagging</span></strong><span> (Bootstrap aggregating) — метод ансамблирования алгоритмов, который заключается в обучении </span><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-120-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 118%; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>N</mi></math>" role="presentation"><span id="MJXc-Node-2130" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-2131" class="mjx-mrow"><span id="MJXc-Node-2132" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.267em; padding-right: 0.085em;">N</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>N</mi></math></span></span><script type="math/tex" id="MathJax-Element-120">N</script></span><span> алгоритмов на бутстрапированных выборках и усреднении их ответа.</span>
<ul>
<li><span>Если предположить, что ошибки базовых алгоритмов не скоррелированы (что, очевидно, неправда, так как обучающие выборки бустрапировались из общего множества объектов), и их дисперсии равны между собой, то бэггинг уменьшает разброс базового алгоритма в </span><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-121-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 118%; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>N</mi></math>" role="presentation"><span id="MJXc-Node-2133" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-2134" class="mjx-mrow"><span id="MJXc-Node-2135" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.267em; padding-right: 0.085em;">N</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>N</mi></math></span></span><script type="math/tex" id="MathJax-Element-121">N</script></span><span> раз.</span>
<ul>
<li><span>Т.е. бэггинг не меняет bias базовых алгоритмов, но уменьшает их дисперсию. Поэтому он сильно увеличивает качество деревьев, которые обладают низким смещением, но высоким разбросом.</span></li>
</ul>
</li>
<li><span>После обучения модели с помощью бэггинга мы можем для каждого объекта из выборки получить усреднённое предсказание тех алгоритмов, в обучающую подвыборку которых этот объект не попал. Получив подобное предсказание для каждого объекта можно посчитать метрику качества, которая будет как-то оценивать финальное качество модели. Такой подход называется </span><em><span>OOB</span></em><span> — Out-of-bag estimation.</span></li>
</ul>
</li>
<li><strong><span>Random Subspace Method</span></strong><span> (RSM) — метод случайных подпространств. Аналогично бэггингу, обучаем каждый базовый алгоритм используя только случайное подмножество признаков. При таком подходе алгоритмы становятся ещё более нескорелированными.</span></li>
<li><strong><span>Blending</span></strong><span> (</span><em><span>смесь экспертов</span></em><span> по лекциям К.В. Воронцова) — метод ансмаблирования алгоритмов, заключающийся во “взвешенном голосовании” алгоритмов разных семейств. По сути мы строим линейную модель над предсказаниями разных алгоритмов.</span><br>
<span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span class="mjx-chtml MJXc-display" style="text-align: center;"><span id="MathJax-Element-122-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 118%; text-align: center; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mover><mi>f</mi><mo stretchy=&quot;false&quot;>&amp;#x005E;</mo></mover></mrow><mo stretchy=&quot;false&quot;>(</mo><mi>x</mi><mo stretchy=&quot;false&quot;>)</mo><mo>=</mo><munderover><mo movablelimits=&quot;false&quot;>&amp;#x2211;</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>N</mi></munderover><msub><mi>&amp;#x03C1;</mi><mi>i</mi></msub><msub><mi>f</mi><mi>i</mi></msub><mo stretchy=&quot;false&quot;>(</mo><mi>x</mi><mo stretchy=&quot;false&quot;>)</mo><mo>,</mo><mspace width=&quot;thickmathspace&quot; /><munderover><mo movablelimits=&quot;false&quot;>&amp;#x2211;</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>N</mi></munderover><msub><mi>&amp;#x03C1;</mi><mi>i</mi></msub><mo>=</mo><mn>1</mn><mo>,</mo><mspace width=&quot;thickmathspace&quot; /><mi mathvariant=&quot;normal&quot;>&amp;#x2200;</mi><mi>i</mi><mn>0</mn><mo>&amp;#x2A7D;</mo><msub><mi>&amp;#x03C1;</mi><mi>i</mi></msub><mo>&amp;#x2A7E;</mo><mo>.</mo></math>" role="presentation"><span id="MJXc-Node-2136" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-2137" class="mjx-mrow"><span id="MJXc-Node-2138" class="mjx-texatom"><span id="MJXc-Node-2139" class="mjx-mrow"><span id="MJXc-Node-2140" class="mjx-munderover"><span class="mjx-stack"><span class="mjx-over" style="height: 0.213em; padding-bottom: 0.06em; padding-left: 0.256em;"><span id="MJXc-Node-2142" class="mjx-mo" style="vertical-align: top;"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.426em; padding-bottom: 0.32em;">^</span></span></span><span class="mjx-op"><span id="MJXc-Node-2141" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.479em; padding-right: 0.06em;">f</span></span></span></span></span></span></span><span id="MJXc-Node-2143" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.479em; padding-bottom: 0.585em;">(</span></span><span id="MJXc-Node-2144" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.215em; padding-bottom: 0.267em;">x</span></span><span id="MJXc-Node-2145" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.479em; padding-bottom: 0.585em;">)</span></span><span id="MJXc-Node-2146" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.056em; padding-bottom: 0.32em;">=</span></span><span id="MJXc-Node-2147" class="mjx-munderover MJXc-space3"><span class="mjx-itable"><span class="mjx-row"><span class="mjx-cell"><span class="mjx-stack"><span class="mjx-over" style="font-size: 70.7%; padding-bottom: 0.258em; padding-top: 0.141em; padding-left: 0.577em;"><span id="MJXc-Node-2154" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.267em; padding-right: 0.085em;">N</span></span></span><span class="mjx-op"><span id="MJXc-Node-2148" class="mjx-mo"><span class="mjx-char MJXc-TeX-size2-R" style="padding-top: 0.744em; padding-bottom: 0.744em;">∑</span></span></span></span></span></span><span class="mjx-row"><span class="mjx-under" style="font-size: 70.7%; padding-top: 0.236em; padding-bottom: 0.141em; padding-left: 0.21em;"><span id="MJXc-Node-2149" class="mjx-texatom" style=""><span id="MJXc-Node-2150" class="mjx-mrow"><span id="MJXc-Node-2151" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.426em; padding-bottom: 0.267em;">i</span></span><span id="MJXc-Node-2152" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.056em; padding-bottom: 0.32em;">=</span></span><span id="MJXc-Node-2153" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.373em; padding-bottom: 0.32em;">1</span></span></span></span></span></span></span></span><span id="MJXc-Node-2155" class="mjx-msubsup MJXc-space1"><span class="mjx-base"><span id="MJXc-Node-2156" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.215em; padding-bottom: 0.479em;">ρ</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-2157" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.426em; padding-bottom: 0.267em;">i</span></span></span></span><span id="MJXc-Node-2158" class="mjx-msubsup"><span class="mjx-base" style="margin-right: -0.06em;"><span id="MJXc-Node-2159" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.479em; padding-right: 0.06em;">f</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-2160" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.426em; padding-bottom: 0.267em;">i</span></span></span></span><span id="MJXc-Node-2161" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.479em; padding-bottom: 0.585em;">(</span></span><span id="MJXc-Node-2162" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.215em; padding-bottom: 0.267em;">x</span></span><span id="MJXc-Node-2163" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.479em; padding-bottom: 0.585em;">)</span></span><span id="MJXc-Node-2164" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="margin-top: -0.156em; padding-bottom: 0.532em;">,</span></span><span id="MJXc-Node-2165" class="mjx-mspace" style="width: 0.278em; height: 0px;"></span><span id="MJXc-Node-2166" class="mjx-munderover MJXc-space1"><span class="mjx-itable"><span class="mjx-row"><span class="mjx-cell"><span class="mjx-stack"><span class="mjx-over" style="font-size: 70.7%; padding-bottom: 0.258em; padding-top: 0.141em; padding-left: 0.577em;"><span id="MJXc-Node-2173" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.267em; padding-right: 0.085em;">N</span></span></span><span class="mjx-op"><span id="MJXc-Node-2167" class="mjx-mo"><span class="mjx-char MJXc-TeX-size2-R" style="padding-top: 0.744em; padding-bottom: 0.744em;">∑</span></span></span></span></span></span><span class="mjx-row"><span class="mjx-under" style="font-size: 70.7%; padding-top: 0.236em; padding-bottom: 0.141em; padding-left: 0.21em;"><span id="MJXc-Node-2168" class="mjx-texatom" style=""><span id="MJXc-Node-2169" class="mjx-mrow"><span id="MJXc-Node-2170" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.426em; padding-bottom: 0.267em;">i</span></span><span id="MJXc-Node-2171" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.056em; padding-bottom: 0.32em;">=</span></span><span id="MJXc-Node-2172" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.373em; padding-bottom: 0.32em;">1</span></span></span></span></span></span></span></span><span id="MJXc-Node-2174" class="mjx-msubsup MJXc-space1"><span class="mjx-base"><span id="MJXc-Node-2175" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.215em; padding-bottom: 0.479em;">ρ</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-2176" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.426em; padding-bottom: 0.267em;">i</span></span></span></span><span id="MJXc-Node-2177" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.056em; padding-bottom: 0.32em;">=</span></span><span id="MJXc-Node-2178" class="mjx-mn MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.373em; padding-bottom: 0.32em;">1</span></span><span id="MJXc-Node-2179" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="margin-top: -0.156em; padding-bottom: 0.532em;">,</span></span><span id="MJXc-Node-2180" class="mjx-mspace" style="width: 0.278em; height: 0px;"></span><span id="MJXc-Node-2181" class="mjx-mi MJXc-space1"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.426em; padding-bottom: 0.373em;">∀</span></span><span id="MJXc-Node-2182" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.426em; padding-bottom: 0.267em;">i</span></span><span id="MJXc-Node-2183" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.373em; padding-bottom: 0.373em;">0</span></span><span id="MJXc-Node-2184" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-ams-R" style="padding-top: 0.373em; padding-bottom: 0.426em;">⩽</span></span><span id="MJXc-Node-2185" class="mjx-msubsup MJXc-space3"><span class="mjx-base"><span id="MJXc-Node-2186" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.215em; padding-bottom: 0.479em;">ρ</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-2187" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.426em; padding-bottom: 0.267em;">i</span></span></span></span><span id="MJXc-Node-2188" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-ams-R" style="padding-top: 0.373em; padding-bottom: 0.426em;">⩾</span></span><span id="MJXc-Node-2189" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="margin-top: -0.156em; padding-bottom: 0.32em;">.</span></span></span></span><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mrow class="MJX-TeXAtom-ORD"><mover><mi>f</mi><mo stretchy="false">^</mo></mover></mrow><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mo>=</mo><munderover><mo movablelimits="false">∑</mo><mrow class="MJX-TeXAtom-ORD"><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>N</mi></munderover><msub><mi>ρ</mi><mi>i</mi></msub><msub><mi>f</mi><mi>i</mi></msub><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mo>,</mo><mspace width="thickmathspace"></mspace><munderover><mo movablelimits="false">∑</mo><mrow class="MJX-TeXAtom-ORD"><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>N</mi></munderover><msub><mi>ρ</mi><mi>i</mi></msub><mo>=</mo><mn>1</mn><mo>,</mo><mspace width="thickmathspace"></mspace><mi mathvariant="normal">∀</mi><mi>i</mi><mn>0</mn><mo>⩽</mo><msub><mi>ρ</mi><mi>i</mi></msub><mo>⩾</mo><mo>.</mo></math></span></span></span><script type="math/tex; mode=display" id="MathJax-Element-122">
 \hat{f}(x) = \sum\limits_{i = 1}^N\rho_if_i(x), \; \sum\limits_{i = 1}^N\rho_i = 1, \; 
 \forall i 0 \leqslant \rho_i \geqslant.
</script></span>
<ul>
<li><span>Сначала выборка делится на две части — обучение и валидация.</span></li>
<li><span>Затем на первой части обучается некоторое число базовых алгоритмов </span><em><span>из разных семейств.</span></em></li>
<li><span>На второй части получим матрицу предсказаний обученных алгоритмов.</span></li>
<li><span>Используем полученную матрицу для настройки коэффициентов для взвешенного голосования обученных моделей (иначе говоря, обучаем линейную модель с условием, что сумма коэффициентов должна быть равна единице и все они должны лежать между 0 и 1).</span></li>
<li><span>Преимущества: простой метод ансамблирования, можно усреднять по разным разбиениям выборки, чтобы улучшить качество.</span></li>
<li><span>Недостатки: приходится платить данными (мы осознанно уменьшаем выборку на которой обучаются базовые алгоритмы), линейная комбинация алгоритмов не может описать более сложных зависимостей</span><br>
<img src="https://i.imgur.com/ZSJgILf.png" alt=""></li>
</ul>
</li>
<li><strong><span>Stacking</span></strong><span> — улучшенная версия блендинга. Вместо того, чтобы просто делить выборку на две части, делается аналог кросс-валидации — выборка делится на </span><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-123-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 118%; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>k</mi></math>" role="presentation"><span id="MJXc-Node-2190" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-2191" class="mjx-mrow"><span id="MJXc-Node-2192" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.267em;">k</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>k</mi></math></span></span><script type="math/tex" id="MathJax-Element-123">k</script></span><span> фолдов и каждый базовый алгоритм обучается </span><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-124-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 118%; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>k</mi></math>" role="presentation"><span id="MJXc-Node-2193" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-2194" class="mjx-mrow"><span id="MJXc-Node-2195" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.267em;">k</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>k</mi></math></span></span><script type="math/tex" id="MathJax-Element-124">k</script></span><span> раз на </span><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-125-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 118%; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>k</mi><mo>&amp;#x2212;</mo><mn>1</mn></math>" role="presentation"><span id="MJXc-Node-2196" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-2197" class="mjx-mrow"><span id="MJXc-Node-2198" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.267em;">k</span></span><span id="MJXc-Node-2199" class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.32em; padding-bottom: 0.426em;">−</span></span><span id="MJXc-Node-2200" class="mjx-mn MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.373em; padding-bottom: 0.32em;">1</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>k</mi><mo>−</mo><mn>1</mn></math></span></span><script type="math/tex" id="MathJax-Element-125">k - 1</script></span><span> фолде. Получаем предсказания для оставшегося фолда. После завершения этого процесса у нас будут предсказания каждого алгоритма для каждой фолда. Собираем из этих предсказаний новую выборку (предсказания одного алгоритма - один новый признак), на которой обучаем некоторую новую модель (необязательно линейную).</span><br>
<img src="https://i.imgur.com/Hwz8qVZ.png" alt=""></li>
<li><span>Преимущества:</span>
<ul>
<li><span>Можно повторять процесс рекурсивно несколько раз, получая стэкинг стэкингов и т.п.</span></li>
<li><span>Один из самых эффективных методов ансамбирования. Популярен в соревнованиях по машинному обучению.</span></li>
</ul>
</li>
<li><span>Недостатки:</span>
<ul>
<li><span>Признаки на которых мы обучаем мета-алгоритм (на последнем шаге стэкинга) на самом деле получены разными базовыми алгоритмами (т.к. они обучались на разных подвыборках) и склеены (чинится с помощью регуляризации/добавления случайного шума в выборку).</span></li>
<li><span>Итоговую модель очень сложно как-либо интерпретировать.</span></li>
</ul>
</li>
</ul><h3 id="10-Random-Forest" data-id="10-Random-Forest"><a class="anchor hidden-xs" href="#10-Random-Forest" title="10-Random-Forest"><span class="octicon octicon-link"></span></a><span>10. Random Forest.</span></h3><p><span>Модель, являющаяся ансамблем деревьев, который обучается с помощью бэггинга и метода случайных подпространств одновременно. Т.е. каждый базовый алгоритм обучается на бутстрапированной подвыборке со случайно выбранным подмножеством признаков.</span></p><ul>
<li><span>Т.к. деревья очень слабо скорелированы друг с другом при таком подходе, реальный разброс сильнее приближается к оценке </span><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-126-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 118%; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mfrac><mtext>&amp;#x420;&amp;#x430;&amp;#x437;&amp;#x431;&amp;#x440;&amp;#x43E;&amp;#x441; &amp;#x431;&amp;#x430;&amp;#x437;&amp;#x43E;&amp;#x432;&amp;#x43E;&amp;#x433;&amp;#x43E; &amp;#x430;&amp;#x43B;&amp;#x433;&amp;#x43E;&amp;#x440;&amp;#x438;&amp;#x442;&amp;#x43C;&amp;#x430;</mtext><mi>N</mi></mfrac></math>" role="presentation"><span id="MJXc-Node-2201" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-2202" class="mjx-mrow"><span id="MJXc-Node-2203" class="mjx-mfrac"><span class="mjx-box MJXc-stacked" style="width: 8.607em; padding: 0px 0.12em;"><span class="mjx-numerator" style="font-size: 70.7%; width: 12.172em; top: -1.633em;"><span id="MJXc-Node-2204" class="mjx-mtext" style=""><span class="mjx-char" style="padding-top: 0.532em; padding-bottom: 0.215em;"><span class="mjx-charbox MJXc-TeX-unknown-R" style="padding-bottom: 0.297em; width: 0.572em;">Р</span><span class="mjx-charbox MJXc-TeX-unknown-R" style="padding-bottom: 0.297em; width: 0.445em;">а</span><span class="mjx-charbox MJXc-TeX-unknown-R" style="padding-bottom: 0.297em; width: 0.392em;">з</span><span class="mjx-charbox MJXc-TeX-unknown-R" style="padding-bottom: 0.297em; width: 0.508em;">б</span><span class="mjx-charbox MJXc-TeX-unknown-R" style="padding-bottom: 0.297em; width: 0.498em;">р</span><span class="mjx-charbox MJXc-TeX-unknown-R" style="padding-bottom: 0.297em; width: 0.508em;">о</span><span class="mjx-charbox MJXc-TeX-unknown-R" style="padding-bottom: 0.297em; width: 0.456em;">с</span><span class="mjx-charbox MJXc-TeX-main-R" style="padding-bottom: 0.314em;"> </span><span class="mjx-charbox MJXc-TeX-unknown-R" style="padding-bottom: 0.297em; width: 0.508em;">б</span><span class="mjx-charbox MJXc-TeX-unknown-R" style="padding-bottom: 0.297em; width: 0.445em;">а</span><span class="mjx-charbox MJXc-TeX-unknown-R" style="padding-bottom: 0.297em; width: 0.392em;">з</span><span class="mjx-charbox MJXc-TeX-unknown-R" style="padding-bottom: 0.297em; width: 0.508em;">о</span><span class="mjx-charbox MJXc-TeX-unknown-R" style="padding-bottom: 0.297em; width: 0.477em;">в</span><span class="mjx-charbox MJXc-TeX-unknown-R" style="padding-bottom: 0.297em; width: 0.508em;">о</span><span class="mjx-charbox MJXc-TeX-unknown-R" style="padding-bottom: 0.297em; width: 0.392em;">г</span><span class="mjx-charbox MJXc-TeX-unknown-R" style="padding-bottom: 0.297em; width: 0.508em;">о</span><span class="mjx-charbox MJXc-TeX-main-R" style="padding-bottom: 0.314em;"> </span><span class="mjx-charbox MJXc-TeX-unknown-R" style="padding-bottom: 0.297em; width: 0.445em;">а</span><span class="mjx-charbox MJXc-TeX-unknown-R" style="padding-bottom: 0.297em; width: 0.498em;">л</span><span class="mjx-charbox MJXc-TeX-unknown-R" style="padding-bottom: 0.297em; width: 0.392em;">г</span><span class="mjx-charbox MJXc-TeX-unknown-R" style="padding-bottom: 0.297em; width: 0.508em;">о</span><span class="mjx-charbox MJXc-TeX-unknown-R" style="padding-bottom: 0.297em; width: 0.498em;">р</span><span class="mjx-charbox MJXc-TeX-unknown-R" style="padding-bottom: 0.297em; width: 0.519em;">и</span><span class="mjx-charbox MJXc-TeX-unknown-R" style="padding-bottom: 0.297em; width: 0.434em;">т</span><span class="mjx-charbox MJXc-TeX-unknown-R" style="padding-bottom: 0.297em; width: 0.614em;">м</span><span class="mjx-charbox MJXc-TeX-unknown-R" style="padding-bottom: 0.297em; width: 0.445em;">а</span></span></span></span><span class="mjx-denominator" style="font-size: 70.7%; width: 12.172em; bottom: -0.609em;"><span id="MJXc-Node-2205" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.267em; padding-right: 0.085em;">N</span></span></span><span style="border-bottom-width: 1.3px; border-bottom-style: solid; top: -0.283em; width: 8.607em;" class="mjx-line"></span></span><span style="height: 1.586em; vertical-align: -0.431em;" class="mjx-vsize"></span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mfrac><mtext>Разброс базового алгоритма</mtext><mi>N</mi></mfrac></math></span></span><script type="math/tex" id="MathJax-Element-126">\frac{\text{Разброс базового алгоритма}}{N}</script></span><span>.</span></li>
<li><span>Такой метод обучения очень эффективен именно для деревьев, потому что деревья легко переобучаются и, как следствие, обладают низким смещением и высоким разбросом. Уменьшая разброс с помощью бэггинга и RSM, мы получаем модель с низкими смещением и разбросом.</span></li>
<li><span>Одна из лучших базовых моделей почти в любой задаче.</span></li>
<li><span>Удобнее работать с пропущенными значениями — для предсказания на объекте усредняем ответ только по тем деревьям, которые не обучались на признаке с пропущенным значением.</span></li>
</ul><h3 id="11-Бустинг-Градиентный-бустинг" data-id="11-Бустинг-Градиентный-бустинг"><a class="anchor hidden-xs" href="#11-Бустинг-Градиентный-бустинг" title="11-Бустинг-Градиентный-бустинг"><span class="octicon octicon-link"></span></a><span>11. Бустинг. Градиентный бустинг.</span></h3><ul>
<li><strong><span>Бустинг</span></strong><span> — метод ансамблирования алгоритмов (одного семейства) который состоит в том, что результат итогового алгоритма равен сумме всех обученных базовых алгоритмов. Т.е. каждый последующий алгоритм добавляемый в ансамбль обучается так, чтобы уменьшать ошибку уже построенной части ансамбля.</span><br>
<span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span class="mjx-chtml MJXc-display" style="text-align: center;"><span id="MathJax-Element-127-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 118%; text-align: center; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mover><mi>f</mi><mo stretchy=&quot;false&quot;>&amp;#x005E;</mo></mover></mrow><mo stretchy=&quot;false&quot;>(</mo><mi>x</mi><mo stretchy=&quot;false&quot;>)</mo><mo>=</mo><munderover><mo movablelimits=&quot;false&quot;>&amp;#x2211;</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>N</mi></munderover><msub><mi>&amp;#x03C1;</mi><mi>i</mi></msub><msub><mi>f</mi><mi>i</mi></msub><mo stretchy=&quot;false&quot;>(</mo><mi>x</mi><mo stretchy=&quot;false&quot;>)</mo></math>" role="presentation"><span id="MJXc-Node-2206" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-2207" class="mjx-mrow"><span id="MJXc-Node-2208" class="mjx-texatom"><span id="MJXc-Node-2209" class="mjx-mrow"><span id="MJXc-Node-2210" class="mjx-munderover"><span class="mjx-stack"><span class="mjx-over" style="height: 0.213em; padding-bottom: 0.06em; padding-left: 0.256em;"><span id="MJXc-Node-2212" class="mjx-mo" style="vertical-align: top;"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.426em; padding-bottom: 0.32em;">^</span></span></span><span class="mjx-op"><span id="MJXc-Node-2211" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.479em; padding-right: 0.06em;">f</span></span></span></span></span></span></span><span id="MJXc-Node-2213" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.479em; padding-bottom: 0.585em;">(</span></span><span id="MJXc-Node-2214" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.215em; padding-bottom: 0.267em;">x</span></span><span id="MJXc-Node-2215" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.479em; padding-bottom: 0.585em;">)</span></span><span id="MJXc-Node-2216" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.056em; padding-bottom: 0.32em;">=</span></span><span id="MJXc-Node-2217" class="mjx-munderover MJXc-space3"><span class="mjx-itable"><span class="mjx-row"><span class="mjx-cell"><span class="mjx-stack"><span class="mjx-over" style="font-size: 70.7%; padding-bottom: 0.258em; padding-top: 0.141em; padding-left: 0.577em;"><span id="MJXc-Node-2224" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.267em; padding-right: 0.085em;">N</span></span></span><span class="mjx-op"><span id="MJXc-Node-2218" class="mjx-mo"><span class="mjx-char MJXc-TeX-size2-R" style="padding-top: 0.744em; padding-bottom: 0.744em;">∑</span></span></span></span></span></span><span class="mjx-row"><span class="mjx-under" style="font-size: 70.7%; padding-top: 0.236em; padding-bottom: 0.141em; padding-left: 0.21em;"><span id="MJXc-Node-2219" class="mjx-texatom" style=""><span id="MJXc-Node-2220" class="mjx-mrow"><span id="MJXc-Node-2221" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.426em; padding-bottom: 0.267em;">i</span></span><span id="MJXc-Node-2222" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.056em; padding-bottom: 0.32em;">=</span></span><span id="MJXc-Node-2223" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.373em; padding-bottom: 0.32em;">1</span></span></span></span></span></span></span></span><span id="MJXc-Node-2225" class="mjx-msubsup MJXc-space1"><span class="mjx-base"><span id="MJXc-Node-2226" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.215em; padding-bottom: 0.479em;">ρ</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-2227" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.426em; padding-bottom: 0.267em;">i</span></span></span></span><span id="MJXc-Node-2228" class="mjx-msubsup"><span class="mjx-base" style="margin-right: -0.06em;"><span id="MJXc-Node-2229" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.479em; padding-right: 0.06em;">f</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-2230" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.426em; padding-bottom: 0.267em;">i</span></span></span></span><span id="MJXc-Node-2231" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.479em; padding-bottom: 0.585em;">(</span></span><span id="MJXc-Node-2232" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.215em; padding-bottom: 0.267em;">x</span></span><span id="MJXc-Node-2233" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.479em; padding-bottom: 0.585em;">)</span></span></span></span><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mrow class="MJX-TeXAtom-ORD"><mover><mi>f</mi><mo stretchy="false">^</mo></mover></mrow><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mo>=</mo><munderover><mo movablelimits="false">∑</mo><mrow class="MJX-TeXAtom-ORD"><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>N</mi></munderover><msub><mi>ρ</mi><mi>i</mi></msub><msub><mi>f</mi><mi>i</mi></msub><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo></math></span></span></span><script type="math/tex; mode=display" id="MathJax-Element-127">
 \hat{f}(x) = \sum\limits_{i = 1}^N\rho_if_i(x)
</script></span><br>
<span>Здесь </span><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-128-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 118%; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>f</mi><mi>i</mi></msub></math>" role="presentation"><span id="MJXc-Node-2234" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-2235" class="mjx-mrow"><span id="MJXc-Node-2236" class="mjx-msubsup"><span class="mjx-base" style="margin-right: -0.06em;"><span id="MJXc-Node-2237" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.479em; padding-right: 0.06em;">f</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-2238" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.426em; padding-bottom: 0.267em;">i</span></span></span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>f</mi><mi>i</mi></msub></math></span></span><script type="math/tex" id="MathJax-Element-128">f_i</script></span><span> — базовые алгоритмы, </span><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-129-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 118%; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>&amp;#x03C1;</mi><mi>i</mi></msub></math>" role="presentation"><span id="MJXc-Node-2239" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-2240" class="mjx-mrow"><span id="MJXc-Node-2241" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-2242" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.215em; padding-bottom: 0.479em;">ρ</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-2243" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.426em; padding-bottom: 0.267em;">i</span></span></span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>ρ</mi><mi>i</mi></msub></math></span></span><script type="math/tex" id="MathJax-Element-129">\rho_i</script></span><span> — коэффициенты с которыми мы учитываем базовые алгоритмы.</span></li>
<li><span>Заметим, что бустинг над линейными моделями не даёт почти </span><em><span>никакого</span></em><span> прироста качества относительно обычной линейной модели, потому что итоговый ансамбль также будет являться линейной моделью.</span></li>
<li><strong><span>Градиентный бустинг</span></strong><span> — один из самых эффективных алгоритмов построения бустинга. Можно понимать его как градиентный спуск в пространстве моделей.</span><br>
<img src="https://i.imgur.com/vxQ4MVc.png" alt=""></li>
<li><span>Описание алгоритма:</span><br>
<span>0. Фиксируем дифференцируемую функцию потерь, подходящую для нашей задачи.</span>
<ol>
<li><span>Выбираем простую начальную модель </span><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-130-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 118%; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>f</mi><mn>0</mn></msub></math>" role="presentation"><span id="MJXc-Node-2244" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-2245" class="mjx-mrow"><span id="MJXc-Node-2246" class="mjx-msubsup"><span class="mjx-base" style="margin-right: -0.06em;"><span id="MJXc-Node-2247" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.479em; padding-right: 0.06em;">f</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-2248" class="mjx-mn" style=""><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.373em; padding-bottom: 0.373em;">0</span></span></span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>f</mi><mn>0</mn></msub></math></span></span><script type="math/tex" id="MathJax-Element-130">f_0</script></span><span> — среднее значение таргета в регрессии и выборочные вероятности (доля каждого класса) в случае классификации.</span></li>
<li><span>Пусть уже построены </span><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-131-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 118%; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>t</mi><mo>&amp;#x2212;</mo><mn>1</mn></math>" role="presentation"><span id="MJXc-Node-2249" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-2250" class="mjx-mrow"><span id="MJXc-Node-2251" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.426em; padding-bottom: 0.267em;">t</span></span><span id="MJXc-Node-2252" class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.32em; padding-bottom: 0.426em;">−</span></span><span id="MJXc-Node-2253" class="mjx-mn MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.373em; padding-bottom: 0.32em;">1</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>t</mi><mo>−</mo><mn>1</mn></math></span></span><script type="math/tex" id="MathJax-Element-131">t - 1</script></span><span> алгоримтов. Тогда вычислим значение антиградиента функции потерь (производные берём по ответу построенного ансамбля на обучающей выборке как по независимой переменной) в точке </span><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-132-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 118%; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mo stretchy=&quot;false&quot;>(</mo><mi>X</mi><mo>,</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mover><mi>f</mi><mo stretchy=&quot;false&quot;>&amp;#x005E;</mo></mover></mrow><mo stretchy=&quot;false&quot;>(</mo><mi>X</mi><mo stretchy=&quot;false&quot;>)</mo><mo stretchy=&quot;false&quot;>)</mo><mo>.</mo></math>" role="presentation"><span id="MJXc-Node-2254" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-2255" class="mjx-mrow"><span id="MJXc-Node-2256" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.479em; padding-bottom: 0.585em;">(</span></span><span id="MJXc-Node-2257" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.267em; padding-right: 0.024em;">X</span></span><span id="MJXc-Node-2258" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="margin-top: -0.156em; padding-bottom: 0.532em;">,</span></span><span id="MJXc-Node-2259" class="mjx-texatom MJXc-space1"><span id="MJXc-Node-2260" class="mjx-mrow"><span id="MJXc-Node-2261" class="mjx-munderover"><span class="mjx-stack"><span class="mjx-over" style="height: 0.213em; padding-bottom: 0.06em; padding-left: 0.256em;"><span id="MJXc-Node-2263" class="mjx-mo" style="vertical-align: top;"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.426em; padding-bottom: 0.32em;">^</span></span></span><span class="mjx-op"><span id="MJXc-Node-2262" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.479em; padding-right: 0.06em;">f</span></span></span></span></span></span></span><span id="MJXc-Node-2264" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.479em; padding-bottom: 0.585em;">(</span></span><span id="MJXc-Node-2265" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.267em; padding-right: 0.024em;">X</span></span><span id="MJXc-Node-2266" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.479em; padding-bottom: 0.585em;">)</span></span><span id="MJXc-Node-2267" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.479em; padding-bottom: 0.585em;">)</span></span><span id="MJXc-Node-2268" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="margin-top: -0.156em; padding-bottom: 0.32em;">.</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo stretchy="false">(</mo><mi>X</mi><mo>,</mo><mrow class="MJX-TeXAtom-ORD"><mover><mi>f</mi><mo stretchy="false">^</mo></mover></mrow><mo stretchy="false">(</mo><mi>X</mi><mo stretchy="false">)</mo><mo stretchy="false">)</mo><mo>.</mo></math></span></span><script type="math/tex" id="MathJax-Element-132">(X, \hat{f}(X)).</script></span></li>
<li><span>Обучаем новый алгоритм </span><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-133-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 118%; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>f</mi><mi>t</mi></msub><mo>,</mo></math>" role="presentation"><span id="MJXc-Node-2269" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-2270" class="mjx-mrow"><span id="MJXc-Node-2271" class="mjx-msubsup"><span class="mjx-base" style="margin-right: -0.06em;"><span id="MJXc-Node-2272" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.479em; padding-right: 0.06em;">f</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-2273" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.426em; padding-bottom: 0.267em;">t</span></span></span></span><span id="MJXc-Node-2274" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="margin-top: -0.156em; padding-bottom: 0.532em;">,</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>f</mi><mi>t</mi></msub><mo>,</mo></math></span></span><script type="math/tex" id="MathJax-Element-133">f_t,</script></span><span> используя в качестве целевой переменной значения антиградиента, полученные на предыдущем шаге, используя среднеквадратичную функцию ошибки (MSE).</span></li>
<li><span>Подбираем коэффициент </span><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-134-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 118%; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>&amp;#x03C1;</mi><mi>t</mi></msub></math>" role="presentation"><span id="MJXc-Node-2275" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-2276" class="mjx-mrow"><span id="MJXc-Node-2277" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-2278" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.215em; padding-bottom: 0.479em;">ρ</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-2279" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.426em; padding-bottom: 0.267em;">t</span></span></span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>ρ</mi><mi>t</mi></msub></math></span></span><script type="math/tex" id="MathJax-Element-134">\rho_t</script></span><span> так, чтобы минимизировать значение функции потерь для ансамбля с новым алгоритмом.</span></li>
<li><span>Повторяем шаги 2-4, пока не достигнем желаемого количества алгоритмов / пока значение функции ошибки не станет достаточно маленьким / пока модуль антиградиента не стал достаточно маленьким.</span></li>
</ol>
</li>
<li><span>Внимательный читатель заметит, что в алгоритме предполагается, что базовый алгоритм решает задачу регрессии, когда обучается под антиградиент. Фактически, нас устраивает что мы используем для обучения алгоритмов классификации, которые обычно предсказывают вероятности, среднеквадратичную ошибку. Причиной этого является то, что вся информация о минимизации исходного функционала уже заложена в векторе антиградиента, на который обучается очередная модель.</span></li>
</ul><h3 id="12-Матричные-вычисления-Матричное-дифференцирование-Производные-основных-функций-aTx-Ax" data-id="12-Матричные-вычисления-Матричное-дифференцирование-Производные-основных-функций-aTx-Ax"><a class="anchor hidden-xs" href="#12-Матричные-вычисления-Матричное-дифференцирование-Производные-основных-функций-aTx-Ax" title="12-Матричные-вычисления-Матричное-дифференцирование-Производные-основных-функций-aTx-Ax"><span class="octicon octicon-link"></span></a><span>12. Матричные вычисления. Матричное дифференцирование. Производные основных функций: </span><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-466-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 114%; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msup><mi>a</mi><mi>T</mi></msup><mi>x</mi><mo>,</mo><mi>A</mi><mi>x</mi><mo>.</mo></math>" role="presentation"><span id="MJXc-Node-6139" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-6140" class="mjx-mrow"><span id="MJXc-Node-6141" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-6142" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.221em; padding-bottom: 0.265em;">a</span></span></span><span class="mjx-sup" style="font-size: 70.7%; vertical-align: 0.513em; padding-left: 0px; padding-right: 0.071em;"><span id="MJXc-Node-6143" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.441em; padding-bottom: 0.265em; padding-right: 0.12em;">T</span></span></span></span><span id="MJXc-Node-6144" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.221em; padding-bottom: 0.309em;">x</span></span><span id="MJXc-Node-6145" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="margin-top: -0.173em; padding-bottom: 0.529em;">,</span></span><span id="MJXc-Node-6146" class="mjx-mi MJXc-space1"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.485em; padding-bottom: 0.265em;">A</span></span><span id="MJXc-Node-6147" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.221em; padding-bottom: 0.309em;">x</span></span><span id="MJXc-Node-6148" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="margin-top: -0.173em; padding-bottom: 0.353em;">.</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msup><mi>a</mi><mi>T</mi></msup><mi>x</mi><mo>,</mo><mi>A</mi><mi>x</mi><mo>.</mo></math></span></span><script type="math/tex" id="MathJax-Element-466">a^Tx, Ax.</script></span></h3><p><em><span>Подробно этот вопрос на лекциях не рассказывался.</span></em><br>
<span>При обучении нейронных сетей мы часто работает с матричными вычислениями. В частности, для реализации backpropogation необходимо уметь считать производные результатов слоёв по входным данным и параметрам слоя. Напомним суть некоторых таких производных:</span></p><ul>
<li><span>Производная скаляра по матрице </span><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-136-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 118%; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>n</mi><mo>&amp;#x00D7;</mo><mi>m</mi></math>" role="presentation"><span id="MJXc-Node-2280" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-2281" class="mjx-mrow"><span id="MJXc-Node-2282" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.215em; padding-bottom: 0.267em;">n</span></span><span id="MJXc-Node-2283" class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.215em; padding-bottom: 0.32em;">×</span></span><span id="MJXc-Node-2284" class="mjx-mi MJXc-space2"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.215em; padding-bottom: 0.267em;">m</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>n</mi><mo>×</mo><mi>m</mi></math></span></span><script type="math/tex" id="MathJax-Element-136">n \times m</script></span><span> — матрица формы </span><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-137-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 118%; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>n</mi><mo>&amp;#x00D7;</mo><mi>m</mi><mo>.</mo></math>" role="presentation"><span id="MJXc-Node-2285" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-2286" class="mjx-mrow"><span id="MJXc-Node-2287" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.215em; padding-bottom: 0.267em;">n</span></span><span id="MJXc-Node-2288" class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.215em; padding-bottom: 0.32em;">×</span></span><span id="MJXc-Node-2289" class="mjx-mi MJXc-space2"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.215em; padding-bottom: 0.267em;">m</span></span><span id="MJXc-Node-2290" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="margin-top: -0.156em; padding-bottom: 0.32em;">.</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>n</mi><mo>×</mo><mi>m</mi><mo>.</mo></math></span></span><script type="math/tex" id="MathJax-Element-137">n \times m.</script></span></li>
<li><span>Производная скаляра по вектору размерности </span><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-138-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 118%; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>n</mi></math>" role="presentation"><span id="MJXc-Node-2291" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-2292" class="mjx-mrow"><span id="MJXc-Node-2293" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.215em; padding-bottom: 0.267em;">n</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>n</mi></math></span></span><script type="math/tex" id="MathJax-Element-138">n</script></span><span> (градиент) — вектор размерности </span><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-139-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 118%; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>n</mi><mo>.</mo></math>" role="presentation"><span id="MJXc-Node-2294" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-2295" class="mjx-mrow"><span id="MJXc-Node-2296" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.215em; padding-bottom: 0.267em;">n</span></span><span id="MJXc-Node-2297" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="margin-top: -0.156em; padding-bottom: 0.32em;">.</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>n</mi><mo>.</mo></math></span></span><script type="math/tex" id="MathJax-Element-139">n.</script></span></li>
<li><span>Производная матрицы по матрицы (возникает в линейном слое) — в общем случае тензор 4 ранга.</span>
<ul>
<li><span>Тензор на пальцах:</span>
<ul>
<li><span>Нулевого ранга = скаляр</span></li>
<li><span>Первого ранга = вектор</span></li>
<li><span>Второго ранга = матрица</span></li>
<li><span>Третьего ранга = вектор из матриц (3 индекса)</span></li>
<li><span>Четвёртого ранга = матрица из матриц (4 индекса)</span></li>
<li><em><span>К существованию последних двух объектов автор пришёл самостоятельно и не претендует на экспертность в тензорном исчислении.</span></em></li>
</ul>
</li>
<li><span>На самом деле при обучении моделей никто не считает и не хранит в памяти тензоры 4 ранга, так как это слишком дорого, если мы работаем в пространствах высокой размерности. Так как модель линейного слоя, использующаяся в нейронных сетях простая </span><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-140-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 118%; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mo stretchy=&quot;false&quot;>(</mo><mi>f</mi><mo stretchy=&quot;false&quot;>(</mo><mi>X</mi><mo stretchy=&quot;false&quot;>)</mo><mo>=</mo><mi>X</mi><mi>W</mi><mo>+</mo><mi>b</mi><mo stretchy=&quot;false&quot;>)</mo><mo>,</mo></math>" role="presentation"><span id="MJXc-Node-2298" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-2299" class="mjx-mrow"><span id="MJXc-Node-2300" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.479em; padding-bottom: 0.585em;">(</span></span><span id="MJXc-Node-2301" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.479em; padding-right: 0.06em;">f</span></span><span id="MJXc-Node-2302" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.479em; padding-bottom: 0.585em;">(</span></span><span id="MJXc-Node-2303" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.267em; padding-right: 0.024em;">X</span></span><span id="MJXc-Node-2304" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.479em; padding-bottom: 0.585em;">)</span></span><span id="MJXc-Node-2305" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.056em; padding-bottom: 0.32em;">=</span></span><span id="MJXc-Node-2306" class="mjx-mi MJXc-space3"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.267em; padding-right: 0.024em;">X</span></span><span id="MJXc-Node-2307" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.32em; padding-right: 0.104em;">W</span></span><span id="MJXc-Node-2308" class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.32em; padding-bottom: 0.426em;">+</span></span><span id="MJXc-Node-2309" class="mjx-mi MJXc-space2"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.267em;">b</span></span><span id="MJXc-Node-2310" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.479em; padding-bottom: 0.585em;">)</span></span><span id="MJXc-Node-2311" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="margin-top: -0.156em; padding-bottom: 0.532em;">,</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo stretchy="false">(</mo><mi>f</mi><mo stretchy="false">(</mo><mi>X</mi><mo stretchy="false">)</mo><mo>=</mo><mi>X</mi><mi>W</mi><mo>+</mo><mi>b</mi><mo stretchy="false">)</mo><mo>,</mo></math></span></span><script type="math/tex" id="MathJax-Element-140">(f(X) = XW + b),</script></span><span> То в этом тензоре 4 ранга будет очень много нулей (потому что при элемент </span><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-141-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 118%; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>a</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>i</mi><mi>j</mi></mrow></msub></math>" role="presentation"><span id="MJXc-Node-2312" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-2313" class="mjx-mrow"><span id="MJXc-Node-2314" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-2315" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.215em; padding-bottom: 0.267em;">a</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-2316" class="mjx-texatom" style=""><span id="MJXc-Node-2317" class="mjx-mrow"><span id="MJXc-Node-2318" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.426em; padding-bottom: 0.267em;">i</span></span><span id="MJXc-Node-2319" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.426em; padding-bottom: 0.479em;">j</span></span></span></span></span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>a</mi><mrow class="MJX-TeXAtom-ORD"><mi>i</mi><mi>j</mi></mrow></msub></math></span></span><script type="math/tex" id="MathJax-Element-141">a_{ij}</script></span><span> произведения матриц зависит только от строки </span><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-142-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 118%; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>i</mi></math>" role="presentation"><span id="MJXc-Node-2320" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-2321" class="mjx-mrow"><span id="MJXc-Node-2322" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.426em; padding-bottom: 0.267em;">i</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>i</mi></math></span></span><script type="math/tex" id="MathJax-Element-142">i</script></span><span> первого множителя и от столбца </span><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-143-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 118%; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>j</mi></math>" role="presentation"><span id="MJXc-Node-2323" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-2324" class="mjx-mrow"><span id="MJXc-Node-2325" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.426em; padding-bottom: 0.479em;">j</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>j</mi></math></span></span><script type="math/tex" id="MathJax-Element-143">j</script></span><span> второго) и поэтому его можно “сжать” до матрицы.</span></li>
<li><span>Более подробно как считаются градиенты линейных слоёв можно посмотреть </span><a href="http://cs231n.stanford.edu/handouts/linear-backprop.pdf" target="_blank" rel="noopener"><span>здесь</span></a><span>.</span></li>
</ul>
</li>
</ul><p><span>Производные основных функций:</span><br>
<span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span class="mjx-chtml MJXc-display" style="text-align: center;"><span id="MathJax-Element-144-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 118%; text-align: center; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><mtable rowspacing=&quot;3pt&quot; columnspacing=&quot;1em&quot; displaystyle=&quot;true&quot;><mtr><mtd><mfrac><mrow><mi mathvariant=&quot;normal&quot;>&amp;#x2202;</mi><mo stretchy=&quot;false&quot;>(</mo><msup><mi>a</mi><mi>T</mi></msup><mi>x</mi><mo stretchy=&quot;false&quot;>)</mo></mrow><mrow><mi mathvariant=&quot;normal&quot;>&amp;#x2202;</mi><mi>x</mi></mrow></mfrac><mo>=</mo><mi>a</mi></mtd></mtr><mtr><mtd><mfrac><mrow><mi mathvariant=&quot;normal&quot;>&amp;#x2202;</mi><mo stretchy=&quot;false&quot;>(</mo><mi>A</mi><mi>x</mi><mo stretchy=&quot;false&quot;>)</mo></mrow><mrow><mi mathvariant=&quot;normal&quot;>&amp;#x2202;</mi><mi>x</mi></mrow></mfrac><mo>=</mo><mi>A</mi></mtd></mtr></mtable></math>" role="presentation"><span id="MJXc-Node-2326" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-2327" class="mjx-mrow"><span id="MJXc-Node-2328" class="mjx-mtable" style="vertical-align: -2.23em; padding: 0px 0.167em;"><span class="mjx-table"><span id="MJXc-Node-2329" class="mjx-mtr" style="height: 2.522em;"><span id="MJXc-Node-2330" class="mjx-mtd" style="padding: 0px; width: 5.281em;"><span id="MJXc-Node-2331" class="mjx-mrow"><span id="MJXc-Node-2332" class="mjx-mfrac"><span class="mjx-box MJXc-stacked" style="width: 3.178em; padding: 0px 0.12em;"><span class="mjx-numerator" style="width: 3.178em; top: -1.61em;"><span id="MJXc-Node-2333" class="mjx-mrow"><span id="MJXc-Node-2334" class="mjx-mi"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.426em; padding-bottom: 0.373em; padding-right: 0.035em;">∂</span></span><span id="MJXc-Node-2335" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.479em; padding-bottom: 0.585em;">(</span></span><span id="MJXc-Node-2336" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-2337" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.215em; padding-bottom: 0.267em;">a</span></span></span><span class="mjx-sup" style="font-size: 70.7%; vertical-align: 0.513em; padding-left: 0px; padding-right: 0.071em;"><span id="MJXc-Node-2338" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.267em; padding-right: 0.12em;">T</span></span></span></span><span id="MJXc-Node-2339" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.215em; padding-bottom: 0.267em;">x</span></span><span id="MJXc-Node-2340" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.479em; padding-bottom: 0.585em;">)</span></span></span></span><span class="mjx-denominator" style="width: 3.178em; bottom: -0.763em;"><span id="MJXc-Node-2341" class="mjx-mrow"><span id="MJXc-Node-2342" class="mjx-mi"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.426em; padding-bottom: 0.373em; padding-right: 0.035em;">∂</span></span><span id="MJXc-Node-2343" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.215em; padding-bottom: 0.267em;">x</span></span></span></span><span style="border-bottom-width: 1.3px; border-bottom-style: solid; top: -0.283em; width: 3.178em;" class="mjx-line"></span></span><span style="height: 2.372em; vertical-align: -0.763em;" class="mjx-vsize"></span></span><span id="MJXc-Node-2344" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.056em; padding-bottom: 0.32em;">=</span></span><span id="MJXc-Node-2345" class="mjx-mi MJXc-space3"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.215em; padding-bottom: 0.267em;">a</span></span><span class="mjx-strut"></span></span></span></span><span id="MJXc-Node-2346" class="mjx-mtr" style="height: 2.438em;"><span id="MJXc-Node-2347" class="mjx-mtd" style="padding: 0.15em 0px 0px;"><span id="MJXc-Node-2348" class="mjx-mrow"><span id="MJXc-Node-2349" class="mjx-mfrac"><span class="mjx-box MJXc-stacked" style="width: 2.866em; padding: 0px 0.12em;"><span class="mjx-numerator" style="width: 2.866em; top: -1.526em;"><span id="MJXc-Node-2350" class="mjx-mrow"><span id="MJXc-Node-2351" class="mjx-mi"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.426em; padding-bottom: 0.373em; padding-right: 0.035em;">∂</span></span><span id="MJXc-Node-2352" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.479em; padding-bottom: 0.585em;">(</span></span><span id="MJXc-Node-2353" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.267em;">A</span></span><span id="MJXc-Node-2354" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.215em; padding-bottom: 0.267em;">x</span></span><span id="MJXc-Node-2355" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.479em; padding-bottom: 0.585em;">)</span></span></span></span><span class="mjx-denominator" style="width: 2.866em; bottom: -0.763em;"><span id="MJXc-Node-2356" class="mjx-mrow"><span id="MJXc-Node-2357" class="mjx-mi"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.426em; padding-bottom: 0.373em; padding-right: 0.035em;">∂</span></span><span id="MJXc-Node-2358" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.215em; padding-bottom: 0.267em;">x</span></span></span></span><span style="border-bottom-width: 1.3px; border-bottom-style: solid; top: -0.283em; width: 2.866em;" class="mjx-line"></span></span><span style="height: 2.288em; vertical-align: -0.763em;" class="mjx-vsize"></span></span><span id="MJXc-Node-2359" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.056em; padding-bottom: 0.32em;">=</span></span><span id="MJXc-Node-2360" class="mjx-mi MJXc-space3"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.267em;">A</span></span><span class="mjx-strut"></span></span></span></span></span></span></span></span><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mtable rowspacing="3pt" columnspacing="1em" displaystyle="true"><mtr><mtd><mfrac><mrow><mi mathvariant="normal">∂</mi><mo stretchy="false">(</mo><msup><mi>a</mi><mi>T</mi></msup><mi>x</mi><mo stretchy="false">)</mo></mrow><mrow><mi mathvariant="normal">∂</mi><mi>x</mi></mrow></mfrac><mo>=</mo><mi>a</mi></mtd></mtr><mtr><mtd><mfrac><mrow><mi mathvariant="normal">∂</mi><mo stretchy="false">(</mo><mi>A</mi><mi>x</mi><mo stretchy="false">)</mo></mrow><mrow><mi mathvariant="normal">∂</mi><mi>x</mi></mrow></mfrac><mo>=</mo><mi>A</mi></mtd></mtr></mtable></math></span></span></span><script type="math/tex; mode=display" id="MathJax-Element-144">
\begin{gather}
    \frac{\partial (a^Tx)}{\partial x} = a \\
    \frac{\partial (Ax)}{\partial x} = A
\end{gather}
</script></span></p><h3 id="13-Backpropagation-Градиентный-спуск-GD-Стохастический-градиентный-спуск-SGD-Adaptive-gradient-methods-Adagrad-adamax-adadelta-RMSprop-Adam" data-id="13-Backpropagation-Градиентный-спуск-GD-Стохастический-градиентный-спуск-SGD-Adaptive-gradient-methods-Adagrad-adamax-adadelta-RMSprop-Adam"><a class="anchor hidden-xs" href="#13-Backpropagation-Градиентный-спуск-GD-Стохастический-градиентный-спуск-SGD-Adaptive-gradient-methods-Adagrad-adamax-adadelta-RMSprop-Adam" title="13-Backpropagation-Градиентный-спуск-GD-Стохастический-градиентный-спуск-SGD-Adaptive-gradient-methods-Adagrad-adamax-adadelta-RMSprop-Adam"><span class="octicon octicon-link"></span></a><span>13. Backpropagation. Градиентный спуск (GD). Стохастический градиентный спуск (SGD). Adaptive gradient methods. Adagrad, adamax, adadelta. RMSprop. Adam.</span></h3><h4 id="Backpropagation" data-id="Backpropagation"><a class="anchor hidden-xs" href="#Backpropagation" title="Backpropagation"><span class="octicon octicon-link"></span></a><span>Backpropagation</span></h4><p><strong><span>Backpropogation</span></strong><span> — алгоритм, использующийся для расчёта градиента нейронной сети во всем её параметрам. Для обучения нейронных сетей нам нужно уметь вычислять этот градиент, т.к. с ним работает большинство используемых методов оптимизации. Однако вычислять частную производную по каждому параметру (или даже по параметрам каждого слоя) и составлять из них многомерное нечто долго, поэтому используется другой подход, учитывающий архитектуру нейронных сетей.</span><br>
<span>Мы постепенно начинаем считать градиент с производной функции ошибки по результату последнего слоя. Так как для каждого слоя мы умеем считать производную результата по входным данным и по параметрам, то мы слой за слоем подсчитываем эти градиенты, начиная с последнего. Если обозначить </span><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-145-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 118%; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>L</mi></math>" role="presentation"><span id="MJXc-Node-2361" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-2362" class="mjx-mrow"><span id="MJXc-Node-2363" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.267em;">L</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>L</mi></math></span></span><script type="math/tex" id="MathJax-Element-145">L</script></span><span> — функцию ошибки, </span><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-146-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 118%; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>X</mi></math>" role="presentation"><span id="MJXc-Node-2364" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-2365" class="mjx-mrow"><span id="MJXc-Node-2366" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.267em; padding-right: 0.024em;">X</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>X</mi></math></span></span><script type="math/tex" id="MathJax-Element-146">X</script></span><span> — входные данные слоя, </span><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-147-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 118%; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>Y</mi></math>" role="presentation"><span id="MJXc-Node-2367" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-2368" class="mjx-mrow"><span id="MJXc-Node-2369" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.267em; padding-right: 0.182em;">Y</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>Y</mi></math></span></span><script type="math/tex" id="MathJax-Element-147">Y</script></span><span> — результат работы слоя, а </span><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-148-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 118%; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>&amp;#x03B8;</mi></math>" role="presentation"><span id="MJXc-Node-2370" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-2371" class="mjx-mrow"><span id="MJXc-Node-2372" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.267em;">θ</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>θ</mi></math></span></span><script type="math/tex" id="MathJax-Element-148">\theta</script></span><span> — параметры слоя, то эти производные вычисляются следующим образом:</span><br>
<span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span class="mjx-chtml MJXc-display" style="text-align: center;"><span id="MathJax-Element-149-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 118%; text-align: center; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><mtable rowspacing=&quot;3pt&quot; columnspacing=&quot;1em&quot; displaystyle=&quot;true&quot;><mtr><mtd><mfrac><mrow><mi mathvariant=&quot;normal&quot;>&amp;#x2202;</mi><mi>L</mi></mrow><mrow><mi mathvariant=&quot;normal&quot;>&amp;#x2202;</mi><mi>X</mi></mrow></mfrac><mo>=</mo><mfrac><mrow><mi mathvariant=&quot;normal&quot;>&amp;#x2202;</mi><mi>L</mi></mrow><mrow><mi mathvariant=&quot;normal&quot;>&amp;#x2202;</mi><mi>Y</mi></mrow></mfrac><mo>&amp;#x22C5;</mo><mfrac><mrow><mi mathvariant=&quot;normal&quot;>&amp;#x2202;</mi><mi>Y</mi></mrow><mrow><mi mathvariant=&quot;normal&quot;>&amp;#x2202;</mi><mi>X</mi></mrow></mfrac></mtd></mtr><mtr><mtd><mfrac><mrow><mi mathvariant=&quot;normal&quot;>&amp;#x2202;</mi><mi>L</mi></mrow><mrow><mi mathvariant=&quot;normal&quot;>&amp;#x2202;</mi><mi>&amp;#x03B8;</mi></mrow></mfrac><mo>=</mo><mfrac><mrow><mi mathvariant=&quot;normal&quot;>&amp;#x2202;</mi><mi>L</mi></mrow><mrow><mi mathvariant=&quot;normal&quot;>&amp;#x2202;</mi><mi>Y</mi></mrow></mfrac><mo>&amp;#x22C5;</mo><mfrac><mrow><mi mathvariant=&quot;normal&quot;>&amp;#x2202;</mi><mi>Y</mi></mrow><mrow><mi mathvariant=&quot;normal&quot;>&amp;#x2202;</mi><mi>&amp;#x03B8;</mi></mrow></mfrac></mtd></mtr></mtable></math>" role="presentation"><span id="MJXc-Node-2373" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-2374" class="mjx-mrow"><span id="MJXc-Node-2375" class="mjx-mtable" style="vertical-align: -2.079em; padding: 0px 0.167em;"><span class="mjx-table"><span id="MJXc-Node-2376" class="mjx-mtr" style="height: 2.329em;"><span id="MJXc-Node-2377" class="mjx-mtd" style="padding: 0px; width: 7.541em;"><span id="MJXc-Node-2378" class="mjx-mrow"><span id="MJXc-Node-2379" class="mjx-mfrac"><span class="mjx-box MJXc-stacked" style="width: 1.618em; padding: 0px 0.12em;"><span class="mjx-numerator" style="width: 1.618em; top: -1.417em;"><span id="MJXc-Node-2380" class="mjx-mrow"><span id="MJXc-Node-2381" class="mjx-mi"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.426em; padding-bottom: 0.373em; padding-right: 0.035em;">∂</span></span><span id="MJXc-Node-2382" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.267em;">L</span></span></span></span><span class="mjx-denominator" style="width: 1.618em; bottom: -0.763em;"><span id="MJXc-Node-2383" class="mjx-mrow"><span id="MJXc-Node-2384" class="mjx-mi"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.426em; padding-bottom: 0.373em; padding-right: 0.035em;">∂</span></span><span id="MJXc-Node-2385" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.267em; padding-right: 0.024em;">X</span></span></span></span><span style="border-bottom-width: 1.3px; border-bottom-style: solid; top: -0.283em; width: 1.618em;" class="mjx-line"></span></span><span style="height: 2.179em; vertical-align: -0.763em;" class="mjx-vsize"></span></span><span id="MJXc-Node-2386" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.056em; padding-bottom: 0.32em;">=</span></span><span id="MJXc-Node-2387" class="mjx-mfrac MJXc-space3"><span class="mjx-box MJXc-stacked" style="width: 1.529em; padding: 0px 0.12em;"><span class="mjx-numerator" style="width: 1.529em; top: -1.417em;"><span id="MJXc-Node-2388" class="mjx-mrow"><span id="MJXc-Node-2389" class="mjx-mi"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.426em; padding-bottom: 0.373em; padding-right: 0.035em;">∂</span></span><span id="MJXc-Node-2390" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.267em;">L</span></span></span></span><span class="mjx-denominator" style="width: 1.529em; bottom: -0.763em;"><span id="MJXc-Node-2391" class="mjx-mrow"><span id="MJXc-Node-2392" class="mjx-mi"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.426em; padding-bottom: 0.373em; padding-right: 0.035em;">∂</span></span><span id="MJXc-Node-2393" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.267em; padding-right: 0.182em;">Y</span></span></span></span><span style="border-bottom-width: 1.3px; border-bottom-style: solid; top: -0.283em; width: 1.529em;" class="mjx-line"></span></span><span style="height: 2.179em; vertical-align: -0.763em;" class="mjx-vsize"></span></span><span id="MJXc-Node-2394" class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.003em; padding-bottom: 0.32em;">⋅</span></span><span id="MJXc-Node-2395" class="mjx-mfrac MJXc-space2"><span class="mjx-box MJXc-stacked" style="width: 1.618em; padding: 0px 0.12em;"><span class="mjx-numerator" style="width: 1.618em; top: -1.417em;"><span id="MJXc-Node-2396" class="mjx-mrow"><span id="MJXc-Node-2397" class="mjx-mi"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.426em; padding-bottom: 0.373em; padding-right: 0.035em;">∂</span></span><span id="MJXc-Node-2398" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.267em; padding-right: 0.182em;">Y</span></span></span></span><span class="mjx-denominator" style="width: 1.618em; bottom: -0.763em;"><span id="MJXc-Node-2399" class="mjx-mrow"><span id="MJXc-Node-2400" class="mjx-mi"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.426em; padding-bottom: 0.373em; padding-right: 0.035em;">∂</span></span><span id="MJXc-Node-2401" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.267em; padding-right: 0.024em;">X</span></span></span></span><span style="border-bottom-width: 1.3px; border-bottom-style: solid; top: -0.283em; width: 1.618em;" class="mjx-line"></span></span><span style="height: 2.179em; vertical-align: -0.763em;" class="mjx-vsize"></span></span><span class="mjx-strut"></span></span></span></span><span id="MJXc-Node-2402" class="mjx-mtr" style="height: 2.329em;"><span id="MJXc-Node-2403" class="mjx-mtd" style="padding: 0.15em 0px 0px;"><span id="MJXc-Node-2404" class="mjx-mrow"><span id="MJXc-Node-2405" class="mjx-mfrac"><span class="mjx-box MJXc-stacked" style="width: 1.447em; padding: 0px 0.12em;"><span class="mjx-numerator" style="width: 1.447em; top: -1.417em;"><span id="MJXc-Node-2406" class="mjx-mrow"><span id="MJXc-Node-2407" class="mjx-mi"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.426em; padding-bottom: 0.373em; padding-right: 0.035em;">∂</span></span><span id="MJXc-Node-2408" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.267em;">L</span></span></span></span><span class="mjx-denominator" style="width: 1.447em; bottom: -0.763em;"><span id="MJXc-Node-2409" class="mjx-mrow"><span id="MJXc-Node-2410" class="mjx-mi"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.426em; padding-bottom: 0.373em; padding-right: 0.035em;">∂</span></span><span id="MJXc-Node-2411" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.267em;">θ</span></span></span></span><span style="border-bottom-width: 1.3px; border-bottom-style: solid; top: -0.283em; width: 1.447em;" class="mjx-line"></span></span><span style="height: 2.179em; vertical-align: -0.763em;" class="mjx-vsize"></span></span><span id="MJXc-Node-2412" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.056em; padding-bottom: 0.32em;">=</span></span><span id="MJXc-Node-2413" class="mjx-mfrac MJXc-space3"><span class="mjx-box MJXc-stacked" style="width: 1.529em; padding: 0px 0.12em;"><span class="mjx-numerator" style="width: 1.529em; top: -1.417em;"><span id="MJXc-Node-2414" class="mjx-mrow"><span id="MJXc-Node-2415" class="mjx-mi"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.426em; padding-bottom: 0.373em; padding-right: 0.035em;">∂</span></span><span id="MJXc-Node-2416" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.267em;">L</span></span></span></span><span class="mjx-denominator" style="width: 1.529em; bottom: -0.763em;"><span id="MJXc-Node-2417" class="mjx-mrow"><span id="MJXc-Node-2418" class="mjx-mi"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.426em; padding-bottom: 0.373em; padding-right: 0.035em;">∂</span></span><span id="MJXc-Node-2419" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.267em; padding-right: 0.182em;">Y</span></span></span></span><span style="border-bottom-width: 1.3px; border-bottom-style: solid; top: -0.283em; width: 1.529em;" class="mjx-line"></span></span><span style="height: 2.179em; vertical-align: -0.763em;" class="mjx-vsize"></span></span><span id="MJXc-Node-2420" class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.003em; padding-bottom: 0.32em;">⋅</span></span><span id="MJXc-Node-2421" class="mjx-mfrac MJXc-space2"><span class="mjx-box MJXc-stacked" style="width: 1.529em; padding: 0px 0.12em;"><span class="mjx-numerator" style="width: 1.529em; top: -1.417em;"><span id="MJXc-Node-2422" class="mjx-mrow"><span id="MJXc-Node-2423" class="mjx-mi"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.426em; padding-bottom: 0.373em; padding-right: 0.035em;">∂</span></span><span id="MJXc-Node-2424" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.267em; padding-right: 0.182em;">Y</span></span></span></span><span class="mjx-denominator" style="width: 1.529em; bottom: -0.763em;"><span id="MJXc-Node-2425" class="mjx-mrow"><span id="MJXc-Node-2426" class="mjx-mi"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.426em; padding-bottom: 0.373em; padding-right: 0.035em;">∂</span></span><span id="MJXc-Node-2427" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.267em;">θ</span></span></span></span><span style="border-bottom-width: 1.3px; border-bottom-style: solid; top: -0.283em; width: 1.529em;" class="mjx-line"></span></span><span style="height: 2.179em; vertical-align: -0.763em;" class="mjx-vsize"></span></span><span class="mjx-strut"></span></span></span></span></span></span></span></span><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mtable rowspacing="3pt" columnspacing="1em" displaystyle="true"><mtr><mtd><mfrac><mrow><mi mathvariant="normal">∂</mi><mi>L</mi></mrow><mrow><mi mathvariant="normal">∂</mi><mi>X</mi></mrow></mfrac><mo>=</mo><mfrac><mrow><mi mathvariant="normal">∂</mi><mi>L</mi></mrow><mrow><mi mathvariant="normal">∂</mi><mi>Y</mi></mrow></mfrac><mo>⋅</mo><mfrac><mrow><mi mathvariant="normal">∂</mi><mi>Y</mi></mrow><mrow><mi mathvariant="normal">∂</mi><mi>X</mi></mrow></mfrac></mtd></mtr><mtr><mtd><mfrac><mrow><mi mathvariant="normal">∂</mi><mi>L</mi></mrow><mrow><mi mathvariant="normal">∂</mi><mi>θ</mi></mrow></mfrac><mo>=</mo><mfrac><mrow><mi mathvariant="normal">∂</mi><mi>L</mi></mrow><mrow><mi mathvariant="normal">∂</mi><mi>Y</mi></mrow></mfrac><mo>⋅</mo><mfrac><mrow><mi mathvariant="normal">∂</mi><mi>Y</mi></mrow><mrow><mi mathvariant="normal">∂</mi><mi>θ</mi></mrow></mfrac></mtd></mtr></mtable></math></span></span></span><script type="math/tex; mode=display" id="MathJax-Element-149">
\begin{gather}
    \frac{\partial L}{\partial X} = \frac{\partial L}{\partial Y} \cdot \frac{\partial Y}{\partial X}\\
    \frac{\partial L}{\partial \theta} = \frac{\partial L}{\partial Y} \cdot \frac{\partial Y}{\partial \theta}
\end{gather}
</script></span><br>
<span>Здесь </span><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-150-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 118%; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mfrac><mrow><mi mathvariant=&quot;normal&quot;>&amp;#x2202;</mi><mi>L</mi></mrow><mrow><mi mathvariant=&quot;normal&quot;>&amp;#x2202;</mi><mi>Y</mi></mrow></mfrac></math>" role="presentation"><span id="MJXc-Node-2428" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-2429" class="mjx-mrow"><span id="MJXc-Node-2430" class="mjx-mfrac"><span class="mjx-box MJXc-stacked" style="width: 1.081em; padding: 0px 0.12em;"><span class="mjx-numerator" style="font-size: 70.7%; width: 1.529em; top: -1.37em;"><span id="MJXc-Node-2431" class="mjx-mrow" style=""><span id="MJXc-Node-2432" class="mjx-mi"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.426em; padding-bottom: 0.373em; padding-right: 0.035em;">∂</span></span><span id="MJXc-Node-2433" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.267em;">L</span></span></span></span><span class="mjx-denominator" style="font-size: 70.7%; width: 1.529em; bottom: -0.663em;"><span id="MJXc-Node-2434" class="mjx-mrow" style=""><span id="MJXc-Node-2435" class="mjx-mi"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.426em; padding-bottom: 0.373em; padding-right: 0.035em;">∂</span></span><span id="MJXc-Node-2436" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.267em; padding-right: 0.182em;">Y</span></span></span></span><span style="border-bottom-width: 1.3px; border-bottom-style: solid; top: -0.283em; width: 1.081em;" class="mjx-line"></span></span><span style="height: 1.438em; vertical-align: -0.469em;" class="mjx-vsize"></span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mfrac><mrow><mi mathvariant="normal">∂</mi><mi>L</mi></mrow><mrow><mi mathvariant="normal">∂</mi><mi>Y</mi></mrow></mfrac></math></span></span><script type="math/tex" id="MathJax-Element-150">\frac{\partial L}{\partial Y}</script></span><span> — градиент посчитанный на предыдущем шаге (то есть в структуре сети — на следующем слое), </span><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-151-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 118%; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mfrac><mrow><mi mathvariant=&quot;normal&quot;>&amp;#x2202;</mi><mi>L</mi></mrow><mrow><mi mathvariant=&quot;normal&quot;>&amp;#x2202;</mi><mi>X</mi></mrow></mfrac></math>" role="presentation"><span id="MJXc-Node-2437" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-2438" class="mjx-mrow"><span id="MJXc-Node-2439" class="mjx-mfrac"><span class="mjx-box MJXc-stacked" style="width: 1.144em; padding: 0px 0.12em;"><span class="mjx-numerator" style="font-size: 70.7%; width: 1.618em; top: -1.37em;"><span id="MJXc-Node-2440" class="mjx-mrow" style=""><span id="MJXc-Node-2441" class="mjx-mi"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.426em; padding-bottom: 0.373em; padding-right: 0.035em;">∂</span></span><span id="MJXc-Node-2442" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.267em;">L</span></span></span></span><span class="mjx-denominator" style="font-size: 70.7%; width: 1.618em; bottom: -0.663em;"><span id="MJXc-Node-2443" class="mjx-mrow" style=""><span id="MJXc-Node-2444" class="mjx-mi"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.426em; padding-bottom: 0.373em; padding-right: 0.035em;">∂</span></span><span id="MJXc-Node-2445" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.267em; padding-right: 0.024em;">X</span></span></span></span><span style="border-bottom-width: 1.3px; border-bottom-style: solid; top: -0.283em; width: 1.144em;" class="mjx-line"></span></span><span style="height: 1.438em; vertical-align: -0.469em;" class="mjx-vsize"></span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mfrac><mrow><mi mathvariant="normal">∂</mi><mi>L</mi></mrow><mrow><mi mathvariant="normal">∂</mi><mi>X</mi></mrow></mfrac></math></span></span><script type="math/tex" id="MathJax-Element-151">\frac{\partial L}{\partial X}</script></span><span> — производная по </span><em><span>результату предыдущего (в архитектуре сети) слоя</span></em><span>, которая передаётся дальше в качестве </span><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-152-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 118%; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mfrac><mrow><mi mathvariant=&quot;normal&quot;>&amp;#x2202;</mi><mi>L</mi></mrow><mrow><mi mathvariant=&quot;normal&quot;>&amp;#x2202;</mi><mi>Y</mi></mrow></mfrac></math>" role="presentation"><span id="MJXc-Node-2446" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-2447" class="mjx-mrow"><span id="MJXc-Node-2448" class="mjx-mfrac"><span class="mjx-box MJXc-stacked" style="width: 1.081em; padding: 0px 0.12em;"><span class="mjx-numerator" style="font-size: 70.7%; width: 1.529em; top: -1.37em;"><span id="MJXc-Node-2449" class="mjx-mrow" style=""><span id="MJXc-Node-2450" class="mjx-mi"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.426em; padding-bottom: 0.373em; padding-right: 0.035em;">∂</span></span><span id="MJXc-Node-2451" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.267em;">L</span></span></span></span><span class="mjx-denominator" style="font-size: 70.7%; width: 1.529em; bottom: -0.663em;"><span id="MJXc-Node-2452" class="mjx-mrow" style=""><span id="MJXc-Node-2453" class="mjx-mi"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.426em; padding-bottom: 0.373em; padding-right: 0.035em;">∂</span></span><span id="MJXc-Node-2454" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.267em; padding-right: 0.182em;">Y</span></span></span></span><span style="border-bottom-width: 1.3px; border-bottom-style: solid; top: -0.283em; width: 1.081em;" class="mjx-line"></span></span><span style="height: 1.438em; vertical-align: -0.469em;" class="mjx-vsize"></span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mfrac><mrow><mi mathvariant="normal">∂</mi><mi>L</mi></mrow><mrow><mi mathvariant="normal">∂</mi><mi>Y</mi></mrow></mfrac></math></span></span><script type="math/tex" id="MathJax-Element-152">\frac{\partial L}{\partial Y}</script></span><span> предыдущему слою и </span><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-153-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 118%; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mfrac><mrow><mi mathvariant=&quot;normal&quot;>&amp;#x2202;</mi><mi>L</mi></mrow><mrow><mi mathvariant=&quot;normal&quot;>&amp;#x2202;</mi><mi>&amp;#x03B8;</mi></mrow></mfrac></math>" role="presentation"><span id="MJXc-Node-2455" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-2456" class="mjx-mrow"><span id="MJXc-Node-2457" class="mjx-mfrac"><span class="mjx-box MJXc-stacked" style="width: 1.023em; padding: 0px 0.12em;"><span class="mjx-numerator" style="font-size: 70.7%; width: 1.447em; top: -1.37em;"><span id="MJXc-Node-2458" class="mjx-mrow" style=""><span id="MJXc-Node-2459" class="mjx-mi"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.426em; padding-bottom: 0.373em; padding-right: 0.035em;">∂</span></span><span id="MJXc-Node-2460" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.267em;">L</span></span></span></span><span class="mjx-denominator" style="font-size: 70.7%; width: 1.447em; bottom: -0.663em;"><span id="MJXc-Node-2461" class="mjx-mrow" style=""><span id="MJXc-Node-2462" class="mjx-mi"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.426em; padding-bottom: 0.373em; padding-right: 0.035em;">∂</span></span><span id="MJXc-Node-2463" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.267em;">θ</span></span></span></span><span style="border-bottom-width: 1.3px; border-bottom-style: solid; top: -0.283em; width: 1.023em;" class="mjx-line"></span></span><span style="height: 1.438em; vertical-align: -0.469em;" class="mjx-vsize"></span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mfrac><mrow><mi mathvariant="normal">∂</mi><mi>L</mi></mrow><mrow><mi mathvariant="normal">∂</mi><mi>θ</mi></mrow></mfrac></math></span></span><script type="math/tex" id="MathJax-Element-153">\frac{\partial L}{\partial \theta}</script></span><span> — производная по параметром, которую мы где-то храним и которую будем использовать для обновления параметров этого слоя.</span><br>
<span>Заметим, что значения градиентов нужно вычислять в конкретных точках, то есть нам нужно хранить в слоях значения входных данных каждого слоя.</span><br>
<span>При обучении сети могут использоваться разные градиентные алгоритмы оптимизации. Ниже можно прочитать описания некоторых из них.</span></p><h4 id="Gradient-Descent-GD" data-id="Gradient-Descent-GD"><a class="anchor hidden-xs" href="#Gradient-Descent-GD" title="Gradient-Descent-GD"><span class="octicon octicon-link"></span></a><span>Gradient Descent (GD)</span></h4><p><span>Самый простой способ оптимизации функции это обычный </span><strong><span>градиентный спуск</span></strong><span>. Пусть мы хотим минимизировать функционал ошибки </span><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-154-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 118%; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>J</mi><mo stretchy=&quot;false&quot;>(</mo><mi>&amp;#x03B8;</mi><mo>,</mo><mi>X</mi><mo>,</mo><mi>y</mi><mo stretchy=&quot;false&quot;>)</mo></math>" role="presentation"><span id="MJXc-Node-2464" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-2465" class="mjx-mrow"><span id="MJXc-Node-2466" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.32em; padding-right: 0.078em;">J</span></span><span id="MJXc-Node-2467" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.479em; padding-bottom: 0.585em;">(</span></span><span id="MJXc-Node-2468" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.267em;">θ</span></span><span id="MJXc-Node-2469" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="margin-top: -0.156em; padding-bottom: 0.532em;">,</span></span><span id="MJXc-Node-2470" class="mjx-mi MJXc-space1"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.267em; padding-right: 0.024em;">X</span></span><span id="MJXc-Node-2471" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="margin-top: -0.156em; padding-bottom: 0.532em;">,</span></span><span id="MJXc-Node-2472" class="mjx-mi MJXc-space1"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.215em; padding-bottom: 0.479em; padding-right: 0.006em;">y</span></span><span id="MJXc-Node-2473" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.479em; padding-bottom: 0.585em;">)</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>J</mi><mo stretchy="false">(</mo><mi>θ</mi><mo>,</mo><mi>X</mi><mo>,</mo><mi>y</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-154">J(\theta, X, y)</script></span><span>, где </span><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-155-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 118%; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>&amp;#x03B8;</mi></math>" role="presentation"><span id="MJXc-Node-2474" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-2475" class="mjx-mrow"><span id="MJXc-Node-2476" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.267em;">θ</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>θ</mi></math></span></span><script type="math/tex" id="MathJax-Element-155">\theta</script></span><span> - праметры нашей модели, </span><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-156-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 118%; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>X</mi></math>" role="presentation"><span id="MJXc-Node-2477" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-2478" class="mjx-mrow"><span id="MJXc-Node-2479" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.267em; padding-right: 0.024em;">X</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>X</mi></math></span></span><script type="math/tex" id="MathJax-Element-156">X</script></span><span> - объекты, </span><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-157-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 118%; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>y</mi></math>" role="presentation"><span id="MJXc-Node-2480" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-2481" class="mjx-mrow"><span id="MJXc-Node-2482" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.215em; padding-bottom: 0.479em; padding-right: 0.006em;">y</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>y</mi></math></span></span><script type="math/tex" id="MathJax-Element-157">y</script></span><span> - целевая переменная. Будем подбирать оптимальные параметры </span><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-158-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 118%; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>&amp;#x03B8;</mi></math>" role="presentation"><span id="MJXc-Node-2483" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-2484" class="mjx-mrow"><span id="MJXc-Node-2485" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.267em;">θ</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>θ</mi></math></span></span><script type="math/tex" id="MathJax-Element-158">\theta</script></span><span>. Выберем какую-то начальную точку (например, случайно сгенерированные параметры) и будем итеративно двигать эту точку в направлении антиградиента функционала:</span><br>
<span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span class="mjx-chtml MJXc-display" style="text-align: center;"><span id="MathJax-Element-159-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 118%; text-align: center; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><msub><mi>&amp;#x03B8;</mi><mi>t</mi></msub><mo>=</mo><msub><mi>&amp;#x03B8;</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>t</mi><mo>&amp;#x2212;</mo><mn>1</mn></mrow></msub><mo>&amp;#x2212;</mo><mi>&amp;#x03B7;</mi><mo>&amp;#x22C5;</mo><msub><mi mathvariant=&quot;normal&quot;>&amp;#x2207;</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>&amp;#x03B8;</mi></mrow></msub><mi>J</mi><mrow><mo>(</mo><msub><mi>&amp;#x03B8;</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>t</mi><mo>&amp;#x2212;</mo><mn>1</mn></mrow></msub><mo>;</mo><mi>x</mi><mo>;</mo><mi>y</mi><mo>)</mo></mrow></math>" role="presentation"><span id="MJXc-Node-2486" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-2487" class="mjx-mrow"><span id="MJXc-Node-2488" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-2489" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.267em;">θ</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-2490" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.426em; padding-bottom: 0.267em;">t</span></span></span></span><span id="MJXc-Node-2491" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.056em; padding-bottom: 0.32em;">=</span></span><span id="MJXc-Node-2492" class="mjx-msubsup MJXc-space3"><span class="mjx-base"><span id="MJXc-Node-2493" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.267em;">θ</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-2494" class="mjx-texatom" style=""><span id="MJXc-Node-2495" class="mjx-mrow"><span id="MJXc-Node-2496" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.426em; padding-bottom: 0.267em;">t</span></span><span id="MJXc-Node-2497" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.32em; padding-bottom: 0.426em;">−</span></span><span id="MJXc-Node-2498" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.373em; padding-bottom: 0.32em;">1</span></span></span></span></span></span><span id="MJXc-Node-2499" class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.32em; padding-bottom: 0.426em;">−</span></span><span id="MJXc-Node-2500" class="mjx-mi MJXc-space2"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.215em; padding-bottom: 0.479em; padding-right: 0.006em;">η</span></span><span id="MJXc-Node-2501" class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.003em; padding-bottom: 0.32em;">⋅</span></span><span id="MJXc-Node-2502" class="mjx-msubsup MJXc-space2"><span class="mjx-base"><span id="MJXc-Node-2503" class="mjx-mi"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.373em; padding-bottom: 0.373em;">∇</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.23em; padding-right: 0.071em;"><span id="MJXc-Node-2504" class="mjx-texatom" style=""><span id="MJXc-Node-2505" class="mjx-mrow"><span id="MJXc-Node-2506" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.267em;">θ</span></span></span></span></span></span><span id="MJXc-Node-2507" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.32em; padding-right: 0.078em;">J</span></span><span id="MJXc-Node-2508" class="mjx-mrow MJXc-space1"><span id="MJXc-Node-2509" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.479em; padding-bottom: 0.585em;">(</span></span><span id="MJXc-Node-2510" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-2511" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.267em;">θ</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-2512" class="mjx-texatom" style=""><span id="MJXc-Node-2513" class="mjx-mrow"><span id="MJXc-Node-2514" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.426em; padding-bottom: 0.267em;">t</span></span><span id="MJXc-Node-2515" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.32em; padding-bottom: 0.426em;">−</span></span><span id="MJXc-Node-2516" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.373em; padding-bottom: 0.32em;">1</span></span></span></span></span></span><span id="MJXc-Node-2517" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.162em; padding-bottom: 0.532em;">;</span></span><span id="MJXc-Node-2518" class="mjx-mi MJXc-space1"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.215em; padding-bottom: 0.267em;">x</span></span><span id="MJXc-Node-2519" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.162em; padding-bottom: 0.532em;">;</span></span><span id="MJXc-Node-2520" class="mjx-mi MJXc-space1"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.215em; padding-bottom: 0.479em; padding-right: 0.006em;">y</span></span><span id="MJXc-Node-2521" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.479em; padding-bottom: 0.585em;">)</span></span></span></span></span><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><msub><mi>θ</mi><mi>t</mi></msub><mo>=</mo><msub><mi>θ</mi><mrow class="MJX-TeXAtom-ORD"><mi>t</mi><mo>−</mo><mn>1</mn></mrow></msub><mo>−</mo><mi>η</mi><mo>⋅</mo><msub><mi mathvariant="normal">∇</mi><mrow class="MJX-TeXAtom-ORD"><mi>θ</mi></mrow></msub><mi>J</mi><mrow><mo>(</mo><msub><mi>θ</mi><mrow class="MJX-TeXAtom-ORD"><mi>t</mi><mo>−</mo><mn>1</mn></mrow></msub><mo>;</mo><mi>x</mi><mo>;</mo><mi>y</mi><mo>)</mo></mrow></math></span></span></span><script type="math/tex; mode=display" id="MathJax-Element-159">
\theta_t=\theta_{t-1}-\eta \cdot \nabla_{\theta} J\left(\theta_{t-1} ; x ; y\right)
</script></span><br>
<span>где </span><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-160-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 118%; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>&amp;#x03B7;</mi><mo>&amp;#x2208;</mo><mo stretchy=&quot;false&quot;>(</mo><mn>0</mn><mo>,</mo><mn>1</mn><mo stretchy=&quot;false&quot;>)</mo></math>" role="presentation"><span id="MJXc-Node-2522" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-2523" class="mjx-mrow"><span id="MJXc-Node-2524" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.215em; padding-bottom: 0.479em; padding-right: 0.006em;">η</span></span><span id="MJXc-Node-2525" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.267em; padding-bottom: 0.373em;">∈</span></span><span id="MJXc-Node-2526" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.479em; padding-bottom: 0.585em;">(</span></span><span id="MJXc-Node-2527" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.373em; padding-bottom: 0.373em;">0</span></span><span id="MJXc-Node-2528" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="margin-top: -0.156em; padding-bottom: 0.532em;">,</span></span><span id="MJXc-Node-2529" class="mjx-mn MJXc-space1"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.373em; padding-bottom: 0.32em;">1</span></span><span id="MJXc-Node-2530" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.479em; padding-bottom: 0.585em;">)</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>η</mi><mo>∈</mo><mo stretchy="false">(</mo><mn>0</mn><mo>,</mo><mn>1</mn><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-160">\eta \in (0,1)</script></span><span> — learning rate. Будем продолжать этот процесс до сходимости (т.е. пока изменения не будут слишком малы) или пока не достигнем заранее фиксированного числа шагов.</span><br>
<span>Однако считать градиенты по всей выборке достаточно долго, и при плохом выборе параметра </span><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-161-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 118%; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>&amp;#x03B7;</mi></math>" role="presentation"><span id="MJXc-Node-2531" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-2532" class="mjx-mrow"><span id="MJXc-Node-2533" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.215em; padding-bottom: 0.479em; padding-right: 0.006em;">η</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>η</mi></math></span></span><script type="math/tex" id="MathJax-Element-161">\eta</script></span><span> мы можем не сойтись даже для простых функций (</span><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-162-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 118%; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>J</mi><mo>=</mo><msup><mi>&amp;#x03B8;</mi><mn>2</mn></msup></math>" role="presentation"><span id="MJXc-Node-2534" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-2535" class="mjx-mrow"><span id="MJXc-Node-2536" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.32em; padding-right: 0.078em;">J</span></span><span id="MJXc-Node-2537" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.056em; padding-bottom: 0.32em;">=</span></span><span id="MJXc-Node-2538" class="mjx-msubsup MJXc-space3"><span class="mjx-base"><span id="MJXc-Node-2539" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.267em;">θ</span></span></span><span class="mjx-sup" style="font-size: 70.7%; vertical-align: 0.513em; padding-left: 0px; padding-right: 0.071em;"><span id="MJXc-Node-2540" class="mjx-mn" style=""><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.373em; padding-bottom: 0.32em;">2</span></span></span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>J</mi><mo>=</mo><msup><mi>θ</mi><mn>2</mn></msup></math></span></span><script type="math/tex" id="MathJax-Element-162">J = \theta^2</script></span><span>, </span><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-163-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 118%; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>&amp;#x03B7;</mi><mo>=</mo><mn>1</mn></math>" role="presentation"><span id="MJXc-Node-2541" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-2542" class="mjx-mrow"><span id="MJXc-Node-2543" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.215em; padding-bottom: 0.479em; padding-right: 0.006em;">η</span></span><span id="MJXc-Node-2544" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.056em; padding-bottom: 0.32em;">=</span></span><span id="MJXc-Node-2545" class="mjx-mn MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.373em; padding-bottom: 0.32em;">1</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>η</mi><mo>=</mo><mn>1</mn></math></span></span><script type="math/tex" id="MathJax-Element-163">\eta = 1</script></span><span>).</span></p><h4 id="Stochastic-Gradient-Descent-SGD" data-id="Stochastic-Gradient-Descent-SGD"><a class="anchor hidden-xs" href="#Stochastic-Gradient-Descent-SGD" title="Stochastic-Gradient-Descent-SGD"><span class="octicon octicon-link"></span></a><span>Stochastic Gradient Descent (SGD)</span></h4><p><span>Для того, чтобы не считать градиенты по всей выборке давайте будем это делать только для каких-то подмножеств (бачтей) выборки разумного размера. То есть шаг градиентного спуска теперь:</span></p><p><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span class="mjx-chtml MJXc-display" style="text-align: center;"><span id="MathJax-Element-164-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 118%; text-align: center; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><msub><mi>&amp;#x03B8;</mi><mi>t</mi></msub><mo>=</mo><msub><mi>&amp;#x03B8;</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>t</mi><mo>&amp;#x2212;</mo><mn>1</mn></mrow></msub><mo>&amp;#x2212;</mo><mi>&amp;#x03B7;</mi><mo>&amp;#x22C5;</mo><msub><mi mathvariant=&quot;normal&quot;>&amp;#x2207;</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>&amp;#x03B8;</mi></mrow></msub><mi>J</mi><mrow><mo>(</mo><msub><mi>&amp;#x03B8;</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>t</mi><mo>&amp;#x2212;</mo><mn>1</mn></mrow></msub><mo>;</mo><msup><mi>x</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>(</mo><mi>i</mi><mo>:</mo><mi>i</mi><mo>+</mo><mi>n</mi><mo stretchy=&quot;false&quot;>)</mo></mrow></msup><mo>;</mo><msup><mi>y</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>(</mo><mi>i</mi><mo>:</mo><mi>i</mi><mo>+</mo><mi>n</mi><mo stretchy=&quot;false&quot;>)</mo></mrow></msup><mo>)</mo></mrow></math>" role="presentation"><span id="MJXc-Node-2546" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-2547" class="mjx-mrow"><span id="MJXc-Node-2548" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-2549" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.267em;">θ</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-2550" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.426em; padding-bottom: 0.267em;">t</span></span></span></span><span id="MJXc-Node-2551" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.056em; padding-bottom: 0.32em;">=</span></span><span id="MJXc-Node-2552" class="mjx-msubsup MJXc-space3"><span class="mjx-base"><span id="MJXc-Node-2553" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.267em;">θ</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-2554" class="mjx-texatom" style=""><span id="MJXc-Node-2555" class="mjx-mrow"><span id="MJXc-Node-2556" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.426em; padding-bottom: 0.267em;">t</span></span><span id="MJXc-Node-2557" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.32em; padding-bottom: 0.426em;">−</span></span><span id="MJXc-Node-2558" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.373em; padding-bottom: 0.32em;">1</span></span></span></span></span></span><span id="MJXc-Node-2559" class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.32em; padding-bottom: 0.426em;">−</span></span><span id="MJXc-Node-2560" class="mjx-mi MJXc-space2"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.215em; padding-bottom: 0.479em; padding-right: 0.006em;">η</span></span><span id="MJXc-Node-2561" class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.003em; padding-bottom: 0.32em;">⋅</span></span><span id="MJXc-Node-2562" class="mjx-msubsup MJXc-space2"><span class="mjx-base"><span id="MJXc-Node-2563" class="mjx-mi"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.373em; padding-bottom: 0.373em;">∇</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.23em; padding-right: 0.071em;"><span id="MJXc-Node-2564" class="mjx-texatom" style=""><span id="MJXc-Node-2565" class="mjx-mrow"><span id="MJXc-Node-2566" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.267em;">θ</span></span></span></span></span></span><span id="MJXc-Node-2567" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.32em; padding-right: 0.078em;">J</span></span><span id="MJXc-Node-2568" class="mjx-mrow MJXc-space1"><span id="MJXc-Node-2569" class="mjx-mo"><span class="mjx-char MJXc-TeX-size2-R" style="padding-top: 0.903em; padding-bottom: 0.903em;">(</span></span><span id="MJXc-Node-2570" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-2571" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.267em;">θ</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-2572" class="mjx-texatom" style=""><span id="MJXc-Node-2573" class="mjx-mrow"><span id="MJXc-Node-2574" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.426em; padding-bottom: 0.267em;">t</span></span><span id="MJXc-Node-2575" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.32em; padding-bottom: 0.426em;">−</span></span><span id="MJXc-Node-2576" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.373em; padding-bottom: 0.32em;">1</span></span></span></span></span></span><span id="MJXc-Node-2577" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.162em; padding-bottom: 0.532em;">;</span></span><span id="MJXc-Node-2578" class="mjx-msubsup MJXc-space1"><span class="mjx-base"><span id="MJXc-Node-2579" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.215em; padding-bottom: 0.267em;">x</span></span></span><span class="mjx-sup" style="font-size: 70.7%; vertical-align: 0.584em; padding-left: 0px; padding-right: 0.071em;"><span id="MJXc-Node-2580" class="mjx-texatom" style=""><span id="MJXc-Node-2581" class="mjx-mrow"><span id="MJXc-Node-2582" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.479em; padding-bottom: 0.585em;">(</span></span><span id="MJXc-Node-2583" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.426em; padding-bottom: 0.267em;">i</span></span><span id="MJXc-Node-2584" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.162em; padding-bottom: 0.32em;">:</span></span><span id="MJXc-Node-2585" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.426em; padding-bottom: 0.267em;">i</span></span><span id="MJXc-Node-2586" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.32em; padding-bottom: 0.426em;">+</span></span><span id="MJXc-Node-2587" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.215em; padding-bottom: 0.267em;">n</span></span><span id="MJXc-Node-2588" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.479em; padding-bottom: 0.585em;">)</span></span></span></span></span></span><span id="MJXc-Node-2589" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.162em; padding-bottom: 0.532em;">;</span></span><span id="MJXc-Node-2590" class="mjx-msubsup MJXc-space1"><span class="mjx-base" style="margin-right: -0.006em;"><span id="MJXc-Node-2591" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.215em; padding-bottom: 0.479em; padding-right: 0.006em;">y</span></span></span><span class="mjx-sup" style="font-size: 70.7%; vertical-align: 0.584em; padding-left: 0.082em; padding-right: 0.071em;"><span id="MJXc-Node-2592" class="mjx-texatom" style=""><span id="MJXc-Node-2593" class="mjx-mrow"><span id="MJXc-Node-2594" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.479em; padding-bottom: 0.585em;">(</span></span><span id="MJXc-Node-2595" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.426em; padding-bottom: 0.267em;">i</span></span><span id="MJXc-Node-2596" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.162em; padding-bottom: 0.32em;">:</span></span><span id="MJXc-Node-2597" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.426em; padding-bottom: 0.267em;">i</span></span><span id="MJXc-Node-2598" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.32em; padding-bottom: 0.426em;">+</span></span><span id="MJXc-Node-2599" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.215em; padding-bottom: 0.267em;">n</span></span><span id="MJXc-Node-2600" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.479em; padding-bottom: 0.585em;">)</span></span></span></span></span></span><span id="MJXc-Node-2601" class="mjx-mo"><span class="mjx-char MJXc-TeX-size2-R" style="padding-top: 0.903em; padding-bottom: 0.903em;">)</span></span></span></span></span><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><msub><mi>θ</mi><mi>t</mi></msub><mo>=</mo><msub><mi>θ</mi><mrow class="MJX-TeXAtom-ORD"><mi>t</mi><mo>−</mo><mn>1</mn></mrow></msub><mo>−</mo><mi>η</mi><mo>⋅</mo><msub><mi mathvariant="normal">∇</mi><mrow class="MJX-TeXAtom-ORD"><mi>θ</mi></mrow></msub><mi>J</mi><mrow><mo>(</mo><msub><mi>θ</mi><mrow class="MJX-TeXAtom-ORD"><mi>t</mi><mo>−</mo><mn>1</mn></mrow></msub><mo>;</mo><msup><mi>x</mi><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">(</mo><mi>i</mi><mo>:</mo><mi>i</mi><mo>+</mo><mi>n</mi><mo stretchy="false">)</mo></mrow></msup><mo>;</mo><msup><mi>y</mi><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">(</mo><mi>i</mi><mo>:</mo><mi>i</mi><mo>+</mo><mi>n</mi><mo stretchy="false">)</mo></mrow></msup><mo>)</mo></mrow></math></span></span></span><script type="math/tex; mode=display" id="MathJax-Element-164">
\theta_t=\theta_{t-1}-\eta \cdot \nabla_{\theta} J\left(\theta_{t-1} ; x^{(i: i+n)} ; y^{(i: i+n)}\right)
</script></span></p><p><span>Такой метод будет асимптотически сходится к предыдущему (неформально почти УЗБЧ). Теперь это работает быстро. Но у этого метода всё же есть недостатки. Кроме того, что он будет сходится за большее число итераций чем обычный GD:</span></p><ol>
<li><span>Например, пусть выборка плохо нормирована. В таком случае градиенты по одной из осей будут преобладать, а по другой просто колебаться (старая картинка прилагается)</span><br>
<img src="https://i.imgur.com/deTLWjS.png" alt=""></li>
<li><span>Другая проблема связана с седловыми точками (локальными экстремумами) и в целом с точками, в которых модуль градиентов маленький. Скажем пусть </span><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-165-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 118%; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>J</mi><mo>=</mo><mn>0.000228</mn><mo>&amp;#x22C5;</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>|</mo></mrow><mi>&amp;#x03B8;</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>|</mo></mrow></math>" role="presentation"><span id="MJXc-Node-2602" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-2603" class="mjx-mrow"><span id="MJXc-Node-2604" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.32em; padding-right: 0.078em;">J</span></span><span id="MJXc-Node-2605" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.056em; padding-bottom: 0.32em;">=</span></span><span id="MJXc-Node-2606" class="mjx-mn MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.373em; padding-bottom: 0.373em;">0.000228</span></span><span id="MJXc-Node-2607" class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.003em; padding-bottom: 0.32em;">⋅</span></span><span id="MJXc-Node-2608" class="mjx-texatom MJXc-space2"><span id="MJXc-Node-2609" class="mjx-mrow"><span id="MJXc-Node-2610" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.479em; padding-bottom: 0.585em;">|</span></span></span></span><span id="MJXc-Node-2611" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.267em;">θ</span></span><span id="MJXc-Node-2612" class="mjx-texatom"><span id="MJXc-Node-2613" class="mjx-mrow"><span id="MJXc-Node-2614" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.479em; padding-bottom: 0.585em;">|</span></span></span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>J</mi><mo>=</mo><mn>0.000228</mn><mo>⋅</mo><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><mi>θ</mi><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow></math></span></span><script type="math/tex" id="MathJax-Element-165">J = 0.000228\cdot|\theta|</script></span><span>. Если стартовать из токи </span><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-166-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 118%; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>&amp;#x03B8;</mi><mo>=</mo><mn>228</mn></math>" role="presentation"><span id="MJXc-Node-2615" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-2616" class="mjx-mrow"><span id="MJXc-Node-2617" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.267em;">θ</span></span><span id="MJXc-Node-2618" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.056em; padding-bottom: 0.32em;">=</span></span><span id="MJXc-Node-2619" class="mjx-mn MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.373em; padding-bottom: 0.373em;">228</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>θ</mi><mo>=</mo><mn>228</mn></math></span></span><script type="math/tex" id="MathJax-Element-166">\theta = 228</script></span><span>, то нам понадобится 100000 (много) шагов для того, чтобы добраться до нуля, т.к. из-за очень малых значений градиента мы будем очень медленно двигаться к точке оптимума.</span></li>
</ol><ul>
<li><span>Заметим, что обе эти проблемы характерны и для обычного алгоритма градиентного спуска.</span></li>
</ul><p><span>Существует подход, решающий проблему с локальным экстремумом.</span></p><h4 id="SGD-with-momentum" data-id="SGD-with-momentum"><a class="anchor hidden-xs" href="#SGD-with-momentum" title="SGD-with-momentum"><span class="octicon octicon-link"></span></a><span>SGD with momentum</span></h4><p><em><span>Нет в программе, но было в лекциях.</span></em><br>
<span>Стараниями математиков, в том числе и советских (Нестеров и другие) мы можем решить вторую проблему следующим образом: давайте как-то будем использовать предыдущие направления градиентов и лишь слегка изменять направление движения. Простая аналогия здесь, это катящийся по какой-то поверхности шарик с какой-то массой. У этого шарика есть инерция и он разгоняется при одном и том же направлении градиентов (скатывается с наклонной поверхности). Проблема с седловыми точками решена. Теперь формально (для удобства заменим </span><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-167-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 118%; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>J</mi><mo stretchy=&quot;false&quot;>(</mo><msub><mi>&amp;#x03B8;</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>t</mi><mo>&amp;#x2212;</mo><mn>1</mn></mrow></msub><mo>;</mo><msup><mi>x</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>(</mo><mi>i</mi><mo>:</mo><mi>i</mi><mo>+</mo><mi>n</mi><mo stretchy=&quot;false&quot;>)</mo></mrow></msup><mo>;</mo><msup><mi>y</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>(</mo><mi>i</mi><mo>:</mo><mi>i</mi><mo>+</mo><mi>n</mi><mo stretchy=&quot;false&quot;>)</mo></mrow></msup><mo stretchy=&quot;false&quot;>)</mo><mo>=</mo><mi>J</mi><mo stretchy=&quot;false&quot;>(</mo><msub><mi>&amp;#x03B8;</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>t</mi><mo>&amp;#x2212;</mo><mn>1</mn></mrow></msub><mo stretchy=&quot;false&quot;>)</mo></math>" role="presentation"><span id="MJXc-Node-2620" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-2621" class="mjx-mrow"><span id="MJXc-Node-2622" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.32em; padding-right: 0.078em;">J</span></span><span id="MJXc-Node-2623" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.479em; padding-bottom: 0.585em;">(</span></span><span id="MJXc-Node-2624" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-2625" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.267em;">θ</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-2626" class="mjx-texatom" style=""><span id="MJXc-Node-2627" class="mjx-mrow"><span id="MJXc-Node-2628" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.426em; padding-bottom: 0.267em;">t</span></span><span id="MJXc-Node-2629" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.32em; padding-bottom: 0.426em;">−</span></span><span id="MJXc-Node-2630" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.373em; padding-bottom: 0.32em;">1</span></span></span></span></span></span><span id="MJXc-Node-2631" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.162em; padding-bottom: 0.532em;">;</span></span><span id="MJXc-Node-2632" class="mjx-msubsup MJXc-space1"><span class="mjx-base"><span id="MJXc-Node-2633" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.215em; padding-bottom: 0.267em;">x</span></span></span><span class="mjx-sup" style="font-size: 70.7%; vertical-align: 0.513em; padding-left: 0px; padding-right: 0.071em;"><span id="MJXc-Node-2634" class="mjx-texatom" style=""><span id="MJXc-Node-2635" class="mjx-mrow"><span id="MJXc-Node-2636" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.479em; padding-bottom: 0.585em;">(</span></span><span id="MJXc-Node-2637" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.426em; padding-bottom: 0.267em;">i</span></span><span id="MJXc-Node-2638" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.162em; padding-bottom: 0.32em;">:</span></span><span id="MJXc-Node-2639" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.426em; padding-bottom: 0.267em;">i</span></span><span id="MJXc-Node-2640" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.32em; padding-bottom: 0.426em;">+</span></span><span id="MJXc-Node-2641" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.215em; padding-bottom: 0.267em;">n</span></span><span id="MJXc-Node-2642" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.479em; padding-bottom: 0.585em;">)</span></span></span></span></span></span><span id="MJXc-Node-2643" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.162em; padding-bottom: 0.532em;">;</span></span><span id="MJXc-Node-2644" class="mjx-msubsup MJXc-space1"><span class="mjx-base" style="margin-right: -0.006em;"><span id="MJXc-Node-2645" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.215em; padding-bottom: 0.479em; padding-right: 0.006em;">y</span></span></span><span class="mjx-sup" style="font-size: 70.7%; vertical-align: 0.513em; padding-left: 0.082em; padding-right: 0.071em;"><span id="MJXc-Node-2646" class="mjx-texatom" style=""><span id="MJXc-Node-2647" class="mjx-mrow"><span id="MJXc-Node-2648" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.479em; padding-bottom: 0.585em;">(</span></span><span id="MJXc-Node-2649" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.426em; padding-bottom: 0.267em;">i</span></span><span id="MJXc-Node-2650" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.162em; padding-bottom: 0.32em;">:</span></span><span id="MJXc-Node-2651" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.426em; padding-bottom: 0.267em;">i</span></span><span id="MJXc-Node-2652" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.32em; padding-bottom: 0.426em;">+</span></span><span id="MJXc-Node-2653" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.215em; padding-bottom: 0.267em;">n</span></span><span id="MJXc-Node-2654" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.479em; padding-bottom: 0.585em;">)</span></span></span></span></span></span><span id="MJXc-Node-2655" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.479em; padding-bottom: 0.585em;">)</span></span><span id="MJXc-Node-2656" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.056em; padding-bottom: 0.32em;">=</span></span><span id="MJXc-Node-2657" class="mjx-mi MJXc-space3"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.32em; padding-right: 0.078em;">J</span></span><span id="MJXc-Node-2658" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.479em; padding-bottom: 0.585em;">(</span></span><span id="MJXc-Node-2659" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-2660" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.267em;">θ</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-2661" class="mjx-texatom" style=""><span id="MJXc-Node-2662" class="mjx-mrow"><span id="MJXc-Node-2663" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.426em; padding-bottom: 0.267em;">t</span></span><span id="MJXc-Node-2664" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.32em; padding-bottom: 0.426em;">−</span></span><span id="MJXc-Node-2665" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.373em; padding-bottom: 0.32em;">1</span></span></span></span></span></span><span id="MJXc-Node-2666" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.479em; padding-bottom: 0.585em;">)</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>J</mi><mo stretchy="false">(</mo><msub><mi>θ</mi><mrow class="MJX-TeXAtom-ORD"><mi>t</mi><mo>−</mo><mn>1</mn></mrow></msub><mo>;</mo><msup><mi>x</mi><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">(</mo><mi>i</mi><mo>:</mo><mi>i</mi><mo>+</mo><mi>n</mi><mo stretchy="false">)</mo></mrow></msup><mo>;</mo><msup><mi>y</mi><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">(</mo><mi>i</mi><mo>:</mo><mi>i</mi><mo>+</mo><mi>n</mi><mo stretchy="false">)</mo></mrow></msup><mo stretchy="false">)</mo><mo>=</mo><mi>J</mi><mo stretchy="false">(</mo><msub><mi>θ</mi><mrow class="MJX-TeXAtom-ORD"><mi>t</mi><mo>−</mo><mn>1</mn></mrow></msub><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-167">J(\theta_{t-1} ; x^{(i: i+n)} ; y^{(i: i+n)}) = J(\theta_{t-1})</script></span><span>):</span><br>
<span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span class="mjx-chtml MJXc-display" style="text-align: center;"><span id="MathJax-Element-168-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 118%; text-align: center; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><mtable columnalign=&quot;right left right left right left right left right left right left&quot; rowspacing=&quot;3pt&quot; columnspacing=&quot;0em 2em 0em 2em 0em 2em 0em 2em 0em 2em 0em&quot; displaystyle=&quot;true&quot;><mtr><mtd><msub><mi>v</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>t</mi></mrow></msub></mtd><mtd><mi></mi><mo>=</mo><mi>&amp;#x03B3;</mi><msub><mi>v</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>t</mi><mo>&amp;#x2212;</mo><mn>1</mn></mrow></msub><mo>+</mo><mi>&amp;#x03B7;</mi><msub><mi mathvariant=&quot;normal&quot;>&amp;#x2207;</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>&amp;#x03B8;</mi></mrow></msub><mi>J</mi><mo stretchy=&quot;false&quot;>(</mo><msub><mi>&amp;#x03B8;</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>t</mi><mo>&amp;#x2212;</mo><mn>1</mn></mrow></msub><mo stretchy=&quot;false&quot;>)</mo></mtd></mtr><mtr><mtd><msub><mi>&amp;#x03B8;</mi><mi>t</mi></msub></mtd><mtd><mi></mi><mo>=</mo><msub><mi>&amp;#x03B8;</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>t</mi><mo>&amp;#x2212;</mo><mn>1</mn></mrow></msub><mo>&amp;#x2212;</mo><msub><mi>v</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>t</mi></mrow></msub></mtd></mtr></mtable></math>" role="presentation"><span id="MJXc-Node-2667" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-2668" class="mjx-mrow"><span id="MJXc-Node-2669" class="mjx-mtable" style="vertical-align: -0.95em; padding: 0px 0.167em;"><span class="mjx-table"><span id="MJXc-Node-2670" class="mjx-mtr" style="height: 1.225em;"><span id="MJXc-Node-2671" class="mjx-mtd" style="padding: 0px; text-align: right; width: 0.776em;"><span id="MJXc-Node-2672" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-2673" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-2674" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.215em; padding-bottom: 0.267em;">v</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-2675" class="mjx-texatom" style=""><span id="MJXc-Node-2676" class="mjx-mrow"><span id="MJXc-Node-2677" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.426em; padding-bottom: 0.267em;">t</span></span></span></span></span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-2678" class="mjx-mtd" style="padding: 0px; text-align: left; width: 9.556em;"><span id="MJXc-Node-2679" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-2680" class="mjx-mi"></span><span id="MJXc-Node-2681" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.056em; padding-bottom: 0.32em;">=</span></span><span id="MJXc-Node-2682" class="mjx-mi MJXc-space3"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.215em; padding-bottom: 0.479em; padding-right: 0.025em;">γ</span></span><span id="MJXc-Node-2683" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-2684" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.215em; padding-bottom: 0.267em;">v</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-2685" class="mjx-texatom" style=""><span id="MJXc-Node-2686" class="mjx-mrow"><span id="MJXc-Node-2687" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.426em; padding-bottom: 0.267em;">t</span></span><span id="MJXc-Node-2688" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.32em; padding-bottom: 0.426em;">−</span></span><span id="MJXc-Node-2689" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.373em; padding-bottom: 0.32em;">1</span></span></span></span></span></span><span id="MJXc-Node-2690" class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.32em; padding-bottom: 0.426em;">+</span></span><span id="MJXc-Node-2691" class="mjx-mi MJXc-space2"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.215em; padding-bottom: 0.479em; padding-right: 0.006em;">η</span></span><span id="MJXc-Node-2692" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-2693" class="mjx-mi"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.373em; padding-bottom: 0.373em;">∇</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.23em; padding-right: 0.071em;"><span id="MJXc-Node-2694" class="mjx-texatom" style=""><span id="MJXc-Node-2695" class="mjx-mrow"><span id="MJXc-Node-2696" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.267em;">θ</span></span></span></span></span></span><span id="MJXc-Node-2697" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.32em; padding-right: 0.078em;">J</span></span><span id="MJXc-Node-2698" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.479em; padding-bottom: 0.585em;">(</span></span><span id="MJXc-Node-2699" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-2700" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.267em;">θ</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-2701" class="mjx-texatom" style=""><span id="MJXc-Node-2702" class="mjx-mrow"><span id="MJXc-Node-2703" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.426em; padding-bottom: 0.267em;">t</span></span><span id="MJXc-Node-2704" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.32em; padding-bottom: 0.426em;">−</span></span><span id="MJXc-Node-2705" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.373em; padding-bottom: 0.32em;">1</span></span></span></span></span></span><span id="MJXc-Node-2706" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.479em; padding-bottom: 0.585em;">)</span></span><span class="mjx-strut"></span></span></span></span><span id="MJXc-Node-2707" class="mjx-mtr" style="height: 1.176em;"><span id="MJXc-Node-2708" class="mjx-mtd" style="padding: 0.15em 0px 0px; text-align: right;"><span id="MJXc-Node-2709" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-2710" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-2711" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.267em;">θ</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-2712" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.426em; padding-bottom: 0.267em;">t</span></span></span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-2713" class="mjx-mtd" style="padding: 0.15em 0px 0px; text-align: left;"><span id="MJXc-Node-2714" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-2715" class="mjx-mi"></span><span id="MJXc-Node-2716" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.056em; padding-bottom: 0.32em;">=</span></span><span id="MJXc-Node-2717" class="mjx-msubsup MJXc-space3"><span class="mjx-base"><span id="MJXc-Node-2718" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.267em;">θ</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-2719" class="mjx-texatom" style=""><span id="MJXc-Node-2720" class="mjx-mrow"><span id="MJXc-Node-2721" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.426em; padding-bottom: 0.267em;">t</span></span><span id="MJXc-Node-2722" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.32em; padding-bottom: 0.426em;">−</span></span><span id="MJXc-Node-2723" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.373em; padding-bottom: 0.32em;">1</span></span></span></span></span></span><span id="MJXc-Node-2724" class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.32em; padding-bottom: 0.426em;">−</span></span><span id="MJXc-Node-2725" class="mjx-msubsup MJXc-space2"><span class="mjx-base"><span id="MJXc-Node-2726" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.215em; padding-bottom: 0.267em;">v</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-2727" class="mjx-texatom" style=""><span id="MJXc-Node-2728" class="mjx-mrow"><span id="MJXc-Node-2729" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.426em; padding-bottom: 0.267em;">t</span></span></span></span></span></span><span class="mjx-strut"></span></span></span></span></span></span></span></span><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mtable columnalign="right left right left right left right left right left right left" rowspacing="3pt" columnspacing="0em 2em 0em 2em 0em 2em 0em 2em 0em 2em 0em" displaystyle="true"><mtr><mtd><msub><mi>v</mi><mrow class="MJX-TeXAtom-ORD"><mi>t</mi></mrow></msub></mtd><mtd><mi></mi><mo>=</mo><mi>γ</mi><msub><mi>v</mi><mrow class="MJX-TeXAtom-ORD"><mi>t</mi><mo>−</mo><mn>1</mn></mrow></msub><mo>+</mo><mi>η</mi><msub><mi mathvariant="normal">∇</mi><mrow class="MJX-TeXAtom-ORD"><mi>θ</mi></mrow></msub><mi>J</mi><mo stretchy="false">(</mo><msub><mi>θ</mi><mrow class="MJX-TeXAtom-ORD"><mi>t</mi><mo>−</mo><mn>1</mn></mrow></msub><mo stretchy="false">)</mo></mtd></mtr><mtr><mtd><msub><mi>θ</mi><mi>t</mi></msub></mtd><mtd><mi></mi><mo>=</mo><msub><mi>θ</mi><mrow class="MJX-TeXAtom-ORD"><mi>t</mi><mo>−</mo><mn>1</mn></mrow></msub><mo>−</mo><msub><mi>v</mi><mrow class="MJX-TeXAtom-ORD"><mi>t</mi></mrow></msub></mtd></mtr></mtable></math></span></span></span><script type="math/tex; mode=display" id="MathJax-Element-168">
\begin{aligned} v_{t} &=\gamma v_{t-1}+\eta \nabla_{\theta} J(\theta_{t-1}) \\ \theta_t &=\theta_{t-1}-v_{t} \end{aligned}
</script></span><br>
<span>Появляется еще один параметр </span><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-169-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 118%; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>&amp;#x03B3;</mi></math>" role="presentation"><span id="MJXc-Node-2730" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-2731" class="mjx-mrow"><span id="MJXc-Node-2732" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.215em; padding-bottom: 0.479em; padding-right: 0.025em;">γ</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>γ</mi></math></span></span><script type="math/tex" id="MathJax-Element-169">\gamma</script></span><span> – обычно его берут примерно </span><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-170-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 118%; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mn>0.9</mn></math>" role="presentation"><span id="MJXc-Node-2733" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-2734" class="mjx-mrow"><span id="MJXc-Node-2735" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.373em; padding-bottom: 0.373em;">0.9</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mn>0.9</mn></math></span></span><script type="math/tex" id="MathJax-Element-170">0.9</script></span><span>. Очевидно при </span><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-171-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 118%; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>&amp;#x03B3;</mi><mo>=</mo><mn>0</mn></math>" role="presentation"><span id="MJXc-Node-2736" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-2737" class="mjx-mrow"><span id="MJXc-Node-2738" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.215em; padding-bottom: 0.479em; padding-right: 0.025em;">γ</span></span><span id="MJXc-Node-2739" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.056em; padding-bottom: 0.32em;">=</span></span><span id="MJXc-Node-2740" class="mjx-mn MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.373em; padding-bottom: 0.373em;">0</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>γ</mi><mo>=</mo><mn>0</mn></math></span></span><script type="math/tex" id="MathJax-Element-171">\gamma = 0</script></span><span> мы получаем обычный SGD.</span></p><p><strong><span>Extra</span></strong><span>: Лучше считать градиенты не в точке </span><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-172-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 118%; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>&amp;#x03B8;</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>t</mi><mo>&amp;#x2212;</mo><mn>1</mn></mrow></msub></math>" role="presentation"><span id="MJXc-Node-2741" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-2742" class="mjx-mrow"><span id="MJXc-Node-2743" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-2744" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.267em;">θ</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-2745" class="mjx-texatom" style=""><span id="MJXc-Node-2746" class="mjx-mrow"><span id="MJXc-Node-2747" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.426em; padding-bottom: 0.267em;">t</span></span><span id="MJXc-Node-2748" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.32em; padding-bottom: 0.426em;">−</span></span><span id="MJXc-Node-2749" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.373em; padding-bottom: 0.32em;">1</span></span></span></span></span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>θ</mi><mrow class="MJX-TeXAtom-ORD"><mi>t</mi><mo>−</mo><mn>1</mn></mrow></msub></math></span></span><script type="math/tex" id="MathJax-Element-172">\theta_{t-1}</script></span><span>, а в точке </span><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-173-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 118%; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>&amp;#x03B8;</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>t</mi><mo>&amp;#x2212;</mo><mn>1</mn></mrow></msub><mo>&amp;#x2212;</mo><mi>&amp;#x03B3;</mi><msub><mi>v</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>t</mi><mo>&amp;#x2212;</mo><mn>1</mn></mrow></msub></math>" role="presentation"><span id="MJXc-Node-2750" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-2751" class="mjx-mrow"><span id="MJXc-Node-2752" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-2753" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.267em;">θ</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-2754" class="mjx-texatom" style=""><span id="MJXc-Node-2755" class="mjx-mrow"><span id="MJXc-Node-2756" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.426em; padding-bottom: 0.267em;">t</span></span><span id="MJXc-Node-2757" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.32em; padding-bottom: 0.426em;">−</span></span><span id="MJXc-Node-2758" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.373em; padding-bottom: 0.32em;">1</span></span></span></span></span></span><span id="MJXc-Node-2759" class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.32em; padding-bottom: 0.426em;">−</span></span><span id="MJXc-Node-2760" class="mjx-mi MJXc-space2"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.215em; padding-bottom: 0.479em; padding-right: 0.025em;">γ</span></span><span id="MJXc-Node-2761" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-2762" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.215em; padding-bottom: 0.267em;">v</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-2763" class="mjx-texatom" style=""><span id="MJXc-Node-2764" class="mjx-mrow"><span id="MJXc-Node-2765" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.426em; padding-bottom: 0.267em;">t</span></span><span id="MJXc-Node-2766" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.32em; padding-bottom: 0.426em;">−</span></span><span id="MJXc-Node-2767" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.373em; padding-bottom: 0.32em;">1</span></span></span></span></span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>θ</mi><mrow class="MJX-TeXAtom-ORD"><mi>t</mi><mo>−</mo><mn>1</mn></mrow></msub><mo>−</mo><mi>γ</mi><msub><mi>v</mi><mrow class="MJX-TeXAtom-ORD"><mi>t</mi><mo>−</mo><mn>1</mn></mrow></msub></math></span></span><script type="math/tex" id="MathJax-Element-173">\theta_{t-1} - \gamma v_{t-1}</script></span><span>.Такой оптимизатор в некоторых библиотеках называется NAG. Ведь мы заранее знаем, что шагнем в этом направлении. Кажется, лучше даже считать в точке </span><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-174-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 118%; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>&amp;#x03B8;</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>t</mi><mo>&amp;#x2212;</mo><mn>1</mn></mrow></msub><mo>&amp;#x2212;</mo><mfrac><mn>2</mn><mn>3</mn></mfrac><mi>&amp;#x03B3;</mi><msub><mi>v</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>t</mi><mo>&amp;#x2212;</mo><mn>1</mn></mrow></msub></math>" role="presentation"><span id="MJXc-Node-2768" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-2769" class="mjx-mrow"><span id="MJXc-Node-2770" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-2771" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.267em;">θ</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-2772" class="mjx-texatom" style=""><span id="MJXc-Node-2773" class="mjx-mrow"><span id="MJXc-Node-2774" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.426em; padding-bottom: 0.267em;">t</span></span><span id="MJXc-Node-2775" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.32em; padding-bottom: 0.426em;">−</span></span><span id="MJXc-Node-2776" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.373em; padding-bottom: 0.32em;">1</span></span></span></span></span></span><span id="MJXc-Node-2777" class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.32em; padding-bottom: 0.426em;">−</span></span><span id="MJXc-Node-2778" class="mjx-mfrac MJXc-space2"><span class="mjx-box MJXc-stacked" style="width: 0.495em; padding: 0px 0.12em;"><span class="mjx-numerator" style="font-size: 70.7%; width: 0.7em; top: -1.299em;"><span id="MJXc-Node-2779" class="mjx-mn" style=""><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.373em; padding-bottom: 0.32em;">2</span></span></span><span class="mjx-denominator" style="font-size: 70.7%; width: 0.7em; bottom: -0.613em;"><span id="MJXc-Node-2780" class="mjx-mn" style=""><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.373em; padding-bottom: 0.373em;">3</span></span></span><span style="border-bottom-width: 1.3px; border-bottom-style: solid; top: -0.283em; width: 0.495em;" class="mjx-line"></span></span><span style="height: 1.352em; vertical-align: -0.434em;" class="mjx-vsize"></span></span><span id="MJXc-Node-2781" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.215em; padding-bottom: 0.479em; padding-right: 0.025em;">γ</span></span><span id="MJXc-Node-2782" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-2783" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.215em; padding-bottom: 0.267em;">v</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-2784" class="mjx-texatom" style=""><span id="MJXc-Node-2785" class="mjx-mrow"><span id="MJXc-Node-2786" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.426em; padding-bottom: 0.267em;">t</span></span><span id="MJXc-Node-2787" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.32em; padding-bottom: 0.426em;">−</span></span><span id="MJXc-Node-2788" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.373em; padding-bottom: 0.32em;">1</span></span></span></span></span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>θ</mi><mrow class="MJX-TeXAtom-ORD"><mi>t</mi><mo>−</mo><mn>1</mn></mrow></msub><mo>−</mo><mfrac><mn>2</mn><mn>3</mn></mfrac><mi>γ</mi><msub><mi>v</mi><mrow class="MJX-TeXAtom-ORD"><mi>t</mi><mo>−</mo><mn>1</mn></mrow></msub></math></span></span><script type="math/tex" id="MathJax-Element-174">\theta_{t-1} - \frac{2}{3}\gamma v_{t-1}</script></span><span> из каких-то теоретических соображений из методов оптимизации.</span></p><h4 id="Adaptive-gradient-methods" data-id="Adaptive-gradient-methods"><a class="anchor hidden-xs" href="#Adaptive-gradient-methods" title="Adaptive-gradient-methods"><span class="octicon octicon-link"></span></a><span>Adaptive gradient methods</span></h4><p><span>Вернемся к первой проблеме SGD. Как уже упоминалось ранее, она возникает из-за сильной разности модулей проекции градиентов на различные оси. Что делать? Давайте как-то “успокаивать” градиенты. Идея всех методов изложенных ниже это добавлять множитель для каждой оси, который будет обратно пропорцианален модулю предыдущих градиентов по этой оси.</span></p><h4 id="AdaGrad" data-id="AdaGrad"><a class="anchor hidden-xs" href="#AdaGrad" title="AdaGrad"><span class="octicon octicon-link"></span></a><span>AdaGrad</span></h4><p><span>Суть этого алгоритма оптимизации следующая: давайте уменьшать learning rate для параметров, вдоль которых значение градиента слишком большое и увеличивать для параметров, вдоль которых значение градиента наоборот слишком маленькое.</span><br>
<span>Пусть </span><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-175-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 118%; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi mathvariant=&quot;normal&quot;>&amp;#x2207;</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>&amp;#x03B8;</mi></mrow></msub><mi>J</mi><mo stretchy=&quot;false&quot;>(</mo><msub><mi>&amp;#x03B8;</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>t</mi><mo>&amp;#x2212;</mo><mn>1</mn></mrow></msub><mo>,</mo><mi>x</mi><mo>,</mo><mi>y</mi><mo stretchy=&quot;false&quot;>)</mo></math>" role="presentation"><span id="MJXc-Node-2789" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-2790" class="mjx-mrow"><span id="MJXc-Node-2791" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-2792" class="mjx-mi"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.373em; padding-bottom: 0.373em;">∇</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.23em; padding-right: 0.071em;"><span id="MJXc-Node-2793" class="mjx-texatom" style=""><span id="MJXc-Node-2794" class="mjx-mrow"><span id="MJXc-Node-2795" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.267em;">θ</span></span></span></span></span></span><span id="MJXc-Node-2796" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.32em; padding-right: 0.078em;">J</span></span><span id="MJXc-Node-2797" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.479em; padding-bottom: 0.585em;">(</span></span><span id="MJXc-Node-2798" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-2799" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.267em;">θ</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-2800" class="mjx-texatom" style=""><span id="MJXc-Node-2801" class="mjx-mrow"><span id="MJXc-Node-2802" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.426em; padding-bottom: 0.267em;">t</span></span><span id="MJXc-Node-2803" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.32em; padding-bottom: 0.426em;">−</span></span><span id="MJXc-Node-2804" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.373em; padding-bottom: 0.32em;">1</span></span></span></span></span></span><span id="MJXc-Node-2805" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="margin-top: -0.156em; padding-bottom: 0.532em;">,</span></span><span id="MJXc-Node-2806" class="mjx-mi MJXc-space1"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.215em; padding-bottom: 0.267em;">x</span></span><span id="MJXc-Node-2807" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="margin-top: -0.156em; padding-bottom: 0.532em;">,</span></span><span id="MJXc-Node-2808" class="mjx-mi MJXc-space1"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.215em; padding-bottom: 0.479em; padding-right: 0.006em;">y</span></span><span id="MJXc-Node-2809" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.479em; padding-bottom: 0.585em;">)</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi mathvariant="normal">∇</mi><mrow class="MJX-TeXAtom-ORD"><mi>θ</mi></mrow></msub><mi>J</mi><mo stretchy="false">(</mo><msub><mi>θ</mi><mrow class="MJX-TeXAtom-ORD"><mi>t</mi><mo>−</mo><mn>1</mn></mrow></msub><mo>,</mo><mi>x</mi><mo>,</mo><mi>y</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-175">\nabla_{\theta} J(\theta_{t-1}, x, y)</script></span><span> — градиент нашей функции ошибки по всем параметрам сети, где </span><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-176-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 118%; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>&amp;#x03B8;</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>t</mi><mo>&amp;#x2212;</mo><mn>1</mn></mrow></msub></math>" role="presentation"><span id="MJXc-Node-2810" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-2811" class="mjx-mrow"><span id="MJXc-Node-2812" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-2813" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.267em;">θ</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-2814" class="mjx-texatom" style=""><span id="MJXc-Node-2815" class="mjx-mrow"><span id="MJXc-Node-2816" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.426em; padding-bottom: 0.267em;">t</span></span><span id="MJXc-Node-2817" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.32em; padding-bottom: 0.426em;">−</span></span><span id="MJXc-Node-2818" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.373em; padding-bottom: 0.32em;">1</span></span></span></span></span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>θ</mi><mrow class="MJX-TeXAtom-ORD"><mi>t</mi><mo>−</mo><mn>1</mn></mrow></msub></math></span></span><script type="math/tex" id="MathJax-Element-176">\theta_{t-1}</script></span><span> — вектор параметров на шаге </span><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-177-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 118%; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>t</mi><mo>&amp;#x2212;</mo><mn>1</mn></math>" role="presentation"><span id="MJXc-Node-2819" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-2820" class="mjx-mrow"><span id="MJXc-Node-2821" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.426em; padding-bottom: 0.267em;">t</span></span><span id="MJXc-Node-2822" class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.32em; padding-bottom: 0.426em;">−</span></span><span id="MJXc-Node-2823" class="mjx-mn MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.373em; padding-bottom: 0.32em;">1</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>t</mi><mo>−</mo><mn>1</mn></math></span></span><script type="math/tex" id="MathJax-Element-177">t-1</script></span><span>. Тогда, для каждого параметра сети (каждой компоненты вектора </span><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-178-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 118%; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>&amp;#x03B8;</mi></math>" role="presentation"><span id="MJXc-Node-2824" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-2825" class="mjx-mrow"><span id="MJXc-Node-2826" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.267em;">θ</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>θ</mi></math></span></span><script type="math/tex" id="MathJax-Element-178">\theta</script></span><span>) будем хранить </span><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-179-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 118%; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>c</mi><mi>a</mi><mi>c</mi><mi>h</mi><mi>e</mi></math>" role="presentation"><span id="MJXc-Node-2827" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-2828" class="mjx-mrow"><span id="MJXc-Node-2829" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.215em; padding-bottom: 0.267em;">c</span></span><span id="MJXc-Node-2830" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.215em; padding-bottom: 0.267em;">a</span></span><span id="MJXc-Node-2831" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.215em; padding-bottom: 0.267em;">c</span></span><span id="MJXc-Node-2832" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.267em;">h</span></span><span id="MJXc-Node-2833" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.215em; padding-bottom: 0.267em;">e</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>c</mi><mi>a</mi><mi>c</mi><mi>h</mi><mi>e</mi></math></span></span><script type="math/tex" id="MathJax-Element-179">cache</script></span><span> — сумму квадратов производных по этому параметру на всех предыдущих итерациях. Определим шаг обновления этого параметра:</span><br>
<span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span class="mjx-chtml MJXc-display" style="text-align: center;"><span id="MathJax-Element-180-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 118%; text-align: center; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><mtable rowspacing=&quot;3pt&quot; columnspacing=&quot;1em&quot; displaystyle=&quot;true&quot;><mtr><mtd><mi>c</mi><mi>a</mi><mi>c</mi><mi>h</mi><msub><mi>e</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>i</mi><mo>,</mo><mi>t</mi></mrow></msub><mo>=</mo><mi>c</mi><mi>a</mi><mi>c</mi><mi>h</mi><msub><mi>e</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>i</mi><mo>,</mo><mi>t</mi><mo>&amp;#x2212;</mo><mn>1</mn></mrow></msub><mo>+</mo><mo stretchy=&quot;false&quot;>(</mo><msub><mi mathvariant=&quot;normal&quot;>&amp;#x2207;</mi><mi>&amp;#x03B8;</mi></msub><mi>J</mi><mo stretchy=&quot;false&quot;>(</mo><msub><mi>&amp;#x03B8;</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>t</mi><mo>&amp;#x2212;</mo><mn>1</mn></mrow></msub><mo>,</mo><mi>x</mi><mo>,</mo><mi>y</mi><mo stretchy=&quot;false&quot;>)</mo><msubsup><mo stretchy=&quot;false&quot;>)</mo><mi>i</mi><mn>2</mn></msubsup><mo>=</mo><mi>c</mi><mi>a</mi><mi>c</mi><mi>h</mi><msub><mi>e</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>i</mi><mo>,</mo><mi>t</mi><mo>&amp;#x2212;</mo><mn>1</mn></mrow></msub><mo>+</mo><msup><mrow><mo>(</mo><mfrac><mrow><mi mathvariant=&quot;normal&quot;>&amp;#x2202;</mi><mi>J</mi></mrow><mrow><mi mathvariant=&quot;normal&quot;>&amp;#x2202;</mi><msub><mi>&amp;#x03B8;</mi><mi>i</mi></msub></mrow></mfrac><mo>)</mo></mrow><mn>2</mn></msup></mtd></mtr><mtr><mtd><msub><mi>&amp;#x03B8;</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>t</mi><mo>,</mo><mi>i</mi></mrow></msub><mo>=</mo><msub><mi>&amp;#x03B8;</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>t</mi><mo>&amp;#x2212;</mo><mn>1</mn><mo>,</mo><mi>i</mi></mrow></msub><mo>&amp;#x2212;</mo><mfrac><mi>&amp;#x03B7;</mi><mrow><mi>c</mi><mi>a</mi><mi>c</mi><mi>h</mi><msub><mi>e</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>i</mi><mo>,</mo><mi>t</mi></mrow></msub><mo>+</mo><mi>&amp;#x03B5;</mi></mrow></mfrac><mo>&amp;#x22C5;</mo><mo stretchy=&quot;false&quot;>(</mo><msub><mi mathvariant=&quot;normal&quot;>&amp;#x2207;</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>&amp;#x03B8;</mi></mrow></msub><mi>J</mi><mo stretchy=&quot;false&quot;>(</mo><msub><mi>&amp;#x03B8;</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>t</mi><mo>&amp;#x2212;</mo><mn>1</mn></mrow></msub><mo>,</mo><mi>x</mi><mo>,</mo><mi>y</mi><mo stretchy=&quot;false&quot;>)</mo><msub><mo stretchy=&quot;false&quot;>)</mo><mi>i</mi></msub><mo>=</mo><msub><mi>&amp;#x03B8;</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>t</mi><mo>&amp;#x2212;</mo><mn>1</mn><mo>,</mo><mi>i</mi></mrow></msub><mo>&amp;#x2212;</mo><mfrac><mi>&amp;#x03B7;</mi><mrow><mi>c</mi><mi>a</mi><mi>c</mi><mi>h</mi><msub><mi>e</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>i</mi><mo>,</mo><mi>t</mi></mrow></msub><mo>+</mo><mi>&amp;#x03B5;</mi></mrow></mfrac><mo>&amp;#x22C5;</mo><mrow><mo>(</mo><mfrac><mrow><mi mathvariant=&quot;normal&quot;>&amp;#x2202;</mi><mi>J</mi></mrow><mrow><mi mathvariant=&quot;normal&quot;>&amp;#x2202;</mi><msub><mi>&amp;#x03B8;</mi><mi>i</mi></msub></mrow></mfrac><mo>)</mo></mrow></mtd></mtr></mtable></math>" role="presentation"><span id="MJXc-Node-2834" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-2835" class="mjx-mrow"><span id="MJXc-Node-2836" class="mjx-mtable" style="vertical-align: -2.469em; padding: 0px 0.167em;"><span class="mjx-table"><span id="MJXc-Node-2837" class="mjx-mtr" style="height: 2.815em;"><span id="MJXc-Node-2838" class="mjx-mtd" style="padding: 0px; width: 33.073em;"><span id="MJXc-Node-2839" class="mjx-mrow"><span id="MJXc-Node-2840" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.215em; padding-bottom: 0.267em;">c</span></span><span id="MJXc-Node-2841" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.215em; padding-bottom: 0.267em;">a</span></span><span id="MJXc-Node-2842" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.215em; padding-bottom: 0.267em;">c</span></span><span id="MJXc-Node-2843" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.267em;">h</span></span><span id="MJXc-Node-2844" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-2845" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.215em; padding-bottom: 0.267em;">e</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-2846" class="mjx-texatom" style=""><span id="MJXc-Node-2847" class="mjx-mrow"><span id="MJXc-Node-2848" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.426em; padding-bottom: 0.267em;">i</span></span><span id="MJXc-Node-2849" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="margin-top: -0.156em; padding-bottom: 0.532em;">,</span></span><span id="MJXc-Node-2850" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.426em; padding-bottom: 0.267em;">t</span></span></span></span></span></span><span id="MJXc-Node-2851" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.056em; padding-bottom: 0.32em;">=</span></span><span id="MJXc-Node-2852" class="mjx-mi MJXc-space3"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.215em; padding-bottom: 0.267em;">c</span></span><span id="MJXc-Node-2853" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.215em; padding-bottom: 0.267em;">a</span></span><span id="MJXc-Node-2854" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.215em; padding-bottom: 0.267em;">c</span></span><span id="MJXc-Node-2855" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.267em;">h</span></span><span id="MJXc-Node-2856" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-2857" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.215em; padding-bottom: 0.267em;">e</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-2858" class="mjx-texatom" style=""><span id="MJXc-Node-2859" class="mjx-mrow"><span id="MJXc-Node-2860" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.426em; padding-bottom: 0.267em;">i</span></span><span id="MJXc-Node-2861" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="margin-top: -0.156em; padding-bottom: 0.532em;">,</span></span><span id="MJXc-Node-2862" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.426em; padding-bottom: 0.267em;">t</span></span><span id="MJXc-Node-2863" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.32em; padding-bottom: 0.426em;">−</span></span><span id="MJXc-Node-2864" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.373em; padding-bottom: 0.32em;">1</span></span></span></span></span></span><span id="MJXc-Node-2865" class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.32em; padding-bottom: 0.426em;">+</span></span><span id="MJXc-Node-2866" class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.479em; padding-bottom: 0.585em;">(</span></span><span id="MJXc-Node-2867" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-2868" class="mjx-mi"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.373em; padding-bottom: 0.373em;">∇</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.23em; padding-right: 0.071em;"><span id="MJXc-Node-2869" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.267em;">θ</span></span></span></span><span id="MJXc-Node-2870" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.32em; padding-right: 0.078em;">J</span></span><span id="MJXc-Node-2871" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.479em; padding-bottom: 0.585em;">(</span></span><span id="MJXc-Node-2872" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-2873" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.267em;">θ</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-2874" class="mjx-texatom" style=""><span id="MJXc-Node-2875" class="mjx-mrow"><span id="MJXc-Node-2876" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.426em; padding-bottom: 0.267em;">t</span></span><span id="MJXc-Node-2877" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.32em; padding-bottom: 0.426em;">−</span></span><span id="MJXc-Node-2878" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.373em; padding-bottom: 0.32em;">1</span></span></span></span></span></span><span id="MJXc-Node-2879" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="margin-top: -0.156em; padding-bottom: 0.532em;">,</span></span><span id="MJXc-Node-2880" class="mjx-mi MJXc-space1"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.215em; padding-bottom: 0.267em;">x</span></span><span id="MJXc-Node-2881" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="margin-top: -0.156em; padding-bottom: 0.532em;">,</span></span><span id="MJXc-Node-2882" class="mjx-mi MJXc-space1"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.215em; padding-bottom: 0.479em; padding-right: 0.006em;">y</span></span><span id="MJXc-Node-2883" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.479em; padding-bottom: 0.585em;">)</span></span><span id="MJXc-Node-2884" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-2885" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.479em; padding-bottom: 0.585em;">)</span></span></span><span class="mjx-stack" style="vertical-align: -0.311em;"><span class="mjx-sup" style="font-size: 70.7%; padding-bottom: 0.255em; padding-left: 0px; padding-right: 0.071em;"><span id="MJXc-Node-2887" class="mjx-mn" style=""><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.373em; padding-bottom: 0.32em;">2</span></span></span><span class="mjx-sub" style="font-size: 70.7%; padding-right: 0.071em;"><span id="MJXc-Node-2886" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.426em; padding-bottom: 0.267em;">i</span></span></span></span></span><span id="MJXc-Node-2888" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.056em; padding-bottom: 0.32em;">=</span></span><span id="MJXc-Node-2889" class="mjx-mi MJXc-space3"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.215em; padding-bottom: 0.267em;">c</span></span><span id="MJXc-Node-2890" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.215em; padding-bottom: 0.267em;">a</span></span><span id="MJXc-Node-2891" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.215em; padding-bottom: 0.267em;">c</span></span><span id="MJXc-Node-2892" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.267em;">h</span></span><span id="MJXc-Node-2893" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-2894" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.215em; padding-bottom: 0.267em;">e</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-2895" class="mjx-texatom" style=""><span id="MJXc-Node-2896" class="mjx-mrow"><span id="MJXc-Node-2897" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.426em; padding-bottom: 0.267em;">i</span></span><span id="MJXc-Node-2898" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="margin-top: -0.156em; padding-bottom: 0.532em;">,</span></span><span id="MJXc-Node-2899" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.426em; padding-bottom: 0.267em;">t</span></span><span id="MJXc-Node-2900" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.32em; padding-bottom: 0.426em;">−</span></span><span id="MJXc-Node-2901" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.373em; padding-bottom: 0.32em;">1</span></span></span></span></span></span><span id="MJXc-Node-2902" class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.32em; padding-bottom: 0.426em;">+</span></span><span id="MJXc-Node-2903" class="mjx-msubsup MJXc-space2"><span class="mjx-base"><span id="MJXc-Node-2904" class="mjx-mrow"><span id="MJXc-Node-2905" class="mjx-mo"><span class="mjx-char MJXc-TeX-size3-R" style="padding-top: 1.221em; padding-bottom: 1.221em;">(</span></span><span id="MJXc-Node-2906" class="mjx-mfrac"><span class="mjx-box MJXc-stacked" style="width: 1.514em; padding: 0px 0.12em;"><span class="mjx-numerator" style="width: 1.514em; top: -1.417em;"><span id="MJXc-Node-2907" class="mjx-mrow"><span id="MJXc-Node-2908" class="mjx-mi"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.426em; padding-bottom: 0.373em; padding-right: 0.035em;">∂</span></span><span id="MJXc-Node-2909" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.32em; padding-right: 0.078em;">J</span></span></span></span><span class="mjx-denominator" style="width: 1.514em; bottom: -0.891em;"><span id="MJXc-Node-2910" class="mjx-mrow"><span id="MJXc-Node-2911" class="mjx-mi"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.426em; padding-bottom: 0.373em; padding-right: 0.035em;">∂</span></span><span id="MJXc-Node-2912" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-2913" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.267em;">θ</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-2914" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.426em; padding-bottom: 0.267em;">i</span></span></span></span></span></span><span style="border-bottom-width: 1.3px; border-bottom-style: solid; top: -0.283em; width: 1.514em;" class="mjx-line"></span></span><span style="height: 2.307em; vertical-align: -0.891em;" class="mjx-vsize"></span></span><span id="MJXc-Node-2915" class="mjx-mo"><span class="mjx-char MJXc-TeX-size3-R" style="padding-top: 1.221em; padding-bottom: 1.221em;">)</span></span></span></span><span class="mjx-sup" style="font-size: 70.7%; vertical-align: 1.7em; padding-left: 0px; padding-right: 0.071em;"><span id="MJXc-Node-2916" class="mjx-mn" style=""><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.373em; padding-bottom: 0.32em;">2</span></span></span></span><span class="mjx-strut"></span></span></span></span><span id="MJXc-Node-2917" class="mjx-mtr" style="height: 2.624em;"><span id="MJXc-Node-2918" class="mjx-mtd" style="padding: 0.15em 0px 0px;"><span id="MJXc-Node-2919" class="mjx-mrow"><span id="MJXc-Node-2920" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-2921" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.267em;">θ</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-2922" class="mjx-texatom" style=""><span id="MJXc-Node-2923" class="mjx-mrow"><span id="MJXc-Node-2924" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.426em; padding-bottom: 0.267em;">t</span></span><span id="MJXc-Node-2925" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="margin-top: -0.156em; padding-bottom: 0.532em;">,</span></span><span id="MJXc-Node-2926" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.426em; padding-bottom: 0.267em;">i</span></span></span></span></span></span><span id="MJXc-Node-2927" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.056em; padding-bottom: 0.32em;">=</span></span><span id="MJXc-Node-2928" class="mjx-msubsup MJXc-space3"><span class="mjx-base"><span id="MJXc-Node-2929" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.267em;">θ</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-2930" class="mjx-texatom" style=""><span id="MJXc-Node-2931" class="mjx-mrow"><span id="MJXc-Node-2932" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.426em; padding-bottom: 0.267em;">t</span></span><span id="MJXc-Node-2933" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.32em; padding-bottom: 0.426em;">−</span></span><span id="MJXc-Node-2934" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.373em; padding-bottom: 0.32em;">1</span></span><span id="MJXc-Node-2935" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="margin-top: -0.156em; padding-bottom: 0.532em;">,</span></span><span id="MJXc-Node-2936" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.426em; padding-bottom: 0.267em;">i</span></span></span></span></span></span><span id="MJXc-Node-2937" class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.32em; padding-bottom: 0.426em;">−</span></span><span id="MJXc-Node-2938" class="mjx-mfrac MJXc-space2"><span class="mjx-box MJXc-stacked" style="width: 5.057em; padding: 0px 0.12em;"><span class="mjx-numerator" style="width: 5.057em; top: -1.184em;"><span id="MJXc-Node-2939" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.215em; padding-bottom: 0.479em; padding-right: 0.006em;">η</span></span></span><span class="mjx-denominator" style="width: 5.057em; bottom: -0.999em;"><span id="MJXc-Node-2940" class="mjx-mrow"><span id="MJXc-Node-2941" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.215em; padding-bottom: 0.267em;">c</span></span><span id="MJXc-Node-2942" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.215em; padding-bottom: 0.267em;">a</span></span><span id="MJXc-Node-2943" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.215em; padding-bottom: 0.267em;">c</span></span><span id="MJXc-Node-2944" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.267em;">h</span></span><span id="MJXc-Node-2945" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-2946" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.215em; padding-bottom: 0.267em;">e</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-2947" class="mjx-texatom" style=""><span id="MJXc-Node-2948" class="mjx-mrow"><span id="MJXc-Node-2949" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.426em; padding-bottom: 0.267em;">i</span></span><span id="MJXc-Node-2950" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="margin-top: -0.156em; padding-bottom: 0.532em;">,</span></span><span id="MJXc-Node-2951" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.426em; padding-bottom: 0.267em;">t</span></span></span></span></span></span><span id="MJXc-Node-2952" class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.32em; padding-bottom: 0.426em;">+</span></span><span id="MJXc-Node-2953" class="mjx-mi MJXc-space2"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.215em; padding-bottom: 0.32em;">ε</span></span></span></span><span style="border-bottom-width: 1.3px; border-bottom-style: solid; top: -0.283em; width: 5.057em;" class="mjx-line"></span></span><span style="height: 2.183em; vertical-align: -0.999em;" class="mjx-vsize"></span></span><span id="MJXc-Node-2954" class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.003em; padding-bottom: 0.32em;">⋅</span></span><span id="MJXc-Node-2955" class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.479em; padding-bottom: 0.585em;">(</span></span><span id="MJXc-Node-2956" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-2957" class="mjx-mi"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.373em; padding-bottom: 0.373em;">∇</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.23em; padding-right: 0.071em;"><span id="MJXc-Node-2958" class="mjx-texatom" style=""><span id="MJXc-Node-2959" class="mjx-mrow"><span id="MJXc-Node-2960" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.267em;">θ</span></span></span></span></span></span><span id="MJXc-Node-2961" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.32em; padding-right: 0.078em;">J</span></span><span id="MJXc-Node-2962" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.479em; padding-bottom: 0.585em;">(</span></span><span id="MJXc-Node-2963" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-2964" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.267em;">θ</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-2965" class="mjx-texatom" style=""><span id="MJXc-Node-2966" class="mjx-mrow"><span id="MJXc-Node-2967" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.426em; padding-bottom: 0.267em;">t</span></span><span id="MJXc-Node-2968" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.32em; padding-bottom: 0.426em;">−</span></span><span id="MJXc-Node-2969" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.373em; padding-bottom: 0.32em;">1</span></span></span></span></span></span><span id="MJXc-Node-2970" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="margin-top: -0.156em; padding-bottom: 0.532em;">,</span></span><span id="MJXc-Node-2971" class="mjx-mi MJXc-space1"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.215em; padding-bottom: 0.267em;">x</span></span><span id="MJXc-Node-2972" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="margin-top: -0.156em; padding-bottom: 0.532em;">,</span></span><span id="MJXc-Node-2973" class="mjx-mi MJXc-space1"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.215em; padding-bottom: 0.479em; padding-right: 0.006em;">y</span></span><span id="MJXc-Node-2974" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.479em; padding-bottom: 0.585em;">)</span></span><span id="MJXc-Node-2975" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-2976" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.479em; padding-bottom: 0.585em;">)</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-2977" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.426em; padding-bottom: 0.267em;">i</span></span></span></span><span id="MJXc-Node-2978" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.056em; padding-bottom: 0.32em;">=</span></span><span id="MJXc-Node-2979" class="mjx-msubsup MJXc-space3"><span class="mjx-base"><span id="MJXc-Node-2980" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.267em;">θ</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-2981" class="mjx-texatom" style=""><span id="MJXc-Node-2982" class="mjx-mrow"><span id="MJXc-Node-2983" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.426em; padding-bottom: 0.267em;">t</span></span><span id="MJXc-Node-2984" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.32em; padding-bottom: 0.426em;">−</span></span><span id="MJXc-Node-2985" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.373em; padding-bottom: 0.32em;">1</span></span><span id="MJXc-Node-2986" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="margin-top: -0.156em; padding-bottom: 0.532em;">,</span></span><span id="MJXc-Node-2987" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.426em; padding-bottom: 0.267em;">i</span></span></span></span></span></span><span id="MJXc-Node-2988" class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.32em; padding-bottom: 0.426em;">−</span></span><span id="MJXc-Node-2989" class="mjx-mfrac MJXc-space2"><span class="mjx-box MJXc-stacked" style="width: 5.057em; padding: 0px 0.12em;"><span class="mjx-numerator" style="width: 5.057em; top: -1.184em;"><span id="MJXc-Node-2990" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.215em; padding-bottom: 0.479em; padding-right: 0.006em;">η</span></span></span><span class="mjx-denominator" style="width: 5.057em; bottom: -0.999em;"><span id="MJXc-Node-2991" class="mjx-mrow"><span id="MJXc-Node-2992" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.215em; padding-bottom: 0.267em;">c</span></span><span id="MJXc-Node-2993" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.215em; padding-bottom: 0.267em;">a</span></span><span id="MJXc-Node-2994" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.215em; padding-bottom: 0.267em;">c</span></span><span id="MJXc-Node-2995" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.267em;">h</span></span><span id="MJXc-Node-2996" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-2997" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.215em; padding-bottom: 0.267em;">e</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-2998" class="mjx-texatom" style=""><span id="MJXc-Node-2999" class="mjx-mrow"><span id="MJXc-Node-3000" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.426em; padding-bottom: 0.267em;">i</span></span><span id="MJXc-Node-3001" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="margin-top: -0.156em; padding-bottom: 0.532em;">,</span></span><span id="MJXc-Node-3002" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.426em; padding-bottom: 0.267em;">t</span></span></span></span></span></span><span id="MJXc-Node-3003" class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.32em; padding-bottom: 0.426em;">+</span></span><span id="MJXc-Node-3004" class="mjx-mi MJXc-space2"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.215em; padding-bottom: 0.32em;">ε</span></span></span></span><span style="border-bottom-width: 1.3px; border-bottom-style: solid; top: -0.283em; width: 5.057em;" class="mjx-line"></span></span><span style="height: 2.183em; vertical-align: -0.999em;" class="mjx-vsize"></span></span><span id="MJXc-Node-3005" class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.003em; padding-bottom: 0.32em;">⋅</span></span><span id="MJXc-Node-3006" class="mjx-mrow MJXc-space2"><span id="MJXc-Node-3007" class="mjx-mo"><span class="mjx-char MJXc-TeX-size3-R" style="padding-top: 1.221em; padding-bottom: 1.221em;">(</span></span><span id="MJXc-Node-3008" class="mjx-mfrac"><span class="mjx-box MJXc-stacked" style="width: 1.514em; padding: 0px 0.12em;"><span class="mjx-numerator" style="width: 1.514em; top: -1.417em;"><span id="MJXc-Node-3009" class="mjx-mrow"><span id="MJXc-Node-3010" class="mjx-mi"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.426em; padding-bottom: 0.373em; padding-right: 0.035em;">∂</span></span><span id="MJXc-Node-3011" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.32em; padding-right: 0.078em;">J</span></span></span></span><span class="mjx-denominator" style="width: 1.514em; bottom: -0.891em;"><span id="MJXc-Node-3012" class="mjx-mrow"><span id="MJXc-Node-3013" class="mjx-mi"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.426em; padding-bottom: 0.373em; padding-right: 0.035em;">∂</span></span><span id="MJXc-Node-3014" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-3015" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.267em;">θ</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-3016" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.426em; padding-bottom: 0.267em;">i</span></span></span></span></span></span><span style="border-bottom-width: 1.3px; border-bottom-style: solid; top: -0.283em; width: 1.514em;" class="mjx-line"></span></span><span style="height: 2.307em; vertical-align: -0.891em;" class="mjx-vsize"></span></span><span id="MJXc-Node-3017" class="mjx-mo"><span class="mjx-char MJXc-TeX-size3-R" style="padding-top: 1.221em; padding-bottom: 1.221em;">)</span></span></span><span class="mjx-strut"></span></span></span></span></span></span></span></span><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mtable rowspacing="3pt" columnspacing="1em" displaystyle="true"><mtr><mtd><mi>c</mi><mi>a</mi><mi>c</mi><mi>h</mi><msub><mi>e</mi><mrow class="MJX-TeXAtom-ORD"><mi>i</mi><mo>,</mo><mi>t</mi></mrow></msub><mo>=</mo><mi>c</mi><mi>a</mi><mi>c</mi><mi>h</mi><msub><mi>e</mi><mrow class="MJX-TeXAtom-ORD"><mi>i</mi><mo>,</mo><mi>t</mi><mo>−</mo><mn>1</mn></mrow></msub><mo>+</mo><mo stretchy="false">(</mo><msub><mi mathvariant="normal">∇</mi><mi>θ</mi></msub><mi>J</mi><mo stretchy="false">(</mo><msub><mi>θ</mi><mrow class="MJX-TeXAtom-ORD"><mi>t</mi><mo>−</mo><mn>1</mn></mrow></msub><mo>,</mo><mi>x</mi><mo>,</mo><mi>y</mi><mo stretchy="false">)</mo><msubsup><mo stretchy="false">)</mo><mi>i</mi><mn>2</mn></msubsup><mo>=</mo><mi>c</mi><mi>a</mi><mi>c</mi><mi>h</mi><msub><mi>e</mi><mrow class="MJX-TeXAtom-ORD"><mi>i</mi><mo>,</mo><mi>t</mi><mo>−</mo><mn>1</mn></mrow></msub><mo>+</mo><msup><mrow><mo>(</mo><mfrac><mrow><mi mathvariant="normal">∂</mi><mi>J</mi></mrow><mrow><mi mathvariant="normal">∂</mi><msub><mi>θ</mi><mi>i</mi></msub></mrow></mfrac><mo>)</mo></mrow><mn>2</mn></msup></mtd></mtr><mtr><mtd><msub><mi>θ</mi><mrow class="MJX-TeXAtom-ORD"><mi>t</mi><mo>,</mo><mi>i</mi></mrow></msub><mo>=</mo><msub><mi>θ</mi><mrow class="MJX-TeXAtom-ORD"><mi>t</mi><mo>−</mo><mn>1</mn><mo>,</mo><mi>i</mi></mrow></msub><mo>−</mo><mfrac><mi>η</mi><mrow><mi>c</mi><mi>a</mi><mi>c</mi><mi>h</mi><msub><mi>e</mi><mrow class="MJX-TeXAtom-ORD"><mi>i</mi><mo>,</mo><mi>t</mi></mrow></msub><mo>+</mo><mi>ε</mi></mrow></mfrac><mo>⋅</mo><mo stretchy="false">(</mo><msub><mi mathvariant="normal">∇</mi><mrow class="MJX-TeXAtom-ORD"><mi>θ</mi></mrow></msub><mi>J</mi><mo stretchy="false">(</mo><msub><mi>θ</mi><mrow class="MJX-TeXAtom-ORD"><mi>t</mi><mo>−</mo><mn>1</mn></mrow></msub><mo>,</mo><mi>x</mi><mo>,</mo><mi>y</mi><mo stretchy="false">)</mo><msub><mo stretchy="false">)</mo><mi>i</mi></msub><mo>=</mo><msub><mi>θ</mi><mrow class="MJX-TeXAtom-ORD"><mi>t</mi><mo>−</mo><mn>1</mn><mo>,</mo><mi>i</mi></mrow></msub><mo>−</mo><mfrac><mi>η</mi><mrow><mi>c</mi><mi>a</mi><mi>c</mi><mi>h</mi><msub><mi>e</mi><mrow class="MJX-TeXAtom-ORD"><mi>i</mi><mo>,</mo><mi>t</mi></mrow></msub><mo>+</mo><mi>ε</mi></mrow></mfrac><mo>⋅</mo><mrow><mo>(</mo><mfrac><mrow><mi mathvariant="normal">∂</mi><mi>J</mi></mrow><mrow><mi mathvariant="normal">∂</mi><msub><mi>θ</mi><mi>i</mi></msub></mrow></mfrac><mo>)</mo></mrow></mtd></mtr></mtable></math></span></span></span><script type="math/tex; mode=display" id="MathJax-Element-180">
\begin{gather}
    cache_{i, t} = cache_{i, t - 1} + (\nabla_\theta J(\theta_{t-1}, x, y))_i^2 = cache_{i, t - 1} + \left(\frac{\partial J}{\partial \theta_i}\right)^2 \\
\theta_{t, i} = \theta_{t-1, i} - \frac{\eta}{cache_{i, t}+\varepsilon} \cdot (\nabla_{\theta} J(\theta_{t-1}, x, y))_i = \theta_{t-1, i} - \frac{\eta}{cache_{i, t}+\varepsilon} \cdot \left(\frac{\partial J}{\partial \theta_i}\right)
\end{gather}
</script></span><br>
<span>Здесь все производные берутся в точке </span><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-181-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 118%; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>&amp;#x03B8;</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>t</mi><mo>&amp;#x2212;</mo><mn>1</mn></mrow></msub><mo>.</mo></math>" role="presentation"><span id="MJXc-Node-3018" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-3019" class="mjx-mrow"><span id="MJXc-Node-3020" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-3021" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.267em;">θ</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-3022" class="mjx-texatom" style=""><span id="MJXc-Node-3023" class="mjx-mrow"><span id="MJXc-Node-3024" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.426em; padding-bottom: 0.267em;">t</span></span><span id="MJXc-Node-3025" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.32em; padding-bottom: 0.426em;">−</span></span><span id="MJXc-Node-3026" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.373em; padding-bottom: 0.32em;">1</span></span></span></span></span></span><span id="MJXc-Node-3027" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="margin-top: -0.156em; padding-bottom: 0.32em;">.</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>θ</mi><mrow class="MJX-TeXAtom-ORD"><mi>t</mi><mo>−</mo><mn>1</mn></mrow></msub><mo>.</mo></math></span></span><script type="math/tex" id="MathJax-Element-181">\theta_{t - 1}.</script></span><span> </span><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-182-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 118%; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>&amp;#x03B5;</mi></math>" role="presentation"><span id="MJXc-Node-3028" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-3029" class="mjx-mrow"><span id="MJXc-Node-3030" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.215em; padding-bottom: 0.32em;">ε</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>ε</mi></math></span></span><script type="math/tex" id="MathJax-Element-182">\varepsilon</script></span><span> — это маленькое число для “numerical stability” (чтобы не делить на ноль), как правило </span><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-183-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 118%; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mn>1</mn><mo>&amp;#x22C5;</mo><msup><mn>10</mn><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo>&amp;#x2212;</mo><mn>6</mn></mrow></msup><mo>.</mo></math>" role="presentation"><span id="MJXc-Node-3031" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-3032" class="mjx-mrow"><span id="MJXc-Node-3033" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.373em; padding-bottom: 0.32em;">1</span></span><span id="MJXc-Node-3034" class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.003em; padding-bottom: 0.32em;">⋅</span></span><span id="MJXc-Node-3035" class="mjx-msubsup MJXc-space2"><span class="mjx-base"><span id="MJXc-Node-3036" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.373em; padding-bottom: 0.373em;">10</span></span></span><span class="mjx-sup" style="font-size: 70.7%; vertical-align: 0.591em; padding-left: 0px; padding-right: 0.071em;"><span id="MJXc-Node-3037" class="mjx-texatom" style=""><span id="MJXc-Node-3038" class="mjx-mrow"><span id="MJXc-Node-3039" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.32em; padding-bottom: 0.426em;">−</span></span><span id="MJXc-Node-3040" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.373em; padding-bottom: 0.373em;">6</span></span></span></span></span></span><span id="MJXc-Node-3041" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="margin-top: -0.156em; padding-bottom: 0.32em;">.</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mn>1</mn><mo>⋅</mo><msup><mn>10</mn><mrow class="MJX-TeXAtom-ORD"><mo>−</mo><mn>6</mn></mrow></msup><mo>.</mo></math></span></span><script type="math/tex" id="MathJax-Element-183">1\cdot10^{-6}.</script></span><br>
<span>Основная проблема Adagrad в том, что мы никак не ограничиваем величину </span><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-184-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 118%; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>c</mi><mi>a</mi><mi>c</mi><mi>h</mi><mi>e</mi><mo>,</mo></math>" role="presentation"><span id="MJXc-Node-3042" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-3043" class="mjx-mrow"><span id="MJXc-Node-3044" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.215em; padding-bottom: 0.267em;">c</span></span><span id="MJXc-Node-3045" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.215em; padding-bottom: 0.267em;">a</span></span><span id="MJXc-Node-3046" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.215em; padding-bottom: 0.267em;">c</span></span><span id="MJXc-Node-3047" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.267em;">h</span></span><span id="MJXc-Node-3048" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.215em; padding-bottom: 0.267em;">e</span></span><span id="MJXc-Node-3049" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="margin-top: -0.156em; padding-bottom: 0.532em;">,</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>c</mi><mi>a</mi><mi>c</mi><mi>h</mi><mi>e</mi><mo>,</mo></math></span></span><script type="math/tex" id="MathJax-Element-184">cache,</script></span><span> поэтому в какой-то момент он может стать настолько большим, что наш градиент просто затухнет — уменьшится до очень малых значений, и мы будем сходится к оптимуму очень медленно.</span></p><h4 id="RMSProp" data-id="RMSProp"><a class="anchor hidden-xs" href="#RMSProp" title="RMSProp"><span class="octicon octicon-link"></span></a><span>RMSProp</span></h4><p><span>Исправить недостаток предыдущего метода можно следующим образом: будем учитывать старые значение </span><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-185-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 118%; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>c</mi><mi>a</mi><mi>c</mi><mi>h</mi><mi>e</mi></math>" role="presentation"><span id="MJXc-Node-3050" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-3051" class="mjx-mrow"><span id="MJXc-Node-3052" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.215em; padding-bottom: 0.267em;">c</span></span><span id="MJXc-Node-3053" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.215em; padding-bottom: 0.267em;">a</span></span><span id="MJXc-Node-3054" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.215em; padding-bottom: 0.267em;">c</span></span><span id="MJXc-Node-3055" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.267em;">h</span></span><span id="MJXc-Node-3056" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.215em; padding-bottom: 0.267em;">e</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>c</mi><mi>a</mi><mi>c</mi><mi>h</mi><mi>e</mi></math></span></span><script type="math/tex" id="MathJax-Element-185">cache</script></span><span> с некоторым коэффициентом </span><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-186-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 118%; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>&amp;#x03B2;</mi><mo>,</mo></math>" role="presentation"><span id="MJXc-Node-3057" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-3058" class="mjx-mrow"><span id="MJXc-Node-3059" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.479em; padding-right: 0.007em;">β</span></span><span id="MJXc-Node-3060" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="margin-top: -0.156em; padding-bottom: 0.532em;">,</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>β</mi><mo>,</mo></math></span></span><script type="math/tex" id="MathJax-Element-186">\beta,</script></span><span> чтобы замедлить затухание градиента. Давайте вспомним чего мы хотим: мы хотим отнормировать векторы гардиентов по всем осям. Будем считать </span><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-187-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 118%; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>c</mi><mi>a</mi><mi>c</mi><mi>h</mi><mi>e</mi></math>" role="presentation"><span id="MJXc-Node-3061" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-3062" class="mjx-mrow"><span id="MJXc-Node-3063" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.215em; padding-bottom: 0.267em;">c</span></span><span id="MJXc-Node-3064" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.215em; padding-bottom: 0.267em;">a</span></span><span id="MJXc-Node-3065" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.215em; padding-bottom: 0.267em;">c</span></span><span id="MJXc-Node-3066" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.267em;">h</span></span><span id="MJXc-Node-3067" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.215em; padding-bottom: 0.267em;">e</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>c</mi><mi>a</mi><mi>c</mi><mi>h</mi><mi>e</mi></math></span></span><script type="math/tex" id="MathJax-Element-187">cache</script></span><span> на шаге </span><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-188-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 118%; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>t</mi></math>" role="presentation"><span id="MJXc-Node-3068" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-3069" class="mjx-mrow"><span id="MJXc-Node-3070" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.426em; padding-bottom: 0.267em;">t</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>t</mi></math></span></span><script type="math/tex" id="MathJax-Element-188">t</script></span><span> как</span><br>
<span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span class="mjx-chtml MJXc-display" style="text-align: center;"><span id="MathJax-Element-189-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 118%; text-align: center; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><mi>c</mi><mi>a</mi><mi>c</mi><mi>h</mi><msub><mi>e</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>t</mi></mrow></msub><mo>=</mo><mi>&amp;#x03B2;</mi><mi>c</mi><mi>a</mi><mi>c</mi><mi>h</mi><msub><mi>e</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>t</mi><mo>&amp;#x2212;</mo><mn>1</mn></mrow></msub><mo>+</mo><mo stretchy=&quot;false&quot;>(</mo><mn>1</mn><mo>&amp;#x2212;</mo><mi>&amp;#x03B2;</mi><mo stretchy=&quot;false&quot;>)</mo><msubsup><mi>g</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>t</mi></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mn>2</mn></mrow></msubsup></math>" role="presentation"><span id="MJXc-Node-3071" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-3072" class="mjx-mrow"><span id="MJXc-Node-3073" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.215em; padding-bottom: 0.267em;">c</span></span><span id="MJXc-Node-3074" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.215em; padding-bottom: 0.267em;">a</span></span><span id="MJXc-Node-3075" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.215em; padding-bottom: 0.267em;">c</span></span><span id="MJXc-Node-3076" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.267em;">h</span></span><span id="MJXc-Node-3077" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-3078" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.215em; padding-bottom: 0.267em;">e</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-3079" class="mjx-texatom" style=""><span id="MJXc-Node-3080" class="mjx-mrow"><span id="MJXc-Node-3081" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.426em; padding-bottom: 0.267em;">t</span></span></span></span></span></span><span id="MJXc-Node-3082" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.056em; padding-bottom: 0.32em;">=</span></span><span id="MJXc-Node-3083" class="mjx-mi MJXc-space3"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.479em; padding-right: 0.007em;">β</span></span><span id="MJXc-Node-3084" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.215em; padding-bottom: 0.267em;">c</span></span><span id="MJXc-Node-3085" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.215em; padding-bottom: 0.267em;">a</span></span><span id="MJXc-Node-3086" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.215em; padding-bottom: 0.267em;">c</span></span><span id="MJXc-Node-3087" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.267em;">h</span></span><span id="MJXc-Node-3088" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-3089" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.215em; padding-bottom: 0.267em;">e</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-3090" class="mjx-texatom" style=""><span id="MJXc-Node-3091" class="mjx-mrow"><span id="MJXc-Node-3092" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.426em; padding-bottom: 0.267em;">t</span></span><span id="MJXc-Node-3093" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.32em; padding-bottom: 0.426em;">−</span></span><span id="MJXc-Node-3094" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.373em; padding-bottom: 0.32em;">1</span></span></span></span></span></span><span id="MJXc-Node-3095" class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.32em; padding-bottom: 0.426em;">+</span></span><span id="MJXc-Node-3096" class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.479em; padding-bottom: 0.585em;">(</span></span><span id="MJXc-Node-3097" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.373em; padding-bottom: 0.32em;">1</span></span><span id="MJXc-Node-3098" class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.32em; padding-bottom: 0.426em;">−</span></span><span id="MJXc-Node-3099" class="mjx-mi MJXc-space2"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.479em; padding-right: 0.007em;">β</span></span><span id="MJXc-Node-3100" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.479em; padding-bottom: 0.585em;">)</span></span><span id="MJXc-Node-3101" class="mjx-msubsup"><span class="mjx-base" style="margin-right: -0.003em;"><span id="MJXc-Node-3102" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.215em; padding-bottom: 0.479em; padding-right: 0.003em;">g</span></span></span><span class="mjx-stack" style="vertical-align: -0.287em;"><span class="mjx-sup" style="font-size: 70.7%; padding-bottom: 0.255em; padding-left: 0.076em; padding-right: 0.071em;"><span id="MJXc-Node-3106" class="mjx-texatom" style=""><span id="MJXc-Node-3107" class="mjx-mrow"><span id="MJXc-Node-3108" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.373em; padding-bottom: 0.32em;">2</span></span></span></span></span><span class="mjx-sub" style="font-size: 70.7%; padding-right: 0.071em;"><span id="MJXc-Node-3103" class="mjx-texatom" style=""><span id="MJXc-Node-3104" class="mjx-mrow"><span id="MJXc-Node-3105" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.426em; padding-bottom: 0.267em;">t</span></span></span></span></span></span></span></span></span><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mi>c</mi><mi>a</mi><mi>c</mi><mi>h</mi><msub><mi>e</mi><mrow class="MJX-TeXAtom-ORD"><mi>t</mi></mrow></msub><mo>=</mo><mi>β</mi><mi>c</mi><mi>a</mi><mi>c</mi><mi>h</mi><msub><mi>e</mi><mrow class="MJX-TeXAtom-ORD"><mi>t</mi><mo>−</mo><mn>1</mn></mrow></msub><mo>+</mo><mo stretchy="false">(</mo><mn>1</mn><mo>−</mo><mi>β</mi><mo stretchy="false">)</mo><msubsup><mi>g</mi><mrow class="MJX-TeXAtom-ORD"><mi>t</mi></mrow><mrow class="MJX-TeXAtom-ORD"><mn>2</mn></mrow></msubsup></math></span></span></span><script type="math/tex; mode=display" id="MathJax-Element-189">
cache_{t}=\beta cache_{t - 1}+(1 - \beta) g_{t}^{2}
</script></span><br>
<span>Здесь </span><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-190-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 118%; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>g</mi><mi>t</mi></msub></math>" role="presentation"><span id="MJXc-Node-3109" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-3110" class="mjx-mrow"><span id="MJXc-Node-3111" class="mjx-msubsup"><span class="mjx-base" style="margin-right: -0.003em;"><span id="MJXc-Node-3112" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.215em; padding-bottom: 0.479em; padding-right: 0.003em;">g</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-3113" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.426em; padding-bottom: 0.267em;">t</span></span></span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>g</mi><mi>t</mi></msub></math></span></span><script type="math/tex" id="MathJax-Element-190">g_t</script></span><span> — это вектор градиента на шаге </span><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-191-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 118%; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>t</mi><mo>.</mo></math>" role="presentation"><span id="MJXc-Node-3114" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-3115" class="mjx-mrow"><span id="MJXc-Node-3116" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.426em; padding-bottom: 0.267em;">t</span></span><span id="MJXc-Node-3117" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="margin-top: -0.156em; padding-bottom: 0.32em;">.</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>t</mi><mo>.</mo></math></span></span><script type="math/tex" id="MathJax-Element-191">t.</script></span><span> Таким образом, мы придаём больший вес значению градиента на предыдущем шаге, нежели чем на шаг который был десять итераций назад. Таким образом:</span><br>
<span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span class="mjx-chtml MJXc-display" style="text-align: center;"><span id="MathJax-Element-192-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 118%; text-align: center; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><mi mathvariant=&quot;normal&quot;>&amp;#x0394;</mi><msub><mi>&amp;#x03B8;</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>t</mi></mrow></msub><mo>=</mo><mo>&amp;#x2212;</mo><mfrac><mi>&amp;#x03B7;</mi><mrow><mi>c</mi><mi>a</mi><mi>c</mi><mi>h</mi><msub><mi>e</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>t</mi></mrow></msub><mo>+</mo><mi>&amp;#x03F5;</mi></mrow></mfrac><mo>&amp;#x2299;</mo><msub><mi>g</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>t</mi></mrow></msub></math>" role="presentation"><span id="MJXc-Node-3118" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-3119" class="mjx-mrow"><span id="MJXc-Node-3120" class="mjx-mi"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.426em; padding-bottom: 0.32em;">Δ</span></span><span id="MJXc-Node-3121" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-3122" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.267em;">θ</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-3123" class="mjx-texatom" style=""><span id="MJXc-Node-3124" class="mjx-mrow"><span id="MJXc-Node-3125" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.426em; padding-bottom: 0.267em;">t</span></span></span></span></span></span><span id="MJXc-Node-3126" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.056em; padding-bottom: 0.32em;">=</span></span><span id="MJXc-Node-3127" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.32em; padding-bottom: 0.426em;">−</span></span><span id="MJXc-Node-3128" class="mjx-mfrac"><span class="mjx-box MJXc-stacked" style="width: 4.556em; padding: 0px 0.12em;"><span class="mjx-numerator" style="width: 4.556em; top: -1.184em;"><span id="MJXc-Node-3129" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.215em; padding-bottom: 0.479em; padding-right: 0.006em;">η</span></span></span><span class="mjx-denominator" style="width: 4.556em; bottom: -0.87em;"><span id="MJXc-Node-3130" class="mjx-mrow"><span id="MJXc-Node-3131" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.215em; padding-bottom: 0.267em;">c</span></span><span id="MJXc-Node-3132" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.215em; padding-bottom: 0.267em;">a</span></span><span id="MJXc-Node-3133" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.215em; padding-bottom: 0.267em;">c</span></span><span id="MJXc-Node-3134" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.267em;">h</span></span><span id="MJXc-Node-3135" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-3136" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.215em; padding-bottom: 0.267em;">e</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-3137" class="mjx-texatom" style=""><span id="MJXc-Node-3138" class="mjx-mrow"><span id="MJXc-Node-3139" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.426em; padding-bottom: 0.267em;">t</span></span></span></span></span></span><span id="MJXc-Node-3140" class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.32em; padding-bottom: 0.426em;">+</span></span><span id="MJXc-Node-3141" class="mjx-mi MJXc-space2"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.215em; padding-bottom: 0.267em;">ϵ</span></span></span></span><span style="border-bottom-width: 1.3px; border-bottom-style: solid; top: -0.283em; width: 4.556em;" class="mjx-line"></span></span><span style="height: 2.053em; vertical-align: -0.87em;" class="mjx-vsize"></span></span><span id="MJXc-Node-3142" class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.32em; padding-bottom: 0.426em;">⊙</span></span><span id="MJXc-Node-3143" class="mjx-msubsup MJXc-space2"><span class="mjx-base" style="margin-right: -0.003em;"><span id="MJXc-Node-3144" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.215em; padding-bottom: 0.479em; padding-right: 0.003em;">g</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-3145" class="mjx-texatom" style=""><span id="MJXc-Node-3146" class="mjx-mrow"><span id="MJXc-Node-3147" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.426em; padding-bottom: 0.267em;">t</span></span></span></span></span></span></span></span><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mi mathvariant="normal">Δ</mi><msub><mi>θ</mi><mrow class="MJX-TeXAtom-ORD"><mi>t</mi></mrow></msub><mo>=</mo><mo>−</mo><mfrac><mi>η</mi><mrow><mi>c</mi><mi>a</mi><mi>c</mi><mi>h</mi><msub><mi>e</mi><mrow class="MJX-TeXAtom-ORD"><mi>t</mi></mrow></msub><mo>+</mo><mi>ϵ</mi></mrow></mfrac><mo>⊙</mo><msub><mi>g</mi><mrow class="MJX-TeXAtom-ORD"><mi>t</mi></mrow></msub></math></span></span></span><script type="math/tex; mode=display" id="MathJax-Element-192">
\Delta \theta_{t}=-\frac{\eta}{cache_{t}+\epsilon} \odot g_{t}
</script></span><br>
<span>Ну и соответсвтенно</span><br>
<span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span class="mjx-chtml MJXc-display" style="text-align: center;"><span id="MathJax-Element-193-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 118%; text-align: center; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><msub><mi>&amp;#x03B8;</mi><mi>t</mi></msub><mo>=</mo><msub><mi>&amp;#x03B8;</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>t</mi><mo>&amp;#x2212;</mo><mn>1</mn></mrow></msub><mo>+</mo><mi mathvariant=&quot;normal&quot;>&amp;#x0394;</mi><msub><mi>&amp;#x03B8;</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>t</mi><mo>&amp;#x2212;</mo><mn>1</mn></mrow></msub></math>" role="presentation"><span id="MJXc-Node-3148" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-3149" class="mjx-mrow"><span id="MJXc-Node-3150" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-3151" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.267em;">θ</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-3152" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.426em; padding-bottom: 0.267em;">t</span></span></span></span><span id="MJXc-Node-3153" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.056em; padding-bottom: 0.32em;">=</span></span><span id="MJXc-Node-3154" class="mjx-msubsup MJXc-space3"><span class="mjx-base"><span id="MJXc-Node-3155" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.267em;">θ</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-3156" class="mjx-texatom" style=""><span id="MJXc-Node-3157" class="mjx-mrow"><span id="MJXc-Node-3158" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.426em; padding-bottom: 0.267em;">t</span></span><span id="MJXc-Node-3159" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.32em; padding-bottom: 0.426em;">−</span></span><span id="MJXc-Node-3160" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.373em; padding-bottom: 0.32em;">1</span></span></span></span></span></span><span id="MJXc-Node-3161" class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.32em; padding-bottom: 0.426em;">+</span></span><span id="MJXc-Node-3162" class="mjx-mi MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.426em; padding-bottom: 0.32em;">Δ</span></span><span id="MJXc-Node-3163" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-3164" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.267em;">θ</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-3165" class="mjx-texatom" style=""><span id="MJXc-Node-3166" class="mjx-mrow"><span id="MJXc-Node-3167" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.426em; padding-bottom: 0.267em;">t</span></span><span id="MJXc-Node-3168" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.32em; padding-bottom: 0.426em;">−</span></span><span id="MJXc-Node-3169" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.373em; padding-bottom: 0.32em;">1</span></span></span></span></span></span></span></span><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><msub><mi>θ</mi><mi>t</mi></msub><mo>=</mo><msub><mi>θ</mi><mrow class="MJX-TeXAtom-ORD"><mi>t</mi><mo>−</mo><mn>1</mn></mrow></msub><mo>+</mo><mi mathvariant="normal">Δ</mi><msub><mi>θ</mi><mrow class="MJX-TeXAtom-ORD"><mi>t</mi><mo>−</mo><mn>1</mn></mrow></msub></math></span></span></span><script type="math/tex; mode=display" id="MathJax-Element-193">
\theta_t = \theta_{t-1} + \Delta\theta_{t-1}
</script></span></p><ul>
<li><span>Заметим, что можно интепретировать </span><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-194-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 118%; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>c</mi><mi>a</mi><mi>c</mi><mi>h</mi><mi>e</mi></math>" role="presentation"><span id="MJXc-Node-3170" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-3171" class="mjx-mrow"><span id="MJXc-Node-3172" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.215em; padding-bottom: 0.267em;">c</span></span><span id="MJXc-Node-3173" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.215em; padding-bottom: 0.267em;">a</span></span><span id="MJXc-Node-3174" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.215em; padding-bottom: 0.267em;">c</span></span><span id="MJXc-Node-3175" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.267em;">h</span></span><span id="MJXc-Node-3176" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.215em; padding-bottom: 0.267em;">e</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>c</mi><mi>a</mi><mi>c</mi><mi>h</mi><mi>e</mi></math></span></span><script type="math/tex" id="MathJax-Element-194">cache</script></span><span> как дисперсию вектора градиентов. Тогда, в предыдущем алгоритме использовалось обычное среднее, а в этом взвешенное среднее, а именно экспоненциальное скользящее среднее (EMA).</span></li>
</ul><h4 id="Adadelta" data-id="Adadelta"><a class="anchor hidden-xs" href="#Adadelta" title="Adadelta"><span class="octicon octicon-link"></span></a><span>Adadelta</span></h4><p><span>Метод похож на предыдущий, однако давайте введем величину</span><br>
<span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span class="mjx-chtml MJXc-display" style="text-align: center;"><span id="MathJax-Element-195-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 118%; text-align: center; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><mi>E</mi><msub><mrow><mo>[</mo><mi mathvariant=&quot;normal&quot;>&amp;#x0394;</mi><msup><mi>&amp;#x03B8;</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mn>2</mn></mrow></msup><mo>]</mo></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>t</mi></mrow></msub><mo>=</mo><mi>&amp;#x03B3;</mi><mi>E</mi><msub><mrow><mo>[</mo><mi mathvariant=&quot;normal&quot;>&amp;#x0394;</mi><msup><mi>&amp;#x03B8;</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mn>2</mn></mrow></msup><mo>]</mo></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>t</mi><mo>&amp;#x2212;</mo><mn>1</mn></mrow></msub><mo>+</mo><mo stretchy=&quot;false&quot;>(</mo><mn>1</mn><mo>&amp;#x2212;</mo><mi>&amp;#x03B3;</mi><mo stretchy=&quot;false&quot;>)</mo><mi mathvariant=&quot;normal&quot;>&amp;#x0394;</mi><msubsup><mi>&amp;#x03B8;</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>t</mi></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mn>2</mn></mrow></msubsup></math>" role="presentation"><span id="MJXc-Node-3177" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-3178" class="mjx-mrow"><span id="MJXc-Node-3179" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.267em; padding-right: 0.026em;">E</span></span><span id="MJXc-Node-3180" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-3181" class="mjx-mrow"><span id="MJXc-Node-3182" class="mjx-mo"><span class="mjx-char MJXc-TeX-size1-R" style="padding-top: 0.638em; padding-bottom: 0.638em;">[</span></span><span id="MJXc-Node-3183" class="mjx-mi"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.426em; padding-bottom: 0.32em;">Δ</span></span><span id="MJXc-Node-3184" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-3185" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.267em;">θ</span></span></span><span class="mjx-sup" style="font-size: 70.7%; vertical-align: 0.584em; padding-left: 0px; padding-right: 0.071em;"><span id="MJXc-Node-3186" class="mjx-texatom" style=""><span id="MJXc-Node-3187" class="mjx-mrow"><span id="MJXc-Node-3188" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.373em; padding-bottom: 0.32em;">2</span></span></span></span></span></span><span id="MJXc-Node-3189" class="mjx-mo"><span class="mjx-char MJXc-TeX-size1-R" style="padding-top: 0.638em; padding-bottom: 0.638em;">]</span></span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.579em; padding-right: 0.071em;"><span id="MJXc-Node-3190" class="mjx-texatom" style=""><span id="MJXc-Node-3191" class="mjx-mrow"><span id="MJXc-Node-3192" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.426em; padding-bottom: 0.267em;">t</span></span></span></span></span></span><span id="MJXc-Node-3193" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.056em; padding-bottom: 0.32em;">=</span></span><span id="MJXc-Node-3194" class="mjx-mi MJXc-space3"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.215em; padding-bottom: 0.479em; padding-right: 0.025em;">γ</span></span><span id="MJXc-Node-3195" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.267em; padding-right: 0.026em;">E</span></span><span id="MJXc-Node-3196" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-3197" class="mjx-mrow"><span id="MJXc-Node-3198" class="mjx-mo"><span class="mjx-char MJXc-TeX-size1-R" style="padding-top: 0.638em; padding-bottom: 0.638em;">[</span></span><span id="MJXc-Node-3199" class="mjx-mi"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.426em; padding-bottom: 0.32em;">Δ</span></span><span id="MJXc-Node-3200" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-3201" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.267em;">θ</span></span></span><span class="mjx-sup" style="font-size: 70.7%; vertical-align: 0.584em; padding-left: 0px; padding-right: 0.071em;"><span id="MJXc-Node-3202" class="mjx-texatom" style=""><span id="MJXc-Node-3203" class="mjx-mrow"><span id="MJXc-Node-3204" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.373em; padding-bottom: 0.32em;">2</span></span></span></span></span></span><span id="MJXc-Node-3205" class="mjx-mo"><span class="mjx-char MJXc-TeX-size1-R" style="padding-top: 0.638em; padding-bottom: 0.638em;">]</span></span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.579em; padding-right: 0.071em;"><span id="MJXc-Node-3206" class="mjx-texatom" style=""><span id="MJXc-Node-3207" class="mjx-mrow"><span id="MJXc-Node-3208" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.426em; padding-bottom: 0.267em;">t</span></span><span id="MJXc-Node-3209" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.32em; padding-bottom: 0.426em;">−</span></span><span id="MJXc-Node-3210" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.373em; padding-bottom: 0.32em;">1</span></span></span></span></span></span><span id="MJXc-Node-3211" class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.32em; padding-bottom: 0.426em;">+</span></span><span id="MJXc-Node-3212" class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.479em; padding-bottom: 0.585em;">(</span></span><span id="MJXc-Node-3213" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.373em; padding-bottom: 0.32em;">1</span></span><span id="MJXc-Node-3214" class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.32em; padding-bottom: 0.426em;">−</span></span><span id="MJXc-Node-3215" class="mjx-mi MJXc-space2"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.215em; padding-bottom: 0.479em; padding-right: 0.025em;">γ</span></span><span id="MJXc-Node-3216" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.479em; padding-bottom: 0.585em;">)</span></span><span id="MJXc-Node-3217" class="mjx-mi"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.426em; padding-bottom: 0.32em;">Δ</span></span><span id="MJXc-Node-3218" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-3219" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.267em;">θ</span></span></span><span class="mjx-stack" style="vertical-align: -0.287em;"><span class="mjx-sup" style="font-size: 70.7%; padding-bottom: 0.255em; padding-left: 0px; padding-right: 0.071em;"><span id="MJXc-Node-3223" class="mjx-texatom" style=""><span id="MJXc-Node-3224" class="mjx-mrow"><span id="MJXc-Node-3225" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.373em; padding-bottom: 0.32em;">2</span></span></span></span></span><span class="mjx-sub" style="font-size: 70.7%; padding-right: 0.071em;"><span id="MJXc-Node-3220" class="mjx-texatom" style=""><span id="MJXc-Node-3221" class="mjx-mrow"><span id="MJXc-Node-3222" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.426em; padding-bottom: 0.267em;">t</span></span></span></span></span></span></span></span></span><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mi>E</mi><msub><mrow><mo>[</mo><mi mathvariant="normal">Δ</mi><msup><mi>θ</mi><mrow class="MJX-TeXAtom-ORD"><mn>2</mn></mrow></msup><mo>]</mo></mrow><mrow class="MJX-TeXAtom-ORD"><mi>t</mi></mrow></msub><mo>=</mo><mi>γ</mi><mi>E</mi><msub><mrow><mo>[</mo><mi mathvariant="normal">Δ</mi><msup><mi>θ</mi><mrow class="MJX-TeXAtom-ORD"><mn>2</mn></mrow></msup><mo>]</mo></mrow><mrow class="MJX-TeXAtom-ORD"><mi>t</mi><mo>−</mo><mn>1</mn></mrow></msub><mo>+</mo><mo stretchy="false">(</mo><mn>1</mn><mo>−</mo><mi>γ</mi><mo stretchy="false">)</mo><mi mathvariant="normal">Δ</mi><msubsup><mi>θ</mi><mrow class="MJX-TeXAtom-ORD"><mi>t</mi></mrow><mrow class="MJX-TeXAtom-ORD"><mn>2</mn></mrow></msubsup></math></span></span></span><script type="math/tex; mode=display" id="MathJax-Element-195">
E\left[\Delta \theta^{2}\right]_{t}=\gamma E\left[\Delta \theta^{2}\right]_{t-1}+(1-\gamma) \Delta \theta_{t}^{2}
</script></span><br>
<span>Пусть так же: </span><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span class="mjx-chtml MJXc-display" style="text-align: center;"><span id="MathJax-Element-196-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 118%; text-align: center; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><mi>R</mi><mi>M</mi><mi>S</mi><mo stretchy=&quot;false&quot;>[</mo><mi mathvariant=&quot;normal&quot;>&amp;#x0394;</mi><mi>&amp;#x03B8;</mi><msub><mo stretchy=&quot;false&quot;>]</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>t</mi></mrow></msub><mo>=</mo><msqrt><mi>E</mi><msub><mrow><mo>[</mo><mi mathvariant=&quot;normal&quot;>&amp;#x0394;</mi><msup><mi>&amp;#x03B8;</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mn>2</mn></mrow></msup><mo>]</mo></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>t</mi></mrow></msub><mo>+</mo><mi>&amp;#x03F5;</mi></msqrt></math>" role="presentation"><span id="MJXc-Node-3226" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-3227" class="mjx-mrow"><span id="MJXc-Node-3228" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.32em;">R</span></span><span id="MJXc-Node-3229" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.267em; padding-right: 0.081em;">M</span></span><span id="MJXc-Node-3230" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.32em; padding-right: 0.032em;">S</span></span><span id="MJXc-Node-3231" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.479em; padding-bottom: 0.585em;">[</span></span><span id="MJXc-Node-3232" class="mjx-mi"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.426em; padding-bottom: 0.32em;">Δ</span></span><span id="MJXc-Node-3233" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.267em;">θ</span></span><span id="MJXc-Node-3234" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-3235" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.479em; padding-bottom: 0.585em;">]</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-3236" class="mjx-texatom" style=""><span id="MJXc-Node-3237" class="mjx-mrow"><span id="MJXc-Node-3238" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.426em; padding-bottom: 0.267em;">t</span></span></span></span></span></span><span id="MJXc-Node-3239" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.056em; padding-bottom: 0.32em;">=</span></span><span id="MJXc-Node-3240" class="mjx-msqrt MJXc-space3"><span class="mjx-box" style="padding-top: 0.045em;"><span class="mjx-surd"><span class="mjx-char MJXc-TeX-size2-R" style="padding-top: 0.903em; padding-bottom: 0.903em;">√</span></span><span class="mjx-box" style="padding-top: 0.172em; border-top-width: 1.4px; border-top-style: solid;"><span id="MJXc-Node-3241" class="mjx-mrow"><span id="MJXc-Node-3242" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.267em; padding-right: 0.026em;">E</span></span><span id="MJXc-Node-3243" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-3244" class="mjx-mrow"><span id="MJXc-Node-3245" class="mjx-mo"><span class="mjx-char MJXc-TeX-size1-R" style="padding-top: 0.638em; padding-bottom: 0.638em;">[</span></span><span id="MJXc-Node-3246" class="mjx-mi"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.426em; padding-bottom: 0.32em;">Δ</span></span><span id="MJXc-Node-3247" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-3248" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.267em;">θ</span></span></span><span class="mjx-sup" style="font-size: 70.7%; vertical-align: 0.584em; padding-left: 0px; padding-right: 0.071em;"><span id="MJXc-Node-3249" class="mjx-texatom" style=""><span id="MJXc-Node-3250" class="mjx-mrow"><span id="MJXc-Node-3251" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.373em; padding-bottom: 0.32em;">2</span></span></span></span></span></span><span id="MJXc-Node-3252" class="mjx-mo"><span class="mjx-char MJXc-TeX-size1-R" style="padding-top: 0.638em; padding-bottom: 0.638em;">]</span></span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.579em; padding-right: 0.071em;"><span id="MJXc-Node-3253" class="mjx-texatom" style=""><span id="MJXc-Node-3254" class="mjx-mrow"><span id="MJXc-Node-3255" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.426em; padding-bottom: 0.267em;">t</span></span></span></span></span></span><span id="MJXc-Node-3256" class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.32em; padding-bottom: 0.426em;">+</span></span><span id="MJXc-Node-3257" class="mjx-mi MJXc-space2"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.215em; padding-bottom: 0.267em;">ϵ</span></span></span></span></span></span></span></span><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mi>R</mi><mi>M</mi><mi>S</mi><mo stretchy="false">[</mo><mi mathvariant="normal">Δ</mi><mi>θ</mi><msub><mo stretchy="false">]</mo><mrow class="MJX-TeXAtom-ORD"><mi>t</mi></mrow></msub><mo>=</mo><msqrt><mi>E</mi><msub><mrow><mo>[</mo><mi mathvariant="normal">Δ</mi><msup><mi>θ</mi><mrow class="MJX-TeXAtom-ORD"><mn>2</mn></mrow></msup><mo>]</mo></mrow><mrow class="MJX-TeXAtom-ORD"><mi>t</mi></mrow></msub><mo>+</mo><mi>ϵ</mi></msqrt></math></span></span></span><script type="math/tex; mode=display" id="MathJax-Element-196">R M S[\Delta \theta]_{t}=\sqrt{E\left[\Delta \theta^{2}\right]_{t}+\epsilon}</script></span><br>
<span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span class="mjx-chtml MJXc-display" style="text-align: center;"><span id="MathJax-Element-197-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 118%; text-align: center; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><mi>R</mi><mi>M</mi><mi>S</mi><msub><mrow><mo>[</mo><mi mathvariant=&quot;normal&quot;>&amp;#x0394;</mi><mi>g</mi><mo>]</mo></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>t</mi></mrow></msub><mo>=</mo><msqrt><mi>E</mi><msub><mrow><mo>[</mo><msup><mi>g</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mn>2</mn></mrow></msup><mo>]</mo></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>t</mi></mrow></msub><mo>+</mo><mi>&amp;#x03F5;</mi></msqrt></math>" role="presentation"><span id="MJXc-Node-3258" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-3259" class="mjx-mrow"><span id="MJXc-Node-3260" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.32em;">R</span></span><span id="MJXc-Node-3261" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.267em; padding-right: 0.081em;">M</span></span><span id="MJXc-Node-3262" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.32em; padding-right: 0.032em;">S</span></span><span id="MJXc-Node-3263" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-3264" class="mjx-mrow"><span id="MJXc-Node-3265" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.479em; padding-bottom: 0.585em;">[</span></span><span id="MJXc-Node-3266" class="mjx-mi"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.426em; padding-bottom: 0.32em;">Δ</span></span><span id="MJXc-Node-3267" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.215em; padding-bottom: 0.479em; padding-right: 0.003em;">g</span></span><span id="MJXc-Node-3268" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.479em; padding-bottom: 0.585em;">]</span></span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.439em; padding-right: 0.071em;"><span id="MJXc-Node-3269" class="mjx-texatom" style=""><span id="MJXc-Node-3270" class="mjx-mrow"><span id="MJXc-Node-3271" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.426em; padding-bottom: 0.267em;">t</span></span></span></span></span></span><span id="MJXc-Node-3272" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.056em; padding-bottom: 0.32em;">=</span></span><span id="MJXc-Node-3273" class="mjx-msqrt MJXc-space3"><span class="mjx-box" style="padding-top: 0.045em;"><span class="mjx-surd"><span class="mjx-char MJXc-TeX-size2-R" style="padding-top: 0.903em; padding-bottom: 0.903em;">√</span></span><span class="mjx-box" style="padding-top: 0.172em; border-top-width: 1.4px; border-top-style: solid;"><span id="MJXc-Node-3274" class="mjx-mrow"><span id="MJXc-Node-3275" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.267em; padding-right: 0.026em;">E</span></span><span id="MJXc-Node-3276" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-3277" class="mjx-mrow"><span id="MJXc-Node-3278" class="mjx-mo"><span class="mjx-char MJXc-TeX-size1-R" style="padding-top: 0.638em; padding-bottom: 0.638em;">[</span></span><span id="MJXc-Node-3279" class="mjx-msubsup"><span class="mjx-base" style="margin-right: -0.003em;"><span id="MJXc-Node-3280" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.215em; padding-bottom: 0.479em; padding-right: 0.003em;">g</span></span></span><span class="mjx-sup" style="font-size: 70.7%; vertical-align: 0.584em; padding-left: 0.076em; padding-right: 0.071em;"><span id="MJXc-Node-3281" class="mjx-texatom" style=""><span id="MJXc-Node-3282" class="mjx-mrow"><span id="MJXc-Node-3283" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.373em; padding-bottom: 0.32em;">2</span></span></span></span></span></span><span id="MJXc-Node-3284" class="mjx-mo"><span class="mjx-char MJXc-TeX-size1-R" style="padding-top: 0.638em; padding-bottom: 0.638em;">]</span></span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.579em; padding-right: 0.071em;"><span id="MJXc-Node-3285" class="mjx-texatom" style=""><span id="MJXc-Node-3286" class="mjx-mrow"><span id="MJXc-Node-3287" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.426em; padding-bottom: 0.267em;">t</span></span></span></span></span></span><span id="MJXc-Node-3288" class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.32em; padding-bottom: 0.426em;">+</span></span><span id="MJXc-Node-3289" class="mjx-mi MJXc-space2"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.215em; padding-bottom: 0.267em;">ϵ</span></span></span></span></span></span></span></span><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mi>R</mi><mi>M</mi><mi>S</mi><msub><mrow><mo>[</mo><mi mathvariant="normal">Δ</mi><mi>g</mi><mo>]</mo></mrow><mrow class="MJX-TeXAtom-ORD"><mi>t</mi></mrow></msub><mo>=</mo><msqrt><mi>E</mi><msub><mrow><mo>[</mo><msup><mi>g</mi><mrow class="MJX-TeXAtom-ORD"><mn>2</mn></mrow></msup><mo>]</mo></mrow><mrow class="MJX-TeXAtom-ORD"><mi>t</mi></mrow></msub><mo>+</mo><mi>ϵ</mi></msqrt></math></span></span></span><script type="math/tex; mode=display" id="MathJax-Element-197">
R M S \left[\Delta g\right]_{t} = \sqrt{E\left[g^{2}\right]_{t}+\epsilon}
</script></span><br>
<span>Можно считать, что величина </span><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-198-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 118%; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>R</mi><mi>M</mi><mi>S</mi><msub><mrow><mo>[</mo><mi mathvariant=&quot;normal&quot;>&amp;#x0394;</mi><mi>g</mi><mo>]</mo></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>t</mi></mrow></msub></math>" role="presentation"><span id="MJXc-Node-3290" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-3291" class="mjx-mrow"><span id="MJXc-Node-3292" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.32em;">R</span></span><span id="MJXc-Node-3293" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.267em; padding-right: 0.081em;">M</span></span><span id="MJXc-Node-3294" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.32em; padding-right: 0.032em;">S</span></span><span id="MJXc-Node-3295" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-3296" class="mjx-mrow"><span id="MJXc-Node-3297" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.479em; padding-bottom: 0.585em;">[</span></span><span id="MJXc-Node-3298" class="mjx-mi"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.426em; padding-bottom: 0.32em;">Δ</span></span><span id="MJXc-Node-3299" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.215em; padding-bottom: 0.479em; padding-right: 0.003em;">g</span></span><span id="MJXc-Node-3300" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.479em; padding-bottom: 0.585em;">]</span></span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.439em; padding-right: 0.071em;"><span id="MJXc-Node-3301" class="mjx-texatom" style=""><span id="MJXc-Node-3302" class="mjx-mrow"><span id="MJXc-Node-3303" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.426em; padding-bottom: 0.267em;">t</span></span></span></span></span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>R</mi><mi>M</mi><mi>S</mi><msub><mrow><mo>[</mo><mi mathvariant="normal">Δ</mi><mi>g</mi><mo>]</mo></mrow><mrow class="MJX-TeXAtom-ORD"><mi>t</mi></mrow></msub></math></span></span><script type="math/tex" id="MathJax-Element-198">R M S\left[\Delta g\right]_{t}</script></span><span> есть новое обозначение </span><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-199-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 118%; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>c</mi><mi>a</mi><mi>c</mi><mi>h</mi><mi>e</mi></math>" role="presentation"><span id="MJXc-Node-3304" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-3305" class="mjx-mrow"><span id="MJXc-Node-3306" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.215em; padding-bottom: 0.267em;">c</span></span><span id="MJXc-Node-3307" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.215em; padding-bottom: 0.267em;">a</span></span><span id="MJXc-Node-3308" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.215em; padding-bottom: 0.267em;">c</span></span><span id="MJXc-Node-3309" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.267em;">h</span></span><span id="MJXc-Node-3310" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.215em; padding-bottom: 0.267em;">e</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>c</mi><mi>a</mi><mi>c</mi><mi>h</mi><mi>e</mi></math></span></span><script type="math/tex" id="MathJax-Element-199">cache</script></span><span> из предыдущего метода (она действительно имеет такой же смысл).</span><br>
<span>И будем делать шаг следующим образом:</span><br>
<span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span class="mjx-chtml MJXc-display" style="text-align: center;"><span id="MathJax-Element-200-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 118%; text-align: center; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><mtable columnalign=&quot;right left right left right left right left right left right left&quot; rowspacing=&quot;3pt&quot; columnspacing=&quot;0em 2em 0em 2em 0em 2em 0em 2em 0em 2em 0em&quot; displaystyle=&quot;true&quot;><mtr><mtd><mi mathvariant=&quot;normal&quot;>&amp;#x0394;</mi><msub><mi>&amp;#x03B8;</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>t</mi></mrow></msub></mtd><mtd><mi></mi><mo>=</mo><mo>&amp;#x2212;</mo><mfrac><mrow><mi>R</mi><mi>M</mi><mi>S</mi><mo stretchy=&quot;false&quot;>[</mo><mi mathvariant=&quot;normal&quot;>&amp;#x0394;</mi><mi>&amp;#x03B8;</mi><msub><mo stretchy=&quot;false&quot;>]</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>t</mi><mo>&amp;#x2212;</mo><mn>1</mn></mrow></msub></mrow><mrow><mi>R</mi><mi>M</mi><mi>S</mi><mo stretchy=&quot;false&quot;>[</mo><mi>g</mi><msub><mo stretchy=&quot;false&quot;>]</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>t</mi></mrow></msub></mrow></mfrac><msub><mi>g</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>t</mi></mrow></msub></mtd></mtr><mtr><mtd><msub><mi>&amp;#x03B8;</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>t</mi><mo>+</mo><mn>1</mn></mrow></msub></mtd><mtd><mi></mi><mo>=</mo><msub><mi>&amp;#x03B8;</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>t</mi></mrow></msub><mo>+</mo><mi mathvariant=&quot;normal&quot;>&amp;#x0394;</mi><msub><mi>&amp;#x03B8;</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>t</mi></mrow></msub></mtd></mtr></mtable></math>" role="presentation"><span id="MJXc-Node-3311" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-3312" class="mjx-mrow"><span id="MJXc-Node-3313" class="mjx-mtable" style="vertical-align: -1.688em; padding: 0px 0.167em;"><span class="mjx-table"><span id="MJXc-Node-3314" class="mjx-mtr" style="height: 2.701em;"><span id="MJXc-Node-3315" class="mjx-mtd" style="padding: 0px; text-align: right; width: 1.663em;"><span id="MJXc-Node-3316" class="mjx-mrow" style="margin-top: 0.526em;"><span id="MJXc-Node-3317" class="mjx-mi"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.426em; padding-bottom: 0.32em;">Δ</span></span><span id="MJXc-Node-3318" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-3319" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.267em;">θ</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-3320" class="mjx-texatom" style=""><span id="MJXc-Node-3321" class="mjx-mrow"><span id="MJXc-Node-3322" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.426em; padding-bottom: 0.267em;">t</span></span></span></span></span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-3323" class="mjx-mtd" style="padding: 0px; text-align: left; width: 8.826em;"><span id="MJXc-Node-3324" class="mjx-mrow"><span id="MJXc-Node-3325" class="mjx-mi"></span><span id="MJXc-Node-3326" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.056em; padding-bottom: 0.32em;">=</span></span><span id="MJXc-Node-3327" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.32em; padding-bottom: 0.426em;">−</span></span><span id="MJXc-Node-3328" class="mjx-mfrac"><span class="mjx-box MJXc-stacked" style="width: 5.707em; padding: 0px 0.12em;"><span class="mjx-numerator" style="width: 5.707em; top: -1.526em;"><span id="MJXc-Node-3329" class="mjx-mrow"><span id="MJXc-Node-3330" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.32em;">R</span></span><span id="MJXc-Node-3331" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.267em; padding-right: 0.081em;">M</span></span><span id="MJXc-Node-3332" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.32em; padding-right: 0.032em;">S</span></span><span id="MJXc-Node-3333" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.479em; padding-bottom: 0.585em;">[</span></span><span id="MJXc-Node-3334" class="mjx-mi"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.426em; padding-bottom: 0.32em;">Δ</span></span><span id="MJXc-Node-3335" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.267em;">θ</span></span><span id="MJXc-Node-3336" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-3337" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.479em; padding-bottom: 0.585em;">]</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-3338" class="mjx-texatom" style=""><span id="MJXc-Node-3339" class="mjx-mrow"><span id="MJXc-Node-3340" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.426em; padding-bottom: 0.267em;">t</span></span><span id="MJXc-Node-3341" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.32em; padding-bottom: 0.426em;">−</span></span><span id="MJXc-Node-3342" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.373em; padding-bottom: 0.32em;">1</span></span></span></span></span></span></span></span><span class="mjx-denominator" style="width: 5.707em; bottom: -1.026em;"><span id="MJXc-Node-3343" class="mjx-mrow"><span id="MJXc-Node-3344" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.32em;">R</span></span><span id="MJXc-Node-3345" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.267em; padding-right: 0.081em;">M</span></span><span id="MJXc-Node-3346" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.32em; padding-right: 0.032em;">S</span></span><span id="MJXc-Node-3347" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.479em; padding-bottom: 0.585em;">[</span></span><span id="MJXc-Node-3348" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.215em; padding-bottom: 0.479em; padding-right: 0.003em;">g</span></span><span id="MJXc-Node-3349" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-3350" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.479em; padding-bottom: 0.585em;">]</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-3351" class="mjx-texatom" style=""><span id="MJXc-Node-3352" class="mjx-mrow"><span id="MJXc-Node-3353" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.426em; padding-bottom: 0.267em;">t</span></span></span></span></span></span></span></span><span style="border-bottom-width: 1.3px; border-bottom-style: solid; top: -0.283em; width: 5.707em;" class="mjx-line"></span></span><span style="height: 2.551em; vertical-align: -1.026em;" class="mjx-vsize"></span></span><span id="MJXc-Node-3354" class="mjx-msubsup"><span class="mjx-base" style="margin-right: -0.003em;"><span id="MJXc-Node-3355" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.215em; padding-bottom: 0.479em; padding-right: 0.003em;">g</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-3356" class="mjx-texatom" style=""><span id="MJXc-Node-3357" class="mjx-mrow"><span id="MJXc-Node-3358" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.426em; padding-bottom: 0.267em;">t</span></span></span></span></span></span><span class="mjx-strut"></span></span></span></span><span id="MJXc-Node-3359" class="mjx-mtr" style="height: 1.176em;"><span id="MJXc-Node-3360" class="mjx-mtd" style="padding: 0.15em 0px 0px; text-align: right;"><span id="MJXc-Node-3361" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-3362" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-3363" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.267em;">θ</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-3364" class="mjx-texatom" style=""><span id="MJXc-Node-3365" class="mjx-mrow"><span id="MJXc-Node-3366" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.426em; padding-bottom: 0.267em;">t</span></span><span id="MJXc-Node-3367" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.32em; padding-bottom: 0.426em;">+</span></span><span id="MJXc-Node-3368" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.373em; padding-bottom: 0.32em;">1</span></span></span></span></span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-3369" class="mjx-mtd" style="padding: 0.15em 0px 0px; text-align: left;"><span id="MJXc-Node-3370" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-3371" class="mjx-mi"></span><span id="MJXc-Node-3372" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.056em; padding-bottom: 0.32em;">=</span></span><span id="MJXc-Node-3373" class="mjx-msubsup MJXc-space3"><span class="mjx-base"><span id="MJXc-Node-3374" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.267em;">θ</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-3375" class="mjx-texatom" style=""><span id="MJXc-Node-3376" class="mjx-mrow"><span id="MJXc-Node-3377" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.426em; padding-bottom: 0.267em;">t</span></span></span></span></span></span><span id="MJXc-Node-3378" class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.32em; padding-bottom: 0.426em;">+</span></span><span id="MJXc-Node-3379" class="mjx-mi MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.426em; padding-bottom: 0.32em;">Δ</span></span><span id="MJXc-Node-3380" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-3381" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.267em;">θ</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-3382" class="mjx-texatom" style=""><span id="MJXc-Node-3383" class="mjx-mrow"><span id="MJXc-Node-3384" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.426em; padding-bottom: 0.267em;">t</span></span></span></span></span></span><span class="mjx-strut"></span></span></span></span></span></span></span></span><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mtable columnalign="right left right left right left right left right left right left" rowspacing="3pt" columnspacing="0em 2em 0em 2em 0em 2em 0em 2em 0em 2em 0em" displaystyle="true"><mtr><mtd><mi mathvariant="normal">Δ</mi><msub><mi>θ</mi><mrow class="MJX-TeXAtom-ORD"><mi>t</mi></mrow></msub></mtd><mtd><mi></mi><mo>=</mo><mo>−</mo><mfrac><mrow><mi>R</mi><mi>M</mi><mi>S</mi><mo stretchy="false">[</mo><mi mathvariant="normal">Δ</mi><mi>θ</mi><msub><mo stretchy="false">]</mo><mrow class="MJX-TeXAtom-ORD"><mi>t</mi><mo>−</mo><mn>1</mn></mrow></msub></mrow><mrow><mi>R</mi><mi>M</mi><mi>S</mi><mo stretchy="false">[</mo><mi>g</mi><msub><mo stretchy="false">]</mo><mrow class="MJX-TeXAtom-ORD"><mi>t</mi></mrow></msub></mrow></mfrac><msub><mi>g</mi><mrow class="MJX-TeXAtom-ORD"><mi>t</mi></mrow></msub></mtd></mtr><mtr><mtd><msub><mi>θ</mi><mrow class="MJX-TeXAtom-ORD"><mi>t</mi><mo>+</mo><mn>1</mn></mrow></msub></mtd><mtd><mi></mi><mo>=</mo><msub><mi>θ</mi><mrow class="MJX-TeXAtom-ORD"><mi>t</mi></mrow></msub><mo>+</mo><mi mathvariant="normal">Δ</mi><msub><mi>θ</mi><mrow class="MJX-TeXAtom-ORD"><mi>t</mi></mrow></msub></mtd></mtr></mtable></math></span></span></span><script type="math/tex; mode=display" id="MathJax-Element-200">
\begin{aligned} \Delta \theta_{t} &=-\frac{R M S[\Delta \theta]_{t-1}}{R M S[g]_{t}} g_{t} \\ \theta_{t+1} &=\theta_{t}+\Delta \theta_{t} \end{aligned}
</script></span><br>
<span>Особенностью такого подхода является то, что нам не нужно подбирать learning rate, соответсвенно уменьшается число гиперпараметров.</span></p><h4 id="Adam" data-id="Adam"><a class="anchor hidden-xs" href="#Adam" title="Adam"><span class="octicon octicon-link"></span></a><span>Adam</span></h4><p><span>Апофеоз всего написанного выше. Давайте совместим два метода: RMSProp (как улучшение Adagrad) и momentum. Получим два множителя перед градиентом, один из которых будет прямо пропорцианален модулям предыдущих градиентов, а другой обратно пропорцианален. Продолжая аналогию с тяжелым шариком последний множитель будет выступать в роли силы трения.</span></p><p><span>Пусть </span><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-201-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 118%; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>g</mi><mi>t</mi></msub></math>" role="presentation"><span id="MJXc-Node-3385" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-3386" class="mjx-mrow"><span id="MJXc-Node-3387" class="mjx-msubsup"><span class="mjx-base" style="margin-right: -0.003em;"><span id="MJXc-Node-3388" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.215em; padding-bottom: 0.479em; padding-right: 0.003em;">g</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-3389" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.426em; padding-bottom: 0.267em;">t</span></span></span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>g</mi><mi>t</mi></msub></math></span></span><script type="math/tex" id="MathJax-Element-201">g_t</script></span><span> — всё ещё вектор градиентов на шаге </span><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-202-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 118%; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>t</mi><mo>.</mo></math>" role="presentation"><span id="MJXc-Node-3390" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-3391" class="mjx-mrow"><span id="MJXc-Node-3392" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.426em; padding-bottom: 0.267em;">t</span></span><span id="MJXc-Node-3393" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="margin-top: -0.156em; padding-bottom: 0.32em;">.</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>t</mi><mo>.</mo></math></span></span><script type="math/tex" id="MathJax-Element-202">t.</script></span><br>
<span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span class="mjx-chtml MJXc-display" style="text-align: center;"><span id="MathJax-Element-203-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 118%; text-align: center; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><mtable columnalign=&quot;right left right left right left right left right left right left&quot; rowspacing=&quot;3pt&quot; columnspacing=&quot;0em 2em 0em 2em 0em 2em 0em 2em 0em 2em 0em&quot; displaystyle=&quot;true&quot;><mtr><mtd><msub><mi>m</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>t</mi></mrow></msub></mtd><mtd><mi></mi><mo>=</mo><msub><mi>&amp;#x03B2;</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mn>1</mn></mrow></msub><msub><mi>m</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>t</mi><mo>&amp;#x2212;</mo><mn>1</mn></mrow></msub><mo>+</mo><mrow><mo>(</mo><mn>1</mn><mo>&amp;#x2212;</mo><msub><mi>&amp;#x03B2;</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mn>1</mn></mrow></msub><mo>)</mo></mrow><msub><mi>g</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>t</mi></mrow></msub></mtd></mtr><mtr><mtd><msub><mi>v</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>t</mi></mrow></msub></mtd><mtd><mi></mi><mo>=</mo><msub><mi>&amp;#x03B2;</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mn>2</mn></mrow></msub><msub><mi>v</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>t</mi><mo>&amp;#x2212;</mo><mn>1</mn></mrow></msub><mo>+</mo><mrow><mo>(</mo><mn>1</mn><mo>&amp;#x2212;</mo><msub><mi>&amp;#x03B2;</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mn>2</mn></mrow></msub><mo>)</mo></mrow><msubsup><mi>g</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>t</mi></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mn>2</mn></mrow></msubsup></mtd></mtr></mtable></math>" role="presentation"><span id="MJXc-Node-3394" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-3395" class="mjx-mrow"><span id="MJXc-Node-3396" class="mjx-mtable" style="vertical-align: -1.024em; padding: 0px 0.167em;"><span class="mjx-table"><span id="MJXc-Node-3397" class="mjx-mtr" style="height: 1.225em;"><span id="MJXc-Node-3398" class="mjx-mtd" style="padding: 0px; text-align: right; width: 1.169em;"><span id="MJXc-Node-3399" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-3400" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-3401" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.215em; padding-bottom: 0.267em;">m</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-3402" class="mjx-texatom" style=""><span id="MJXc-Node-3403" class="mjx-mrow"><span id="MJXc-Node-3404" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.426em; padding-bottom: 0.267em;">t</span></span></span></span></span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-3405" class="mjx-mtd" style="padding: 0px; text-align: left; width: 9.973em;"><span id="MJXc-Node-3406" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-3407" class="mjx-mi"></span><span id="MJXc-Node-3408" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.056em; padding-bottom: 0.32em;">=</span></span><span id="MJXc-Node-3409" class="mjx-msubsup MJXc-space3"><span class="mjx-base" style="margin-right: -0.007em;"><span id="MJXc-Node-3410" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.479em; padding-right: 0.007em;">β</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-3411" class="mjx-texatom" style=""><span id="MJXc-Node-3412" class="mjx-mrow"><span id="MJXc-Node-3413" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.373em; padding-bottom: 0.32em;">1</span></span></span></span></span></span><span id="MJXc-Node-3414" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-3415" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.215em; padding-bottom: 0.267em;">m</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-3416" class="mjx-texatom" style=""><span id="MJXc-Node-3417" class="mjx-mrow"><span id="MJXc-Node-3418" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.426em; padding-bottom: 0.267em;">t</span></span><span id="MJXc-Node-3419" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.32em; padding-bottom: 0.426em;">−</span></span><span id="MJXc-Node-3420" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.373em; padding-bottom: 0.32em;">1</span></span></span></span></span></span><span id="MJXc-Node-3421" class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.32em; padding-bottom: 0.426em;">+</span></span><span id="MJXc-Node-3422" class="mjx-mrow MJXc-space2"><span id="MJXc-Node-3423" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.479em; padding-bottom: 0.585em;">(</span></span><span id="MJXc-Node-3424" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.373em; padding-bottom: 0.32em;">1</span></span><span id="MJXc-Node-3425" class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.32em; padding-bottom: 0.426em;">−</span></span><span id="MJXc-Node-3426" class="mjx-msubsup MJXc-space2"><span class="mjx-base" style="margin-right: -0.007em;"><span id="MJXc-Node-3427" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.479em; padding-right: 0.007em;">β</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-3428" class="mjx-texatom" style=""><span id="MJXc-Node-3429" class="mjx-mrow"><span id="MJXc-Node-3430" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.373em; padding-bottom: 0.32em;">1</span></span></span></span></span></span><span id="MJXc-Node-3431" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.479em; padding-bottom: 0.585em;">)</span></span></span><span id="MJXc-Node-3432" class="mjx-msubsup MJXc-space1"><span class="mjx-base" style="margin-right: -0.003em;"><span id="MJXc-Node-3433" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.215em; padding-bottom: 0.479em; padding-right: 0.003em;">g</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-3434" class="mjx-texatom" style=""><span id="MJXc-Node-3435" class="mjx-mrow"><span id="MJXc-Node-3436" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.426em; padding-bottom: 0.267em;">t</span></span></span></span></span></span><span class="mjx-strut"></span></span></span></span><span id="MJXc-Node-3437" class="mjx-mtr" style="height: 1.322em;"><span id="MJXc-Node-3438" class="mjx-mtd" style="padding: 0.15em 0px 0px; text-align: right;"><span id="MJXc-Node-3439" class="mjx-mrow" style="margin-top: -0.14em;"><span id="MJXc-Node-3440" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-3441" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.215em; padding-bottom: 0.267em;">v</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-3442" class="mjx-texatom" style=""><span id="MJXc-Node-3443" class="mjx-mrow"><span id="MJXc-Node-3444" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.426em; padding-bottom: 0.267em;">t</span></span></span></span></span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-3445" class="mjx-mtd" style="padding: 0.15em 0px 0px; text-align: left;"><span id="MJXc-Node-3446" class="mjx-mrow" style="margin-top: -0.14em;"><span id="MJXc-Node-3447" class="mjx-mi"></span><span id="MJXc-Node-3448" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.056em; padding-bottom: 0.32em;">=</span></span><span id="MJXc-Node-3449" class="mjx-msubsup MJXc-space3"><span class="mjx-base" style="margin-right: -0.007em;"><span id="MJXc-Node-3450" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.479em; padding-right: 0.007em;">β</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-3451" class="mjx-texatom" style=""><span id="MJXc-Node-3452" class="mjx-mrow"><span id="MJXc-Node-3453" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.373em; padding-bottom: 0.32em;">2</span></span></span></span></span></span><span id="MJXc-Node-3454" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-3455" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.215em; padding-bottom: 0.267em;">v</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-3456" class="mjx-texatom" style=""><span id="MJXc-Node-3457" class="mjx-mrow"><span id="MJXc-Node-3458" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.426em; padding-bottom: 0.267em;">t</span></span><span id="MJXc-Node-3459" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.32em; padding-bottom: 0.426em;">−</span></span><span id="MJXc-Node-3460" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.373em; padding-bottom: 0.32em;">1</span></span></span></span></span></span><span id="MJXc-Node-3461" class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.32em; padding-bottom: 0.426em;">+</span></span><span id="MJXc-Node-3462" class="mjx-mrow MJXc-space2"><span id="MJXc-Node-3463" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.479em; padding-bottom: 0.585em;">(</span></span><span id="MJXc-Node-3464" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.373em; padding-bottom: 0.32em;">1</span></span><span id="MJXc-Node-3465" class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.32em; padding-bottom: 0.426em;">−</span></span><span id="MJXc-Node-3466" class="mjx-msubsup MJXc-space2"><span class="mjx-base" style="margin-right: -0.007em;"><span id="MJXc-Node-3467" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.479em; padding-right: 0.007em;">β</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-3468" class="mjx-texatom" style=""><span id="MJXc-Node-3469" class="mjx-mrow"><span id="MJXc-Node-3470" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.373em; padding-bottom: 0.32em;">2</span></span></span></span></span></span><span id="MJXc-Node-3471" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.479em; padding-bottom: 0.585em;">)</span></span></span><span id="MJXc-Node-3472" class="mjx-msubsup MJXc-space1"><span class="mjx-base" style="margin-right: -0.003em;"><span id="MJXc-Node-3473" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.215em; padding-bottom: 0.479em; padding-right: 0.003em;">g</span></span></span><span class="mjx-stack" style="vertical-align: -0.287em;"><span class="mjx-sup" style="font-size: 70.7%; padding-bottom: 0.255em; padding-left: 0.076em; padding-right: 0.071em;"><span id="MJXc-Node-3477" class="mjx-texatom" style=""><span id="MJXc-Node-3478" class="mjx-mrow"><span id="MJXc-Node-3479" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.373em; padding-bottom: 0.32em;">2</span></span></span></span></span><span class="mjx-sub" style="font-size: 70.7%; padding-right: 0.071em;"><span id="MJXc-Node-3474" class="mjx-texatom" style=""><span id="MJXc-Node-3475" class="mjx-mrow"><span id="MJXc-Node-3476" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.426em; padding-bottom: 0.267em;">t</span></span></span></span></span></span></span><span class="mjx-strut"></span></span></span></span></span></span></span></span><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mtable columnalign="right left right left right left right left right left right left" rowspacing="3pt" columnspacing="0em 2em 0em 2em 0em 2em 0em 2em 0em 2em 0em" displaystyle="true"><mtr><mtd><msub><mi>m</mi><mrow class="MJX-TeXAtom-ORD"><mi>t</mi></mrow></msub></mtd><mtd><mi></mi><mo>=</mo><msub><mi>β</mi><mrow class="MJX-TeXAtom-ORD"><mn>1</mn></mrow></msub><msub><mi>m</mi><mrow class="MJX-TeXAtom-ORD"><mi>t</mi><mo>−</mo><mn>1</mn></mrow></msub><mo>+</mo><mrow><mo>(</mo><mn>1</mn><mo>−</mo><msub><mi>β</mi><mrow class="MJX-TeXAtom-ORD"><mn>1</mn></mrow></msub><mo>)</mo></mrow><msub><mi>g</mi><mrow class="MJX-TeXAtom-ORD"><mi>t</mi></mrow></msub></mtd></mtr><mtr><mtd><msub><mi>v</mi><mrow class="MJX-TeXAtom-ORD"><mi>t</mi></mrow></msub></mtd><mtd><mi></mi><mo>=</mo><msub><mi>β</mi><mrow class="MJX-TeXAtom-ORD"><mn>2</mn></mrow></msub><msub><mi>v</mi><mrow class="MJX-TeXAtom-ORD"><mi>t</mi><mo>−</mo><mn>1</mn></mrow></msub><mo>+</mo><mrow><mo>(</mo><mn>1</mn><mo>−</mo><msub><mi>β</mi><mrow class="MJX-TeXAtom-ORD"><mn>2</mn></mrow></msub><mo>)</mo></mrow><msubsup><mi>g</mi><mrow class="MJX-TeXAtom-ORD"><mi>t</mi></mrow><mrow class="MJX-TeXAtom-ORD"><mn>2</mn></mrow></msubsup></mtd></mtr></mtable></math></span></span></span><script type="math/tex; mode=display" id="MathJax-Element-203">
\begin{aligned} m_{t} &=\beta_{1} m_{t-1}+\left(1-\beta_{1}\right) g_{t} \\ v_{t} &=\beta_{2} v_{t-1}+\left(1-\beta_{2}\right) g_{t}^{2} \end{aligned}
</script></span><br>
<span>То есть </span><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-204-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 118%; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>m</mi><mi>t</mi></msub></math>" role="presentation"><span id="MJXc-Node-3480" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-3481" class="mjx-mrow"><span id="MJXc-Node-3482" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-3483" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.215em; padding-bottom: 0.267em;">m</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-3484" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.426em; padding-bottom: 0.267em;">t</span></span></span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>m</mi><mi>t</mi></msub></math></span></span><script type="math/tex" id="MathJax-Element-204">m_t</script></span><span> – это первый момент величины </span><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-205-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 118%; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>g</mi><mi>t</mi></msub></math>" role="presentation"><span id="MJXc-Node-3485" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-3486" class="mjx-mrow"><span id="MJXc-Node-3487" class="mjx-msubsup"><span class="mjx-base" style="margin-right: -0.003em;"><span id="MJXc-Node-3488" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.215em; padding-bottom: 0.479em; padding-right: 0.003em;">g</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-3489" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.426em; padding-bottom: 0.267em;">t</span></span></span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>g</mi><mi>t</mi></msub></math></span></span><script type="math/tex" id="MathJax-Element-205">g_t</script></span><span> (среднее, аналог скорости </span><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-206-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 118%; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>v</mi></math>" role="presentation"><span id="MJXc-Node-3490" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-3491" class="mjx-mrow"><span id="MJXc-Node-3492" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.215em; padding-bottom: 0.267em;">v</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>v</mi></math></span></span><script type="math/tex" id="MathJax-Element-206">v</script></span><span> в momentum SGD). А </span><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-207-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 118%; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>v</mi><mi>t</mi></msub></math>" role="presentation"><span id="MJXc-Node-3493" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-3494" class="mjx-mrow"><span id="MJXc-Node-3495" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-3496" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.215em; padding-bottom: 0.267em;">v</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-3497" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.426em; padding-bottom: 0.267em;">t</span></span></span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>v</mi><mi>t</mi></msub></math></span></span><script type="math/tex" id="MathJax-Element-207">v_t</script></span><span> – второй момент </span><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-208-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 118%; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>g</mi><mi>t</mi></msub></math>" role="presentation"><span id="MJXc-Node-3498" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-3499" class="mjx-mrow"><span id="MJXc-Node-3500" class="mjx-msubsup"><span class="mjx-base" style="margin-right: -0.003em;"><span id="MJXc-Node-3501" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.215em; padding-bottom: 0.479em; padding-right: 0.003em;">g</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-3502" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.426em; padding-bottom: 0.267em;">t</span></span></span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>g</mi><mi>t</mi></msub></math></span></span><script type="math/tex" id="MathJax-Element-208">g_t</script></span><span> (аналог </span><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-209-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 118%; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>c</mi><mi>a</mi><mi>c</mi><mi>h</mi><mi>e</mi></math>" role="presentation"><span id="MJXc-Node-3503" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-3504" class="mjx-mrow"><span id="MJXc-Node-3505" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.215em; padding-bottom: 0.267em;">c</span></span><span id="MJXc-Node-3506" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.215em; padding-bottom: 0.267em;">a</span></span><span id="MJXc-Node-3507" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.215em; padding-bottom: 0.267em;">c</span></span><span id="MJXc-Node-3508" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.267em;">h</span></span><span id="MJXc-Node-3509" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.215em; padding-bottom: 0.267em;">e</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>c</mi><mi>a</mi><mi>c</mi><mi>h</mi><mi>e</mi></math></span></span><script type="math/tex" id="MathJax-Element-209">cache</script></span><span> в RMSProp). Однако эти оценки смещенные (если воспринимать их как оценки из статистики). Давайте сделаем их несмещенными:</span><br>
<span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span class="mjx-chtml MJXc-display" style="text-align: center;"><span id="MathJax-Element-210-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 118%; text-align: center; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><mtable columnalign=&quot;right left right left right left right left right left right left&quot; rowspacing=&quot;3pt&quot; columnspacing=&quot;0em 2em 0em 2em 0em 2em 0em 2em 0em 2em 0em&quot; displaystyle=&quot;true&quot;><mtr><mtd><msub><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mover><mi>m</mi><mo stretchy=&quot;false&quot;>&amp;#x005E;</mo></mover></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>t</mi></mrow></msub></mtd><mtd><mi></mi><mo>=</mo><mfrac><msub><mi>m</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>t</mi></mrow></msub><mrow><mn>1</mn><mo>&amp;#x2212;</mo><msubsup><mi>&amp;#x03B2;</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mn>1</mn></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>t</mi></mrow></msubsup></mrow></mfrac></mtd></mtr><mtr><mtd><msub><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mover><mi>v</mi><mo stretchy=&quot;false&quot;>&amp;#x005E;</mo></mover></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>t</mi></mrow></msub></mtd><mtd><mi></mi><mo>=</mo><mfrac><msub><mi>v</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>t</mi></mrow></msub><mrow><mn>1</mn><mo>&amp;#x2212;</mo><msubsup><mi>&amp;#x03B2;</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mn>2</mn></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>t</mi></mrow></msubsup></mrow></mfrac></mtd></mtr></mtable></math>" role="presentation"><span id="MJXc-Node-3510" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-3511" class="mjx-mrow"><span id="MJXc-Node-3512" class="mjx-mtable" style="vertical-align: -2.192em; padding: 0px 0.167em;"><span class="mjx-table"><span id="MJXc-Node-3513" class="mjx-mtr" style="height: 2.441em;"><span id="MJXc-Node-3514" class="mjx-mtd" style="padding: 0px; text-align: right; width: 1.169em;"><span id="MJXc-Node-3515" class="mjx-mrow" style="margin-top: 0.144em;"><span id="MJXc-Node-3516" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-3517" class="mjx-texatom"><span id="MJXc-Node-3518" class="mjx-mrow"><span id="MJXc-Node-3519" class="mjx-munderover"><span class="mjx-stack"><span class="mjx-over" style="height: 0.213em; padding-bottom: 0.06em; padding-left: 0.189em;"><span id="MJXc-Node-3521" class="mjx-mo" style="vertical-align: top;"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.426em; padding-bottom: 0.32em;">^</span></span></span><span class="mjx-op"><span id="MJXc-Node-3520" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.215em; padding-bottom: 0.267em;">m</span></span></span></span></span></span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-3522" class="mjx-texatom" style=""><span id="MJXc-Node-3523" class="mjx-mrow"><span id="MJXc-Node-3524" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.426em; padding-bottom: 0.267em;">t</span></span></span></span></span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-3525" class="mjx-mtd" style="padding: 0px; text-align: left; width: 4.451em;"><span id="MJXc-Node-3526" class="mjx-mrow"><span id="MJXc-Node-3527" class="mjx-mi"></span><span id="MJXc-Node-3528" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.056em; padding-bottom: 0.32em;">=</span></span><span id="MJXc-Node-3529" class="mjx-mfrac MJXc-space3"><span class="mjx-box MJXc-stacked" style="width: 2.877em; padding: 0px 0.12em;"><span class="mjx-numerator" style="width: 2.877em; top: -1.144em;"><span id="MJXc-Node-3530" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-3531" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.215em; padding-bottom: 0.267em;">m</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-3532" class="mjx-texatom" style=""><span id="MJXc-Node-3533" class="mjx-mrow"><span id="MJXc-Node-3534" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.426em; padding-bottom: 0.267em;">t</span></span></span></span></span></span></span><span class="mjx-denominator" style="width: 2.877em; bottom: -1.148em;"><span id="MJXc-Node-3535" class="mjx-mrow"><span id="MJXc-Node-3536" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.373em; padding-bottom: 0.32em;">1</span></span><span id="MJXc-Node-3537" class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.32em; padding-bottom: 0.426em;">−</span></span><span id="MJXc-Node-3538" class="mjx-msubsup MJXc-space2"><span class="mjx-base" style="margin-right: -0.007em;"><span id="MJXc-Node-3539" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.479em; padding-right: 0.007em;">β</span></span></span><span class="mjx-stack" style="vertical-align: -0.315em;"><span class="mjx-sup" style="font-size: 70.7%; padding-bottom: 0.255em; padding-left: 0.084em; padding-right: 0.071em;"><span id="MJXc-Node-3543" class="mjx-texatom" style=""><span id="MJXc-Node-3544" class="mjx-mrow"><span id="MJXc-Node-3545" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.426em; padding-bottom: 0.267em;">t</span></span></span></span></span><span class="mjx-sub" style="font-size: 70.7%; padding-right: 0.071em;"><span id="MJXc-Node-3540" class="mjx-texatom" style=""><span id="MJXc-Node-3541" class="mjx-mrow"><span id="MJXc-Node-3542" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.373em; padding-bottom: 0.32em;">1</span></span></span></span></span></span></span></span></span><span style="border-bottom-width: 1.3px; border-bottom-style: solid; top: -0.283em; width: 2.877em;" class="mjx-line"></span></span><span style="height: 2.291em; vertical-align: -1.148em;" class="mjx-vsize"></span></span><span class="mjx-strut"></span></span></span></span><span id="MJXc-Node-3546" class="mjx-mtr" style="height: 2.442em;"><span id="MJXc-Node-3547" class="mjx-mtd" style="padding: 0.15em 0px 0px; text-align: right;"><span id="MJXc-Node-3548" class="mjx-mrow" style="margin-top: 0.145em;"><span id="MJXc-Node-3549" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-3550" class="mjx-texatom"><span id="MJXc-Node-3551" class="mjx-mrow"><span id="MJXc-Node-3552" class="mjx-munderover"><span class="mjx-stack"><span class="mjx-over" style="height: 0.213em; padding-bottom: 0.06em; padding-left: 0.02em;"><span id="MJXc-Node-3554" class="mjx-mo" style="vertical-align: top;"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.426em; padding-bottom: 0.32em;">^</span></span></span><span class="mjx-op"><span id="MJXc-Node-3553" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.215em; padding-bottom: 0.267em;">v</span></span></span></span></span></span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-3555" class="mjx-texatom" style=""><span id="MJXc-Node-3556" class="mjx-mrow"><span id="MJXc-Node-3557" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.426em; padding-bottom: 0.267em;">t</span></span></span></span></span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-3558" class="mjx-mtd" style="padding: 0.15em 0px 0px; text-align: left;"><span id="MJXc-Node-3559" class="mjx-mrow"><span id="MJXc-Node-3560" class="mjx-mi"></span><span id="MJXc-Node-3561" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.056em; padding-bottom: 0.32em;">=</span></span><span id="MJXc-Node-3562" class="mjx-mfrac MJXc-space3"><span class="mjx-box MJXc-stacked" style="width: 2.877em; padding: 0px 0.12em;"><span class="mjx-numerator" style="width: 2.877em; top: -1.145em;"><span id="MJXc-Node-3563" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-3564" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.215em; padding-bottom: 0.267em;">v</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-3565" class="mjx-texatom" style=""><span id="MJXc-Node-3566" class="mjx-mrow"><span id="MJXc-Node-3567" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.426em; padding-bottom: 0.267em;">t</span></span></span></span></span></span></span><span class="mjx-denominator" style="width: 2.877em; bottom: -1.148em;"><span id="MJXc-Node-3568" class="mjx-mrow"><span id="MJXc-Node-3569" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.373em; padding-bottom: 0.32em;">1</span></span><span id="MJXc-Node-3570" class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.32em; padding-bottom: 0.426em;">−</span></span><span id="MJXc-Node-3571" class="mjx-msubsup MJXc-space2"><span class="mjx-base" style="margin-right: -0.007em;"><span id="MJXc-Node-3572" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.479em; padding-right: 0.007em;">β</span></span></span><span class="mjx-stack" style="vertical-align: -0.315em;"><span class="mjx-sup" style="font-size: 70.7%; padding-bottom: 0.255em; padding-left: 0.084em; padding-right: 0.071em;"><span id="MJXc-Node-3576" class="mjx-texatom" style=""><span id="MJXc-Node-3577" class="mjx-mrow"><span id="MJXc-Node-3578" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.426em; padding-bottom: 0.267em;">t</span></span></span></span></span><span class="mjx-sub" style="font-size: 70.7%; padding-right: 0.071em;"><span id="MJXc-Node-3573" class="mjx-texatom" style=""><span id="MJXc-Node-3574" class="mjx-mrow"><span id="MJXc-Node-3575" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.373em; padding-bottom: 0.32em;">2</span></span></span></span></span></span></span></span></span><span style="border-bottom-width: 1.3px; border-bottom-style: solid; top: -0.283em; width: 2.877em;" class="mjx-line"></span></span><span style="height: 2.292em; vertical-align: -1.148em;" class="mjx-vsize"></span></span><span class="mjx-strut"></span></span></span></span></span></span></span></span><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mtable columnalign="right left right left right left right left right left right left" rowspacing="3pt" columnspacing="0em 2em 0em 2em 0em 2em 0em 2em 0em 2em 0em" displaystyle="true"><mtr><mtd><msub><mrow class="MJX-TeXAtom-ORD"><mover><mi>m</mi><mo stretchy="false">^</mo></mover></mrow><mrow class="MJX-TeXAtom-ORD"><mi>t</mi></mrow></msub></mtd><mtd><mi></mi><mo>=</mo><mfrac><msub><mi>m</mi><mrow class="MJX-TeXAtom-ORD"><mi>t</mi></mrow></msub><mrow><mn>1</mn><mo>−</mo><msubsup><mi>β</mi><mrow class="MJX-TeXAtom-ORD"><mn>1</mn></mrow><mrow class="MJX-TeXAtom-ORD"><mi>t</mi></mrow></msubsup></mrow></mfrac></mtd></mtr><mtr><mtd><msub><mrow class="MJX-TeXAtom-ORD"><mover><mi>v</mi><mo stretchy="false">^</mo></mover></mrow><mrow class="MJX-TeXAtom-ORD"><mi>t</mi></mrow></msub></mtd><mtd><mi></mi><mo>=</mo><mfrac><msub><mi>v</mi><mrow class="MJX-TeXAtom-ORD"><mi>t</mi></mrow></msub><mrow><mn>1</mn><mo>−</mo><msubsup><mi>β</mi><mrow class="MJX-TeXAtom-ORD"><mn>2</mn></mrow><mrow class="MJX-TeXAtom-ORD"><mi>t</mi></mrow></msubsup></mrow></mfrac></mtd></mtr></mtable></math></span></span></span><script type="math/tex; mode=display" id="MathJax-Element-210">
\begin{aligned} \hat{m}_{t} &=\frac{m_{t}}{1-\beta_{1}^{t}} \\ \hat{v}_{t} &=\frac{v_{t}}{1-\beta_{2}^{t}} \end{aligned}
</script></span><br>
<span>Тогда правило обновления параметров</span><br>
<span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span class="mjx-chtml MJXc-display" style="text-align: center;"><span id="MathJax-Element-211-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 118%; text-align: center; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><msub><mi>&amp;#x03B8;</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>t</mi><mo>+</mo><mn>1</mn></mrow></msub><mo>=</mo><msub><mi>&amp;#x03B8;</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>t</mi></mrow></msub><mo>&amp;#x2212;</mo><mfrac><mi>&amp;#x03B7;</mi><mrow><msqrt><msub><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mover><mi>v</mi><mo stretchy=&quot;false&quot;>&amp;#x005E;</mo></mover></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>t</mi></mrow></msub></msqrt><mo>+</mo><mi>&amp;#x03F5;</mi></mrow></mfrac><msub><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mover><mi>m</mi><mo stretchy=&quot;false&quot;>&amp;#x005E;</mo></mover></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>t</mi></mrow></msub></math>" role="presentation"><span id="MJXc-Node-3579" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-3580" class="mjx-mrow"><span id="MJXc-Node-3581" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-3582" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.267em;">θ</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-3583" class="mjx-texatom" style=""><span id="MJXc-Node-3584" class="mjx-mrow"><span id="MJXc-Node-3585" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.426em; padding-bottom: 0.267em;">t</span></span><span id="MJXc-Node-3586" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.32em; padding-bottom: 0.426em;">+</span></span><span id="MJXc-Node-3587" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.373em; padding-bottom: 0.32em;">1</span></span></span></span></span></span><span id="MJXc-Node-3588" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.056em; padding-bottom: 0.32em;">=</span></span><span id="MJXc-Node-3589" class="mjx-msubsup MJXc-space3"><span class="mjx-base"><span id="MJXc-Node-3590" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.267em;">θ</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-3591" class="mjx-texatom" style=""><span id="MJXc-Node-3592" class="mjx-mrow"><span id="MJXc-Node-3593" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.426em; padding-bottom: 0.267em;">t</span></span></span></span></span></span><span id="MJXc-Node-3594" class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.32em; padding-bottom: 0.426em;">−</span></span><span id="MJXc-Node-3595" class="mjx-mfrac MJXc-space2"><span class="mjx-box MJXc-stacked" style="width: 3.639em; padding: 0px 0.12em;"><span class="mjx-numerator" style="width: 3.639em; top: -1.184em;"><span id="MJXc-Node-3596" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.215em; padding-bottom: 0.479em; padding-right: 0.006em;">η</span></span></span><span class="mjx-denominator" style="width: 3.639em; bottom: -1.286em;"><span id="MJXc-Node-3597" class="mjx-mrow"><span id="MJXc-Node-3598" class="mjx-msqrt"><span class="mjx-box" style="padding-top: 0.045em;"><span class="mjx-surd"><span class="mjx-char MJXc-TeX-size1-R" style="padding-top: 0.638em; padding-bottom: 0.638em;">√</span></span><span class="mjx-box" style="padding-top: 0.129em; border-top-width: 1.4px; border-top-style: solid;"><span id="MJXc-Node-3599" class="mjx-mrow"><span id="MJXc-Node-3600" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-3601" class="mjx-texatom"><span id="MJXc-Node-3602" class="mjx-mrow"><span id="MJXc-Node-3603" class="mjx-munderover"><span class="mjx-stack"><span class="mjx-over" style="height: 0.213em; padding-bottom: 0.06em; padding-left: 0.02em;"><span id="MJXc-Node-3605" class="mjx-mo" style="vertical-align: top;"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.426em; padding-bottom: 0.32em;">^</span></span></span><span class="mjx-op"><span id="MJXc-Node-3604" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.215em; padding-bottom: 0.267em;">v</span></span></span></span></span></span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-3606" class="mjx-texatom" style=""><span id="MJXc-Node-3607" class="mjx-mrow"><span id="MJXc-Node-3608" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.426em; padding-bottom: 0.267em;">t</span></span></span></span></span></span></span></span></span></span><span id="MJXc-Node-3609" class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.32em; padding-bottom: 0.426em;">+</span></span><span id="MJXc-Node-3610" class="mjx-mi MJXc-space2"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.215em; padding-bottom: 0.267em;">ϵ</span></span></span></span><span style="border-bottom-width: 1.3px; border-bottom-style: solid; top: -0.283em; width: 3.639em;" class="mjx-line"></span></span><span style="height: 2.469em; vertical-align: -1.286em;" class="mjx-vsize"></span></span><span id="MJXc-Node-3611" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-3612" class="mjx-texatom"><span id="MJXc-Node-3613" class="mjx-mrow"><span id="MJXc-Node-3614" class="mjx-munderover"><span class="mjx-stack"><span class="mjx-over" style="height: 0.213em; padding-bottom: 0.06em; padding-left: 0.189em;"><span id="MJXc-Node-3616" class="mjx-mo" style="vertical-align: top;"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.426em; padding-bottom: 0.32em;">^</span></span></span><span class="mjx-op"><span id="MJXc-Node-3615" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.215em; padding-bottom: 0.267em;">m</span></span></span></span></span></span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-3617" class="mjx-texatom" style=""><span id="MJXc-Node-3618" class="mjx-mrow"><span id="MJXc-Node-3619" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.426em; padding-bottom: 0.267em;">t</span></span></span></span></span></span></span></span><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><msub><mi>θ</mi><mrow class="MJX-TeXAtom-ORD"><mi>t</mi><mo>+</mo><mn>1</mn></mrow></msub><mo>=</mo><msub><mi>θ</mi><mrow class="MJX-TeXAtom-ORD"><mi>t</mi></mrow></msub><mo>−</mo><mfrac><mi>η</mi><mrow><msqrt><msub><mrow class="MJX-TeXAtom-ORD"><mover><mi>v</mi><mo stretchy="false">^</mo></mover></mrow><mrow class="MJX-TeXAtom-ORD"><mi>t</mi></mrow></msub></msqrt><mo>+</mo><mi>ϵ</mi></mrow></mfrac><msub><mrow class="MJX-TeXAtom-ORD"><mover><mi>m</mi><mo stretchy="false">^</mo></mover></mrow><mrow class="MJX-TeXAtom-ORD"><mi>t</mi></mrow></msub></math></span></span></span><script type="math/tex; mode=display" id="MathJax-Element-211">
\theta_{t+1}=\theta_{t}-\frac{\eta}{\sqrt{\hat{v}_{t}}+\epsilon} \hat{m}_{t}
</script></span><br>
<span>Здесь </span><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-212-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 118%; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>e</mi><mi>t</mi><mi>a</mi></math>" role="presentation"><span id="MJXc-Node-3620" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-3621" class="mjx-mrow"><span id="MJXc-Node-3622" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.215em; padding-bottom: 0.267em;">e</span></span><span id="MJXc-Node-3623" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.426em; padding-bottom: 0.267em;">t</span></span><span id="MJXc-Node-3624" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.215em; padding-bottom: 0.267em;">a</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>e</mi><mi>t</mi><mi>a</mi></math></span></span><script type="math/tex" id="MathJax-Element-212">eta</script></span><span> — обычный learning rate, </span><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-213-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 118%; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mover><mi>m</mi><mo stretchy=&quot;false&quot;>&amp;#x005E;</mo></mover></mrow></math>" role="presentation"><span id="MJXc-Node-3625" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-3626" class="mjx-mrow"><span id="MJXc-Node-3627" class="mjx-texatom"><span id="MJXc-Node-3628" class="mjx-mrow"><span id="MJXc-Node-3629" class="mjx-munderover"><span class="mjx-stack"><span class="mjx-over" style="height: 0.213em; padding-bottom: 0.06em; padding-left: 0.189em;"><span id="MJXc-Node-3631" class="mjx-mo" style="vertical-align: top;"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.426em; padding-bottom: 0.32em;">^</span></span></span><span class="mjx-op"><span id="MJXc-Node-3630" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.215em; padding-bottom: 0.267em;">m</span></span></span></span></span></span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow class="MJX-TeXAtom-ORD"><mover><mi>m</mi><mo stretchy="false">^</mo></mover></mrow></math></span></span><script type="math/tex" id="MathJax-Element-213">\hat{m}</script></span><span> — градиент с momentum, а </span><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-214-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 118%; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mover><mi>v</mi><mo stretchy=&quot;false&quot;>&amp;#x005E;</mo></mover></mrow></math>" role="presentation"><span id="MJXc-Node-3632" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-3633" class="mjx-mrow"><span id="MJXc-Node-3634" class="mjx-texatom"><span id="MJXc-Node-3635" class="mjx-mrow"><span id="MJXc-Node-3636" class="mjx-munderover"><span class="mjx-stack"><span class="mjx-over" style="height: 0.213em; padding-bottom: 0.06em; padding-left: 0.02em;"><span id="MJXc-Node-3638" class="mjx-mo" style="vertical-align: top;"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.426em; padding-bottom: 0.32em;">^</span></span></span><span class="mjx-op"><span id="MJXc-Node-3637" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.215em; padding-bottom: 0.267em;">v</span></span></span></span></span></span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow class="MJX-TeXAtom-ORD"><mover><mi>v</mi><mo stretchy="false">^</mo></mover></mrow></math></span></span><script type="math/tex" id="MathJax-Element-214">\hat{v}</script></span><span> — нормировочный множитель </span><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-215-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 118%; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>c</mi><mi>a</mi><mi>c</mi><mi>h</mi><mi>e</mi></math>" role="presentation"><span id="MJXc-Node-3639" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-3640" class="mjx-mrow"><span id="MJXc-Node-3641" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.215em; padding-bottom: 0.267em;">c</span></span><span id="MJXc-Node-3642" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.215em; padding-bottom: 0.267em;">a</span></span><span id="MJXc-Node-3643" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.215em; padding-bottom: 0.267em;">c</span></span><span id="MJXc-Node-3644" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.267em;">h</span></span><span id="MJXc-Node-3645" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.215em; padding-bottom: 0.267em;">e</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>c</mi><mi>a</mi><mi>c</mi><mi>h</mi><mi>e</mi></math></span></span><script type="math/tex" id="MathJax-Element-215">cache</script></span><span> (для каждой компоненты вектора параметров свой).</span></p><p><strong><span>Extra</span></strong><span> Как показывает практика величина </span><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-216-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 118%; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mover><mi>v</mi><mo stretchy=&quot;false&quot;>&amp;#x005E;</mo></mover></mrow><mi>t</mi></msub></math>" role="presentation"><span id="MJXc-Node-3646" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-3647" class="mjx-mrow"><span id="MJXc-Node-3648" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-3649" class="mjx-texatom"><span id="MJXc-Node-3650" class="mjx-mrow"><span id="MJXc-Node-3651" class="mjx-munderover"><span class="mjx-stack"><span class="mjx-over" style="height: 0.213em; padding-bottom: 0.06em; padding-left: 0.02em;"><span id="MJXc-Node-3653" class="mjx-mo" style="vertical-align: top;"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.426em; padding-bottom: 0.32em;">^</span></span></span><span class="mjx-op"><span id="MJXc-Node-3652" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.215em; padding-bottom: 0.267em;">v</span></span></span></span></span></span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-3654" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.426em; padding-bottom: 0.267em;">t</span></span></span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mrow class="MJX-TeXAtom-ORD"><mover><mi>v</mi><mo stretchy="false">^</mo></mover></mrow><mi>t</mi></msub></math></span></span><script type="math/tex" id="MathJax-Element-216">\hat{v}_t</script></span><span> имеет большую дисперсию на первых итерациях алгоритма. Существует несколько способов это решить, например отключить оптимизацию adaptive learning rate в начале обучения или добавить так называемай warmup: в начале он стартует с learning rate </span><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-217-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 118%; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mo>=</mo><mn>0.01</mn><mi>&amp;#x03B7;</mi></math>" role="presentation"><span id="MJXc-Node-3655" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-3656" class="mjx-mrow"><span id="MJXc-Node-3657" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.056em; padding-bottom: 0.32em;">=</span></span><span id="MJXc-Node-3658" class="mjx-mn MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.373em; padding-bottom: 0.373em;">0.01</span></span><span id="MJXc-Node-3659" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.215em; padding-bottom: 0.479em; padding-right: 0.006em;">η</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo>=</mo><mn>0.01</mn><mi>η</mi></math></span></span><script type="math/tex" id="MathJax-Element-217">= 0.01\eta</script></span><span> и затем первые </span><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-218-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 118%; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>n</mi></math>" role="presentation"><span id="MJXc-Node-3660" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-3661" class="mjx-mrow"><span id="MJXc-Node-3662" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.215em; padding-bottom: 0.267em;">n</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>n</mi></math></span></span><script type="math/tex" id="MathJax-Element-218">n</script></span><span> шагов он его постепенно повышает доводя до </span><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-219-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 118%; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mn>1</mn><mo>&amp;#x22C5;</mo><mi>&amp;#x03B7;</mi></math>" role="presentation"><span id="MJXc-Node-3663" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-3664" class="mjx-mrow"><span id="MJXc-Node-3665" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.373em; padding-bottom: 0.32em;">1</span></span><span id="MJXc-Node-3666" class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.003em; padding-bottom: 0.32em;">⋅</span></span><span id="MJXc-Node-3667" class="mjx-mi MJXc-space2"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.215em; padding-bottom: 0.479em; padding-right: 0.006em;">η</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mn>1</mn><mo>⋅</mo><mi>η</mi></math></span></span><script type="math/tex" id="MathJax-Element-219">1\cdot\eta</script></span><span>. Так же есть оптимизатор под названием RectifiedAdam который корректирует </span><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-220-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 118%; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mover><mi>v</mi><mo stretchy=&quot;false&quot;>&amp;#x005E;</mo></mover></mrow><mi>t</mi></msub></math>" role="presentation"><span id="MJXc-Node-3668" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-3669" class="mjx-mrow"><span id="MJXc-Node-3670" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-3671" class="mjx-texatom"><span id="MJXc-Node-3672" class="mjx-mrow"><span id="MJXc-Node-3673" class="mjx-munderover"><span class="mjx-stack"><span class="mjx-over" style="height: 0.213em; padding-bottom: 0.06em; padding-left: 0.02em;"><span id="MJXc-Node-3675" class="mjx-mo" style="vertical-align: top;"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.426em; padding-bottom: 0.32em;">^</span></span></span><span class="mjx-op"><span id="MJXc-Node-3674" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.215em; padding-bottom: 0.267em;">v</span></span></span></span></span></span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-3676" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.426em; padding-bottom: 0.267em;">t</span></span></span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mrow class="MJX-TeXAtom-ORD"><mover><mi>v</mi><mo stretchy="false">^</mo></mover></mrow><mi>t</mi></msub></math></span></span><script type="math/tex" id="MathJax-Element-220">\hat{v}_t</script></span><span>.</span></p><p><strong><span>Extra</span></strong><span> Существует еще одна оптимизация под названием look ahead. Он как бы заглядывает вперед на </span><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-221-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 118%; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>k</mi></math>" role="presentation"><span id="MJXc-Node-3677" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-3678" class="mjx-mrow"><span id="MJXc-Node-3679" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.267em;">k</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>k</mi></math></span></span><script type="math/tex" id="MathJax-Element-221">k</script></span><span> шагов и затем проводит прямую между шагами </span><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-222-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 118%; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>t</mi><mo>&amp;#x2212;</mo><mi>k</mi></math>" role="presentation"><span id="MJXc-Node-3680" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-3681" class="mjx-mrow"><span id="MJXc-Node-3682" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.426em; padding-bottom: 0.267em;">t</span></span><span id="MJXc-Node-3683" class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.32em; padding-bottom: 0.426em;">−</span></span><span id="MJXc-Node-3684" class="mjx-mi MJXc-space2"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.267em;">k</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>t</mi><mo>−</mo><mi>k</mi></math></span></span><script type="math/tex" id="MathJax-Element-222">t-k</script></span><span> и </span><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-223-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 118%; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>t</mi></math>" role="presentation"><span id="MJXc-Node-3685" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-3686" class="mjx-mrow"><span id="MJXc-Node-3687" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.426em; padding-bottom: 0.267em;">t</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>t</mi></math></span></span><script type="math/tex" id="MathJax-Element-223">t</script></span><span> берет точку по середине этой прямой и продолжает уже от нее.</span><br>
<img src="https://i.imgur.com/tmUWmoB.png" alt=""></p><p><span>Отметим, что так как все методы используют learning rate, то распространённой практикой является его изменение в ходе обучения модели. Например, уменьшать learning_rate каждый раз, когда функционал ошибки начинает меняться слишком слабо на каждой итерации.</span></p><h3 id="14-Neural-network-concept-Fully-connected-networks-Logistic-regression-as-simple-NN-XOR-problem" data-id="14-Neural-network-concept-Fully-connected-networks-Logistic-regression-as-simple-NN-XOR-problem"><a class="anchor hidden-xs" href="#14-Neural-network-concept-Fully-connected-networks-Logistic-regression-as-simple-NN-XOR-problem" title="14-Neural-network-concept-Fully-connected-networks-Logistic-regression-as-simple-NN-XOR-problem"><span class="octicon octicon-link"></span></a><span>14. Neural network concept. Fully-connected networks. Logistic regression as simple NN. XOR problem.</span></h3><p><strong><span>Нейронная сеть</span></strong><span> — модель машинного обучения, по сути являющаяся последовательностью некоторых простых преобразований, которые зависят от некоторых параметров. Одно такое преобразование (“строительный кирпичик”) нейронной сети называется </span><em><span>слоем</span></em><span> или </span><em><span>модулем.</span></em><span> Единственное требование к преобразованиям использующимся в нейронной сети — возможность посчитать любую его частную производную в любой точке. При обучении нейронной сети происходит поиск оптимальных с точки зрения функции ошибки параметров всей сети (т.е. параметров каждого преобразования).</span><br>
<span>Слои бывают нескольих типов:</span></p><ul>
<li><em><span>Linear (Fully-connected) layer</span></em><span> — линейный слой (его ещё называют полносвязным). Один из двух основополагающих типов слоёв. Его суть — выполнение простого линейного преобразования данных с предыдущего слоя (или входных данных, если это первый слой). То есть, если </span><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-224-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 118%; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>X</mi></math>" role="presentation"><span id="MJXc-Node-3688" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-3689" class="mjx-mrow"><span id="MJXc-Node-3690" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.267em; padding-right: 0.024em;">X</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>X</mi></math></span></span><script type="math/tex" id="MathJax-Element-224">X</script></span><span> — матрица объекты-признаки или выход предыдущего слоя, то выход линейного слоя </span><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-225-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 118%; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>f</mi><mo stretchy=&quot;false&quot;>(</mo><mi>X</mi><mo stretchy=&quot;false&quot;>)</mo></math>" role="presentation"><span id="MJXc-Node-3691" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-3692" class="mjx-mrow"><span id="MJXc-Node-3693" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.479em; padding-right: 0.06em;">f</span></span><span id="MJXc-Node-3694" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.479em; padding-bottom: 0.585em;">(</span></span><span id="MJXc-Node-3695" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.267em; padding-right: 0.024em;">X</span></span><span id="MJXc-Node-3696" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.479em; padding-bottom: 0.585em;">)</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>f</mi><mo stretchy="false">(</mo><mi>X</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-225">f(X)</script></span><span> определяется следующим образом:</span><br>
<span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span class="mjx-chtml MJXc-display" style="text-align: center;"><span id="MathJax-Element-226-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 118%; text-align: center; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><mi>f</mi><mo stretchy=&quot;false&quot;>(</mo><mi>X</mi><mo stretchy=&quot;false&quot;>)</mo><mo>=</mo><mi>X</mi><mi>W</mi><mo>+</mo><mi>b</mi></math>" role="presentation"><span id="MJXc-Node-3697" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-3698" class="mjx-mrow"><span id="MJXc-Node-3699" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.479em; padding-right: 0.06em;">f</span></span><span id="MJXc-Node-3700" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.479em; padding-bottom: 0.585em;">(</span></span><span id="MJXc-Node-3701" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.267em; padding-right: 0.024em;">X</span></span><span id="MJXc-Node-3702" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.479em; padding-bottom: 0.585em;">)</span></span><span id="MJXc-Node-3703" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.056em; padding-bottom: 0.32em;">=</span></span><span id="MJXc-Node-3704" class="mjx-mi MJXc-space3"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.267em; padding-right: 0.024em;">X</span></span><span id="MJXc-Node-3705" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.32em; padding-right: 0.104em;">W</span></span><span id="MJXc-Node-3706" class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.32em; padding-bottom: 0.426em;">+</span></span><span id="MJXc-Node-3707" class="mjx-mi MJXc-space2"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.267em;">b</span></span></span></span><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mi>f</mi><mo stretchy="false">(</mo><mi>X</mi><mo stretchy="false">)</mo><mo>=</mo><mi>X</mi><mi>W</mi><mo>+</mo><mi>b</mi></math></span></span></span><script type="math/tex; mode=display" id="MathJax-Element-226">
f(X) = XW + b
</script></span><br>
<span>Здесь матрица линейного преобразования </span><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-227-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 118%; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>W</mi></math>" role="presentation"><span id="MJXc-Node-3708" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-3709" class="mjx-mrow"><span id="MJXc-Node-3710" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.32em; padding-right: 0.104em;">W</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>W</mi></math></span></span><script type="math/tex" id="MathJax-Element-227">W</script></span><span> (в общем случае не квадратная) и вектор сдвига </span><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-228-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 118%; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>b</mi></math>" role="presentation"><span id="MJXc-Node-3711" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-3712" class="mjx-mrow"><span id="MJXc-Node-3713" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.267em;">b</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>b</mi></math></span></span><script type="math/tex" id="MathJax-Element-228">b</script></span><span> являются параметрами слоя.</span>
<ul>
<li><span>Отметим, что линейный слой можно воспринимать как переход из одного признакового пространства в другое, т.е. как некоторое преобразование признаков.</span></li>
</ul>
</li>
<li><em><span>Activation layer</span></em><span> — слой активации. Второй основной тип слоя. Если бы сеть состояла только из линейных слоёв, то она выражалсь бы как одно линейное преобразование. Поэтому в нейронных сетях используют функции активации, которые выполняют какое-либо нелинейное преобразование над данными. То есть каждому элементу </span><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-229-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 118%; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>x</mi></math>" role="presentation"><span id="MJXc-Node-3714" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-3715" class="mjx-mrow"><span id="MJXc-Node-3716" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.215em; padding-bottom: 0.267em;">x</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>x</mi></math></span></span><script type="math/tex" id="MathJax-Element-229">x</script></span><span> входной матрицы сопоставляется значение некоторой нелинейной функции </span><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-230-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 118%; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>&amp;#x03C3;</mi><mo stretchy=&quot;false&quot;>(</mo><mi>x</mi><mo stretchy=&quot;false&quot;>)</mo></math>" role="presentation"><span id="MJXc-Node-3717" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-3718" class="mjx-mrow"><span id="MJXc-Node-3719" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.215em; padding-bottom: 0.267em; padding-right: 0.001em;">σ</span></span><span id="MJXc-Node-3720" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.479em; padding-bottom: 0.585em;">(</span></span><span id="MJXc-Node-3721" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.215em; padding-bottom: 0.267em;">x</span></span><span id="MJXc-Node-3722" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.479em; padding-bottom: 0.585em;">)</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>σ</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-230">\sigma(x)</script></span><span> (которое может зависеть и от других элементов входной матрицы).</span>
<ul>
<li><span>Примеры самых распространённых функций активации:</span>
<ul>
<li><span>Sigmoid: </span><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-231-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 118%; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>&amp;#x03C3;</mi><mo stretchy=&quot;false&quot;>(</mo><mi>x</mi><mo stretchy=&quot;false&quot;>)</mo><mo>=</mo><mfrac><mn>1</mn><mrow><mn>1</mn><mo>+</mo><mi>exp</mi><mo>&amp;#x2061;</mo><mo stretchy=&quot;false&quot;>(</mo><mo>&amp;#x2212;</mo><mi>x</mi><mo stretchy=&quot;false&quot;>)</mo></mrow></mfrac><mo>.</mo></math>" role="presentation"><span id="MJXc-Node-3723" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-3724" class="mjx-mrow"><span id="MJXc-Node-3725" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.215em; padding-bottom: 0.267em; padding-right: 0.001em;">σ</span></span><span id="MJXc-Node-3726" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.479em; padding-bottom: 0.585em;">(</span></span><span id="MJXc-Node-3727" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.215em; padding-bottom: 0.267em;">x</span></span><span id="MJXc-Node-3728" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.479em; padding-bottom: 0.585em;">)</span></span><span id="MJXc-Node-3729" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.056em; padding-bottom: 0.32em;">=</span></span><span id="MJXc-Node-3730" class="mjx-mfrac MJXc-space3"><span class="mjx-box MJXc-stacked" style="width: 3.63em; padding: 0px 0.12em;"><span class="mjx-numerator" style="font-size: 70.7%; width: 5.134em; top: -1.299em;"><span id="MJXc-Node-3731" class="mjx-mn" style=""><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.373em; padding-bottom: 0.32em;">1</span></span></span><span class="mjx-denominator" style="font-size: 70.7%; width: 5.134em; bottom: -0.926em;"><span id="MJXc-Node-3732" class="mjx-mrow" style=""><span id="MJXc-Node-3733" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.373em; padding-bottom: 0.32em;">1</span></span><span id="MJXc-Node-3734" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.32em; padding-bottom: 0.426em;">+</span></span><span id="MJXc-Node-3735" class="mjx-mi"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.162em; padding-bottom: 0.532em;">exp</span></span><span id="MJXc-Node-3736" class="mjx-mo"><span class="mjx-char"></span></span><span id="MJXc-Node-3737" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.479em; padding-bottom: 0.585em;">(</span></span><span id="MJXc-Node-3738" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.32em; padding-bottom: 0.426em;">−</span></span><span id="MJXc-Node-3739" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.215em; padding-bottom: 0.267em;">x</span></span><span id="MJXc-Node-3740" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.479em; padding-bottom: 0.585em;">)</span></span></span></span><span style="border-bottom-width: 1.3px; border-bottom-style: solid; top: -0.283em; width: 3.63em;" class="mjx-line"></span></span><span style="height: 1.574em; vertical-align: -0.655em;" class="mjx-vsize"></span></span><span id="MJXc-Node-3741" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="margin-top: -0.156em; padding-bottom: 0.32em;">.</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>σ</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mo>=</mo><mfrac><mn>1</mn><mrow><mn>1</mn><mo>+</mo><mi>exp</mi><mo>⁡</mo><mo stretchy="false">(</mo><mo>−</mo><mi>x</mi><mo stretchy="false">)</mo></mrow></mfrac><mo>.</mo></math></span></span><script type="math/tex" id="MathJax-Element-231">\sigma(x) = \frac{1}{1 + \exp(-x)}.</script></span></li>
<li><span>Tanh: </span><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-232-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 118%; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>&amp;#x03C3;</mi><mo stretchy=&quot;false&quot;>(</mo><mi>x</mi><mo stretchy=&quot;false&quot;>)</mo><mo>=</mo><mi>tanh</mi><mo>&amp;#x2061;</mo><mo stretchy=&quot;false&quot;>(</mo><mi>x</mi><mo stretchy=&quot;false&quot;>)</mo><mo>=</mo><mfrac><mrow><msup><mi>e</mi><mi>x</mi></msup><mo>&amp;#x2212;</mo><msup><mi>e</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo>&amp;#x2212;</mo><mi>x</mi></mrow></msup></mrow><mrow><msup><mi>e</mi><mi>x</mi></msup><mo>+</mo><msup><mi>e</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo>&amp;#x2212;</mo><mi>x</mi></mrow></msup></mrow></mfrac><mo>.</mo></math>" role="presentation"><span id="MJXc-Node-3742" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-3743" class="mjx-mrow"><span id="MJXc-Node-3744" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.215em; padding-bottom: 0.267em; padding-right: 0.001em;">σ</span></span><span id="MJXc-Node-3745" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.479em; padding-bottom: 0.585em;">(</span></span><span id="MJXc-Node-3746" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.215em; padding-bottom: 0.267em;">x</span></span><span id="MJXc-Node-3747" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.479em; padding-bottom: 0.585em;">)</span></span><span id="MJXc-Node-3748" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.056em; padding-bottom: 0.32em;">=</span></span><span id="MJXc-Node-3749" class="mjx-mi MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.426em; padding-bottom: 0.373em;">tanh</span></span><span id="MJXc-Node-3750" class="mjx-mo"><span class="mjx-char"></span></span><span id="MJXc-Node-3751" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.479em; padding-bottom: 0.585em;">(</span></span><span id="MJXc-Node-3752" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.215em; padding-bottom: 0.267em;">x</span></span><span id="MJXc-Node-3753" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.479em; padding-bottom: 0.585em;">)</span></span><span id="MJXc-Node-3754" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.056em; padding-bottom: 0.32em;">=</span></span><span id="MJXc-Node-3755" class="mjx-mfrac MJXc-space3"><span class="mjx-box MJXc-stacked" style="width: 2.362em; padding: 0px 0.12em;"><span class="mjx-numerator" style="font-size: 70.7%; width: 3.34em; top: -1.483em;"><span id="MJXc-Node-3756" class="mjx-mrow" style=""><span id="MJXc-Node-3757" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-3758" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.215em; padding-bottom: 0.267em;">e</span></span></span><span class="mjx-sup" style="font-size: 70.7%; vertical-align: 0.513em; padding-left: 0px; padding-right: 0.071em;"><span id="MJXc-Node-3759" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.215em; padding-bottom: 0.267em;">x</span></span></span></span><span id="MJXc-Node-3760" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.32em; padding-bottom: 0.426em;">−</span></span><span id="MJXc-Node-3761" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-3762" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.215em; padding-bottom: 0.267em;">e</span></span></span><span class="mjx-sup" style="font-size: 70.7%; vertical-align: 0.513em; padding-left: 0px; padding-right: 0.071em;"><span id="MJXc-Node-3763" class="mjx-texatom" style=""><span id="MJXc-Node-3764" class="mjx-mrow"><span id="MJXc-Node-3765" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.32em; padding-bottom: 0.426em;">−</span></span><span id="MJXc-Node-3766" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.215em; padding-bottom: 0.267em;">x</span></span></span></span></span></span></span></span><span class="mjx-denominator" style="font-size: 70.7%; width: 3.34em; bottom: -0.702em;"><span id="MJXc-Node-3767" class="mjx-mrow" style=""><span id="MJXc-Node-3768" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-3769" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.215em; padding-bottom: 0.267em;">e</span></span></span><span class="mjx-sup" style="font-size: 70.7%; vertical-align: 0.409em; padding-left: 0px; padding-right: 0.071em;"><span id="MJXc-Node-3770" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.215em; padding-bottom: 0.267em;">x</span></span></span></span><span id="MJXc-Node-3771" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.32em; padding-bottom: 0.426em;">+</span></span><span id="MJXc-Node-3772" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-3773" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.215em; padding-bottom: 0.267em;">e</span></span></span><span class="mjx-sup" style="font-size: 70.7%; vertical-align: 0.409em; padding-left: 0px; padding-right: 0.071em;"><span id="MJXc-Node-3774" class="mjx-texatom" style=""><span id="MJXc-Node-3775" class="mjx-mrow"><span id="MJXc-Node-3776" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.32em; padding-bottom: 0.426em;">−</span></span><span id="MJXc-Node-3777" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.215em; padding-bottom: 0.267em;">x</span></span></span></span></span></span></span></span><span style="border-bottom-width: 1.3px; border-bottom-style: solid; top: -0.283em; width: 2.362em;" class="mjx-line"></span></span><span style="height: 1.545em; vertical-align: -0.496em;" class="mjx-vsize"></span></span><span id="MJXc-Node-3778" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="margin-top: -0.156em; padding-bottom: 0.32em;">.</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>σ</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mo>=</mo><mi>tanh</mi><mo>⁡</mo><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mo>=</mo><mfrac><mrow><msup><mi>e</mi><mi>x</mi></msup><mo>−</mo><msup><mi>e</mi><mrow class="MJX-TeXAtom-ORD"><mo>−</mo><mi>x</mi></mrow></msup></mrow><mrow><msup><mi>e</mi><mi>x</mi></msup><mo>+</mo><msup><mi>e</mi><mrow class="MJX-TeXAtom-ORD"><mo>−</mo><mi>x</mi></mrow></msup></mrow></mfrac><mo>.</mo></math></span></span><script type="math/tex" id="MathJax-Element-232">\sigma(x) = \tanh(x) = \frac{e^x - e^{-x}}{e^x + e^{-x}}.</script></span></li>
<li><span>ReLU (Rectified Linear Unit): </span><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-233-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 118%; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>&amp;#x03C3;</mi><mo stretchy=&quot;false&quot;>(</mo><mi>x</mi><mo stretchy=&quot;false&quot;>)</mo><mo>=</mo><mo movablelimits=&quot;true&quot; form=&quot;prefix&quot;>max</mo><mo stretchy=&quot;false&quot;>(</mo><mn>0</mn><mo>,</mo><mi>x</mi><mo stretchy=&quot;false&quot;>)</mo><mo>.</mo></math>" role="presentation"><span id="MJXc-Node-3779" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-3780" class="mjx-mrow"><span id="MJXc-Node-3781" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.215em; padding-bottom: 0.267em; padding-right: 0.001em;">σ</span></span><span id="MJXc-Node-3782" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.479em; padding-bottom: 0.585em;">(</span></span><span id="MJXc-Node-3783" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.215em; padding-bottom: 0.267em;">x</span></span><span id="MJXc-Node-3784" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.479em; padding-bottom: 0.585em;">)</span></span><span id="MJXc-Node-3785" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.056em; padding-bottom: 0.32em;">=</span></span><span id="MJXc-Node-3786" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.162em; padding-bottom: 0.373em;">max</span></span><span id="MJXc-Node-3787" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.479em; padding-bottom: 0.585em;">(</span></span><span id="MJXc-Node-3788" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.373em; padding-bottom: 0.373em;">0</span></span><span id="MJXc-Node-3789" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="margin-top: -0.156em; padding-bottom: 0.532em;">,</span></span><span id="MJXc-Node-3790" class="mjx-mi MJXc-space1"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.215em; padding-bottom: 0.267em;">x</span></span><span id="MJXc-Node-3791" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.479em; padding-bottom: 0.585em;">)</span></span><span id="MJXc-Node-3792" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="margin-top: -0.156em; padding-bottom: 0.32em;">.</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>σ</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mo>=</mo><mo movablelimits="true" form="prefix">max</mo><mo stretchy="false">(</mo><mn>0</mn><mo>,</mo><mi>x</mi><mo stretchy="false">)</mo><mo>.</mo></math></span></span><script type="math/tex" id="MathJax-Element-233">\sigma(x) = \max(0, x).</script></span></li>
<li><span>Softplus (SmoothReLU): </span><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-234-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 118%; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>&amp;#x03C3;</mi><mo stretchy=&quot;false&quot;>(</mo><mi>x</mi><mo stretchy=&quot;false&quot;>)</mo><mo>=</mo><mi>log</mi><mo>&amp;#x2061;</mo><mo stretchy=&quot;false&quot;>(</mo><mn>1</mn><mo>+</mo><msup><mi>e</mi><mi>x</mi></msup><mo stretchy=&quot;false&quot;>)</mo><mo>.</mo></math>" role="presentation"><span id="MJXc-Node-3793" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-3794" class="mjx-mrow"><span id="MJXc-Node-3795" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.215em; padding-bottom: 0.267em; padding-right: 0.001em;">σ</span></span><span id="MJXc-Node-3796" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.479em; padding-bottom: 0.585em;">(</span></span><span id="MJXc-Node-3797" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.215em; padding-bottom: 0.267em;">x</span></span><span id="MJXc-Node-3798" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.479em; padding-bottom: 0.585em;">)</span></span><span id="MJXc-Node-3799" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.056em; padding-bottom: 0.32em;">=</span></span><span id="MJXc-Node-3800" class="mjx-mi MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.426em; padding-bottom: 0.532em;">log</span></span><span id="MJXc-Node-3801" class="mjx-mo"><span class="mjx-char"></span></span><span id="MJXc-Node-3802" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.479em; padding-bottom: 0.585em;">(</span></span><span id="MJXc-Node-3803" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.373em; padding-bottom: 0.32em;">1</span></span><span id="MJXc-Node-3804" class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.32em; padding-bottom: 0.426em;">+</span></span><span id="MJXc-Node-3805" class="mjx-msubsup MJXc-space2"><span class="mjx-base"><span id="MJXc-Node-3806" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.215em; padding-bottom: 0.267em;">e</span></span></span><span class="mjx-sup" style="font-size: 70.7%; vertical-align: 0.513em; padding-left: 0px; padding-right: 0.071em;"><span id="MJXc-Node-3807" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.215em; padding-bottom: 0.267em;">x</span></span></span></span><span id="MJXc-Node-3808" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.479em; padding-bottom: 0.585em;">)</span></span><span id="MJXc-Node-3809" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="margin-top: -0.156em; padding-bottom: 0.32em;">.</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>σ</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mo>=</mo><mi>log</mi><mo>⁡</mo><mo stretchy="false">(</mo><mn>1</mn><mo>+</mo><msup><mi>e</mi><mi>x</mi></msup><mo stretchy="false">)</mo><mo>.</mo></math></span></span><script type="math/tex" id="MathJax-Element-234">\sigma(x) = \log(1 + e^x).</script></span></li>
</ul>
</li>
<li><span>Слой активации обычно не меняет форму входной матрицы.</span></li>
<li><span>В некоторых материалах одним слоем нейронной сети называется функция активации от линейного преобразования. Это тонкость терминологии и на суть модели она не влияет.</span></li>
</ul>
</li>
<li><span>Другие слои, например </span><em><span>BatchNormalization, Convolutional Layers, Dropout</span></em><span> и т.д.</span></li>
</ul><p><span>Если сеть состоит только из линейных слоёв (и, возможно, функции активации в конце), то она называется </span><strong><span>полносвязной (fully-connected).</span></strong><br>
<span>Самым простым примером нейронной сети является уже знакомая нам </span><strong><span>логистическая регрессия.</span></strong><span> Её можно описать как нейронную сеть, состоящую из одного линейного слоя, который преобразовывает матрицу объекты-признаки в некоторый вектор и из одного слоя активации с сигмоидой.</span><br>
<img src="https://thedatafrog.com/static/blog/images/2019/01/one_neuron.49288164e12e.png" alt=""><br>
<strong><span>XOR-problem.</span></strong><span> Когда был предложен концепт </span><em><span>перцептрона</span></em><span> (нейронной сети с одним линейным слоем и одной функцией активации), было обнаружено, что такая модель не может смоделировать простую логическую функцию исключающего “или” (XOR).</span><br>
<img src="https://i.imgur.com/9EgtdO5.png" alt=""><br>
<span>Так как нельзя было построить одну разделяющую поверхность, которая бы правильно классифицировала объекты. Однако, было понятно что модель, состоящая из нескольких перцептронов, смогла бы решить эту задачу, так как могла бы строить более сложные разделяющие поверхности, но на момент первого упоминания этой проблемы автор перцептрона </span><em><span>Фрэнк Розенблатт</span></em><span> не знал алгоритма позволяющего обучить такую модель.</span></p><h3 id="15-Losses-for-NNs-logistic-loss-cross-entropy-Softmax-and-Log-softmax-activations-numerical-stability" data-id="15-Losses-for-NNs-logistic-loss-cross-entropy-Softmax-and-Log-softmax-activations-numerical-stability"><a class="anchor hidden-xs" href="#15-Losses-for-NNs-logistic-loss-cross-entropy-Softmax-and-Log-softmax-activations-numerical-stability" title="15-Losses-for-NNs-logistic-loss-cross-entropy-Softmax-and-Log-softmax-activations-numerical-stability"><span class="octicon octicon-link"></span></a><span>15. Losses for NNs: logistic loss, cross-entropy. Softmax and Log-softmax activations, numerical stability.</span></h3><ul>
<li><span>Первым шагом для обучения нейронной сети (как и для решения любой задачи машинного обучения) является выбор функции ошибки. Для нейронных сетей подходит абсолютно любая дифференцируемая функция потерь (так как мы обучаеть сеть с помощью градиентных методов оптимизации).</span><br>
<span>Для задачи классификации самым распространённым функционалом ошибки является </span><strong><span>кросс-энтропия</span></strong><span>, она же — </span><em><span>логистическая функция ошибки (LogLoss):</span></em><br>
<span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span class="mjx-chtml MJXc-display" style="text-align: center;"><span id="MathJax-Element-235-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 118%; text-align: center; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><mi>L</mi><mo stretchy=&quot;false&quot;>(</mo><mi>y</mi><mo>,</mo><mi>p</mi><mo stretchy=&quot;false&quot;>)</mo><mo>=</mo><mo>&amp;#x2212;</mo><munderover><mo movablelimits=&quot;false&quot;>&amp;#x2211;</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>n</mi></munderover><munderover><mo movablelimits=&quot;false&quot;>&amp;#x2211;</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>k</mi><mo>=</mo><mn>1</mn></mrow><mi>K</mi></munderover><mo stretchy=&quot;false&quot;>[</mo><msub><mi>y</mi><mi>i</mi></msub><mo>=</mo><mi>k</mi><mo stretchy=&quot;false&quot;>]</mo><mi>log</mi><mo>&amp;#x2061;</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><msub><mi>p</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>i</mi><mo>,</mo><mi>k</mi></mrow></msub></mrow><mo>,</mo></math>" role="presentation"><span id="MJXc-Node-3810" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-3811" class="mjx-mrow"><span id="MJXc-Node-3812" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.267em;">L</span></span><span id="MJXc-Node-3813" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.479em; padding-bottom: 0.585em;">(</span></span><span id="MJXc-Node-3814" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.215em; padding-bottom: 0.479em; padding-right: 0.006em;">y</span></span><span id="MJXc-Node-3815" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="margin-top: -0.156em; padding-bottom: 0.532em;">,</span></span><span id="MJXc-Node-3816" class="mjx-mi MJXc-space1"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.215em; padding-bottom: 0.479em;">p</span></span><span id="MJXc-Node-3817" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.479em; padding-bottom: 0.585em;">)</span></span><span id="MJXc-Node-3818" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.056em; padding-bottom: 0.32em;">=</span></span><span id="MJXc-Node-3819" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.32em; padding-bottom: 0.426em;">−</span></span><span id="MJXc-Node-3820" class="mjx-munderover MJXc-space1"><span class="mjx-itable"><span class="mjx-row"><span class="mjx-cell"><span class="mjx-stack"><span class="mjx-over" style="font-size: 70.7%; padding-bottom: 0.247em; padding-top: 0.141em; padding-left: 0.721em;"><span id="MJXc-Node-3827" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.215em; padding-bottom: 0.267em;">n</span></span></span><span class="mjx-op"><span id="MJXc-Node-3821" class="mjx-mo"><span class="mjx-char MJXc-TeX-size2-R" style="padding-top: 0.744em; padding-bottom: 0.744em;">∑</span></span></span></span></span></span><span class="mjx-row"><span class="mjx-under" style="font-size: 70.7%; padding-top: 0.236em; padding-bottom: 0.141em; padding-left: 0.21em;"><span id="MJXc-Node-3822" class="mjx-texatom" style=""><span id="MJXc-Node-3823" class="mjx-mrow"><span id="MJXc-Node-3824" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.426em; padding-bottom: 0.267em;">i</span></span><span id="MJXc-Node-3825" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.056em; padding-bottom: 0.32em;">=</span></span><span id="MJXc-Node-3826" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.373em; padding-bottom: 0.32em;">1</span></span></span></span></span></span></span></span><span id="MJXc-Node-3828" class="mjx-munderover MJXc-space1"><span class="mjx-itable"><span class="mjx-row"><span class="mjx-cell"><span class="mjx-stack"><span class="mjx-over" style="font-size: 70.7%; padding-bottom: 0.258em; padding-top: 0.141em; padding-left: 0.577em;"><span id="MJXc-Node-3835" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.267em; padding-right: 0.04em;">K</span></span></span><span class="mjx-op"><span id="MJXc-Node-3829" class="mjx-mo"><span class="mjx-char MJXc-TeX-size2-R" style="padding-top: 0.744em; padding-bottom: 0.744em;">∑</span></span></span></span></span></span><span class="mjx-row"><span class="mjx-under" style="font-size: 70.7%; padding-top: 0.236em; padding-bottom: 0.141em; padding-left: 0.122em;"><span id="MJXc-Node-3830" class="mjx-texatom" style=""><span id="MJXc-Node-3831" class="mjx-mrow"><span id="MJXc-Node-3832" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.267em;">k</span></span><span id="MJXc-Node-3833" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.056em; padding-bottom: 0.32em;">=</span></span><span id="MJXc-Node-3834" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.373em; padding-bottom: 0.32em;">1</span></span></span></span></span></span></span></span><span id="MJXc-Node-3836" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.479em; padding-bottom: 0.585em;">[</span></span><span id="MJXc-Node-3837" class="mjx-msubsup"><span class="mjx-base" style="margin-right: -0.006em;"><span id="MJXc-Node-3838" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.215em; padding-bottom: 0.479em; padding-right: 0.006em;">y</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-3839" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.426em; padding-bottom: 0.267em;">i</span></span></span></span><span id="MJXc-Node-3840" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.056em; padding-bottom: 0.32em;">=</span></span><span id="MJXc-Node-3841" class="mjx-mi MJXc-space3"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.267em;">k</span></span><span id="MJXc-Node-3842" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.479em; padding-bottom: 0.585em;">]</span></span><span id="MJXc-Node-3843" class="mjx-mi MJXc-space1"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.426em; padding-bottom: 0.532em;">log</span></span><span id="MJXc-Node-3844" class="mjx-mo"><span class="mjx-char"></span></span><span id="MJXc-Node-3845" class="mjx-texatom MJXc-space1"><span id="MJXc-Node-3846" class="mjx-mrow"><span id="MJXc-Node-3847" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-3848" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.215em; padding-bottom: 0.479em;">p</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.219em; padding-right: 0.071em;"><span id="MJXc-Node-3849" class="mjx-texatom" style=""><span id="MJXc-Node-3850" class="mjx-mrow"><span id="MJXc-Node-3851" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.426em; padding-bottom: 0.267em;">i</span></span><span id="MJXc-Node-3852" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="margin-top: -0.156em; padding-bottom: 0.532em;">,</span></span><span id="MJXc-Node-3853" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.267em;">k</span></span></span></span></span></span></span></span><span id="MJXc-Node-3854" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="margin-top: -0.156em; padding-bottom: 0.532em;">,</span></span></span></span><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mi>L</mi><mo stretchy="false">(</mo><mi>y</mi><mo>,</mo><mi>p</mi><mo stretchy="false">)</mo><mo>=</mo><mo>−</mo><munderover><mo movablelimits="false">∑</mo><mrow class="MJX-TeXAtom-ORD"><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>n</mi></munderover><munderover><mo movablelimits="false">∑</mo><mrow class="MJX-TeXAtom-ORD"><mi>k</mi><mo>=</mo><mn>1</mn></mrow><mi>K</mi></munderover><mo stretchy="false">[</mo><msub><mi>y</mi><mi>i</mi></msub><mo>=</mo><mi>k</mi><mo stretchy="false">]</mo><mi>log</mi><mo>⁡</mo><mrow class="MJX-TeXAtom-ORD"><msub><mi>p</mi><mrow class="MJX-TeXAtom-ORD"><mi>i</mi><mo>,</mo><mi>k</mi></mrow></msub></mrow><mo>,</mo></math></span></span></span><script type="math/tex; mode=display" id="MathJax-Element-235">
 L(y, p) = -\sum\limits_{i = 1}^n\sum\limits_{k = 1}^K [y_i = k]\log{p_{i,k}},
</script></span><br>
<span>где </span><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-236-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 118%; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>y</mi></math>" role="presentation"><span id="MJXc-Node-3855" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-3856" class="mjx-mrow"><span id="MJXc-Node-3857" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.215em; padding-bottom: 0.479em; padding-right: 0.006em;">y</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>y</mi></math></span></span><script type="math/tex" id="MathJax-Element-236">y</script></span><span> — вектор из правильных меток классов, </span><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-237-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 118%; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>p</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>i</mi><mo>,</mo><mi>k</mi></mrow></msub><mo>=</mo><mi>p</mi><mo stretchy=&quot;false&quot;>(</mo><mtext>&amp;#x41E;&amp;#x431;&amp;#x44A;&amp;#x435;&amp;#x43A;&amp;#x442;&amp;#xA0;</mtext><msub><mi>x</mi><mi>i</mi></msub><mtext>&amp;#xA0;&amp;#x43F;&amp;#x440;&amp;#x438;&amp;#x43D;&amp;#x430;&amp;#x434;&amp;#x43B;&amp;#x435;&amp;#x436;&amp;#x438;&amp;#x442; &amp;#x43A;&amp;#x43B;&amp;#x430;&amp;#x441;&amp;#x441;&amp;#x443;&amp;#xA0;</mtext><mi>k</mi><mo stretchy=&quot;false&quot;>)</mo><mo>,</mo></math>" role="presentation"><span id="MJXc-Node-3858" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-3859" class="mjx-mrow"><span id="MJXc-Node-3860" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-3861" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.215em; padding-bottom: 0.479em;">p</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.219em; padding-right: 0.071em;"><span id="MJXc-Node-3862" class="mjx-texatom" style=""><span id="MJXc-Node-3863" class="mjx-mrow"><span id="MJXc-Node-3864" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.426em; padding-bottom: 0.267em;">i</span></span><span id="MJXc-Node-3865" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="margin-top: -0.156em; padding-bottom: 0.532em;">,</span></span><span id="MJXc-Node-3866" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.267em;">k</span></span></span></span></span></span><span id="MJXc-Node-3867" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.056em; padding-bottom: 0.32em;">=</span></span><span id="MJXc-Node-3868" class="mjx-mi MJXc-space3"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.215em; padding-bottom: 0.479em;">p</span></span><span id="MJXc-Node-3869" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.479em; padding-bottom: 0.585em;">(</span></span><span id="MJXc-Node-3870" class="mjx-mtext"><span class="mjx-char" style="padding-top: 0.532em; padding-bottom: 0.215em;"><span class="mjx-charbox MJXc-TeX-unknown-R" style="padding-bottom: 0.297em; width: 0.731em;">О</span><span class="mjx-charbox MJXc-TeX-unknown-R" style="padding-bottom: 0.297em; width: 0.508em;">б</span><span class="mjx-charbox MJXc-TeX-unknown-R" style="padding-bottom: 0.297em; width: 0.54em;">ъ</span><span class="mjx-charbox MJXc-TeX-unknown-R" style="padding-bottom: 0.297em; width: 0.466em;">е</span><span class="mjx-charbox MJXc-TeX-unknown-R" style="padding-bottom: 0.297em; width: 0.498em;">к</span><span class="mjx-charbox MJXc-TeX-unknown-R" style="padding-bottom: 0.297em; width: 0.434em;">т</span><span class="mjx-charbox MJXc-TeX-main-R" style="padding-bottom: 0.314em;">&nbsp;</span></span></span><span id="MJXc-Node-3871" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-3872" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.215em; padding-bottom: 0.267em;">x</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-3873" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.426em; padding-bottom: 0.267em;">i</span></span></span></span><span id="MJXc-Node-3874" class="mjx-mtext"><span class="mjx-char" style="padding-top: 0.532em; padding-bottom: 0.215em;"><span class="mjx-charbox MJXc-TeX-main-R" style="padding-bottom: 0.314em;">&nbsp;</span><span class="mjx-charbox MJXc-TeX-unknown-R" style="padding-bottom: 0.297em; width: 0.519em;">п</span><span class="mjx-charbox MJXc-TeX-unknown-R" style="padding-bottom: 0.297em; width: 0.498em;">р</span><span class="mjx-charbox MJXc-TeX-unknown-R" style="padding-bottom: 0.297em; width: 0.519em;">и</span><span class="mjx-charbox MJXc-TeX-unknown-R" style="padding-bottom: 0.297em; width: 0.519em;">н</span><span class="mjx-charbox MJXc-TeX-unknown-R" style="padding-bottom: 0.297em; width: 0.445em;">а</span><span class="mjx-charbox MJXc-TeX-unknown-R" style="padding-bottom: 0.297em; width: 0.456em;">д</span><span class="mjx-charbox MJXc-TeX-unknown-R" style="padding-bottom: 0.297em; width: 0.498em;">л</span><span class="mjx-charbox MJXc-TeX-unknown-R" style="padding-bottom: 0.297em; width: 0.466em;">е</span><span class="mjx-charbox MJXc-TeX-unknown-R" style="padding-bottom: 0.297em; width: 0.72em;">ж</span><span class="mjx-charbox MJXc-TeX-unknown-R" style="padding-bottom: 0.297em; width: 0.519em;">и</span><span class="mjx-charbox MJXc-TeX-unknown-R" style="padding-bottom: 0.297em; width: 0.434em;">т</span><span class="mjx-charbox MJXc-TeX-main-R" style="padding-bottom: 0.314em;"> </span><span class="mjx-charbox MJXc-TeX-unknown-R" style="padding-bottom: 0.297em; width: 0.498em;">к</span><span class="mjx-charbox MJXc-TeX-unknown-R" style="padding-bottom: 0.297em; width: 0.498em;">л</span><span class="mjx-charbox MJXc-TeX-unknown-R" style="padding-bottom: 0.297em; width: 0.445em;">а</span><span class="mjx-charbox MJXc-TeX-unknown-R" style="padding-bottom: 0.297em; width: 0.456em;">с</span><span class="mjx-charbox MJXc-TeX-unknown-R" style="padding-bottom: 0.297em; width: 0.456em;">с</span><span class="mjx-charbox MJXc-TeX-unknown-R" style="padding-bottom: 0.297em; width: 0.487em;">у</span><span class="mjx-charbox MJXc-TeX-main-R" style="padding-bottom: 0.314em;">&nbsp;</span></span></span><span id="MJXc-Node-3875" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.267em;">k</span></span><span id="MJXc-Node-3876" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.479em; padding-bottom: 0.585em;">)</span></span><span id="MJXc-Node-3877" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="margin-top: -0.156em; padding-bottom: 0.532em;">,</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>p</mi><mrow class="MJX-TeXAtom-ORD"><mi>i</mi><mo>,</mo><mi>k</mi></mrow></msub><mo>=</mo><mi>p</mi><mo stretchy="false">(</mo><mtext>Объект&nbsp;</mtext><msub><mi>x</mi><mi>i</mi></msub><mtext>&nbsp;принадлежит классу&nbsp;</mtext><mi>k</mi><mo stretchy="false">)</mo><mo>,</mo></math></span></span><script type="math/tex" id="MathJax-Element-237">p_{i,k} = p(\text{Объект }x_i\text{ принадлежит классу }k),</script></span><span> </span><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-238-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 118%; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>p</mi></math>" role="presentation"><span id="MJXc-Node-3878" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-3879" class="mjx-mrow"><span id="MJXc-Node-3880" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.215em; padding-bottom: 0.479em;">p</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>p</mi></math></span></span><script type="math/tex" id="MathJax-Element-238">p</script></span><span> — матрица составленная из таких вероятностей.</span>
<ul>
<li><span>Отметим, что иногда под логистической функцией потерь понимают случай кросс-энтропии под бинарной классификацией.</span></li>
</ul>
</li>
<li><span>Для задачи классификации часто в качестве финальной функции активации используют </span><strong><span>Softmax:</span></strong><br>
<span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span class="mjx-chtml MJXc-display" style="text-align: center;"><span id="MathJax-Element-239-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 118%; text-align: center; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><mi>&amp;#x03C3;</mi><mo stretchy=&quot;false&quot;>(</mo><msub><mi>x</mi><mi>i</mi></msub><mo stretchy=&quot;false&quot;>)</mo><mo>=</mo><mfrac><msup><mi>e</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><msub><mi>x</mi><mi>i</mi></msub></mrow></msup><mrow><munderover><mo movablelimits=&quot;false&quot;>&amp;#x2211;</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>j</mi><mo>=</mo><mn>1</mn></mrow><mi>p</mi></munderover><msup><mi>e</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><msub><mi>x</mi><mi>j</mi></msub></mrow></msup></mrow></mfrac><mo>,</mo></math>" role="presentation"><span id="MJXc-Node-3881" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-3882" class="mjx-mrow"><span id="MJXc-Node-3883" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.215em; padding-bottom: 0.267em; padding-right: 0.001em;">σ</span></span><span id="MJXc-Node-3884" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.479em; padding-bottom: 0.585em;">(</span></span><span id="MJXc-Node-3885" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-3886" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.215em; padding-bottom: 0.267em;">x</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-3887" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.426em; padding-bottom: 0.267em;">i</span></span></span></span><span id="MJXc-Node-3888" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.479em; padding-bottom: 0.585em;">)</span></span><span id="MJXc-Node-3889" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.056em; padding-bottom: 0.32em;">=</span></span><span id="MJXc-Node-3890" class="mjx-mfrac MJXc-space3"><span class="mjx-box MJXc-stacked" style="width: 2.698em; padding: 0px 0.12em;"><span class="mjx-numerator" style="width: 2.698em; top: -1.37em;"><span id="MJXc-Node-3891" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-3892" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.215em; padding-bottom: 0.267em;">e</span></span></span><span class="mjx-sup" style="font-size: 70.7%; vertical-align: 0.513em; padding-left: 0px; padding-right: 0.071em;"><span id="MJXc-Node-3893" class="mjx-texatom" style=""><span id="MJXc-Node-3894" class="mjx-mrow"><span id="MJXc-Node-3895" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-3896" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.215em; padding-bottom: 0.267em;">x</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-3897" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.426em; padding-bottom: 0.267em;">i</span></span></span></span></span></span></span></span></span><span class="mjx-denominator" style="width: 2.698em; bottom: -2.639em;"><span id="MJXc-Node-3898" class="mjx-mrow"><span id="MJXc-Node-3899" class="mjx-munderover"><span class="mjx-itable"><span class="mjx-row"><span class="mjx-cell"><span class="mjx-stack"><span class="mjx-over" style="font-size: 70.7%; padding-bottom: 0.157em; padding-top: 0.141em; padding-left: 0.593em;"><span id="MJXc-Node-3906" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.215em; padding-bottom: 0.479em;">p</span></span></span><span class="mjx-op" style="padding-left: 0.07em;"><span id="MJXc-Node-3900" class="mjx-mo"><span class="mjx-char MJXc-TeX-size1-R" style="padding-top: 0.532em; padding-bottom: 0.532em;">∑</span></span></span></span></span></span><span class="mjx-row"><span class="mjx-under" style="font-size: 70.7%; padding-top: 0.236em; padding-bottom: 0.141em;"><span id="MJXc-Node-3901" class="mjx-texatom" style=""><span id="MJXc-Node-3902" class="mjx-mrow"><span id="MJXc-Node-3903" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.426em; padding-bottom: 0.479em;">j</span></span><span id="MJXc-Node-3904" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.056em; padding-bottom: 0.32em;">=</span></span><span id="MJXc-Node-3905" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.373em; padding-bottom: 0.32em;">1</span></span></span></span></span></span></span></span><span id="MJXc-Node-3907" class="mjx-msubsup MJXc-space1"><span class="mjx-base"><span id="MJXc-Node-3908" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.215em; padding-bottom: 0.267em;">e</span></span></span><span class="mjx-sup" style="font-size: 70.7%; vertical-align: 0.468em; padding-left: 0px; padding-right: 0.071em;"><span id="MJXc-Node-3909" class="mjx-texatom" style=""><span id="MJXc-Node-3910" class="mjx-mrow"><span id="MJXc-Node-3911" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-3912" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.215em; padding-bottom: 0.267em;">x</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-3913" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.426em; padding-bottom: 0.479em;">j</span></span></span></span></span></span></span></span></span></span><span style="border-bottom-width: 1.3px; border-bottom-style: solid; top: -0.283em; width: 2.698em;" class="mjx-line"></span></span><span style="height: 4.009em; vertical-align: -2.639em;" class="mjx-vsize"></span></span><span id="MJXc-Node-3914" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="margin-top: -0.156em; padding-bottom: 0.532em;">,</span></span></span></span><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mi>σ</mi><mo stretchy="false">(</mo><msub><mi>x</mi><mi>i</mi></msub><mo stretchy="false">)</mo><mo>=</mo><mfrac><msup><mi>e</mi><mrow class="MJX-TeXAtom-ORD"><msub><mi>x</mi><mi>i</mi></msub></mrow></msup><mrow><munderover><mo movablelimits="false">∑</mo><mrow class="MJX-TeXAtom-ORD"><mi>j</mi><mo>=</mo><mn>1</mn></mrow><mi>p</mi></munderover><msup><mi>e</mi><mrow class="MJX-TeXAtom-ORD"><msub><mi>x</mi><mi>j</mi></msub></mrow></msup></mrow></mfrac><mo>,</mo></math></span></span></span><script type="math/tex; mode=display" id="MathJax-Element-239">
 \sigma(x_i) = \frac{e^{x_i}}{\sum\limits_{j = 1}^pe^{x_j}},
</script></span><br>
<span>где </span><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-240-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 118%; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>x</mi><mi>i</mi></msub></math>" role="presentation"><span id="MJXc-Node-3915" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-3916" class="mjx-mrow"><span id="MJXc-Node-3917" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-3918" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.215em; padding-bottom: 0.267em;">x</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-3919" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.426em; padding-bottom: 0.267em;">i</span></span></span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>x</mi><mi>i</mi></msub></math></span></span><script type="math/tex" id="MathJax-Element-240">x_i</script></span><span> — это одна компонента вектора (объекта) </span><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-241-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 118%; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>x</mi><mo>,</mo></math>" role="presentation"><span id="MJXc-Node-3920" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-3921" class="mjx-mrow"><span id="MJXc-Node-3922" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.215em; padding-bottom: 0.267em;">x</span></span><span id="MJXc-Node-3923" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="margin-top: -0.156em; padding-bottom: 0.532em;">,</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>x</mi><mo>,</mo></math></span></span><script type="math/tex" id="MathJax-Element-241">x,</script></span><span> и сумма в знаменателе идёт по всем компонентам этого вектора.</span>
<ul>
<li><span>Соответственно, если размерность вектора равна количеству классов, то можно значения Softmax</span><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-242-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 118%; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mo stretchy=&quot;false&quot;>(</mo><mi>x</mi><mo stretchy=&quot;false&quot;>)</mo></math>" role="presentation"><span id="MJXc-Node-3924" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-3925" class="mjx-mrow"><span id="MJXc-Node-3926" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.479em; padding-bottom: 0.585em;">(</span></span><span id="MJXc-Node-3927" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.215em; padding-bottom: 0.267em;">x</span></span><span id="MJXc-Node-3928" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.479em; padding-bottom: 0.585em;">)</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-242">(x)</script></span><span> интерпретировать как вероятности объекта принадлежать конкретным классам.</span></li>
</ul>
</li>
<li><span>Большим недостатком Softmax является то, что для его расчёта нужно считать значение экспоненты, что дорого в смысле вычислительной мощности. Однако обратим внимание на то, что для функции потерь нам нужны не сами вероятности, а логарифмы вероятностей. В таком случае определим другую функцию активации </span><strong><span>LogSoftmax:</span></strong><br>
<span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span class="mjx-chtml MJXc-display" style="text-align: center;"><span id="MathJax-Element-243-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 118%; text-align: center; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><mi>&amp;#x03C3;</mi><mo stretchy=&quot;false&quot;>(</mo><msub><mi>x</mi><mi>i</mi></msub><mo stretchy=&quot;false&quot;>)</mo><mo>=</mo><msub><mi>x</mi><mi>i</mi></msub><mo>&amp;#x2212;</mo><mi>log</mi><mo>&amp;#x2061;</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><munderover><mo movablelimits=&quot;false&quot;>&amp;#x2211;</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>j</mi><mo>=</mo><mn>1</mn></mrow><mi>p</mi></munderover><msup><mi>e</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><msub><mi>x</mi><mi>j</mi></msub></mrow></msup></mrow><mo>=</mo><mi>log</mi><mo>&amp;#x2061;</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mtext>Softmax</mtext><mo stretchy=&quot;false&quot;>(</mo><msub><mi>x</mi><mi>i</mi></msub><mo stretchy=&quot;false&quot;>)</mo></mrow></math>" role="presentation"><span id="MJXc-Node-3929" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-3930" class="mjx-mrow"><span id="MJXc-Node-3931" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.215em; padding-bottom: 0.267em; padding-right: 0.001em;">σ</span></span><span id="MJXc-Node-3932" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.479em; padding-bottom: 0.585em;">(</span></span><span id="MJXc-Node-3933" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-3934" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.215em; padding-bottom: 0.267em;">x</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-3935" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.426em; padding-bottom: 0.267em;">i</span></span></span></span><span id="MJXc-Node-3936" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.479em; padding-bottom: 0.585em;">)</span></span><span id="MJXc-Node-3937" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.056em; padding-bottom: 0.32em;">=</span></span><span id="MJXc-Node-3938" class="mjx-msubsup MJXc-space3"><span class="mjx-base"><span id="MJXc-Node-3939" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.215em; padding-bottom: 0.267em;">x</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-3940" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.426em; padding-bottom: 0.267em;">i</span></span></span></span><span id="MJXc-Node-3941" class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.32em; padding-bottom: 0.426em;">−</span></span><span id="MJXc-Node-3942" class="mjx-mi MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.426em; padding-bottom: 0.532em;">log</span></span><span id="MJXc-Node-3943" class="mjx-mo"><span class="mjx-char"></span></span><span id="MJXc-Node-3944" class="mjx-texatom MJXc-space1"><span id="MJXc-Node-3945" class="mjx-mrow"><span id="MJXc-Node-3946" class="mjx-munderover"><span class="mjx-itable"><span class="mjx-row"><span class="mjx-cell"><span class="mjx-stack"><span class="mjx-over" style="font-size: 70.7%; padding-bottom: 0.157em; padding-top: 0.141em; padding-left: 0.77em;"><span id="MJXc-Node-3953" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.215em; padding-bottom: 0.479em;">p</span></span></span><span class="mjx-op"><span id="MJXc-Node-3947" class="mjx-mo"><span class="mjx-char MJXc-TeX-size2-R" style="padding-top: 0.744em; padding-bottom: 0.744em;">∑</span></span></span></span></span></span><span class="mjx-row"><span class="mjx-under" style="font-size: 70.7%; padding-top: 0.236em; padding-bottom: 0.141em; padding-left: 0.176em;"><span id="MJXc-Node-3948" class="mjx-texatom" style=""><span id="MJXc-Node-3949" class="mjx-mrow"><span id="MJXc-Node-3950" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.426em; padding-bottom: 0.479em;">j</span></span><span id="MJXc-Node-3951" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.056em; padding-bottom: 0.32em;">=</span></span><span id="MJXc-Node-3952" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.373em; padding-bottom: 0.32em;">1</span></span></span></span></span></span></span></span><span id="MJXc-Node-3954" class="mjx-msubsup MJXc-space1"><span class="mjx-base"><span id="MJXc-Node-3955" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.215em; padding-bottom: 0.267em;">e</span></span></span><span class="mjx-sup" style="font-size: 70.7%; vertical-align: 0.584em; padding-left: 0px; padding-right: 0.071em;"><span id="MJXc-Node-3956" class="mjx-texatom" style=""><span id="MJXc-Node-3957" class="mjx-mrow"><span id="MJXc-Node-3958" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-3959" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.215em; padding-bottom: 0.267em;">x</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-3960" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.426em; padding-bottom: 0.479em;">j</span></span></span></span></span></span></span></span></span></span><span id="MJXc-Node-3961" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.056em; padding-bottom: 0.32em;">=</span></span><span id="MJXc-Node-3962" class="mjx-mi MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.426em; padding-bottom: 0.532em;">log</span></span><span id="MJXc-Node-3963" class="mjx-mo"><span class="mjx-char"></span></span><span id="MJXc-Node-3964" class="mjx-texatom MJXc-space1"><span id="MJXc-Node-3965" class="mjx-mrow"><span id="MJXc-Node-3966" class="mjx-mtext"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.426em; padding-bottom: 0.373em;">Softmax</span></span><span id="MJXc-Node-3967" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.479em; padding-bottom: 0.585em;">(</span></span><span id="MJXc-Node-3968" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-3969" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.215em; padding-bottom: 0.267em;">x</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-3970" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.426em; padding-bottom: 0.267em;">i</span></span></span></span><span id="MJXc-Node-3971" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.479em; padding-bottom: 0.585em;">)</span></span></span></span></span></span><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mi>σ</mi><mo stretchy="false">(</mo><msub><mi>x</mi><mi>i</mi></msub><mo stretchy="false">)</mo><mo>=</mo><msub><mi>x</mi><mi>i</mi></msub><mo>−</mo><mi>log</mi><mo>⁡</mo><mrow class="MJX-TeXAtom-ORD"><munderover><mo movablelimits="false">∑</mo><mrow class="MJX-TeXAtom-ORD"><mi>j</mi><mo>=</mo><mn>1</mn></mrow><mi>p</mi></munderover><msup><mi>e</mi><mrow class="MJX-TeXAtom-ORD"><msub><mi>x</mi><mi>j</mi></msub></mrow></msup></mrow><mo>=</mo><mi>log</mi><mo>⁡</mo><mrow class="MJX-TeXAtom-ORD"><mtext>Softmax</mtext><mo stretchy="false">(</mo><msub><mi>x</mi><mi>i</mi></msub><mo stretchy="false">)</mo></mrow></math></span></span></span><script type="math/tex; mode=display" id="MathJax-Element-243">
 \sigma(x_i) = x_i - \log{\sum\limits_{j = 1}^pe^{x_j}} = \log{\text{Softmax}(x_i)}
</script></span>
<ul>
<li><span>Основное преимущество LogSoftmax заключается в том, что его вычисление быстрее чем Softmax и более вычислительно устойчиво (numerically stable), т.к. нам не нужно делить две эскпоненты (потенциально два больших числа) друг на друга. Также от этой функции быстрее считается кросс-энтропия.</span></li>
</ul>
</li>
</ul><h3 id="16-Activation-functions-their-impact-on-the-network-computational-complexity" data-id="16-Activation-functions-their-impact-on-the-network-computational-complexity"><a class="anchor hidden-xs" href="#16-Activation-functions-their-impact-on-the-network-computational-complexity" title="16-Activation-functions-their-impact-on-the-network-computational-complexity"><span class="octicon octicon-link"></span></a><span>16. Activation functions, their impact on the network, computational complexity.</span></h3><p><strong><span>Слои активации</span></strong><span> нужны в нейронной сети, чтобы она могла восстанавливать нелинейные зависимости. Функции активации обычно применяются после линейного преобразования.</span><br>
<span>Функции активации являются дифференцируемыми верхними оценками на пороговую функцию. То есть их смысл в том, что результат функции активации становится равным 1 на больших положительных значениях входных данных и 0 (или -1) на больших отрицательных. Можно интепретировать это так: данный слой (“нейрон”) </span><em><span>активируется</span></em><span> когда входные данные больше по модулю некоторого порогового значения.</span><br>
<span>Обычно слои активации не параметризуют, так так такую параметризацию можно выразить через линейное преобразование над данными (или над результатом работы слоя).</span><br>
<span>Примеры некоторых слоёв активации:</span></p><ul>
<li><span>Sigmoid: </span><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-244-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 118%; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>f</mi><mo stretchy=&quot;false&quot;>(</mo><mi>x</mi><mo stretchy=&quot;false&quot;>)</mo><mo>=</mo><mfrac><mn>1</mn><mrow><mn>1</mn><mo>+</mo><msup><mi>e</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo>&amp;#x2212;</mo><mi>x</mi></mrow></msup></mrow></mfrac><mo>.</mo></math>" role="presentation"><span id="MJXc-Node-3972" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-3973" class="mjx-mrow"><span id="MJXc-Node-3974" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.479em; padding-right: 0.06em;">f</span></span><span id="MJXc-Node-3975" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.479em; padding-bottom: 0.585em;">(</span></span><span id="MJXc-Node-3976" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.215em; padding-bottom: 0.267em;">x</span></span><span id="MJXc-Node-3977" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.479em; padding-bottom: 0.585em;">)</span></span><span id="MJXc-Node-3978" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.056em; padding-bottom: 0.32em;">=</span></span><span id="MJXc-Node-3979" class="mjx-mfrac MJXc-space3"><span class="mjx-box MJXc-stacked" style="width: 2.075em; padding: 0px 0.12em;"><span class="mjx-numerator" style="font-size: 70.7%; width: 2.934em; top: -1.299em;"><span id="MJXc-Node-3980" class="mjx-mn" style=""><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.373em; padding-bottom: 0.32em;">1</span></span></span><span class="mjx-denominator" style="font-size: 70.7%; width: 2.934em; bottom: -0.702em;"><span id="MJXc-Node-3981" class="mjx-mrow" style=""><span id="MJXc-Node-3982" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.373em; padding-bottom: 0.32em;">1</span></span><span id="MJXc-Node-3983" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.32em; padding-bottom: 0.426em;">+</span></span><span id="MJXc-Node-3984" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-3985" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.215em; padding-bottom: 0.267em;">e</span></span></span><span class="mjx-sup" style="font-size: 70.7%; vertical-align: 0.409em; padding-left: 0px; padding-right: 0.071em;"><span id="MJXc-Node-3986" class="mjx-texatom" style=""><span id="MJXc-Node-3987" class="mjx-mrow"><span id="MJXc-Node-3988" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.32em; padding-bottom: 0.426em;">−</span></span><span id="MJXc-Node-3989" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.215em; padding-bottom: 0.267em;">x</span></span></span></span></span></span></span></span><span style="border-bottom-width: 1.3px; border-bottom-style: solid; top: -0.283em; width: 2.075em;" class="mjx-line"></span></span><span style="height: 1.415em; vertical-align: -0.496em;" class="mjx-vsize"></span></span><span id="MJXc-Node-3990" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="margin-top: -0.156em; padding-bottom: 0.32em;">.</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>f</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mo>=</mo><mfrac><mn>1</mn><mrow><mn>1</mn><mo>+</mo><msup><mi>e</mi><mrow class="MJX-TeXAtom-ORD"><mo>−</mo><mi>x</mi></mrow></msup></mrow></mfrac><mo>.</mo></math></span></span><script type="math/tex" id="MathJax-Element-244">f(x) = \frac{1}{1 + e^{-x}}.</script></span>
<ul>
<li><span>Исторически первая использовавшася функция активации.</span></li>
<li><span>Переводит значения предыдущего слоя в отрезок </span><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-245-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 118%; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mo stretchy=&quot;false&quot;>[</mo><mn>0</mn><mo>,</mo><mn>1</mn><mo stretchy=&quot;false&quot;>]</mo></math>" role="presentation"><span id="MJXc-Node-3991" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-3992" class="mjx-mrow"><span id="MJXc-Node-3993" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.479em; padding-bottom: 0.585em;">[</span></span><span id="MJXc-Node-3994" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.373em; padding-bottom: 0.373em;">0</span></span><span id="MJXc-Node-3995" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="margin-top: -0.156em; padding-bottom: 0.532em;">,</span></span><span id="MJXc-Node-3996" class="mjx-mn MJXc-space1"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.373em; padding-bottom: 0.32em;">1</span></span><span id="MJXc-Node-3997" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.479em; padding-bottom: 0.585em;">]</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo stretchy="false">[</mo><mn>0</mn><mo>,</mo><mn>1</mn><mo stretchy="false">]</mo></math></span></span><script type="math/tex" id="MathJax-Element-245">[0, 1]</script></span></li>
<li><span>Недостатки:</span>
<ul>
<li><span>При больших по модулю входных значениях сигмоида практически равна константе, а значит имеет очень малые производные. При использовании backpropogation при проходе через этот слой накопленный градиент умножится на очень малое число и мы потеряем всю информацию о градиентах предыдущих слоёв. В таком случае говорят, что градиенты </span><em><span>затухают.</span></em></li>
<li><span>Линейные модели лучше всего работают с отцентрированными данными одного масштаба. Сигмоида же не центрирована, т.к. сдвигает данные в сторону положительных значений (значения сигмоиды </span><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-246-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 118%; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mo>&amp;gt;=</mo><mn>0</mn></math>" role="presentation"><span id="MJXc-Node-3998" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-3999" class="mjx-mrow"><span id="MJXc-Node-4000" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.056em; padding-bottom: 0.373em;">&gt;<span class="mjx-charbox MJXc-TeX-main-R" style="padding-bottom: 0.314em;">=</span></span></span><span id="MJXc-Node-4001" class="mjx-mn MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.373em; padding-bottom: 0.373em;">0</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo>&gt;=</mo><mn>0</mn></math></span></span><script type="math/tex" id="MathJax-Element-246">>= 0</script></span><span>).</span></li>
<li><span>Вычисление сигмоиды требует вычисления экспоненты, что является дорогой операцией в смысле вычислительных ресурсов.</span></li>
</ul>
</li>
</ul>
</li>
<li><span>Гиперболический тангенс: </span><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-247-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 118%; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>f</mi><mo stretchy=&quot;false&quot;>(</mo><mi>x</mi><mo stretchy=&quot;false&quot;>)</mo><mo>=</mo><mi>tanh</mi><mo>&amp;#x2061;</mo><mo stretchy=&quot;false&quot;>(</mo><mi>x</mi><mo stretchy=&quot;false&quot;>)</mo><mo>=</mo><mfrac><mrow><msup><mi>e</mi><mi>x</mi></msup><mo>&amp;#x2212;</mo><msup><mi>e</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo>&amp;#x2212;</mo><mi>x</mi></mrow></msup></mrow><mrow><msup><mi>e</mi><mi>x</mi></msup><mo>+</mo><msup><mi>e</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo>&amp;#x2212;</mo><mi>x</mi></mrow></msup></mrow></mfrac><mo>.</mo></math>" role="presentation"><span id="MJXc-Node-4002" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-4003" class="mjx-mrow"><span id="MJXc-Node-4004" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.479em; padding-right: 0.06em;">f</span></span><span id="MJXc-Node-4005" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.479em; padding-bottom: 0.585em;">(</span></span><span id="MJXc-Node-4006" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.215em; padding-bottom: 0.267em;">x</span></span><span id="MJXc-Node-4007" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.479em; padding-bottom: 0.585em;">)</span></span><span id="MJXc-Node-4008" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.056em; padding-bottom: 0.32em;">=</span></span><span id="MJXc-Node-4009" class="mjx-mi MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.426em; padding-bottom: 0.373em;">tanh</span></span><span id="MJXc-Node-4010" class="mjx-mo"><span class="mjx-char"></span></span><span id="MJXc-Node-4011" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.479em; padding-bottom: 0.585em;">(</span></span><span id="MJXc-Node-4012" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.215em; padding-bottom: 0.267em;">x</span></span><span id="MJXc-Node-4013" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.479em; padding-bottom: 0.585em;">)</span></span><span id="MJXc-Node-4014" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.056em; padding-bottom: 0.32em;">=</span></span><span id="MJXc-Node-4015" class="mjx-mfrac MJXc-space3"><span class="mjx-box MJXc-stacked" style="width: 2.362em; padding: 0px 0.12em;"><span class="mjx-numerator" style="font-size: 70.7%; width: 3.34em; top: -1.483em;"><span id="MJXc-Node-4016" class="mjx-mrow" style=""><span id="MJXc-Node-4017" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-4018" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.215em; padding-bottom: 0.267em;">e</span></span></span><span class="mjx-sup" style="font-size: 70.7%; vertical-align: 0.513em; padding-left: 0px; padding-right: 0.071em;"><span id="MJXc-Node-4019" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.215em; padding-bottom: 0.267em;">x</span></span></span></span><span id="MJXc-Node-4020" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.32em; padding-bottom: 0.426em;">−</span></span><span id="MJXc-Node-4021" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-4022" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.215em; padding-bottom: 0.267em;">e</span></span></span><span class="mjx-sup" style="font-size: 70.7%; vertical-align: 0.513em; padding-left: 0px; padding-right: 0.071em;"><span id="MJXc-Node-4023" class="mjx-texatom" style=""><span id="MJXc-Node-4024" class="mjx-mrow"><span id="MJXc-Node-4025" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.32em; padding-bottom: 0.426em;">−</span></span><span id="MJXc-Node-4026" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.215em; padding-bottom: 0.267em;">x</span></span></span></span></span></span></span></span><span class="mjx-denominator" style="font-size: 70.7%; width: 3.34em; bottom: -0.702em;"><span id="MJXc-Node-4027" class="mjx-mrow" style=""><span id="MJXc-Node-4028" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-4029" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.215em; padding-bottom: 0.267em;">e</span></span></span><span class="mjx-sup" style="font-size: 70.7%; vertical-align: 0.409em; padding-left: 0px; padding-right: 0.071em;"><span id="MJXc-Node-4030" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.215em; padding-bottom: 0.267em;">x</span></span></span></span><span id="MJXc-Node-4031" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.32em; padding-bottom: 0.426em;">+</span></span><span id="MJXc-Node-4032" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-4033" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.215em; padding-bottom: 0.267em;">e</span></span></span><span class="mjx-sup" style="font-size: 70.7%; vertical-align: 0.409em; padding-left: 0px; padding-right: 0.071em;"><span id="MJXc-Node-4034" class="mjx-texatom" style=""><span id="MJXc-Node-4035" class="mjx-mrow"><span id="MJXc-Node-4036" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.32em; padding-bottom: 0.426em;">−</span></span><span id="MJXc-Node-4037" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.215em; padding-bottom: 0.267em;">x</span></span></span></span></span></span></span></span><span style="border-bottom-width: 1.3px; border-bottom-style: solid; top: -0.283em; width: 2.362em;" class="mjx-line"></span></span><span style="height: 1.545em; vertical-align: -0.496em;" class="mjx-vsize"></span></span><span id="MJXc-Node-4038" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="margin-top: -0.156em; padding-bottom: 0.32em;">.</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>f</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mo>=</mo><mi>tanh</mi><mo>⁡</mo><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mo>=</mo><mfrac><mrow><msup><mi>e</mi><mi>x</mi></msup><mo>−</mo><msup><mi>e</mi><mrow class="MJX-TeXAtom-ORD"><mo>−</mo><mi>x</mi></mrow></msup></mrow><mrow><msup><mi>e</mi><mi>x</mi></msup><mo>+</mo><msup><mi>e</mi><mrow class="MJX-TeXAtom-ORD"><mo>−</mo><mi>x</mi></mrow></msup></mrow></mfrac><mo>.</mo></math></span></span><script type="math/tex" id="MathJax-Element-247">f(x) = \tanh(x) = \frac{e^x - e^{-x}}{e^x + e^{-x}}.</script></span>
<ul>
<li><span>Принимает значения в </span><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-248-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 118%; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mo stretchy=&quot;false&quot;>[</mo><mo>&amp;#x2212;</mo><mn>1</mn><mo>,</mo><mn>1</mn><mo stretchy=&quot;false&quot;>]</mo><mo>.</mo></math>" role="presentation"><span id="MJXc-Node-4039" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-4040" class="mjx-mrow"><span id="MJXc-Node-4041" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.479em; padding-bottom: 0.585em;">[</span></span><span id="MJXc-Node-4042" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.32em; padding-bottom: 0.426em;">−</span></span><span id="MJXc-Node-4043" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.373em; padding-bottom: 0.32em;">1</span></span><span id="MJXc-Node-4044" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="margin-top: -0.156em; padding-bottom: 0.532em;">,</span></span><span id="MJXc-Node-4045" class="mjx-mn MJXc-space1"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.373em; padding-bottom: 0.32em;">1</span></span><span id="MJXc-Node-4046" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.479em; padding-bottom: 0.585em;">]</span></span><span id="MJXc-Node-4047" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="margin-top: -0.156em; padding-bottom: 0.32em;">.</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo stretchy="false">[</mo><mo>−</mo><mn>1</mn><mo>,</mo><mn>1</mn><mo stretchy="false">]</mo><mo>.</mo></math></span></span><script type="math/tex" id="MathJax-Element-248">[-1, 1].</script></span></li>
<li><span>Отцентрирована (симметрична относительно </span><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-249-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 118%; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mo stretchy=&quot;false&quot;>(</mo><mn>0</mn><mo>,</mo><mn>0</mn><mo stretchy=&quot;false&quot;>)</mo></math>" role="presentation"><span id="MJXc-Node-4048" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-4049" class="mjx-mrow"><span id="MJXc-Node-4050" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.479em; padding-bottom: 0.585em;">(</span></span><span id="MJXc-Node-4051" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.373em; padding-bottom: 0.373em;">0</span></span><span id="MJXc-Node-4052" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="margin-top: -0.156em; padding-bottom: 0.532em;">,</span></span><span id="MJXc-Node-4053" class="mjx-mn MJXc-space1"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.373em; padding-bottom: 0.373em;">0</span></span><span id="MJXc-Node-4054" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.479em; padding-bottom: 0.585em;">)</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo stretchy="false">(</mo><mn>0</mn><mo>,</mo><mn>0</mn><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-249">(0, 0)</script></span><span>).</span></li>
<li><span>Всё ещё имеется проблема </span><em><span>затухания градиентов</span></em><span>.</span></li>
</ul>
</li>
<li><span>ReLU (Rectified Linear Unit): </span><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-250-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 118%; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>f</mi><mo stretchy=&quot;false&quot;>(</mo><mi>x</mi><mo stretchy=&quot;false&quot;>)</mo><mo>=</mo><mo movablelimits=&quot;true&quot; form=&quot;prefix&quot;>max</mo><mo stretchy=&quot;false&quot;>(</mo><mn>0</mn><mo>,</mo><mi>x</mi><mo stretchy=&quot;false&quot;>)</mo><mo>.</mo></math>" role="presentation"><span id="MJXc-Node-4055" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-4056" class="mjx-mrow"><span id="MJXc-Node-4057" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.479em; padding-right: 0.06em;">f</span></span><span id="MJXc-Node-4058" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.479em; padding-bottom: 0.585em;">(</span></span><span id="MJXc-Node-4059" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.215em; padding-bottom: 0.267em;">x</span></span><span id="MJXc-Node-4060" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.479em; padding-bottom: 0.585em;">)</span></span><span id="MJXc-Node-4061" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.056em; padding-bottom: 0.32em;">=</span></span><span id="MJXc-Node-4062" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.162em; padding-bottom: 0.373em;">max</span></span><span id="MJXc-Node-4063" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.479em; padding-bottom: 0.585em;">(</span></span><span id="MJXc-Node-4064" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.373em; padding-bottom: 0.373em;">0</span></span><span id="MJXc-Node-4065" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="margin-top: -0.156em; padding-bottom: 0.532em;">,</span></span><span id="MJXc-Node-4066" class="mjx-mi MJXc-space1"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.215em; padding-bottom: 0.267em;">x</span></span><span id="MJXc-Node-4067" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.479em; padding-bottom: 0.585em;">)</span></span><span id="MJXc-Node-4068" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="margin-top: -0.156em; padding-bottom: 0.32em;">.</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>f</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mo>=</mo><mo movablelimits="true" form="prefix">max</mo><mo stretchy="false">(</mo><mn>0</mn><mo>,</mo><mi>x</mi><mo stretchy="false">)</mo><mo>.</mo></math></span></span><script type="math/tex" id="MathJax-Element-250">f(x) = \max(0, x).</script></span>
<ul>
<li><span>Градиенты не затухают при положительных входных значениях.</span></li>
<li><span>Крайне быстро вычисляется.</span></li>
<li><span>На практике методы оптимизации для сетей с ReLU гораздо быстрее сходятся.</span></li>
<li><span>Недостатки: не центрирована (смещена в область положительных значений), в области отрицательных значений градиент затухает</span></li>
</ul>
</li>
<li><span>Проблему ReLU с градиентами при </span><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-251-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 118%; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>x</mi><mo>&amp;lt;</mo><mn>0</mn></math>" role="presentation"><span id="MJXc-Node-4069" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-4070" class="mjx-mrow"><span id="MJXc-Node-4071" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.215em; padding-bottom: 0.267em;">x</span></span><span id="MJXc-Node-4072" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.267em; padding-bottom: 0.373em;">&lt;</span></span><span id="MJXc-Node-4073" class="mjx-mn MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.373em; padding-bottom: 0.373em;">0</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>x</mi><mo>&lt;</mo><mn>0</mn></math></span></span><script type="math/tex" id="MathJax-Element-251">x < 0</script></span><span> исправляет LeakyReLU: </span><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-252-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 118%; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>f</mi><mo stretchy=&quot;false&quot;>(</mo><mi>x</mi><mo stretchy=&quot;false&quot;>)</mo><mo>=</mo><mo movablelimits=&quot;true&quot; form=&quot;prefix&quot;>max</mo><mo stretchy=&quot;false&quot;>(</mo><mn>0.01</mn><mi>x</mi><mo>,</mo><mi>x</mi><mo stretchy=&quot;false&quot;>)</mo><mo>.</mo></math>" role="presentation"><span id="MJXc-Node-4074" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-4075" class="mjx-mrow"><span id="MJXc-Node-4076" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.479em; padding-right: 0.06em;">f</span></span><span id="MJXc-Node-4077" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.479em; padding-bottom: 0.585em;">(</span></span><span id="MJXc-Node-4078" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.215em; padding-bottom: 0.267em;">x</span></span><span id="MJXc-Node-4079" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.479em; padding-bottom: 0.585em;">)</span></span><span id="MJXc-Node-4080" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.056em; padding-bottom: 0.32em;">=</span></span><span id="MJXc-Node-4081" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.162em; padding-bottom: 0.373em;">max</span></span><span id="MJXc-Node-4082" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.479em; padding-bottom: 0.585em;">(</span></span><span id="MJXc-Node-4083" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.373em; padding-bottom: 0.373em;">0.01</span></span><span id="MJXc-Node-4084" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.215em; padding-bottom: 0.267em;">x</span></span><span id="MJXc-Node-4085" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="margin-top: -0.156em; padding-bottom: 0.532em;">,</span></span><span id="MJXc-Node-4086" class="mjx-mi MJXc-space1"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.215em; padding-bottom: 0.267em;">x</span></span><span id="MJXc-Node-4087" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.479em; padding-bottom: 0.585em;">)</span></span><span id="MJXc-Node-4088" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="margin-top: -0.156em; padding-bottom: 0.32em;">.</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>f</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mo>=</mo><mo movablelimits="true" form="prefix">max</mo><mo stretchy="false">(</mo><mn>0.01</mn><mi>x</mi><mo>,</mo><mi>x</mi><mo stretchy="false">)</mo><mo>.</mo></math></span></span><script type="math/tex" id="MathJax-Element-252">f(x) = \max(0.01x, x).</script></span>
<ul>
<li><span>Имеет те же преимущества что и ReLU, но градиент в области отрицательных значений не равен 0.</span></li>
<li><span>Если вместо </span><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-253-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 118%; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mn>0.01</mn></math>" role="presentation"><span id="MJXc-Node-4089" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-4090" class="mjx-mrow"><span id="MJXc-Node-4091" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.373em; padding-bottom: 0.373em;">0.01</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mn>0.01</mn></math></span></span><script type="math/tex" id="MathJax-Element-253">0.01</script></span><span> в формуле использовать обучаемый параметр </span><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-254-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 118%; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>&amp;#x03B1;</mi><mo>,</mo></math>" role="presentation"><span id="MJXc-Node-4092" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-4093" class="mjx-mrow"><span id="MJXc-Node-4094" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.215em; padding-bottom: 0.267em;">α</span></span><span id="MJXc-Node-4095" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="margin-top: -0.156em; padding-bottom: 0.532em;">,</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>α</mi><mo>,</mo></math></span></span><script type="math/tex" id="MathJax-Element-254">\alpha,</script></span><span> то получим Parametric Rectifier (PReLU).</span></li>
</ul>
</li>
<li><span>ELU (Exponential Linear Unit):</span><br>
<span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span class="mjx-chtml MJXc-display" style="text-align: center;"><span id="MathJax-Element-255-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 118%; text-align: center; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><mi>f</mi><mo stretchy=&quot;false&quot;>(</mo><mi>x</mi><mo stretchy=&quot;false&quot;>)</mo><mo>=</mo><mrow><mo>{</mo><mtable columnalign=&quot;left left&quot; rowspacing=&quot;.2em&quot; columnspacing=&quot;1em&quot; displaystyle=&quot;false&quot;><mtr><mtd><mi>x</mi><mo>,</mo></mtd><mtd><mtext>&amp;#xA0;if&amp;#xA0;</mtext><mi>x</mi><mo>&amp;gt;</mo><mn>0</mn></mtd></mtr><mtr><mtd><mi>&amp;#x03B1;</mi><mo stretchy=&quot;false&quot;>(</mo><mi>exp</mi><mo>&amp;#x2061;</mo><mo stretchy=&quot;false&quot;>(</mo><mi>x</mi><mo stretchy=&quot;false&quot;>)</mo><mo>+</mo><mn>1</mn><mo stretchy=&quot;false&quot;>)</mo><mo>,</mo></mtd><mtd><mtext>&amp;#xA0;if&amp;#xA0;</mtext><mi>x</mi><mo>&amp;#x2A7D;</mo><mn>0</mn></mtd></mtr></mtable><mo fence=&quot;true&quot; stretchy=&quot;true&quot; symmetric=&quot;true&quot;></mo></mrow></math>" role="presentation"><span id="MJXc-Node-4096" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-4097" class="mjx-mrow"><span id="MJXc-Node-4098" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.479em; padding-right: 0.06em;">f</span></span><span id="MJXc-Node-4099" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.479em; padding-bottom: 0.585em;">(</span></span><span id="MJXc-Node-4100" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.215em; padding-bottom: 0.267em;">x</span></span><span id="MJXc-Node-4101" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.479em; padding-bottom: 0.585em;">)</span></span><span id="MJXc-Node-4102" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.056em; padding-bottom: 0.32em;">=</span></span><span id="MJXc-Node-4103" class="mjx-mrow MJXc-space3"><span id="MJXc-Node-4104" class="mjx-mo"><span class="mjx-char MJXc-TeX-size3-R" style="padding-top: 1.221em; padding-bottom: 1.221em;">{</span></span><span id="MJXc-Node-4105" class="mjx-mtable" style="vertical-align: -0.897em; padding: 0px 0.167em;"><span class="mjx-table"><span id="MJXc-Node-4106" class="mjx-mtr" style="height: 1.119em;"><span id="MJXc-Node-4107" class="mjx-mtd" style="padding: 0px 0.5em 0px 0px; text-align: left; width: 6.296em;"><span id="MJXc-Node-4108" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-4109" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.215em; padding-bottom: 0.267em;">x</span></span><span id="MJXc-Node-4110" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="margin-top: -0.156em; padding-bottom: 0.532em;">,</span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-4111" class="mjx-mtd" style="padding: 0px 0px 0px 0.5em; text-align: left; width: 3.49em;"><span id="MJXc-Node-4112" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-4113" class="mjx-mtext"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.426em; padding-bottom: 0.32em;">&nbsp;if&nbsp;</span></span><span id="MJXc-Node-4114" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.215em; padding-bottom: 0.267em;">x</span></span><span id="MJXc-Node-4115" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.267em; padding-bottom: 0.373em;">&gt;</span></span><span id="MJXc-Node-4116" class="mjx-mn MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.373em; padding-bottom: 0.373em;">0</span></span><span class="mjx-strut"></span></span></span></span><span id="MJXc-Node-4117" class="mjx-mtr" style="height: 1.175em;"><span id="MJXc-Node-4118" class="mjx-mtd" style="padding: 0.1em 0.5em 0px 0px; text-align: left;"><span id="MJXc-Node-4119" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-4120" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.215em; padding-bottom: 0.267em;">α</span></span><span id="MJXc-Node-4121" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.479em; padding-bottom: 0.585em;">(</span></span><span id="MJXc-Node-4122" class="mjx-mi"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.162em; padding-bottom: 0.532em;">exp</span></span><span id="MJXc-Node-4123" class="mjx-mo"><span class="mjx-char"></span></span><span id="MJXc-Node-4124" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.479em; padding-bottom: 0.585em;">(</span></span><span id="MJXc-Node-4125" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.215em; padding-bottom: 0.267em;">x</span></span><span id="MJXc-Node-4126" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.479em; padding-bottom: 0.585em;">)</span></span><span id="MJXc-Node-4127" class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.32em; padding-bottom: 0.426em;">+</span></span><span id="MJXc-Node-4128" class="mjx-mn MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.373em; padding-bottom: 0.32em;">1</span></span><span id="MJXc-Node-4129" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.479em; padding-bottom: 0.585em;">)</span></span><span id="MJXc-Node-4130" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="margin-top: -0.156em; padding-bottom: 0.532em;">,</span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-4131" class="mjx-mtd" style="padding: 0.1em 0px 0px 0.5em; text-align: left;"><span id="MJXc-Node-4132" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-4133" class="mjx-mtext"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.426em; padding-bottom: 0.32em;">&nbsp;if&nbsp;</span></span><span id="MJXc-Node-4134" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.215em; padding-bottom: 0.267em;">x</span></span><span id="MJXc-Node-4135" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-ams-R" style="padding-top: 0.373em; padding-bottom: 0.426em;">⩽</span></span><span id="MJXc-Node-4136" class="mjx-mn MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.373em; padding-bottom: 0.373em;">0</span></span><span class="mjx-strut"></span></span></span></span></span></span><span id="MJXc-Node-4137" class="mjx-mo" style="width: 0.12em;"></span></span></span></span><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mi>f</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mo>=</mo><mrow><mo>{</mo><mtable columnalign="left left" rowspacing=".2em" columnspacing="1em" displaystyle="false"><mtr><mtd><mi>x</mi><mo>,</mo></mtd><mtd><mtext>&nbsp;if&nbsp;</mtext><mi>x</mi><mo>&gt;</mo><mn>0</mn></mtd></mtr><mtr><mtd><mi>α</mi><mo stretchy="false">(</mo><mi>exp</mi><mo>⁡</mo><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mo>+</mo><mn>1</mn><mo stretchy="false">)</mo><mo>,</mo></mtd><mtd><mtext>&nbsp;if&nbsp;</mtext><mi>x</mi><mo>⩽</mo><mn>0</mn></mtd></mtr></mtable><mo fence="true" stretchy="true" symmetric="true"></mo></mrow></math></span></span></span><script type="math/tex; mode=display" id="MathJax-Element-255">
 f(x) = \begin{cases}
     x, &\text{ if } x > 0\\
     \alpha(\exp(x) + 1), &\text{ if } x \leqslant 0
 \end{cases}
</script></span>
<ul>
<li><span>Имеет все преимущества ReLU.</span></li>
<li><span>Требует вычисления экспоненты.</span></li>
<li><span>Редко встречается на практике.</span></li>
</ul>
</li>
</ul><h3 id="17-Matrix-convolution-Convoluational-layer-backpropagation-through-it-1x1-convolutions-comparison-to-Dense-layers-MaxAverage-Pooling" data-id="17-Matrix-convolution-Convoluational-layer-backpropagation-through-it-1x1-convolutions-comparison-to-Dense-layers-MaxAverage-Pooling"><a class="anchor hidden-xs" href="#17-Matrix-convolution-Convoluational-layer-backpropagation-through-it-1x1-convolutions-comparison-to-Dense-layers-MaxAverage-Pooling" title="17-Matrix-convolution-Convoluational-layer-backpropagation-through-it-1x1-convolutions-comparison-to-Dense-layers-MaxAverage-Pooling"><span class="octicon octicon-link"></span></a><span>17. Matrix convolution. Convoluational layer, backpropagation through it. 1x1 convolutions, comparison to Dense layers. Max/Average Pooling.</span></h3><ul>
<li><strong><span>Matrix convolution.</span></strong><span> Операция свёртки для матриц, определяется следующим образом:</span><br>
<span>Выбирается определённый фильтр, который также называется ядром свёртки. По сути это линейная функция, которая применяется к некоторой квадратной подматрице размера (</span><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-256-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 118%; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>k</mi><mo>&amp;#x00D7;</mo><mi>k</mi></math>" role="presentation"><span id="MJXc-Node-4138" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-4139" class="mjx-mrow"><span id="MJXc-Node-4140" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.267em;">k</span></span><span id="MJXc-Node-4141" class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.215em; padding-bottom: 0.32em;">×</span></span><span id="MJXc-Node-4142" class="mjx-mi MJXc-space2"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.267em;">k</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>k</mi><mo>×</mo><mi>k</mi></math></span></span><script type="math/tex" id="MathJax-Element-256">k \times k</script></span><span>). Пространственные размеры меньше (то есть </span><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-257-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 118%; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>k</mi></math>" role="presentation"><span id="MJXc-Node-4143" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-4144" class="mjx-mrow"><span id="MJXc-Node-4145" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.267em;">k</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>k</mi></math></span></span><script type="math/tex" id="MathJax-Element-257">k</script></span><span> обязательно меньше размера исходной матрицы хотя бы на 1).</span><br>
<span>Соответственно, значение фильтра на каждой подматрице размер которой совпадает с размером фильтра — одно число. Составим из этих чисел новую матрицу. Она и будет являться результатом операции свёртки.</span></li>
<li><strong><span>Convolutional layer.</span></strong><span> Изображение отличается от матрицы только наличием третьего измперения (каналов). Потребуем от фильтра, чтобы он также имел глубину равную глубине входных данных для нашего слоя. Тогда результат операции свёртки к входным данным и будет результатом работы слоя. Заметим, что можно в одном слое определить несколько фильтров и обучать их одновременно. Тогда у результата работы слоя также появится глубина, равная количеству фильтров, использовавшихся в слое.</span></li>
<li><strong><span>Padding.</span></strong><span> В случае если мы хотим, чтобы свёрточный слой не изменял длину и ширину входного тензора, мы можем увелиить размеры входных данных добавив по краям нулевые значения. На линейное преобразование это не повлияет, но мы сможем извлекать какие-то признаки из значений, близких к краям тензора.</span></li>
<li><strong><span>Stride.</span></strong><span> Приём использующийся для ускорения вычислений — вместо того чтобы сдвигать фильтр по одному пикселю при вычислении результата свёртки, увелими этот размер шага. Эта операция уменьшает размер результата работы слоя.</span></li>
<li><span>Заметим, что в свёрточном слое количество параметров на порядки меньше чем в полносвязном слое.</span></li>
<li><span>Свёртка 1 на 1 переводит пиксели всех каналов (или один “ряд в глубину”) тензора в одно число. Если испольщовать несколько фильтров 1 на 1,то мы можем таким образом просто варьировать число каналов (глубину нашего тензора). По сути это некоторый аналог линейного слоя, который сохраняет структуру в данных.</span></li>
<li><strong><span>Pooling.</span></strong><span> Приём использующийся для сжатия тензоров вдоль длины и ширины. Например, поделим матрицу в каждом канале на непересекающиеся подматрицы по 4 клетки. Затем каждой такой подматрице поставим в соответствие одно число — максимум или среднее элементов подматрицы.</span><br>
<img src="https://i.imgur.com/h6VayEC.png" alt=""></li>
</ul><h3 id="18-Seq2-something-Recurrence-as-proxy-to-work-with-local-context" data-id="18-Seq2-something-Recurrence-as-proxy-to-work-with-local-context"><a class="anchor hidden-xs" href="#18-Seq2-something-Recurrence-as-proxy-to-work-with-local-context" title="18-Seq2-something-Recurrence-as-proxy-to-work-with-local-context"><span class="octicon octicon-link"></span></a><span>18. Seq2 something. Recurrence as proxy to work with local context.</span></h3><ul>
<li><span>Sequence2Sequence — нейронная сеть, состоящая из двух рекуррентных слоёв. Применяется, например в задаче перевода.</span>
<ul>
<li><span>Первая нейронная сеть кодирует данную ей последовательность (преобразовывает её в последовательность скрытых состояний) и передаёт второй сети.</span></li>
<li><span>Вторая сеть использует данное скрытое состояние как начальное и генерирует перевод.</span></li>
<li><span>Вся модель обучается целиком.</span></li>
<li><span>Легко обобщить этот концепт на sequence2something. Можно использовать финальное скрытое состояние как входные данные для другой нейронной сети или совсем другого алгоритма, решающего какую либо задачу. Такой подход будет эффективным, так как по построению мы храним в скрытом состоянии информацию обо всей последовательности.</span><br>
<img src="https://i.imgur.com/ThUtLJq.png" alt=""></li>
</ul>
</li>
<li><span>Простая рекуррентная нейронная сеть описывается формулой </span><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-258-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 118%; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>tanh</mi><mo>&amp;#x2061;</mo><mo stretchy=&quot;false&quot;>(</mo><mi>W</mi><mi>z</mi><mo>+</mo><mi>b</mi><mo stretchy=&quot;false&quot;>)</mo><mo>,</mo></math>" role="presentation"><span id="MJXc-Node-4146" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-4147" class="mjx-mrow"><span id="MJXc-Node-4148" class="mjx-mi"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.426em; padding-bottom: 0.373em;">tanh</span></span><span id="MJXc-Node-4149" class="mjx-mo"><span class="mjx-char"></span></span><span id="MJXc-Node-4150" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.479em; padding-bottom: 0.585em;">(</span></span><span id="MJXc-Node-4151" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.32em; padding-right: 0.104em;">W</span></span><span id="MJXc-Node-4152" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.215em; padding-bottom: 0.267em; padding-right: 0.003em;">z</span></span><span id="MJXc-Node-4153" class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.32em; padding-bottom: 0.426em;">+</span></span><span id="MJXc-Node-4154" class="mjx-mi MJXc-space2"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.267em;">b</span></span><span id="MJXc-Node-4155" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.479em; padding-bottom: 0.585em;">)</span></span><span id="MJXc-Node-4156" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="margin-top: -0.156em; padding-bottom: 0.532em;">,</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>tanh</mi><mo>⁡</mo><mo stretchy="false">(</mo><mi>W</mi><mi>z</mi><mo>+</mo><mi>b</mi><mo stretchy="false">)</mo><mo>,</mo></math></span></span><script type="math/tex" id="MathJax-Element-258">\tanh(Wz + b),</script></span><span> где </span><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-259-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 118%; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>z</mi></math>" role="presentation"><span id="MJXc-Node-4157" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-4158" class="mjx-mrow"><span id="MJXc-Node-4159" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.215em; padding-bottom: 0.267em; padding-right: 0.003em;">z</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>z</mi></math></span></span><script type="math/tex" id="MathJax-Element-259">z</script></span><span> — конкатенация векторов скрытого состояния и входного объекта сети.</span>
<ul>
<li><span>Наличие вектора скрытого состояния или контекста является общей чертой всех рекуррентных сетей. Он используется для хранения информации обо всех предыдущих объектах последовательности.</span></li>
</ul>
</li>
<li><span>Однако, из-за того факта, что чем длиннее последовательность, тем сильнее затухают градиенты оутпута по первым объектам последовательности (из-за многократного умножения на градиент гиперболического тангенса, который может быть очень близок к 0 на некоторых объектах), при обучении такой нейронной сети она больше фокусируется на тех объектах, которые расположены ближе к ней, т.к. она ещё не успела “забыть” про них.</span></li>
</ul><h3 id="19-LSTMGRU-memory-concept-gates-ideas" data-id="19-LSTMGRU-memory-concept-gates-ideas"><a class="anchor hidden-xs" href="#19-LSTMGRU-memory-concept-gates-ideas" title="19-LSTMGRU-memory-concept-gates-ideas"><span class="octicon octicon-link"></span></a><span>19. LSTM/GRU, memory concept, gates ideas.</span></h3><ul>
<li><span>Основным недостатком базовой архитектуры RNN является то, что скрытое состояние меняется на каждом новом входе. Т.е. слой не может игнорировать какие-то выбросы/нежелательные объекты.</span></li>
<li><span>Поэтому вместо базовой архитектуры часто используются </span><strong><span>LSTM</span></strong><span> (Long-Short-Term Memory) ячейки, в которых реализованы концепты </span><em><span>краткосрочной и долгосрочной</span></em><span> памяти.</span></li>
<li><span>Постараемся объяснить принцип работы LSTM, опираясь на иллюстрацию ниже:</span>
<ul>
<li><span>В LSTM ячейке в любой момент есть три вектора: инпут </span><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-260-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 118%; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>x</mi><mi>t</mi></msub></math>" role="presentation"><span id="MJXc-Node-4160" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-4161" class="mjx-mrow"><span id="MJXc-Node-4162" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-4163" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.215em; padding-bottom: 0.267em;">x</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-4164" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.426em; padding-bottom: 0.267em;">t</span></span></span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>x</mi><mi>t</mi></msub></math></span></span><script type="math/tex" id="MathJax-Element-260">x_t</script></span><span> — очередной объект последовательности, контекст (краткосрочная память) </span><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-261-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 118%; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>h</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>t</mi><mo>&amp;#x2212;</mo><mn>1</mn></mrow></msub></math>" role="presentation"><span id="MJXc-Node-4165" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-4166" class="mjx-mrow"><span id="MJXc-Node-4167" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-4168" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.267em;">h</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-4169" class="mjx-texatom" style=""><span id="MJXc-Node-4170" class="mjx-mrow"><span id="MJXc-Node-4171" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.426em; padding-bottom: 0.267em;">t</span></span><span id="MJXc-Node-4172" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.32em; padding-bottom: 0.426em;">−</span></span><span id="MJXc-Node-4173" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.373em; padding-bottom: 0.32em;">1</span></span></span></span></span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>h</mi><mrow class="MJX-TeXAtom-ORD"><mi>t</mi><mo>−</mo><mn>1</mn></mrow></msub></math></span></span><script type="math/tex" id="MathJax-Element-261">h_{t - 1}</script></span><span> — по сути скрытое состояние из базовой архитектуры и долгосрочная память </span><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-262-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 118%; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>c</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>t</mi><mo>&amp;#x2212;</mo><mn>1</mn></mrow></msub></math>" role="presentation"><span id="MJXc-Node-4174" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-4175" class="mjx-mrow"><span id="MJXc-Node-4176" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-4177" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.215em; padding-bottom: 0.267em;">c</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-4178" class="mjx-texatom" style=""><span id="MJXc-Node-4179" class="mjx-mrow"><span id="MJXc-Node-4180" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.426em; padding-bottom: 0.267em;">t</span></span><span id="MJXc-Node-4181" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.32em; padding-bottom: 0.426em;">−</span></span><span id="MJXc-Node-4182" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.373em; padding-bottom: 0.32em;">1</span></span></span></span></span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>c</mi><mrow class="MJX-TeXAtom-ORD"><mi>t</mi><mo>−</mo><mn>1</mn></mrow></msub></math></span></span><script type="math/tex" id="MathJax-Element-262">c_{t - 1}</script></span><span> — вектор, в котором реализована возможность выборочно “забывать” информацию.</span></li>
<li><span>Сделаем важное пояснение — гейтом (фильтром) по сути является сигмоида над линейным преобразованием. Каждый гейт в процессе обучения всей ячейки обучается на задачу бинарной классификации — хотим мы запоминать объект или нет.</span></li>
<li><span>Допустим в ячейку попал новый объект последовательности. Вычисления происходят следующим образом:</span>
<ul>
<li><span>Сначала конкатенируются скрытое состояние и вход слоя. Далее они никогда не используются по отдельности. Назовём полученный вектор “данными ячейки”.</span></li>
<li><span>На данных ячейки используется </span><em><span>forget gate,</span></em><span> чтобы определить, какую информацию мы будем выкидывать из долгосрочной памяти. Далее вектор долгосрочной памяти обновляется умножением на forget gate (мы “забываем” какую-то инфорацию).</span></li>
<li><span>Затем мы используем </span><em><span>input gate</span></em><span> на данных ячейки чтобы определить, какую информацию мы хотим добавить в долгосрочную память. После этого мы используем </span><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-263-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 118%; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>tanh</mi></math>" role="presentation"><span id="MJXc-Node-4183" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-4184" class="mjx-mrow"><span id="MJXc-Node-4185" class="mjx-mi"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.426em; padding-bottom: 0.373em;">tanh</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>tanh</mi></math></span></span><script type="math/tex" id="MathJax-Element-263">\tanh</script></span><span> на данных ячейки (тот момент, в котором в преобразованиях ячейки появляется нелинейность). Далее преобразованные данные ячейки умножаются на input gate (отбор информации для запоминания) и складываются с долгосрочной памятью (запоминание).</span></li>
<li><span>Последний шаг — обновление скрытого состояния и возвращение результата. Для этого мы применяем </span><em><span>output gate</span></em><span> к данным ячейки (выбираем, какая информация из долгосрочной памяти попадёт в результат). После этого применяем </span><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-264-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 118%; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>tanh</mi></math>" role="presentation"><span id="MJXc-Node-4186" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-4187" class="mjx-mrow"><span id="MJXc-Node-4188" class="mjx-mi"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.426em; padding-bottom: 0.373em;">tanh</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>tanh</mi></math></span></span><script type="math/tex" id="MathJax-Element-264">\tanh</script></span><span> к долгосрочной памяти (она уже содержит информацию о текущем входе и скрытом состоянии, если модель посчитала их релевантными) и умножаем её на output gate. Получившийся вектор используем как результат слоя и новое скрытое состояние.</span><br>
<img src="https://i.imgur.com/X0jMGH9.png" alt=""><br>
<img src="https://i.imgur.com/TGEE1Od.png" alt=""></li>
</ul>
</li>
</ul>
</li>
<li><strong><span>GRU</span></strong><span> (Gate Recurrent Unit) называется ячейка, архитектура которых схожа с LSTM, но в них отсутсвует output gate, поэтому она имеет меньше параметров. В среднем работает немного быстрее чем LSTM, но запоминает чуть “хуже”.</span><br>
<img src="https://i.imgur.com/KNWouIc.png" alt=""><br>
<img src="https://i.imgur.com/1IQ9vJ6.png" alt=""></li>
</ul><h3 id="20-Vanishing-gradient-problem-Potential-solutions" data-id="20-Vanishing-gradient-problem-Potential-solutions"><a class="anchor hidden-xs" href="#20-Vanishing-gradient-problem-Potential-solutions" title="20-Vanishing-gradient-problem-Potential-solutions"><span class="octicon octicon-link"></span></a><span>20. Vanishing gradient problem. Potential solutions.</span></h3><ul>
<li><span>Основное проблемой рекуррентных сетей является </span><strong><span>проблема затухающего градиента</span></strong><span>. Так как мы использовали ограниченные функции активации, то для некоторых объектов мы можем получить достаточно маленькие значения градиентов. Учитывая, что глубина рекуррентной сети растёт с глубиной последовательности, на которой мы работаем, при бэкпропе во время перемножения градиентов на самых первых элементах последовательности мы получаем практически нулевой градиент и не можем настроить параметры модели.</span>
<ul>
<li><span>Заметим, что такая проблема присуща не только рекуррентным сетям, но и любым глубоким сетям вообще.</span></li>
</ul>
</li>
<li><span>Из-за этой проблемы модель в ходе обучения будет обращать гораздо больше внимания на вклад ближайших к выбранному объектов и почти не будет обращать внимание на вклад объекта в функцию потерь на объекте, который отстоит далеко от него.</span><br>
<img src="https://i.imgur.com/mn5aBfP.png" alt=""></li>
<li><span>Однако, архитектура LSTM по умолчанию умеет решать проблему затухающих градиентов. Посмотрим на преобразования, которые происходят с долгсрочной памятью. Там имеет место только умножение, сложение и </span><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-265-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 118%; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>tanh</mi></math>" role="presentation"><span id="MJXc-Node-4189" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-4190" class="mjx-mrow"><span id="MJXc-Node-4191" class="mjx-mi"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.426em; padding-bottom: 0.373em;">tanh</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>tanh</mi></math></span></span><script type="math/tex" id="MathJax-Element-265">\tanh</script></span><span> для получения результата. То есть результат и долгосрочная память отделены только одной функцией активации. Соответственно, когда мы для этого результата посчитаем градиент по долгосрочной памяти, дальше этот градиент никогда не затухнет, и в долгосрочной памяти будет информация про конкретно этот вывод ячейки.</span></li>
</ul><h3 id="21-Работа-с-категориальными-признаками-и-пропущенными-значениями-Mean-encoding" data-id="21-Работа-с-категориальными-признаками-и-пропущенными-значениями-Mean-encoding"><a class="anchor hidden-xs" href="#21-Работа-с-категориальными-признаками-и-пропущенными-значениями-Mean-encoding" title="21-Работа-с-категориальными-признаками-и-пропущенными-значениями-Mean-encoding"><span class="octicon octicon-link"></span></a><span>21. Работа с категориальными признаками и пропущенными значениями. Mean encoding.</span></h3><ul>
<li><span>Напомним, что </span><strong><span>категориальными</span></strong><span> называются те признаки, значения которых лежат в фиксированном заранее множестве. На этом множестве обычно нельзя установить какой-либо порядок</span></li>
<li><span>Основной метод работы с категориальными признаками — </span><strong><span>one-hot encoding</span></strong><span>. Пусть категориальный признак может принимать </span><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-266-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 118%; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>k</mi></math>" role="presentation"><span id="MJXc-Node-4192" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-4193" class="mjx-mrow"><span id="MJXc-Node-4194" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.267em;">k</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>k</mi></math></span></span><script type="math/tex" id="MathJax-Element-266">k</script></span><span> значений. Тогда вместо него мы добавляем в выборку </span><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-267-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 118%; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>k</mi></math>" role="presentation"><span id="MJXc-Node-4195" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-4196" class="mjx-mrow"><span id="MJXc-Node-4197" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.267em;">k</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>k</mi></math></span></span><script type="math/tex" id="MathJax-Element-267">k</script></span><span> бинарных признаков. Если изначальный категориальный признак принимало </span><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-268-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 118%; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>i</mi></math>" role="presentation"><span id="MJXc-Node-4198" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-4199" class="mjx-mrow"><span id="MJXc-Node-4200" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.426em; padding-bottom: 0.267em;">i</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>i</mi></math></span></span><script type="math/tex" id="MathJax-Element-268">i</script></span><span>-ое значение, то значение </span><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-269-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 118%; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>i</mi></math>" role="presentation"><span id="MJXc-Node-4201" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-4202" class="mjx-mrow"><span id="MJXc-Node-4203" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.426em; padding-bottom: 0.267em;">i</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>i</mi></math></span></span><script type="math/tex" id="MathJax-Element-269">i</script></span><span>-ого бинарного признака выставляется единицей, а остальные — нулями.</span>
<ul>
<li><span>Основной минус этого подхода — если у нас много категориальных признаков и/или у них много возможных значений, то мы сильно увеличиваем размер нашей матрицы признаков.</span></li>
</ul>
</li>
<li><span>Другой способ кодирования категориальных признаков признаков — </span><strong><span>Mean encoding</span></strong><span>. Может использоваться в задачах бинарной классификации. Вместо категориального признака мы вводим числовой, значения которого равны отношениям количества объектов положительного класса с этим значением кат. признака к общему количеству объектов в положительном классе.</span><br>
<span>Пусть категориальный признак для </span><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-270-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 118%; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>i</mi></math>" role="presentation"><span id="MJXc-Node-4204" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-4205" class="mjx-mrow"><span id="MJXc-Node-4206" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.426em; padding-bottom: 0.267em;">i</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>i</mi></math></span></span><script type="math/tex" id="MathJax-Element-270">i</script></span><span>-ого объекта был равен </span><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-271-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 118%; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>k</mi><mo>.</mo></math>" role="presentation"><span id="MJXc-Node-4207" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-4208" class="mjx-mrow"><span id="MJXc-Node-4209" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.267em;">k</span></span><span id="MJXc-Node-4210" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="margin-top: -0.156em; padding-bottom: 0.32em;">.</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>k</mi><mo>.</mo></math></span></span><script type="math/tex" id="MathJax-Element-271">k.</script></span><span> Тогда значение нового признака </span><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-272-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 118%; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>l</mi><mi>i</mi></msub></math>" role="presentation"><span id="MJXc-Node-4211" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-4212" class="mjx-mrow"><span id="MJXc-Node-4213" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-4214" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.267em;">l</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-4215" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.426em; padding-bottom: 0.267em;">i</span></span></span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>l</mi><mi>i</mi></msub></math></span></span><script type="math/tex" id="MathJax-Element-272">l_i</script></span><span>:</span><br>
<span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span class="mjx-chtml MJXc-display" style="text-align: center;"><span id="MathJax-Element-273-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 118%; text-align: center; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><msub><mi>l</mi><mi>i</mi></msub><mo>=</mo><mfrac><mrow><munderover><mo movablelimits=&quot;false&quot;>&amp;#x2211;</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>n</mi></munderover><mi mathvariant=&quot;normal&quot;>&amp;#x0023;</mi><mo stretchy=&quot;false&quot;>(</mo><mtext>&amp;#x41E;&amp;#x431;&amp;#x44A;&amp;#x435;&amp;#x43A;&amp;#x442;&amp;#x43E;&amp;#x432; &amp;#x43F;&amp;#x43E;&amp;#x43B;&amp;#x43E;&amp;#x436;&amp;#x438;&amp;#x442;&amp;#x435;&amp;#x43B;&amp;#x44C;&amp;#x43D;&amp;#x43E;&amp;#x433;&amp;#x43E; &amp;#x43A;&amp;#x43B;&amp;#x430;&amp;#x441;&amp;#x441;&amp;#x430; &amp;#x441;&amp;#x43E; &amp;#x437;&amp;#x43D;&amp;#x430;&amp;#x447;&amp;#x435;&amp;#x43D;&amp;#x438;&amp;#x435;&amp;#x43C; &amp;#x43F;&amp;#x440;&amp;#x438;&amp;#x437;&amp;#x43D;&amp;#x430;&amp;#x43A;&amp;#x430;&amp;#xA0;</mtext><mi>k</mi><mo stretchy=&quot;false&quot;>)</mo></mrow><mrow><munderover><mo movablelimits=&quot;false&quot;>&amp;#x2211;</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>n</mi></munderover><mi mathvariant=&quot;normal&quot;>&amp;#x0023;</mi><mo stretchy=&quot;false&quot;>(</mo><mtext>&amp;#x41E;&amp;#x431;&amp;#x44A;&amp;#x435;&amp;#x43A;&amp;#x442;&amp;#x43E;&amp;#x432; &amp;#x43F;&amp;#x43E;&amp;#x43B;&amp;#x43E;&amp;#x436;&amp;#x438;&amp;#x442;&amp;#x435;&amp;#x43B;&amp;#x44C;&amp;#x43D;&amp;#x43E;&amp;#x433;&amp;#x43E; &amp;#x43A;&amp;#x43B;&amp;#x430;&amp;#x441;&amp;#x441;&amp;#x430;</mtext><mo stretchy=&quot;false&quot;>)</mo></mrow></mfrac></math>" role="presentation"><span id="MJXc-Node-4216" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-4217" class="mjx-mrow"><span id="MJXc-Node-4218" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-4219" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.267em;">l</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-4220" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.426em; padding-bottom: 0.267em;">i</span></span></span></span><span id="MJXc-Node-4221" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.056em; padding-bottom: 0.32em;">=</span></span><span id="MJXc-Node-4222" class="mjx-mfrac MJXc-space3"><span class="mjx-box MJXc-stacked" style="width: 28.409em; padding: 0px 0.12em;"><span class="mjx-numerator" style="width: 28.409em; top: -2.936em;"><span id="MJXc-Node-4223" class="mjx-mrow"><span id="MJXc-Node-4224" class="mjx-munderover"><span class="mjx-itable"><span class="mjx-row"><span class="mjx-cell"><span class="mjx-stack"><span class="mjx-over" style="font-size: 70.7%; padding-bottom: 0.247em; padding-top: 0.141em; padding-left: 0.512em;"><span id="MJXc-Node-4231" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.215em; padding-bottom: 0.267em;">n</span></span></span><span class="mjx-op" style="padding-left: 0.046em;"><span id="MJXc-Node-4225" class="mjx-mo"><span class="mjx-char MJXc-TeX-size1-R" style="padding-top: 0.532em; padding-bottom: 0.532em;">∑</span></span></span></span></span></span><span class="mjx-row"><span class="mjx-under" style="font-size: 70.7%; padding-top: 0.236em; padding-bottom: 0.141em;"><span id="MJXc-Node-4226" class="mjx-texatom" style=""><span id="MJXc-Node-4227" class="mjx-mrow"><span id="MJXc-Node-4228" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.426em; padding-bottom: 0.267em;">i</span></span><span id="MJXc-Node-4229" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.056em; padding-bottom: 0.32em;">=</span></span><span id="MJXc-Node-4230" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.373em; padding-bottom: 0.32em;">1</span></span></span></span></span></span></span></span><span id="MJXc-Node-4232" class="mjx-mi MJXc-space1"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.426em; padding-bottom: 0.532em;">#</span></span><span id="MJXc-Node-4233" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.479em; padding-bottom: 0.585em;">(</span></span><span id="MJXc-Node-4234" class="mjx-mtext"><span class="mjx-char" style="padding-top: 0.532em; padding-bottom: 0.215em;"><span class="mjx-charbox MJXc-TeX-unknown-R" style="padding-bottom: 0.297em; width: 0.731em;">О</span><span class="mjx-charbox MJXc-TeX-unknown-R" style="padding-bottom: 0.297em; width: 0.508em;">б</span><span class="mjx-charbox MJXc-TeX-unknown-R" style="padding-bottom: 0.297em; width: 0.54em;">ъ</span><span class="mjx-charbox MJXc-TeX-unknown-R" style="padding-bottom: 0.297em; width: 0.466em;">е</span><span class="mjx-charbox MJXc-TeX-unknown-R" style="padding-bottom: 0.297em; width: 0.498em;">к</span><span class="mjx-charbox MJXc-TeX-unknown-R" style="padding-bottom: 0.297em; width: 0.434em;">т</span><span class="mjx-charbox MJXc-TeX-unknown-R" style="padding-bottom: 0.297em; width: 0.508em;">о</span><span class="mjx-charbox MJXc-TeX-unknown-R" style="padding-bottom: 0.297em; width: 0.477em;">в</span><span class="mjx-charbox MJXc-TeX-main-R" style="padding-bottom: 0.314em;"> </span><span class="mjx-charbox MJXc-TeX-unknown-R" style="padding-bottom: 0.297em; width: 0.519em;">п</span><span class="mjx-charbox MJXc-TeX-unknown-R" style="padding-bottom: 0.297em; width: 0.508em;">о</span><span class="mjx-charbox MJXc-TeX-unknown-R" style="padding-bottom: 0.297em; width: 0.498em;">л</span><span class="mjx-charbox MJXc-TeX-unknown-R" style="padding-bottom: 0.297em; width: 0.508em;">о</span><span class="mjx-charbox MJXc-TeX-unknown-R" style="padding-bottom: 0.297em; width: 0.72em;">ж</span><span class="mjx-charbox MJXc-TeX-unknown-R" style="padding-bottom: 0.297em; width: 0.519em;">и</span><span class="mjx-charbox MJXc-TeX-unknown-R" style="padding-bottom: 0.297em; width: 0.434em;">т</span><span class="mjx-charbox MJXc-TeX-unknown-R" style="padding-bottom: 0.297em; width: 0.466em;">е</span><span class="mjx-charbox MJXc-TeX-unknown-R" style="padding-bottom: 0.297em; width: 0.498em;">л</span><span class="mjx-charbox MJXc-TeX-unknown-R" style="padding-bottom: 0.297em; width: 0.456em;">ь</span><span class="mjx-charbox MJXc-TeX-unknown-R" style="padding-bottom: 0.297em; width: 0.519em;">н</span><span class="mjx-charbox MJXc-TeX-unknown-R" style="padding-bottom: 0.297em; width: 0.508em;">о</span><span class="mjx-charbox MJXc-TeX-unknown-R" style="padding-bottom: 0.297em; width: 0.392em;">г</span><span class="mjx-charbox MJXc-TeX-unknown-R" style="padding-bottom: 0.297em; width: 0.508em;">о</span><span class="mjx-charbox MJXc-TeX-main-R" style="padding-bottom: 0.314em;"> </span><span class="mjx-charbox MJXc-TeX-unknown-R" style="padding-bottom: 0.297em; width: 0.498em;">к</span><span class="mjx-charbox MJXc-TeX-unknown-R" style="padding-bottom: 0.297em; width: 0.498em;">л</span><span class="mjx-charbox MJXc-TeX-unknown-R" style="padding-bottom: 0.297em; width: 0.445em;">а</span><span class="mjx-charbox MJXc-TeX-unknown-R" style="padding-bottom: 0.297em; width: 0.456em;">с</span><span class="mjx-charbox MJXc-TeX-unknown-R" style="padding-bottom: 0.297em; width: 0.456em;">с</span><span class="mjx-charbox MJXc-TeX-unknown-R" style="padding-bottom: 0.297em; width: 0.445em;">а</span><span class="mjx-charbox MJXc-TeX-main-R" style="padding-bottom: 0.314em;"> </span><span class="mjx-charbox MJXc-TeX-unknown-R" style="padding-bottom: 0.297em; width: 0.456em;">с</span><span class="mjx-charbox MJXc-TeX-unknown-R" style="padding-bottom: 0.297em; width: 0.508em;">о</span><span class="mjx-charbox MJXc-TeX-main-R" style="padding-bottom: 0.314em;"> </span><span class="mjx-charbox MJXc-TeX-unknown-R" style="padding-bottom: 0.297em; width: 0.392em;">з</span><span class="mjx-charbox MJXc-TeX-unknown-R" style="padding-bottom: 0.297em; width: 0.519em;">н</span><span class="mjx-charbox MJXc-TeX-unknown-R" style="padding-bottom: 0.297em; width: 0.445em;">а</span><span class="mjx-charbox MJXc-TeX-unknown-R" style="padding-bottom: 0.297em; width: 0.508em;">ч</span><span class="mjx-charbox MJXc-TeX-unknown-R" style="padding-bottom: 0.297em; width: 0.466em;">е</span><span class="mjx-charbox MJXc-TeX-unknown-R" style="padding-bottom: 0.297em; width: 0.519em;">н</span><span class="mjx-charbox MJXc-TeX-unknown-R" style="padding-bottom: 0.297em; width: 0.519em;">и</span><span class="mjx-charbox MJXc-TeX-unknown-R" style="padding-bottom: 0.297em; width: 0.466em;">е</span><span class="mjx-charbox MJXc-TeX-unknown-R" style="padding-bottom: 0.297em; width: 0.614em;">м</span><span class="mjx-charbox MJXc-TeX-main-R" style="padding-bottom: 0.314em;"> </span><span class="mjx-charbox MJXc-TeX-unknown-R" style="padding-bottom: 0.297em; width: 0.519em;">п</span><span class="mjx-charbox MJXc-TeX-unknown-R" style="padding-bottom: 0.297em; width: 0.498em;">р</span><span class="mjx-charbox MJXc-TeX-unknown-R" style="padding-bottom: 0.297em; width: 0.519em;">и</span><span class="mjx-charbox MJXc-TeX-unknown-R" style="padding-bottom: 0.297em; width: 0.392em;">з</span><span class="mjx-charbox MJXc-TeX-unknown-R" style="padding-bottom: 0.297em; width: 0.519em;">н</span><span class="mjx-charbox MJXc-TeX-unknown-R" style="padding-bottom: 0.297em; width: 0.445em;">а</span><span class="mjx-charbox MJXc-TeX-unknown-R" style="padding-bottom: 0.297em; width: 0.498em;">к</span><span class="mjx-charbox MJXc-TeX-unknown-R" style="padding-bottom: 0.297em; width: 0.445em;">а</span><span class="mjx-charbox MJXc-TeX-main-R" style="padding-bottom: 0.314em;">&nbsp;</span></span></span><span id="MJXc-Node-4235" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.267em;">k</span></span><span id="MJXc-Node-4236" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.479em; padding-bottom: 0.585em;">)</span></span></span></span><span class="mjx-denominator" style="width: 28.409em; bottom: -2.436em;"><span id="MJXc-Node-4237" class="mjx-mrow"><span id="MJXc-Node-4238" class="mjx-munderover"><span class="mjx-itable"><span class="mjx-row"><span class="mjx-cell"><span class="mjx-stack"><span class="mjx-over" style="font-size: 70.7%; padding-bottom: 0.247em; padding-top: 0.141em; padding-left: 0.512em;"><span id="MJXc-Node-4245" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.215em; padding-bottom: 0.267em;">n</span></span></span><span class="mjx-op" style="padding-left: 0.046em;"><span id="MJXc-Node-4239" class="mjx-mo"><span class="mjx-char MJXc-TeX-size1-R" style="padding-top: 0.532em; padding-bottom: 0.532em;">∑</span></span></span></span></span></span><span class="mjx-row"><span class="mjx-under" style="font-size: 70.7%; padding-top: 0.236em; padding-bottom: 0.141em;"><span id="MJXc-Node-4240" class="mjx-texatom" style=""><span id="MJXc-Node-4241" class="mjx-mrow"><span id="MJXc-Node-4242" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.426em; padding-bottom: 0.267em;">i</span></span><span id="MJXc-Node-4243" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.056em; padding-bottom: 0.32em;">=</span></span><span id="MJXc-Node-4244" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.373em; padding-bottom: 0.32em;">1</span></span></span></span></span></span></span></span><span id="MJXc-Node-4246" class="mjx-mi MJXc-space1"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.426em; padding-bottom: 0.532em;">#</span></span><span id="MJXc-Node-4247" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.479em; padding-bottom: 0.585em;">(</span></span><span id="MJXc-Node-4248" class="mjx-mtext"><span class="mjx-char" style="padding-top: 0.532em; padding-bottom: 0.215em;"><span class="mjx-charbox MJXc-TeX-unknown-R" style="padding-bottom: 0.297em; width: 0.731em;">О</span><span class="mjx-charbox MJXc-TeX-unknown-R" style="padding-bottom: 0.297em; width: 0.508em;">б</span><span class="mjx-charbox MJXc-TeX-unknown-R" style="padding-bottom: 0.297em; width: 0.54em;">ъ</span><span class="mjx-charbox MJXc-TeX-unknown-R" style="padding-bottom: 0.297em; width: 0.466em;">е</span><span class="mjx-charbox MJXc-TeX-unknown-R" style="padding-bottom: 0.297em; width: 0.498em;">к</span><span class="mjx-charbox MJXc-TeX-unknown-R" style="padding-bottom: 0.297em; width: 0.434em;">т</span><span class="mjx-charbox MJXc-TeX-unknown-R" style="padding-bottom: 0.297em; width: 0.508em;">о</span><span class="mjx-charbox MJXc-TeX-unknown-R" style="padding-bottom: 0.297em; width: 0.477em;">в</span><span class="mjx-charbox MJXc-TeX-main-R" style="padding-bottom: 0.314em;"> </span><span class="mjx-charbox MJXc-TeX-unknown-R" style="padding-bottom: 0.297em; width: 0.519em;">п</span><span class="mjx-charbox MJXc-TeX-unknown-R" style="padding-bottom: 0.297em; width: 0.508em;">о</span><span class="mjx-charbox MJXc-TeX-unknown-R" style="padding-bottom: 0.297em; width: 0.498em;">л</span><span class="mjx-charbox MJXc-TeX-unknown-R" style="padding-bottom: 0.297em; width: 0.508em;">о</span><span class="mjx-charbox MJXc-TeX-unknown-R" style="padding-bottom: 0.297em; width: 0.72em;">ж</span><span class="mjx-charbox MJXc-TeX-unknown-R" style="padding-bottom: 0.297em; width: 0.519em;">и</span><span class="mjx-charbox MJXc-TeX-unknown-R" style="padding-bottom: 0.297em; width: 0.434em;">т</span><span class="mjx-charbox MJXc-TeX-unknown-R" style="padding-bottom: 0.297em; width: 0.466em;">е</span><span class="mjx-charbox MJXc-TeX-unknown-R" style="padding-bottom: 0.297em; width: 0.498em;">л</span><span class="mjx-charbox MJXc-TeX-unknown-R" style="padding-bottom: 0.297em; width: 0.456em;">ь</span><span class="mjx-charbox MJXc-TeX-unknown-R" style="padding-bottom: 0.297em; width: 0.519em;">н</span><span class="mjx-charbox MJXc-TeX-unknown-R" style="padding-bottom: 0.297em; width: 0.508em;">о</span><span class="mjx-charbox MJXc-TeX-unknown-R" style="padding-bottom: 0.297em; width: 0.392em;">г</span><span class="mjx-charbox MJXc-TeX-unknown-R" style="padding-bottom: 0.297em; width: 0.508em;">о</span><span class="mjx-charbox MJXc-TeX-main-R" style="padding-bottom: 0.314em;"> </span><span class="mjx-charbox MJXc-TeX-unknown-R" style="padding-bottom: 0.297em; width: 0.498em;">к</span><span class="mjx-charbox MJXc-TeX-unknown-R" style="padding-bottom: 0.297em; width: 0.498em;">л</span><span class="mjx-charbox MJXc-TeX-unknown-R" style="padding-bottom: 0.297em; width: 0.445em;">а</span><span class="mjx-charbox MJXc-TeX-unknown-R" style="padding-bottom: 0.297em; width: 0.456em;">с</span><span class="mjx-charbox MJXc-TeX-unknown-R" style="padding-bottom: 0.297em; width: 0.456em;">с</span><span class="mjx-charbox MJXc-TeX-unknown-R" style="padding-bottom: 0.297em; width: 0.445em;">а</span></span></span><span id="MJXc-Node-4249" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.479em; padding-bottom: 0.585em;">)</span></span></span></span><span style="border-bottom-width: 1.3px; border-bottom-style: solid; top: -0.283em; width: 28.409em;" class="mjx-line"></span></span><span style="height: 5.373em; vertical-align: -2.436em;" class="mjx-vsize"></span></span></span></span><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><msub><mi>l</mi><mi>i</mi></msub><mo>=</mo><mfrac><mrow><munderover><mo movablelimits="false">∑</mo><mrow class="MJX-TeXAtom-ORD"><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>n</mi></munderover><mi mathvariant="normal">#</mi><mo stretchy="false">(</mo><mtext>Объектов положительного класса со значением признака&nbsp;</mtext><mi>k</mi><mo stretchy="false">)</mo></mrow><mrow><munderover><mo movablelimits="false">∑</mo><mrow class="MJX-TeXAtom-ORD"><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>n</mi></munderover><mi mathvariant="normal">#</mi><mo stretchy="false">(</mo><mtext>Объектов положительного класса</mtext><mo stretchy="false">)</mo></mrow></mfrac></math></span></span></span><script type="math/tex; mode=display" id="MathJax-Element-273">
 l_i = \frac{\sum\limits_{i = 1}^n \#(\text{Объектов положительного класса со значением признака } k)}{\sum\limits_{i = 1}^n \#(\text{Объектов положительного класса})}
</script></span></li>
<li><span>В реальных задачах в обучающих выборках часто встречаются </span><strong><span>пропущенные значения</span></strong><span> некоторых признаков — сбои датчиков и т.п. Перед обучением алгоритма следует их правильно предобрабатывать. Два самых распространённых подхода:</span>
<ul>
<li><span>Вместо пропущенных значений использовать среднее значение этого признака по выборке (или среднее значение по подвыборке с этим же классом). Этот метод более предпочтителен для рещающих деревьев и ансамблей над ними.</span>
<ul>
<li><span>Для категориальных значений аналогичным способом будет присваивание самого частого значения признака. Или использовать случайное значение категориального признака с вероятностями сэмплированными из обучающей выборки.</span></li>
</ul>
</li>
<li><span>Использовать нулевые значения. Этот метод более предпочтителен для линейных моделей (т.к. в точности означает “не учитывать этот признак на этом объекте”).</span></li>
<li><span>Отдельно отметим, что при построении решающего дерева объект с пропущенным значением признака можно “передать” и в левое и в правое поддерево, а затем (взвешенно) усреднить предсказания из поддеревьях.</span></li>
</ul>
</li>
</ul><h3 id="22-Наивный-байесовский-классификатор" data-id="22-Наивный-байесовский-классификатор"><a class="anchor hidden-xs" href="#22-Наивный-байесовский-классификатор" title="22-Наивный-байесовский-классификатор"><span class="octicon octicon-link"></span></a><span>22. Наивный байесовский классификатор.</span></h3><p><span>Пусть стоит задача классификации с </span><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-274-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 118%; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>k</mi></math>" role="presentation"><span id="MJXc-Node-4250" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-4251" class="mjx-mrow"><span id="MJXc-Node-4252" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.267em;">k</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>k</mi></math></span></span><script type="math/tex" id="MathJax-Element-274">k</script></span><span> классами: </span><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-275-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 118%; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>y</mi><mo>&amp;#x2208;</mo><mo fence=&quot;false&quot; stretchy=&quot;false&quot;>{</mo><msub><mi>C</mi><mn>1</mn></msub><mo>,</mo><msub><mi>C</mi><mn>2</mn></msub><mo>,</mo><mo>.</mo><mo>.</mo><mo>.</mo><msub><mi>C</mi><mi>k</mi></msub><mo fence=&quot;false&quot; stretchy=&quot;false&quot;>}</mo></math>" role="presentation"><span id="MJXc-Node-4253" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-4254" class="mjx-mrow"><span id="MJXc-Node-4255" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.215em; padding-bottom: 0.479em; padding-right: 0.006em;">y</span></span><span id="MJXc-Node-4256" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.267em; padding-bottom: 0.373em;">∈</span></span><span id="MJXc-Node-4257" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.479em; padding-bottom: 0.585em;">{</span></span><span id="MJXc-Node-4258" class="mjx-msubsup"><span class="mjx-base" style="margin-right: -0.045em;"><span id="MJXc-Node-4259" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.32em; padding-right: 0.045em;">C</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-4260" class="mjx-mn" style=""><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.373em; padding-bottom: 0.32em;">1</span></span></span></span><span id="MJXc-Node-4261" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="margin-top: -0.156em; padding-bottom: 0.532em;">,</span></span><span id="MJXc-Node-4262" class="mjx-msubsup MJXc-space1"><span class="mjx-base" style="margin-right: -0.045em;"><span id="MJXc-Node-4263" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.32em; padding-right: 0.045em;">C</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-4264" class="mjx-mn" style=""><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.373em; padding-bottom: 0.32em;">2</span></span></span></span><span id="MJXc-Node-4265" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="margin-top: -0.156em; padding-bottom: 0.532em;">,</span></span><span id="MJXc-Node-4266" class="mjx-mo MJXc-space1"><span class="mjx-char MJXc-TeX-main-R" style="margin-top: -0.156em; padding-bottom: 0.32em;">.</span></span><span id="MJXc-Node-4267" class="mjx-mo MJXc-space1"><span class="mjx-char MJXc-TeX-main-R" style="margin-top: -0.156em; padding-bottom: 0.32em;">.</span></span><span id="MJXc-Node-4268" class="mjx-mo MJXc-space1"><span class="mjx-char MJXc-TeX-main-R" style="margin-top: -0.156em; padding-bottom: 0.32em;">.</span></span><span id="MJXc-Node-4269" class="mjx-msubsup MJXc-space1"><span class="mjx-base" style="margin-right: -0.045em;"><span id="MJXc-Node-4270" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.32em; padding-right: 0.045em;">C</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.219em; padding-right: 0.071em;"><span id="MJXc-Node-4271" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.267em;">k</span></span></span></span><span id="MJXc-Node-4272" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.479em; padding-bottom: 0.585em;">}</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>y</mi><mo>∈</mo><mo fence="false" stretchy="false">{</mo><msub><mi>C</mi><mn>1</mn></msub><mo>,</mo><msub><mi>C</mi><mn>2</mn></msub><mo>,</mo><mo>.</mo><mo>.</mo><mo>.</mo><msub><mi>C</mi><mi>k</mi></msub><mo fence="false" stretchy="false">}</mo></math></span></span><script type="math/tex" id="MathJax-Element-275">y \in \{C_1, C_2, ... C_k\}</script></span><br>
<span>Хотим оценивать условную вероятность метки класса для фиксированного объекта:</span><br>
<span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span class="mjx-chtml MJXc-display" style="text-align: center;"><span id="MathJax-Element-276-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 118%; text-align: center; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><mi>P</mi><mo stretchy=&quot;false&quot;>(</mo><msub><mi>y</mi><mi>i</mi></msub><mo>=</mo><msub><mi>C</mi><mi>k</mi></msub><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>|</mo></mrow><msub><mi>x</mi><mi>i</mi></msub><mo stretchy=&quot;false&quot;>)</mo><mo>=</mo><mfrac><mrow><mi>P</mi><mo stretchy=&quot;false&quot;>(</mo><msub><mi>x</mi><mi>i</mi></msub><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>|</mo></mrow><msub><mi>y</mi><mi>i</mi></msub><mo>=</mo><msub><mi>C</mi><mi>k</mi></msub><mo stretchy=&quot;false&quot;>)</mo><mo>&amp;#x22C5;</mo><mi>P</mi><mo stretchy=&quot;false&quot;>(</mo><msub><mi>y</mi><mi>i</mi></msub><mo>=</mo><msub><mi>C</mi><mi>k</mi></msub><mo stretchy=&quot;false&quot;>)</mo></mrow><mrow><mi>P</mi><mo stretchy=&quot;false&quot;>(</mo><msub><mi>x</mi><mi>i</mi></msub><mo stretchy=&quot;false&quot;>)</mo></mrow></mfrac></math>" role="presentation"><span id="MJXc-Node-4273" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-4274" class="mjx-mrow"><span id="MJXc-Node-4275" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.267em; padding-right: 0.109em;">P</span></span><span id="MJXc-Node-4276" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.479em; padding-bottom: 0.585em;">(</span></span><span id="MJXc-Node-4277" class="mjx-msubsup"><span class="mjx-base" style="margin-right: -0.006em;"><span id="MJXc-Node-4278" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.215em; padding-bottom: 0.479em; padding-right: 0.006em;">y</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-4279" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.426em; padding-bottom: 0.267em;">i</span></span></span></span><span id="MJXc-Node-4280" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.056em; padding-bottom: 0.32em;">=</span></span><span id="MJXc-Node-4281" class="mjx-msubsup MJXc-space3"><span class="mjx-base" style="margin-right: -0.045em;"><span id="MJXc-Node-4282" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.32em; padding-right: 0.045em;">C</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.219em; padding-right: 0.071em;"><span id="MJXc-Node-4283" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.267em;">k</span></span></span></span><span id="MJXc-Node-4284" class="mjx-texatom"><span id="MJXc-Node-4285" class="mjx-mrow"><span id="MJXc-Node-4286" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.479em; padding-bottom: 0.585em;">|</span></span></span></span><span id="MJXc-Node-4287" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-4288" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.215em; padding-bottom: 0.267em;">x</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-4289" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.426em; padding-bottom: 0.267em;">i</span></span></span></span><span id="MJXc-Node-4290" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.479em; padding-bottom: 0.585em;">)</span></span><span id="MJXc-Node-4291" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.056em; padding-bottom: 0.32em;">=</span></span><span id="MJXc-Node-4292" class="mjx-mfrac MJXc-space3"><span class="mjx-box MJXc-stacked" style="width: 11.553em; padding: 0px 0.12em;"><span class="mjx-numerator" style="width: 11.553em; top: -1.526em;"><span id="MJXc-Node-4293" class="mjx-mrow"><span id="MJXc-Node-4294" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.267em; padding-right: 0.109em;">P</span></span><span id="MJXc-Node-4295" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.479em; padding-bottom: 0.585em;">(</span></span><span id="MJXc-Node-4296" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-4297" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.215em; padding-bottom: 0.267em;">x</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-4298" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.426em; padding-bottom: 0.267em;">i</span></span></span></span><span id="MJXc-Node-4299" class="mjx-texatom"><span id="MJXc-Node-4300" class="mjx-mrow"><span id="MJXc-Node-4301" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.479em; padding-bottom: 0.585em;">|</span></span></span></span><span id="MJXc-Node-4302" class="mjx-msubsup"><span class="mjx-base" style="margin-right: -0.006em;"><span id="MJXc-Node-4303" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.215em; padding-bottom: 0.479em; padding-right: 0.006em;">y</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-4304" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.426em; padding-bottom: 0.267em;">i</span></span></span></span><span id="MJXc-Node-4305" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.056em; padding-bottom: 0.32em;">=</span></span><span id="MJXc-Node-4306" class="mjx-msubsup MJXc-space3"><span class="mjx-base" style="margin-right: -0.045em;"><span id="MJXc-Node-4307" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.32em; padding-right: 0.045em;">C</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.219em; padding-right: 0.071em;"><span id="MJXc-Node-4308" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.267em;">k</span></span></span></span><span id="MJXc-Node-4309" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.479em; padding-bottom: 0.585em;">)</span></span><span id="MJXc-Node-4310" class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.003em; padding-bottom: 0.32em;">⋅</span></span><span id="MJXc-Node-4311" class="mjx-mi MJXc-space2"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.267em; padding-right: 0.109em;">P</span></span><span id="MJXc-Node-4312" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.479em; padding-bottom: 0.585em;">(</span></span><span id="MJXc-Node-4313" class="mjx-msubsup"><span class="mjx-base" style="margin-right: -0.006em;"><span id="MJXc-Node-4314" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.215em; padding-bottom: 0.479em; padding-right: 0.006em;">y</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-4315" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.426em; padding-bottom: 0.267em;">i</span></span></span></span><span id="MJXc-Node-4316" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.056em; padding-bottom: 0.32em;">=</span></span><span id="MJXc-Node-4317" class="mjx-msubsup MJXc-space3"><span class="mjx-base" style="margin-right: -0.045em;"><span id="MJXc-Node-4318" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.32em; padding-right: 0.045em;">C</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.219em; padding-right: 0.071em;"><span id="MJXc-Node-4319" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.267em;">k</span></span></span></span><span id="MJXc-Node-4320" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.479em; padding-bottom: 0.585em;">)</span></span></span></span><span class="mjx-denominator" style="width: 11.553em; bottom: -1.026em;"><span id="MJXc-Node-4321" class="mjx-mrow"><span id="MJXc-Node-4322" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.267em; padding-right: 0.109em;">P</span></span><span id="MJXc-Node-4323" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.479em; padding-bottom: 0.585em;">(</span></span><span id="MJXc-Node-4324" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-4325" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.215em; padding-bottom: 0.267em;">x</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-4326" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.426em; padding-bottom: 0.267em;">i</span></span></span></span><span id="MJXc-Node-4327" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.479em; padding-bottom: 0.585em;">)</span></span></span></span><span style="border-bottom-width: 1.3px; border-bottom-style: solid; top: -0.283em; width: 11.553em;" class="mjx-line"></span></span><span style="height: 2.551em; vertical-align: -1.026em;" class="mjx-vsize"></span></span></span></span><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mi>P</mi><mo stretchy="false">(</mo><msub><mi>y</mi><mi>i</mi></msub><mo>=</mo><msub><mi>C</mi><mi>k</mi></msub><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><msub><mi>x</mi><mi>i</mi></msub><mo stretchy="false">)</mo><mo>=</mo><mfrac><mrow><mi>P</mi><mo stretchy="false">(</mo><msub><mi>x</mi><mi>i</mi></msub><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><msub><mi>y</mi><mi>i</mi></msub><mo>=</mo><msub><mi>C</mi><mi>k</mi></msub><mo stretchy="false">)</mo><mo>⋅</mo><mi>P</mi><mo stretchy="false">(</mo><msub><mi>y</mi><mi>i</mi></msub><mo>=</mo><msub><mi>C</mi><mi>k</mi></msub><mo stretchy="false">)</mo></mrow><mrow><mi>P</mi><mo stretchy="false">(</mo><msub><mi>x</mi><mi>i</mi></msub><mo stretchy="false">)</mo></mrow></mfrac></math></span></span></span><script type="math/tex; mode=display" id="MathJax-Element-276">
    P(y_i = C_k | x_i) = \frac{P(x_i | y_i = C_k) \cdot P(y_i = C_k)}{P(x_i)}
</script></span><br>
<span>(Здесь была применена теорема Байеса)</span><br>
<span>Подумаем, как можно оценить это выражение. </span><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-277-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 118%; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>P</mi><mo stretchy=&quot;false&quot;>(</mo><msub><mi>y</mi><mi>i</mi></msub><mo>=</mo><msub><mi>C</mi><mi>k</mi></msub><mo stretchy=&quot;false&quot;>)</mo></math>" role="presentation"><span id="MJXc-Node-4328" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-4329" class="mjx-mrow"><span id="MJXc-Node-4330" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.267em; padding-right: 0.109em;">P</span></span><span id="MJXc-Node-4331" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.479em; padding-bottom: 0.585em;">(</span></span><span id="MJXc-Node-4332" class="mjx-msubsup"><span class="mjx-base" style="margin-right: -0.006em;"><span id="MJXc-Node-4333" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.215em; padding-bottom: 0.479em; padding-right: 0.006em;">y</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-4334" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.426em; padding-bottom: 0.267em;">i</span></span></span></span><span id="MJXc-Node-4335" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.056em; padding-bottom: 0.32em;">=</span></span><span id="MJXc-Node-4336" class="mjx-msubsup MJXc-space3"><span class="mjx-base" style="margin-right: -0.045em;"><span id="MJXc-Node-4337" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.32em; padding-right: 0.045em;">C</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.219em; padding-right: 0.071em;"><span id="MJXc-Node-4338" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.267em;">k</span></span></span></span><span id="MJXc-Node-4339" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.479em; padding-bottom: 0.585em;">)</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>P</mi><mo stretchy="false">(</mo><msub><mi>y</mi><mi>i</mi></msub><mo>=</mo><msub><mi>C</mi><mi>k</mi></msub><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-277">P(y_i = C_k)</script></span><span> можно просто оценить долей класса </span><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-278-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 118%; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>C</mi><mi>k</mi></msub></math>" role="presentation"><span id="MJXc-Node-4340" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-4341" class="mjx-mrow"><span id="MJXc-Node-4342" class="mjx-msubsup"><span class="mjx-base" style="margin-right: -0.045em;"><span id="MJXc-Node-4343" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.32em; padding-right: 0.045em;">C</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.219em; padding-right: 0.071em;"><span id="MJXc-Node-4344" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.267em;">k</span></span></span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>C</mi><mi>k</mi></msub></math></span></span><script type="math/tex" id="MathJax-Element-278">C_k</script></span><span> в обучающей выборке.</span><br>
<span>Для оценки множителя </span><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-279-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 118%; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>P</mi><mo stretchy=&quot;false&quot;>(</mo><msub><mi>x</mi><mi>i</mi></msub><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>|</mo></mrow><msub><mi>y</mi><mi>i</mi></msub><mo>=</mo><msub><mi>C</mi><mi>k</mi></msub><mo stretchy=&quot;false&quot;>)</mo></math>" role="presentation"><span id="MJXc-Node-4345" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-4346" class="mjx-mrow"><span id="MJXc-Node-4347" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.267em; padding-right: 0.109em;">P</span></span><span id="MJXc-Node-4348" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.479em; padding-bottom: 0.585em;">(</span></span><span id="MJXc-Node-4349" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-4350" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.215em; padding-bottom: 0.267em;">x</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-4351" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.426em; padding-bottom: 0.267em;">i</span></span></span></span><span id="MJXc-Node-4352" class="mjx-texatom"><span id="MJXc-Node-4353" class="mjx-mrow"><span id="MJXc-Node-4354" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.479em; padding-bottom: 0.585em;">|</span></span></span></span><span id="MJXc-Node-4355" class="mjx-msubsup"><span class="mjx-base" style="margin-right: -0.006em;"><span id="MJXc-Node-4356" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.215em; padding-bottom: 0.479em; padding-right: 0.006em;">y</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-4357" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.426em; padding-bottom: 0.267em;">i</span></span></span></span><span id="MJXc-Node-4358" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.056em; padding-bottom: 0.32em;">=</span></span><span id="MJXc-Node-4359" class="mjx-msubsup MJXc-space3"><span class="mjx-base" style="margin-right: -0.045em;"><span id="MJXc-Node-4360" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.32em; padding-right: 0.045em;">C</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.219em; padding-right: 0.071em;"><span id="MJXc-Node-4361" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.267em;">k</span></span></span></span><span id="MJXc-Node-4362" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.479em; padding-bottom: 0.585em;">)</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>P</mi><mo stretchy="false">(</mo><msub><mi>x</mi><mi>i</mi></msub><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><msub><mi>y</mi><mi>i</mi></msub><mo>=</mo><msub><mi>C</mi><mi>k</mi></msub><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-279">P(x_i | y_i = C_k)</script></span><span> делается </span><strong><span>наивное предположение</span></strong><span> о том, что все признаки независимы и тогда:</span><br>
<span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span class="mjx-chtml MJXc-display" style="text-align: center;"><span id="MathJax-Element-280-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 118%; text-align: center; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><mi>P</mi><mo stretchy=&quot;false&quot;>(</mo><msub><mi>x</mi><mi>i</mi></msub><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>|</mo></mrow><msub><mi>y</mi><mi>i</mi></msub><mo>=</mo><msub><mi>C</mi><mi>k</mi></msub><mo stretchy=&quot;false&quot;>)</mo><mo>=</mo><munderover><mo movablelimits=&quot;false&quot;>&amp;#x220F;</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>l</mi><mo>=</mo><mn>1</mn></mrow><mi>p</mi></munderover><mi>P</mi><mo stretchy=&quot;false&quot;>(</mo><msubsup><mi>x</mi><mi>i</mi><mi>l</mi></msubsup><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>|</mo></mrow><msub><mi>y</mi><mi>i</mi></msub><mo>=</mo><msub><mi>C</mi><mi>k</mi></msub><mo stretchy=&quot;false&quot;>)</mo></math>" role="presentation"><span id="MJXc-Node-4363" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-4364" class="mjx-mrow"><span id="MJXc-Node-4365" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.267em; padding-right: 0.109em;">P</span></span><span id="MJXc-Node-4366" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.479em; padding-bottom: 0.585em;">(</span></span><span id="MJXc-Node-4367" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-4368" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.215em; padding-bottom: 0.267em;">x</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-4369" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.426em; padding-bottom: 0.267em;">i</span></span></span></span><span id="MJXc-Node-4370" class="mjx-texatom"><span id="MJXc-Node-4371" class="mjx-mrow"><span id="MJXc-Node-4372" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.479em; padding-bottom: 0.585em;">|</span></span></span></span><span id="MJXc-Node-4373" class="mjx-msubsup"><span class="mjx-base" style="margin-right: -0.006em;"><span id="MJXc-Node-4374" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.215em; padding-bottom: 0.479em; padding-right: 0.006em;">y</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-4375" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.426em; padding-bottom: 0.267em;">i</span></span></span></span><span id="MJXc-Node-4376" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.056em; padding-bottom: 0.32em;">=</span></span><span id="MJXc-Node-4377" class="mjx-msubsup MJXc-space3"><span class="mjx-base" style="margin-right: -0.045em;"><span id="MJXc-Node-4378" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.32em; padding-right: 0.045em;">C</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.219em; padding-right: 0.071em;"><span id="MJXc-Node-4379" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.267em;">k</span></span></span></span><span id="MJXc-Node-4380" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.479em; padding-bottom: 0.585em;">)</span></span><span id="MJXc-Node-4381" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.056em; padding-bottom: 0.32em;">=</span></span><span id="MJXc-Node-4382" class="mjx-munderover MJXc-space3"><span class="mjx-itable"><span class="mjx-row"><span class="mjx-cell"><span class="mjx-stack"><span class="mjx-over" style="font-size: 70.7%; padding-bottom: 0.157em; padding-top: 0.141em; padding-left: 0.652em;"><span id="MJXc-Node-4389" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.215em; padding-bottom: 0.479em;">p</span></span></span><span class="mjx-op"><span id="MJXc-Node-4383" class="mjx-mo"><span class="mjx-char MJXc-TeX-size2-R" style="padding-top: 0.744em; padding-bottom: 0.744em;">∏</span></span></span></span></span></span><span class="mjx-row"><span class="mjx-under" style="font-size: 70.7%; padding-top: 0.236em; padding-bottom: 0.141em; padding-left: 0.116em;"><span id="MJXc-Node-4384" class="mjx-texatom" style=""><span id="MJXc-Node-4385" class="mjx-mrow"><span id="MJXc-Node-4386" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.267em;">l</span></span><span id="MJXc-Node-4387" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.056em; padding-bottom: 0.32em;">=</span></span><span id="MJXc-Node-4388" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.373em; padding-bottom: 0.32em;">1</span></span></span></span></span></span></span></span><span id="MJXc-Node-4390" class="mjx-mi MJXc-space1"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.267em; padding-right: 0.109em;">P</span></span><span id="MJXc-Node-4391" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.479em; padding-bottom: 0.585em;">(</span></span><span id="MJXc-Node-4392" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-4393" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.215em; padding-bottom: 0.267em;">x</span></span></span><span class="mjx-stack" style="vertical-align: -0.311em;"><span class="mjx-sup" style="font-size: 70.7%; padding-bottom: 0.255em; padding-left: 0px; padding-right: 0.071em;"><span id="MJXc-Node-4395" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.267em;">l</span></span></span><span class="mjx-sub" style="font-size: 70.7%; padding-right: 0.071em;"><span id="MJXc-Node-4394" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.426em; padding-bottom: 0.267em;">i</span></span></span></span></span><span id="MJXc-Node-4396" class="mjx-texatom"><span id="MJXc-Node-4397" class="mjx-mrow"><span id="MJXc-Node-4398" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.479em; padding-bottom: 0.585em;">|</span></span></span></span><span id="MJXc-Node-4399" class="mjx-msubsup"><span class="mjx-base" style="margin-right: -0.006em;"><span id="MJXc-Node-4400" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.215em; padding-bottom: 0.479em; padding-right: 0.006em;">y</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-4401" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.426em; padding-bottom: 0.267em;">i</span></span></span></span><span id="MJXc-Node-4402" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.056em; padding-bottom: 0.32em;">=</span></span><span id="MJXc-Node-4403" class="mjx-msubsup MJXc-space3"><span class="mjx-base" style="margin-right: -0.045em;"><span id="MJXc-Node-4404" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.32em; padding-right: 0.045em;">C</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.219em; padding-right: 0.071em;"><span id="MJXc-Node-4405" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.267em;">k</span></span></span></span><span id="MJXc-Node-4406" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.479em; padding-bottom: 0.585em;">)</span></span></span></span><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mi>P</mi><mo stretchy="false">(</mo><msub><mi>x</mi><mi>i</mi></msub><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><msub><mi>y</mi><mi>i</mi></msub><mo>=</mo><msub><mi>C</mi><mi>k</mi></msub><mo stretchy="false">)</mo><mo>=</mo><munderover><mo movablelimits="false">∏</mo><mrow class="MJX-TeXAtom-ORD"><mi>l</mi><mo>=</mo><mn>1</mn></mrow><mi>p</mi></munderover><mi>P</mi><mo stretchy="false">(</mo><msubsup><mi>x</mi><mi>i</mi><mi>l</mi></msubsup><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><msub><mi>y</mi><mi>i</mi></msub><mo>=</mo><msub><mi>C</mi><mi>k</mi></msub><mo stretchy="false">)</mo></math></span></span></span><script type="math/tex; mode=display" id="MathJax-Element-280">
    P(x_i | y_i = C_k) = \prod\limits_{l = 1}^p P(x_i^l | y_i = C_k)
</script></span><br>
<span>Заметим, что для фиксированного объекта </span><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-281-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 118%; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>x</mi></math>" role="presentation"><span id="MJXc-Node-4407" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-4408" class="mjx-mrow"><span id="MJXc-Node-4409" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.215em; padding-bottom: 0.267em;">x</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>x</mi></math></span></span><script type="math/tex" id="MathJax-Element-281">x</script></span><span> мы хотим предсказывать предсказывать наиболее вероятную метку класса, т.е.</span><br>
<span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span class="mjx-chtml MJXc-display" style="text-align: center;"><span id="MathJax-Element-282-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 118%; text-align: center; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><msub><mi>C</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>t</mi><mi>a</mi><mi>r</mi><mi>g</mi><mi>e</mi><mi>t</mi></mrow></msub><mo stretchy=&quot;false&quot;>(</mo><mi>x</mi><mo stretchy=&quot;false&quot;>)</mo><mo>=</mo><mtext>arg</mtext><munder><mo movablelimits=&quot;true&quot; form=&quot;prefix&quot;>max</mo><mi>k</mi></munder><mi>P</mi><mo stretchy=&quot;false&quot;>(</mo><mi>y</mi><mo>=</mo><msub><mi>C</mi><mi>k</mi></msub><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>|</mo></mrow><mi>x</mi><mo stretchy=&quot;false&quot;>)</mo></math>" role="presentation"><span id="MJXc-Node-4410" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-4411" class="mjx-mrow"><span id="MJXc-Node-4412" class="mjx-msubsup"><span class="mjx-base" style="margin-right: -0.045em;"><span id="MJXc-Node-4413" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.32em; padding-right: 0.045em;">C</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-4414" class="mjx-texatom" style=""><span id="MJXc-Node-4415" class="mjx-mrow"><span id="MJXc-Node-4416" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.426em; padding-bottom: 0.267em;">t</span></span><span id="MJXc-Node-4417" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.215em; padding-bottom: 0.267em;">a</span></span><span id="MJXc-Node-4418" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.215em; padding-bottom: 0.267em;">r</span></span><span id="MJXc-Node-4419" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.215em; padding-bottom: 0.479em; padding-right: 0.003em;">g</span></span><span id="MJXc-Node-4420" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.215em; padding-bottom: 0.267em;">e</span></span><span id="MJXc-Node-4421" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.426em; padding-bottom: 0.267em;">t</span></span></span></span></span></span><span id="MJXc-Node-4422" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.479em; padding-bottom: 0.585em;">(</span></span><span id="MJXc-Node-4423" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.215em; padding-bottom: 0.267em;">x</span></span><span id="MJXc-Node-4424" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.479em; padding-bottom: 0.585em;">)</span></span><span id="MJXc-Node-4425" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.056em; padding-bottom: 0.32em;">=</span></span><span id="MJXc-Node-4426" class="mjx-mtext MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.162em; padding-bottom: 0.532em;">arg</span></span><span id="MJXc-Node-4427" class="mjx-munderover MJXc-space1"><span class="mjx-itable"><span class="mjx-row"><span class="mjx-cell"><span class="mjx-op"><span id="MJXc-Node-4428" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.162em; padding-bottom: 0.373em;">max</span></span></span></span></span><span class="mjx-row"><span class="mjx-under" style="font-size: 70.7%; padding-top: 0.236em; padding-bottom: 0.141em; padding-left: 1.055em;"><span id="MJXc-Node-4429" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.267em;">k</span></span></span></span></span></span><span id="MJXc-Node-4430" class="mjx-mi MJXc-space1"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.267em; padding-right: 0.109em;">P</span></span><span id="MJXc-Node-4431" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.479em; padding-bottom: 0.585em;">(</span></span><span id="MJXc-Node-4432" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.215em; padding-bottom: 0.479em; padding-right: 0.006em;">y</span></span><span id="MJXc-Node-4433" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.056em; padding-bottom: 0.32em;">=</span></span><span id="MJXc-Node-4434" class="mjx-msubsup MJXc-space3"><span class="mjx-base" style="margin-right: -0.045em;"><span id="MJXc-Node-4435" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.32em; padding-right: 0.045em;">C</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.219em; padding-right: 0.071em;"><span id="MJXc-Node-4436" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.267em;">k</span></span></span></span><span id="MJXc-Node-4437" class="mjx-texatom"><span id="MJXc-Node-4438" class="mjx-mrow"><span id="MJXc-Node-4439" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.479em; padding-bottom: 0.585em;">|</span></span></span></span><span id="MJXc-Node-4440" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.215em; padding-bottom: 0.267em;">x</span></span><span id="MJXc-Node-4441" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.479em; padding-bottom: 0.585em;">)</span></span></span></span><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><msub><mi>C</mi><mrow class="MJX-TeXAtom-ORD"><mi>t</mi><mi>a</mi><mi>r</mi><mi>g</mi><mi>e</mi><mi>t</mi></mrow></msub><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mo>=</mo><mtext>arg</mtext><munder><mo movablelimits="true" form="prefix">max</mo><mi>k</mi></munder><mi>P</mi><mo stretchy="false">(</mo><mi>y</mi><mo>=</mo><msub><mi>C</mi><mi>k</mi></msub><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><mi>x</mi><mo stretchy="false">)</mo></math></span></span></span><script type="math/tex; mode=display" id="MathJax-Element-282">
    C_{target}(x) = \text{arg}\max_k P(y = C_k | x)
</script></span><br>
<span>А знаменатель выражения от </span><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-283-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 118%; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>k</mi></math>" role="presentation"><span id="MJXc-Node-4442" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-4443" class="mjx-mrow"><span id="MJXc-Node-4444" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.267em;">k</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>k</mi></math></span></span><script type="math/tex" id="MathJax-Element-283">k</script></span><span> не зависит. Значит мы можем оценивать для каждого объекта только числитель самого первого выражения без учёта знаменателя (хотя в таком случае алгоритм не будет оценивать вероятность принадлежности каждому классу).</span><br>
<span>Заметим, что вычислить знаменатель всё равно можно по </span><em><span>формуле полной вероятности:</span></em><br>
<span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span class="mjx-chtml MJXc-display" style="text-align: center;"><span id="MathJax-Element-284-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 118%; text-align: center; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><mi>P</mi><mo stretchy=&quot;false&quot;>(</mo><mi>x</mi><mo stretchy=&quot;false&quot;>)</mo><mo>=</mo><munderover><mo movablelimits=&quot;false&quot;>&amp;#x2211;</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>k</mi></munderover><mi>P</mi><mo stretchy=&quot;false&quot;>(</mo><mi>x</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>|</mo></mrow><mi>y</mi><mo>=</mo><msub><mi>C</mi><mi>i</mi></msub><mo stretchy=&quot;false&quot;>)</mo><mi>P</mi><mo stretchy=&quot;false&quot;>(</mo><mi>y</mi><mo>=</mo><msub><mi>C</mi><mi>i</mi></msub><mo stretchy=&quot;false&quot;>)</mo></math>" role="presentation"><span id="MJXc-Node-4445" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-4446" class="mjx-mrow"><span id="MJXc-Node-4447" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.267em; padding-right: 0.109em;">P</span></span><span id="MJXc-Node-4448" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.479em; padding-bottom: 0.585em;">(</span></span><span id="MJXc-Node-4449" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.215em; padding-bottom: 0.267em;">x</span></span><span id="MJXc-Node-4450" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.479em; padding-bottom: 0.585em;">)</span></span><span id="MJXc-Node-4451" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.056em; padding-bottom: 0.32em;">=</span></span><span id="MJXc-Node-4452" class="mjx-munderover MJXc-space3"><span class="mjx-itable"><span class="mjx-row"><span class="mjx-cell"><span class="mjx-stack"><span class="mjx-over" style="font-size: 70.7%; padding-bottom: 0.247em; padding-top: 0.141em; padding-left: 0.761em;"><span id="MJXc-Node-4459" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.267em;">k</span></span></span><span class="mjx-op"><span id="MJXc-Node-4453" class="mjx-mo"><span class="mjx-char MJXc-TeX-size2-R" style="padding-top: 0.744em; padding-bottom: 0.744em;">∑</span></span></span></span></span></span><span class="mjx-row"><span class="mjx-under" style="font-size: 70.7%; padding-top: 0.236em; padding-bottom: 0.141em; padding-left: 0.21em;"><span id="MJXc-Node-4454" class="mjx-texatom" style=""><span id="MJXc-Node-4455" class="mjx-mrow"><span id="MJXc-Node-4456" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.426em; padding-bottom: 0.267em;">i</span></span><span id="MJXc-Node-4457" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.056em; padding-bottom: 0.32em;">=</span></span><span id="MJXc-Node-4458" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.373em; padding-bottom: 0.32em;">1</span></span></span></span></span></span></span></span><span id="MJXc-Node-4460" class="mjx-mi MJXc-space1"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.267em; padding-right: 0.109em;">P</span></span><span id="MJXc-Node-4461" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.479em; padding-bottom: 0.585em;">(</span></span><span id="MJXc-Node-4462" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.215em; padding-bottom: 0.267em;">x</span></span><span id="MJXc-Node-4463" class="mjx-texatom"><span id="MJXc-Node-4464" class="mjx-mrow"><span id="MJXc-Node-4465" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.479em; padding-bottom: 0.585em;">|</span></span></span></span><span id="MJXc-Node-4466" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.215em; padding-bottom: 0.479em; padding-right: 0.006em;">y</span></span><span id="MJXc-Node-4467" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.056em; padding-bottom: 0.32em;">=</span></span><span id="MJXc-Node-4468" class="mjx-msubsup MJXc-space3"><span class="mjx-base" style="margin-right: -0.045em;"><span id="MJXc-Node-4469" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.32em; padding-right: 0.045em;">C</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-4470" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.426em; padding-bottom: 0.267em;">i</span></span></span></span><span id="MJXc-Node-4471" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.479em; padding-bottom: 0.585em;">)</span></span><span id="MJXc-Node-4472" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.267em; padding-right: 0.109em;">P</span></span><span id="MJXc-Node-4473" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.479em; padding-bottom: 0.585em;">(</span></span><span id="MJXc-Node-4474" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.215em; padding-bottom: 0.479em; padding-right: 0.006em;">y</span></span><span id="MJXc-Node-4475" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.056em; padding-bottom: 0.32em;">=</span></span><span id="MJXc-Node-4476" class="mjx-msubsup MJXc-space3"><span class="mjx-base" style="margin-right: -0.045em;"><span id="MJXc-Node-4477" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.32em; padding-right: 0.045em;">C</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-4478" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.426em; padding-bottom: 0.267em;">i</span></span></span></span><span id="MJXc-Node-4479" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.479em; padding-bottom: 0.585em;">)</span></span></span></span><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mi>P</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mo>=</mo><munderover><mo movablelimits="false">∑</mo><mrow class="MJX-TeXAtom-ORD"><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>k</mi></munderover><mi>P</mi><mo stretchy="false">(</mo><mi>x</mi><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><mi>y</mi><mo>=</mo><msub><mi>C</mi><mi>i</mi></msub><mo stretchy="false">)</mo><mi>P</mi><mo stretchy="false">(</mo><mi>y</mi><mo>=</mo><msub><mi>C</mi><mi>i</mi></msub><mo stretchy="false">)</mo></math></span></span></span><script type="math/tex; mode=display" id="MathJax-Element-284">
    P(x) = \sum\limits_{i = 1}^k P(x | y = C_i)P(y = C_i)
</script></span><br>
<span>Таким образом, </span><strong><span>наивный байесовский классификатор</span></strong><span> — это следующая функция:</span><br>
<span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span class="mjx-chtml MJXc-display" style="text-align: center;"><span id="MathJax-Element-285-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 118%; text-align: center; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><msub><mi>C</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>t</mi><mi>a</mi><mi>r</mi><mi>g</mi><mi>e</mi><mi>t</mi></mrow></msub><mo stretchy=&quot;false&quot;>(</mo><mi>x</mi><mo stretchy=&quot;false&quot;>)</mo><mo>=</mo><mtext>arg</mtext><munder><mo movablelimits=&quot;true&quot; form=&quot;prefix&quot;>max</mo><mi>k</mi></munder><mi>P</mi><mo stretchy=&quot;false&quot;>(</mo><mi>y</mi><mo>=</mo><msub><mi>C</mi><mi>k</mi></msub><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>|</mo></mrow><mi>x</mi><mo stretchy=&quot;false&quot;>)</mo><mo>=</mo><mtext>arg</mtext><munder><mo movablelimits=&quot;true&quot; form=&quot;prefix&quot;>max</mo><mi>k</mi></munder><munderover><mo movablelimits=&quot;false&quot;>&amp;#x220F;</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>l</mi><mo>=</mo><mn>1</mn></mrow><mi>p</mi></munderover><mi>P</mi><mo stretchy=&quot;false&quot;>(</mo><msup><mi>x</mi><mi>l</mi></msup><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>|</mo></mrow><mi>y</mi><mo>=</mo><msub><mi>C</mi><mi>k</mi></msub><mo stretchy=&quot;false&quot;>)</mo><mi>P</mi><mo stretchy=&quot;false&quot;>(</mo><mi>y</mi><mo>=</mo><msub><mi>C</mi><mi>k</mi></msub><mo stretchy=&quot;false&quot;>)</mo></math>" role="presentation"><span id="MJXc-Node-4480" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-4481" class="mjx-mrow"><span id="MJXc-Node-4482" class="mjx-msubsup"><span class="mjx-base" style="margin-right: -0.045em;"><span id="MJXc-Node-4483" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.32em; padding-right: 0.045em;">C</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-4484" class="mjx-texatom" style=""><span id="MJXc-Node-4485" class="mjx-mrow"><span id="MJXc-Node-4486" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.426em; padding-bottom: 0.267em;">t</span></span><span id="MJXc-Node-4487" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.215em; padding-bottom: 0.267em;">a</span></span><span id="MJXc-Node-4488" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.215em; padding-bottom: 0.267em;">r</span></span><span id="MJXc-Node-4489" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.215em; padding-bottom: 0.479em; padding-right: 0.003em;">g</span></span><span id="MJXc-Node-4490" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.215em; padding-bottom: 0.267em;">e</span></span><span id="MJXc-Node-4491" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.426em; padding-bottom: 0.267em;">t</span></span></span></span></span></span><span id="MJXc-Node-4492" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.479em; padding-bottom: 0.585em;">(</span></span><span id="MJXc-Node-4493" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.215em; padding-bottom: 0.267em;">x</span></span><span id="MJXc-Node-4494" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.479em; padding-bottom: 0.585em;">)</span></span><span id="MJXc-Node-4495" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.056em; padding-bottom: 0.32em;">=</span></span><span id="MJXc-Node-4496" class="mjx-mtext MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.162em; padding-bottom: 0.532em;">arg</span></span><span id="MJXc-Node-4497" class="mjx-munderover MJXc-space1"><span class="mjx-itable"><span class="mjx-row"><span class="mjx-cell"><span class="mjx-op"><span id="MJXc-Node-4498" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.162em; padding-bottom: 0.373em;">max</span></span></span></span></span><span class="mjx-row"><span class="mjx-under" style="font-size: 70.7%; padding-top: 0.236em; padding-bottom: 0.141em; padding-left: 1.055em;"><span id="MJXc-Node-4499" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.267em;">k</span></span></span></span></span></span><span id="MJXc-Node-4500" class="mjx-mi MJXc-space1"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.267em; padding-right: 0.109em;">P</span></span><span id="MJXc-Node-4501" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.479em; padding-bottom: 0.585em;">(</span></span><span id="MJXc-Node-4502" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.215em; padding-bottom: 0.479em; padding-right: 0.006em;">y</span></span><span id="MJXc-Node-4503" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.056em; padding-bottom: 0.32em;">=</span></span><span id="MJXc-Node-4504" class="mjx-msubsup MJXc-space3"><span class="mjx-base" style="margin-right: -0.045em;"><span id="MJXc-Node-4505" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.32em; padding-right: 0.045em;">C</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.219em; padding-right: 0.071em;"><span id="MJXc-Node-4506" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.267em;">k</span></span></span></span><span id="MJXc-Node-4507" class="mjx-texatom"><span id="MJXc-Node-4508" class="mjx-mrow"><span id="MJXc-Node-4509" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.479em; padding-bottom: 0.585em;">|</span></span></span></span><span id="MJXc-Node-4510" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.215em; padding-bottom: 0.267em;">x</span></span><span id="MJXc-Node-4511" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.479em; padding-bottom: 0.585em;">)</span></span><span id="MJXc-Node-4512" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.056em; padding-bottom: 0.32em;">=</span></span><span id="MJXc-Node-4513" class="mjx-mtext MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.162em; padding-bottom: 0.532em;">arg</span></span><span id="MJXc-Node-4514" class="mjx-munderover MJXc-space1"><span class="mjx-itable"><span class="mjx-row"><span class="mjx-cell"><span class="mjx-op"><span id="MJXc-Node-4515" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.162em; padding-bottom: 0.373em;">max</span></span></span></span></span><span class="mjx-row"><span class="mjx-under" style="font-size: 70.7%; padding-top: 0.236em; padding-bottom: 0.141em; padding-left: 1.055em;"><span id="MJXc-Node-4516" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.267em;">k</span></span></span></span></span></span><span id="MJXc-Node-4517" class="mjx-munderover MJXc-space1"><span class="mjx-itable"><span class="mjx-row"><span class="mjx-cell"><span class="mjx-stack"><span class="mjx-over" style="font-size: 70.7%; padding-bottom: 0.157em; padding-top: 0.141em; padding-left: 0.652em;"><span id="MJXc-Node-4524" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.215em; padding-bottom: 0.479em;">p</span></span></span><span class="mjx-op"><span id="MJXc-Node-4518" class="mjx-mo"><span class="mjx-char MJXc-TeX-size2-R" style="padding-top: 0.744em; padding-bottom: 0.744em;">∏</span></span></span></span></span></span><span class="mjx-row"><span class="mjx-under" style="font-size: 70.7%; padding-top: 0.236em; padding-bottom: 0.141em; padding-left: 0.116em;"><span id="MJXc-Node-4519" class="mjx-texatom" style=""><span id="MJXc-Node-4520" class="mjx-mrow"><span id="MJXc-Node-4521" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.267em;">l</span></span><span id="MJXc-Node-4522" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.056em; padding-bottom: 0.32em;">=</span></span><span id="MJXc-Node-4523" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.373em; padding-bottom: 0.32em;">1</span></span></span></span></span></span></span></span><span id="MJXc-Node-4525" class="mjx-mi MJXc-space1"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.267em; padding-right: 0.109em;">P</span></span><span id="MJXc-Node-4526" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.479em; padding-bottom: 0.585em;">(</span></span><span id="MJXc-Node-4527" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-4528" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.215em; padding-bottom: 0.267em;">x</span></span></span><span class="mjx-sup" style="font-size: 70.7%; vertical-align: 0.584em; padding-left: 0px; padding-right: 0.071em;"><span id="MJXc-Node-4529" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.267em;">l</span></span></span></span><span id="MJXc-Node-4530" class="mjx-texatom"><span id="MJXc-Node-4531" class="mjx-mrow"><span id="MJXc-Node-4532" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.479em; padding-bottom: 0.585em;">|</span></span></span></span><span id="MJXc-Node-4533" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.215em; padding-bottom: 0.479em; padding-right: 0.006em;">y</span></span><span id="MJXc-Node-4534" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.056em; padding-bottom: 0.32em;">=</span></span><span id="MJXc-Node-4535" class="mjx-msubsup MJXc-space3"><span class="mjx-base" style="margin-right: -0.045em;"><span id="MJXc-Node-4536" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.32em; padding-right: 0.045em;">C</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.219em; padding-right: 0.071em;"><span id="MJXc-Node-4537" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.267em;">k</span></span></span></span><span id="MJXc-Node-4538" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.479em; padding-bottom: 0.585em;">)</span></span><span id="MJXc-Node-4539" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.267em; padding-right: 0.109em;">P</span></span><span id="MJXc-Node-4540" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.479em; padding-bottom: 0.585em;">(</span></span><span id="MJXc-Node-4541" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.215em; padding-bottom: 0.479em; padding-right: 0.006em;">y</span></span><span id="MJXc-Node-4542" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.056em; padding-bottom: 0.32em;">=</span></span><span id="MJXc-Node-4543" class="mjx-msubsup MJXc-space3"><span class="mjx-base" style="margin-right: -0.045em;"><span id="MJXc-Node-4544" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.32em; padding-right: 0.045em;">C</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.219em; padding-right: 0.071em;"><span id="MJXc-Node-4545" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.267em;">k</span></span></span></span><span id="MJXc-Node-4546" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.479em; padding-bottom: 0.585em;">)</span></span></span></span><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><msub><mi>C</mi><mrow class="MJX-TeXAtom-ORD"><mi>t</mi><mi>a</mi><mi>r</mi><mi>g</mi><mi>e</mi><mi>t</mi></mrow></msub><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mo>=</mo><mtext>arg</mtext><munder><mo movablelimits="true" form="prefix">max</mo><mi>k</mi></munder><mi>P</mi><mo stretchy="false">(</mo><mi>y</mi><mo>=</mo><msub><mi>C</mi><mi>k</mi></msub><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><mi>x</mi><mo stretchy="false">)</mo><mo>=</mo><mtext>arg</mtext><munder><mo movablelimits="true" form="prefix">max</mo><mi>k</mi></munder><munderover><mo movablelimits="false">∏</mo><mrow class="MJX-TeXAtom-ORD"><mi>l</mi><mo>=</mo><mn>1</mn></mrow><mi>p</mi></munderover><mi>P</mi><mo stretchy="false">(</mo><msup><mi>x</mi><mi>l</mi></msup><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><mi>y</mi><mo>=</mo><msub><mi>C</mi><mi>k</mi></msub><mo stretchy="false">)</mo><mi>P</mi><mo stretchy="false">(</mo><mi>y</mi><mo>=</mo><msub><mi>C</mi><mi>k</mi></msub><mo stretchy="false">)</mo></math></span></span></span><script type="math/tex; mode=display" id="MathJax-Element-285">
    C_{target}(x) = \text{arg}\max_k P(y = C_k | x) = 
    \text{arg}\max_k \prod\limits_{l = 1}^p P(x^l | y = C_k) P(y = C_k)
</script></span><br>
<span>Где все множители оцениваются по обучающей выборке. В частности последний множитель - просто доля класса в ней, а для признаков делается оценка условной плотности для каждой пары признак-класс. Несколько примеров оценок этой плотности:</span></p><ul class="contains-task-list">
<li class="task-list-item"><input class="task-list-item-checkbox" disabled="disabled" type="checkbox"><span> 1. - [ ] 1.  - Если признак категориальный — доля его значений в обучающей выборке на этом классе (так же, как с метками)``</span></li>
<li><span>Предположить, что на каждом признаке есть какое-то </span><em><span>априорное</span></em><span> распределение (например, нормальное) и оценить его параметры по обучающей выборке.</span></li>
<li><span>Построить гистограмму для признака и по ней сделать ядерную оценку плотности (ака сделать гистограмму гладкой, чтобы была плотность для непрерывных признаков)</span></li>
<li><span>Построить гистограмму и сразу использовать её в качестве распределения (смотрим в какую “корзину” попало значение признака).</span></li>
</ul><p><span>Заметим, что если из специфики задачи известны априорное плотности для классов или признаков — их можно (и нужно) использовать в алгоритме вместо оценок.</span></p><h3 id="23-Подбор-гиперпараметров-моделей-Кросс-валидация-Утечки-в-процессе-обучения" data-id="23-Подбор-гиперпараметров-моделей-Кросс-валидация-Утечки-в-процессе-обучения"><a class="anchor hidden-xs" href="#23-Подбор-гиперпараметров-моделей-Кросс-валидация-Утечки-в-процессе-обучения" title="23-Подбор-гиперпараметров-моделей-Кросс-валидация-Утечки-в-процессе-обучения"><span class="octicon octicon-link"></span></a><span>23. Подбор гиперпараметров моделей. Кросс-валидация. Утечки в процессе обучения.</span></h3><ul>
<li><strong><span>Подбор гиперпараметров.</span></strong><span> Стандартной практикой в машинном обучении является разделение выборки три части: обучение, валидацию и тест. На первой части происходит обучение модели (подбор обычных параметров), на второй — выбор гиперпарметров для модели (т.е. мы обучаем на первой части несколько моделей с разными значениями гиперпараметров и сравниваем их на валидации). На тесте мы оцениваем финальное качество модели. Преимуществом такого подхода является снижение риска переобучения — если наш алгоритм переобучился на первом или втором этапах, на этапе тестирования мы всегда видим результат работы алгоритма на выборке, которую он </span><em><span>никогда</span></em><span> до этого не видел.</span></li>
<li><strong><span>Утечки в процессе обучения.</span></strong><span> Допустим, мы используем какое-то простое преобразование над данными, которое использует информацию об обучающей выборке (например, нормировку или отбор признаков). Если мы делим нашу выборку на несколько частей, то мы можем делать это преобразование учитывая информацию не только части выборки для обучения, но и тестовой части. В таком случае, информация из теста просачивается в модель и она может лучше под неё подстроиться. Тогда, проверяя финальное качество модели на тесте, мы уже не можем утверждать, что модель “совсем ничего не знает об этих данных”. Таких утечек стоит избегать, чтобы получать более точные оценки качества модели.</span></li>
<li><span>Альтернативный подход к делению выборки на обучение-валидацию-тест — использование </span><strong><span>кросс-валидации.</span></strong><span> Сначала разделим выборку на обучение и тест. Далее поделим обучение ещё на </span><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-286-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 118%; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>k</mi></math>" role="presentation"><span id="MJXc-Node-4547" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-4548" class="mjx-mrow"><span id="MJXc-Node-4549" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.267em;">k</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>k</mi></math></span></span><script type="math/tex" id="MathJax-Element-286">k</script></span><span> частей, которые называются фолдами. Затем будем обучать нашу модель </span><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-287-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 118%; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>k</mi></math>" role="presentation"><span id="MJXc-Node-4550" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-4551" class="mjx-mrow"><span id="MJXc-Node-4552" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.267em;">k</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>k</mi></math></span></span><script type="math/tex" id="MathJax-Element-287">k</script></span><span> раз на </span><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-288-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 118%; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>k</mi><mo>&amp;#x2212;</mo><mn>1</mn></math>" role="presentation"><span id="MJXc-Node-4553" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-4554" class="mjx-mrow"><span id="MJXc-Node-4555" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.267em;">k</span></span><span id="MJXc-Node-4556" class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.32em; padding-bottom: 0.426em;">−</span></span><span id="MJXc-Node-4557" class="mjx-mn MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.373em; padding-bottom: 0.32em;">1</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>k</mi><mo>−</mo><mn>1</mn></math></span></span><script type="math/tex" id="MathJax-Element-288">k-1</script></span><span> фолде и проверять её качество на оставшемся </span><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-289-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 118%; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>k</mi></math>" role="presentation"><span id="MJXc-Node-4558" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-4559" class="mjx-mrow"><span id="MJXc-Node-4560" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.267em;">k</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>k</mi></math></span></span><script type="math/tex" id="MathJax-Element-289">k</script></span><span>-ом фолде. В конце усредняем метрику качества по всем обучениям. Таким образом мы получаем более точную оценку качества нашего алгоритма (так как каждый раз алгоритм обучается на немного разных выборках).</span>
<ul>
<li><span>По сути мы повторяем процесс деление на обучение-валидацию несколько раз с различающимися частями для обучения.</span></li>
<li><span>Часто кросс-валидацию используют для подбора гиперпараметров: для каждого набора гиперпарметров запускается кросс-валидация и оценивается среднее качество. Выбирается набор с лучшим качеством.</span></li>
<li><span>Для малых выборок лучше выбирать большое </span><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-290-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 118%; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>k</mi><mo>.</mo></math>" role="presentation"><span id="MJXc-Node-4561" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-4562" class="mjx-mrow"><span id="MJXc-Node-4563" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.267em;">k</span></span><span id="MJXc-Node-4564" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="margin-top: -0.156em; padding-bottom: 0.32em;">.</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>k</mi><mo>.</mo></math></span></span><script type="math/tex" id="MathJax-Element-290">k.</script></span><span> Для больших выборок — малое.</span></li>
<li><span>Зачастую в качестве </span><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-291-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 118%; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>k</mi></math>" role="presentation"><span id="MJXc-Node-4565" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-4566" class="mjx-mrow"><span id="MJXc-Node-4567" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.267em;">k</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>k</mi></math></span></span><script type="math/tex" id="MathJax-Element-291">k</script></span><span> выбираются значения 3 или 5.</span></li>
<li><span>Время обучения модели на кросс-валидации растёт с количеством фолдов и размером выборки.</span></li>
<li><span>Очень важно не допускать утечек данных при использовании кросс-валидации. Если вы применяете некоторое преобразование данных, то его нужно делать на на всех фолдах, а только на тех </span><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-292-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 118%; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>k</mi><mo>&amp;#x2212;</mo><mn>1</mn><mo>,</mo></math>" role="presentation"><span id="MJXc-Node-4568" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-4569" class="mjx-mrow"><span id="MJXc-Node-4570" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.267em;">k</span></span><span id="MJXc-Node-4571" class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.32em; padding-bottom: 0.426em;">−</span></span><span id="MJXc-Node-4572" class="mjx-mn MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.373em; padding-bottom: 0.32em;">1</span></span><span id="MJXc-Node-4573" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="margin-top: -0.156em; padding-bottom: 0.532em;">,</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>k</mi><mo>−</mo><mn>1</mn><mo>,</mo></math></span></span><script type="math/tex" id="MathJax-Element-292">k -1,</script></span><span> на которых сейчас обучается модель.</span></li>
<li><span>Стадия деления на фолды может происходить по-разному. Примеры стратегий кросс-валидации (приведены названия из </span><code>sklearn</code><span>):</span>
<ul>
<li>
<p><span>KFold — обычное деление на </span><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-293-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 118%; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>k</mi></math>" role="presentation"><span id="MJXc-Node-4574" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-4575" class="mjx-mrow"><span id="MJXc-Node-4576" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.267em;">k</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>k</mi></math></span></span><script type="math/tex" id="MathJax-Element-293">k</script></span><span> фолдов.</span></p>
</li>
<li>
<p><span>ShuffledSplit — выборка перемеишвается </span><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-294-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 118%; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>k</mi></math>" role="presentation"><span id="MJXc-Node-4577" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-4578" class="mjx-mrow"><span id="MJXc-Node-4579" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.267em;">k</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>k</mi></math></span></span><script type="math/tex" id="MathJax-Element-294">k</script></span><span> раз и каждый раз делится на две части. Не гарантируется, что каждый объект хоть раз попадёт в обучение.</span><img src="https://i.imgur.com/8jxl6Rq.png" alt=""></p>
</li>
<li>
<p><span>StratifiedKFold — в каждом фолде сохраняется соотношение между классами, которое было в исходной выборке (используется при несбалансированных классах).</span></p>
</li>
<li>
<p><span>StratifiedShuffleSplit — комбинация StratifiedKFold и ShuffleSplit.</span><img src="https://i.imgur.com/vIX5Snz.png" alt=""></p>
</li>
<li>
<p><span>GroupKFold — учитывет, что объекты могут принадлежать разным группам (например, группы лиц одного человека в случае распознавания пола) </span><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-295-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 118%; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mo stretchy=&quot;false&quot;>&amp;#x21D2;</mo></math>" role="presentation"><span id="MJXc-Node-4580" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-4581" class="mjx-mrow"><span id="MJXc-Node-4582" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.215em; padding-bottom: 0.373em;">⇒</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo stretchy="false">⇒</mo></math></span></span><script type="math/tex" id="MathJax-Element-295">\Rightarrow</script></span><span> деление происходит так, что объекты одной группы либо целиком попадают в тест, либо целиком в валидацию.</span></p>
</li>
<li>
<p><span>GroupShuffleSplit — в отличие от предыдущей стратегии рандомизирован.</span><br>
<img src="https://i.imgur.com/XUvBrku.png" alt=""></p>
</li>
<li>
<p><span>TimeSeriesSplit — стратегия кросс-валидации для временных рядов (т.е. если объекты упорядочены по врем</span><br>
<span>ени). В обучение всегда попадают данные “предшествующие тестам”, их размер увеличивается с каждой итерацией.</span><br>
<img src="https://i.imgur.com/arTUNwB.png" alt=""></p>
</li>
</ul>
</li>
</ul>
</li>
</ul><h3 id="24-Проблема-переобучения-способы-борьбы-с-ней" data-id="24-Проблема-переобучения-способы-борьбы-с-ней"><a class="anchor hidden-xs" href="#24-Проблема-переобучения-способы-борьбы-с-ней" title="24-Проблема-переобучения-способы-борьбы-с-ней"><span class="octicon octicon-link"></span></a><span>24. Проблема переобучения, способы борьбы с ней.</span></h3><ul>
<li><strong><span>Проблема переобучения</span></strong><span> заключается в том, что при достаточно высокой сложности модели мы можем очень сильно уменьшить ошибку на обучающей выборке, но вместе с этим потерять обобщающую способность модели. Грубо говоря, алгоритм слишком сильно подгоняется под обучающую выборку.</span>
<ul>
<li><span>Хорошим примером является задача восстановления многочлена по данным точкам. Известно, что если даны значения функции в </span><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-296-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 118%; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>k</mi></math>" role="presentation"><span id="MJXc-Node-4583" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-4584" class="mjx-mrow"><span id="MJXc-Node-4585" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.267em;">k</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>k</mi></math></span></span><script type="math/tex" id="MathJax-Element-296">k</script></span><span> точках, то построить многочлен степени </span><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-297-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 118%; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>k</mi><mo>,</mo></math>" role="presentation"><span id="MJXc-Node-4586" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-4587" class="mjx-mrow"><span id="MJXc-Node-4588" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.267em;">k</span></span><span id="MJXc-Node-4589" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="margin-top: -0.156em; padding-bottom: 0.532em;">,</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>k</mi><mo>,</mo></math></span></span><script type="math/tex" id="MathJax-Element-297">k,</script></span><span> который пройдёт точно через данные точки. В таком случае линейная модель над признаками </span><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-298-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 118%; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mo stretchy=&quot;false&quot;>(</mo><mn>1</mn><mo>,</mo><mi>x</mi><mo>,</mo><msup><mi>x</mi><mn>2</mn></msup><mo>,</mo><msup><mi>x</mi><mn>3</mn></msup><mo>,</mo><mo>.</mo><mo>.</mo><mo>.</mo><msup><mi>x</mi><mi>k</mi></msup><mo stretchy=&quot;false&quot;>)</mo></math>" role="presentation"><span id="MJXc-Node-4590" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-4591" class="mjx-mrow"><span id="MJXc-Node-4592" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.479em; padding-bottom: 0.585em;">(</span></span><span id="MJXc-Node-4593" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.373em; padding-bottom: 0.32em;">1</span></span><span id="MJXc-Node-4594" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="margin-top: -0.156em; padding-bottom: 0.532em;">,</span></span><span id="MJXc-Node-4595" class="mjx-mi MJXc-space1"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.215em; padding-bottom: 0.267em;">x</span></span><span id="MJXc-Node-4596" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="margin-top: -0.156em; padding-bottom: 0.532em;">,</span></span><span id="MJXc-Node-4597" class="mjx-msubsup MJXc-space1"><span class="mjx-base"><span id="MJXc-Node-4598" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.215em; padding-bottom: 0.267em;">x</span></span></span><span class="mjx-sup" style="font-size: 70.7%; vertical-align: 0.513em; padding-left: 0px; padding-right: 0.071em;"><span id="MJXc-Node-4599" class="mjx-mn" style=""><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.373em; padding-bottom: 0.32em;">2</span></span></span></span><span id="MJXc-Node-4600" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="margin-top: -0.156em; padding-bottom: 0.532em;">,</span></span><span id="MJXc-Node-4601" class="mjx-msubsup MJXc-space1"><span class="mjx-base"><span id="MJXc-Node-4602" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.215em; padding-bottom: 0.267em;">x</span></span></span><span class="mjx-sup" style="font-size: 70.7%; vertical-align: 0.513em; padding-left: 0px; padding-right: 0.071em;"><span id="MJXc-Node-4603" class="mjx-mn" style=""><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.373em; padding-bottom: 0.373em;">3</span></span></span></span><span id="MJXc-Node-4604" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="margin-top: -0.156em; padding-bottom: 0.532em;">,</span></span><span id="MJXc-Node-4605" class="mjx-mo MJXc-space1"><span class="mjx-char MJXc-TeX-main-R" style="margin-top: -0.156em; padding-bottom: 0.32em;">.</span></span><span id="MJXc-Node-4606" class="mjx-mo MJXc-space1"><span class="mjx-char MJXc-TeX-main-R" style="margin-top: -0.156em; padding-bottom: 0.32em;">.</span></span><span id="MJXc-Node-4607" class="mjx-mo MJXc-space1"><span class="mjx-char MJXc-TeX-main-R" style="margin-top: -0.156em; padding-bottom: 0.32em;">.</span></span><span id="MJXc-Node-4608" class="mjx-msubsup MJXc-space1"><span class="mjx-base"><span id="MJXc-Node-4609" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.215em; padding-bottom: 0.267em;">x</span></span></span><span class="mjx-sup" style="font-size: 70.7%; vertical-align: 0.513em; padding-left: 0px; padding-right: 0.071em;"><span id="MJXc-Node-4610" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.267em;">k</span></span></span></span><span id="MJXc-Node-4611" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.479em; padding-bottom: 0.585em;">)</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo stretchy="false">(</mo><mn>1</mn><mo>,</mo><mi>x</mi><mo>,</mo><msup><mi>x</mi><mn>2</mn></msup><mo>,</mo><msup><mi>x</mi><mn>3</mn></msup><mo>,</mo><mo>.</mo><mo>.</mo><mo>.</mo><msup><mi>x</mi><mi>k</mi></msup><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-298">(1, x, x^2, x^3, ... x^k)</script></span><span> сможет достичь нулевой ошибки. Но, очевидно, что если в качестве “источника точек” взять многочлен низкой степени с добавленным шумом, то наша модель совсем не восстанавливает общую зависимость, а подстраивается под шум. Такая модель будет иметь очень большую ошибку на точках сгенерированных таким же способом, но не входящих в обучающую выборку.</span></li>
</ul>
</li>
<li><span>Чтобы избежать переобучения в машинном обучении практикуется несколько разных методов:</span>
<ul>
<li><em><span>Ограничения на сложность модели.</span></em><span> Например, мы можем ограничивать глубину деревьев чтобы уменьшить возможность переобучения. Другой пример — регуляризация линейных моделей. В функцию добавляется штраф за слишком большие веса модели, которые являются признаком переобучения.</span></li>
<li><em><span>Деление выборки на несколько частей:</span></em><span> обучение, валидация и тест (см. пред пункт).</span></li>
<li><em><span>Кросс-валидация.</span></em><span> С её помощью получается более устойчивая оценка качества алгоритма, если не допускать утечек данных. Подробнее см пред. пункт.</span></li>
<li><span>Некоторые другие приёмы:</span>
<ul>
<li><span>Анализ признаков (в т.ч. удаление незначащих и сильно коррелирующих признаков)</span></li>
<li><span>Остановка обучения (например градиентного спуска) в момент, когда функция ошибки на валидации начинает расти.</span></li>
</ul>
</li>
</ul>
</li>
</ul><h3 id="25-Регуляризация-в-Supervised-learning-L1-и-L2-регуляризация-Другие-способы-регуляризации-Регуляризация-как-ограниченияprior-на-модель-eg-глубина-и-кол-во-деревьев-Dropout-Batch-normalization-Weights-normalization-Data-augmentation-etc" data-id="25-Регуляризация-в-Supervised-learning-L1-и-L2-регуляризация-Другие-способы-регуляризации-Регуляризация-как-ограниченияprior-на-модель-eg-глубина-и-кол-во-деревьев-Dropout-Batch-normalization-Weights-normalization-Data-augmentation-etc"><a class="anchor hidden-xs" href="#25-Регуляризация-в-Supervised-learning-L1-и-L2-регуляризация-Другие-способы-регуляризации-Регуляризация-как-ограниченияprior-на-модель-eg-глубина-и-кол-во-деревьев-Dropout-Batch-normalization-Weights-normalization-Data-augmentation-etc" title="25-Регуляризация-в-Supervised-learning-L1-и-L2-регуляризация-Другие-способы-регуляризации-Регуляризация-как-ограниченияprior-на-модель-eg-глубина-и-кол-во-деревьев-Dropout-Batch-normalization-Weights-normalization-Data-augmentation-etc"><span class="octicon octicon-link"></span></a><span>25. Регуляризация в Supervised learning. L1 и L2 регуляризация. Другие способы регуляризации. Регуляризация как ограничения/prior на модель (e.g. глубина и кол-во деревьев, Dropout, Batch-normalization, Weights normalization, Data augmentation etc.)</span></h3><p><strong><span>Регуляризация</span></strong><span> — ограничения, которые мы накладываем на модель при обучении, пользуюясь какими-то собственными представлениями о возможностях модели или имеющейся задаче. Используется как одна из техник для превентивной борьбы с переобучением.</span></p><ul>
<li><span>L1 и L2 регуляризация используются в линейных моделях, чтобы штрафовать её за большие веса. По сути мы ограничиваем множество всех возможных линейных только теми, у которых не очень большие веса. Являются примерами </span><em><span>нормализации весов.</span></em><br>
<span>Слагаемое, добавляемое к функции потерь для регуляризации:</span><br>
<img src="https://i.imgur.com/FTp0F9w.png" alt=""></li>
<li><span>Для деревьев под регуляризацией обычно понимают ограничения на структуру дерева: глубина, количество листьев, количество объектов в листе для продолжения построения и т.п. “Стрижка” дерева после построения также является способом регуляризации.</span></li>
<li><span>Batch Normalization — нормализация данных (и в нейронных сетях и вообще в любых моделях) помогает избежать переобучения, так как не позволяет модели подстраиваться лишний раз под признаки с большими масштабами.</span>
<ul>
<li><span>Суть слоя в вычислении среднего и дисперсии по каждому признаку и нормировке данных. После этого мы делаем линейное преобразование над данными, чтобы модель во время обучения настраивала те значения дисперсии и среднего, которые улучшат её качество.</span></li>
<li><span>Также во время обучения мы накапливаем информацию обо всей обучающей выборке, а не только текущим батчам с помощью </span><em><span>двигающихся среднего и дисперсии:</span></em><br>
<img src="https://i.imgur.com/29VicQe.png" alt=""></li>
<li><span>Такая нормализация позволяет избежать следующего недостатка алгоритма Backpropogation:</span><br>
<span>Пусть есть два идущих друг за другом слоя: А и Б. Для расчёта градиента Б мы используем выход слоя А, а затем меняем параметры слоя Б в соотвествии с полученными значениями градиента. Но следующим шагом бэкпропа будет аналогичная процедура для слоя А и выход этого слоя изменится, что делает изменение параметров слоя Б неактуальным.</span><br>
<span>Однако при использовании BatchNorm после слоя А мы фиксируем среднее и дисперсию его выхода, что почти полностью решает эту проблему.</span></li>
</ul>
</li>
<li><span>Dropout — слой нейронной сети, который регуляризует нашу модель. Пусть матрица </span><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-299-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 118%; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>X</mi></math>" role="presentation"><span id="MJXc-Node-4612" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-4613" class="mjx-mrow"><span id="MJXc-Node-4614" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.267em; padding-right: 0.024em;">X</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>X</mi></math></span></span><script type="math/tex" id="MathJax-Element-299">X</script></span><span> — входные данные этого слоя. Во время для каждого элемента матрицы занулим его с заранее выбранной вероятностью </span><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-300-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 118%; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>p</mi><mo>.</mo></math>" role="presentation"><span id="MJXc-Node-4615" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-4616" class="mjx-mrow"><span id="MJXc-Node-4617" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.215em; padding-bottom: 0.479em;">p</span></span><span id="MJXc-Node-4618" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="margin-top: -0.156em; padding-bottom: 0.32em;">.</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>p</mi><mo>.</mo></math></span></span><script type="math/tex" id="MathJax-Element-300">p.</script></span><span> Соответственно, с вероятностью </span><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-301-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 118%; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mn>1</mn><mo>&amp;#x2212;</mo><mi>p</mi></math>" role="presentation"><span id="MJXc-Node-4619" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-4620" class="mjx-mrow"><span id="MJXc-Node-4621" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.373em; padding-bottom: 0.32em;">1</span></span><span id="MJXc-Node-4622" class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.32em; padding-bottom: 0.426em;">−</span></span><span id="MJXc-Node-4623" class="mjx-mi MJXc-space2"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.215em; padding-bottom: 0.479em;">p</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mn>1</mn><mo>−</mo><mi>p</mi></math></span></span><script type="math/tex" id="MathJax-Element-301">1 - p</script></span><span> мы ничего не делаем с элементом матрицы и так и оставляем его в выходе слоя.</span>
<ul>
<li><span>Суть слоя в том, что мы обучаем более слабую модель (так как сознательно игнорируем некоторую информацию из нашей выборки) и за счёт этого не позволяем модели подогнаться под обучающую выборку.</span></li>
<li><span>Отметим, что во время обучения стоит домножать выходы слоя на нормировочный коэффициент </span><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-302-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 118%; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mfrac><mn>1</mn><mrow><mn>1</mn><mo>&amp;#x2212;</mo><mi>p</mi></mrow></mfrac></math>" role="presentation"><span id="MJXc-Node-4624" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-4625" class="mjx-mrow"><span id="MJXc-Node-4626" class="mjx-mfrac"><span class="mjx-box MJXc-stacked" style="width: 1.401em; padding: 0px 0.12em;"><span class="mjx-numerator" style="font-size: 70.7%; width: 1.981em; top: -1.299em;"><span id="MJXc-Node-4627" class="mjx-mn" style=""><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.373em; padding-bottom: 0.32em;">1</span></span></span><span class="mjx-denominator" style="font-size: 70.7%; width: 1.981em; bottom: -0.786em;"><span id="MJXc-Node-4628" class="mjx-mrow" style=""><span id="MJXc-Node-4629" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.373em; padding-bottom: 0.32em;">1</span></span><span id="MJXc-Node-4630" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.32em; padding-bottom: 0.426em;">−</span></span><span id="MJXc-Node-4631" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.215em; padding-bottom: 0.479em;">p</span></span></span></span><span style="border-bottom-width: 1.3px; border-bottom-style: solid; top: -0.283em; width: 1.401em;" class="mjx-line"></span></span><span style="height: 1.475em; vertical-align: -0.556em;" class="mjx-vsize"></span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mfrac><mn>1</mn><mrow><mn>1</mn><mo>−</mo><mi>p</mi></mrow></mfrac></math></span></span><script type="math/tex" id="MathJax-Element-302">\frac{1}{1 - p}</script></span><span> чтобы не менять среднее выборки (так модель становится более устойчивой).</span></li>
<li><span>Во время эксплуатации модели (inference) этот слой не делает ничего, чтобы использовать полную информацию о выборке.</span></li>
</ul>
</li>
<li><span>Data augmentation — копируем объекты нашей выборки, немного их изменяя, чтобы они оставались в той же генеральной совокупности. Например, в случае с картинками мы можем добавлять зеркальное отражение немного менять цветовую гамму и т.п. Таким образом, модель лучше распознаёт общие закономерности объектов и становится более устойчивой.</span></li>
</ul><h2 id="Теоретический-минимум" data-id="Теоретический-минимум"><a class="anchor hidden-xs" href="#Теоретический-минимум" title="Теоретический-минимум"><span class="octicon octicon-link"></span></a><span>Теоретический минимум.</span></h2><h3 id="1-Постановка-задачи-обучения-с-учителем-supervised-learning-Отличие-регрессии-от-классификации" data-id="1-Постановка-задачи-обучения-с-учителем-supervised-learning-Отличие-регрессии-от-классификации"><a class="anchor hidden-xs" href="#1-Постановка-задачи-обучения-с-учителем-supervised-learning-Отличие-регрессии-от-классификации" title="1-Постановка-задачи-обучения-с-учителем-supervised-learning-Отличие-регрессии-от-классификации"><span class="octicon octicon-link"></span></a><span>1. Постановка задачи обучения с учителем (supervised learning). Отличие регрессии от классификации.</span></h3><ul>
<li><span>Дано: </span><strong><span>выборка (dataset)</span></strong><span> — она же матрица объекты-признаки </span><em><span>(design matrix)</span></em><span> со значениями </span><em><span>целевой переменной (target):</span></em><span> </span><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-303-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 118%; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mo stretchy=&quot;false&quot;>(</mo><mi>X</mi><mo>,</mo><mi>y</mi><msub><mo stretchy=&quot;false&quot;>)</mo><mi>l</mi></msub><mo>.</mo></math>" role="presentation"><span id="MJXc-Node-4632" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-4633" class="mjx-mrow"><span id="MJXc-Node-4634" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.479em; padding-bottom: 0.585em;">(</span></span><span id="MJXc-Node-4635" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.267em; padding-right: 0.024em;">X</span></span><span id="MJXc-Node-4636" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="margin-top: -0.156em; padding-bottom: 0.532em;">,</span></span><span id="MJXc-Node-4637" class="mjx-mi MJXc-space1"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.215em; padding-bottom: 0.479em; padding-right: 0.006em;">y</span></span><span id="MJXc-Node-4638" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-4639" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.479em; padding-bottom: 0.585em;">)</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.219em; padding-right: 0.071em;"><span id="MJXc-Node-4640" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.267em;">l</span></span></span></span><span id="MJXc-Node-4641" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="margin-top: -0.156em; padding-bottom: 0.32em;">.</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo stretchy="false">(</mo><mi>X</mi><mo>,</mo><mi>y</mi><msub><mo stretchy="false">)</mo><mi>l</mi></msub><mo>.</mo></math></span></span><script type="math/tex" id="MathJax-Element-303">(X, y)_l.</script></span></li>
<li><span>Постановка задачи </span><strong><span>обучения с учителем</span></strong><span>: найти алгоритм, минимизирующего фиксированный (для задачи) функционал ошибки на данной обучающей выборке.</span></li>
<li><span>Обычно функционал ошибки сравнивает “предсказания” нашего алгоритма с данными значениями таргета.</span></li>
<li><span>Задачи классифицируются по типу целевой переменной:</span>
<ul>
<li><span>Целевая переменная — вещественное числом (</span><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-304-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 118%; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi mathvariant=&quot;double-struck&quot;>Y</mi></mrow><mo>=</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi mathvariant=&quot;double-struck&quot;>R</mi></mrow></math>" role="presentation"><span id="MJXc-Node-4642" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-4643" class="mjx-mrow"><span id="MJXc-Node-4644" class="mjx-texatom"><span id="MJXc-Node-4645" class="mjx-mrow"><span id="MJXc-Node-4646" class="mjx-mi"><span class="mjx-char MJXc-TeX-ams-R" style="padding-top: 0.426em; padding-bottom: 0.32em;">Y</span></span></span></span><span id="MJXc-Node-4647" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.056em; padding-bottom: 0.32em;">=</span></span><span id="MJXc-Node-4648" class="mjx-texatom MJXc-space3"><span id="MJXc-Node-4649" class="mjx-mrow"><span id="MJXc-Node-4650" class="mjx-mi"><span class="mjx-char MJXc-TeX-ams-R" style="padding-top: 0.426em; padding-bottom: 0.32em;">R</span></span></span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="double-struck">Y</mi></mrow><mo>=</mo><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="double-struck">R</mi></mrow></math></span></span><script type="math/tex" id="MathJax-Element-304">\mathbb{Y} = \mathbb{R}</script></span><span>), то поставлена задача </span><strong><span>регрессии</span></strong><span>.</span></li>
<li><span>Целевая перменная принадлежит какому-то конечному множеству (меток классов), то поставлена задача </span><strong><span>классификации</span></strong><span>. (В частности, если в множестве всего два элемента (класса) то стоит задача </span><em><span>бинарной классификации</span></em><span>).</span></li>
</ul>
</li>
</ul><h3 id="2-Что-такое-объект-целевая-переменная-признак-модель-функционал-ошибки-и-обучение" data-id="2-Что-такое-объект-целевая-переменная-признак-модель-функционал-ошибки-и-обучение"><a class="anchor hidden-xs" href="#2-Что-такое-объект-целевая-переменная-признак-модель-функционал-ошибки-и-обучение" title="2-Что-такое-объект-целевая-переменная-признак-модель-функционал-ошибки-и-обучение"><span class="octicon octicon-link"></span></a><span>2. Что такое объект, целевая переменная, признак, модель, функционал ошибки и обучение.</span></h3><ul>
<li><strong><span>Объект</span></strong>
<ul>
<li><span>То, для чего мы хотим уметь предсказывать значение целевой переменной.</span></li>
<li><span>Вектор из значений признаков (или, что то же самое — точка в пространстве признаков).</span></li>
<li><span>Одна строка матрицы / один элемент обучающей выборки.</span></li>
</ul>
</li>
<li><strong><span>Целевая переменная</span></strong><span> — число или метка класса, ставящаяся в соответствие одному объекту.</span></li>
<li><strong><span>Признак</span></strong><span> — характеристика объекта (любой кусочек информации, который нам доступен об объекте). Признаки могут быть числовыми </span><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-305-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 118%; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mo stretchy=&quot;false&quot;>(</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi mathvariant=&quot;double-struck&quot;>R</mi></mrow><mo stretchy=&quot;false&quot;>)</mo></math>" role="presentation"><span id="MJXc-Node-4651" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-4652" class="mjx-mrow"><span id="MJXc-Node-4653" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.479em; padding-bottom: 0.585em;">(</span></span><span id="MJXc-Node-4654" class="mjx-texatom"><span id="MJXc-Node-4655" class="mjx-mrow"><span id="MJXc-Node-4656" class="mjx-mi"><span class="mjx-char MJXc-TeX-ams-R" style="padding-top: 0.426em; padding-bottom: 0.32em;">R</span></span></span></span><span id="MJXc-Node-4657" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.479em; padding-bottom: 0.585em;">)</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo stretchy="false">(</mo><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="double-struck">R</mi></mrow><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-305">(\mathbb{R})</script></span><span>, категориальными (из фиксированного заранее множества) упорядоченными, или бинарными.</span>
<ul>
<li><span>По сути признаком является любой кусочек информации об объекте.</span></li>
<li><span>Предполагается, что все объекты в рамках одной задачи описываются одними и теми же признаками.</span></li>
</ul>
</li>
<li><strong><span>Модель</span></strong><span> (алгоритм) — отображение из пространства признаков в множество целевой переменной (объект -&gt; целевая переменная).</span></li>
<li><strong><span>Функционал ошибки</span></strong><span> — функционал на множестве алгоритмов, зависящий от обучающей выборки.</span>
<ul>
<li><span>Является характеристикой качества алгоритма: чем больше разница между предсказаниями алгоритма для объектов обучающей выборки и их таргетами, тем больше значение функционала ошибки.</span></li>
</ul>
</li>
<li><strong><span>Обучение</span></strong><span> — процесс подбора параметров, от которых зависит алгоритм, таким образом, чтобы минимизировать функционал ошибки.</span>
<ul>
<li><span>Т.е. перед обучением фиксируется некоторое </span><em><span>семейство алгоритмов</span></em><span> внутри которого модели отличаются друг от друга лишь значениями параметров.</span></li>
</ul>
</li>
</ul><h3 id="3-Что-такое-свойство-iid-" data-id="3-Что-такое-свойство-iid-"><a class="anchor hidden-xs" href="#3-Что-такое-свойство-iid-" title="3-Что-такое-свойство-iid-"><span class="octicon octicon-link"></span></a><span>3. Что такое свойство i.i.d. ?</span></h3><p><strong><span>Independant and Identically Distributed</span></strong><span> - независимые и одинаково распределенные.</span><br>
<span>В машинном обучении обычно предполагается, что обучающая выборка всегда удовлетворяет этому свойству. Это значит:</span></p><ul>
<li><span>Все объекты выборки независимы друг с другом (т.е. их можно считать независимыми случайными векторами) </span><em><span>(independant)</span></em></li>
<li><span>Все объекты выборки одинаково распределены (т.е. эти случайные вектора имеют одинаковое распределение) </span><em><span>(identically distributed)</span></em></li>
</ul><p><span>Второе свойство означает что объекты выборки считаются принадлежащими некоторой одной общей совокупности. Например, если модель обучена предсказывать температуру в России по каким-то климатическим показателям, то мы не сможем воспользоваться этой моделью чтобы предсказать температуру в странах расположенных ближе к экватору.</span></p><h3 id="4-Запишите-формулы-для-линейной-модели-регрессии-и-для-среднеквадратичной-ошибки" data-id="4-Запишите-формулы-для-линейной-модели-регрессии-и-для-среднеквадратичной-ошибки"><a class="anchor hidden-xs" href="#4-Запишите-формулы-для-линейной-модели-регрессии-и-для-среднеквадратичной-ошибки" title="4-Запишите-формулы-для-линейной-модели-регрессии-и-для-среднеквадратичной-ошибки"><span class="octicon octicon-link"></span></a><span>4. Запишите формулы для линейной модели регрессии и для среднеквадратичной ошибки.</span></h3><ul>
<li><span>Линейная регрессия: </span><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-306-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 118%; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>f</mi><mo stretchy=&quot;false&quot;>(</mo><mi>X</mi><mo stretchy=&quot;false&quot;>)</mo><mo>=</mo><mi>X</mi><mi>w</mi><mo>,</mo></math>" role="presentation"><span id="MJXc-Node-4658" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-4659" class="mjx-mrow"><span id="MJXc-Node-4660" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.479em; padding-right: 0.06em;">f</span></span><span id="MJXc-Node-4661" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.479em; padding-bottom: 0.585em;">(</span></span><span id="MJXc-Node-4662" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.267em; padding-right: 0.024em;">X</span></span><span id="MJXc-Node-4663" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.479em; padding-bottom: 0.585em;">)</span></span><span id="MJXc-Node-4664" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.056em; padding-bottom: 0.32em;">=</span></span><span id="MJXc-Node-4665" class="mjx-mi MJXc-space3"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.267em; padding-right: 0.024em;">X</span></span><span id="MJXc-Node-4666" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.215em; padding-bottom: 0.267em;">w</span></span><span id="MJXc-Node-4667" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="margin-top: -0.156em; padding-bottom: 0.532em;">,</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>f</mi><mo stretchy="false">(</mo><mi>X</mi><mo stretchy="false">)</mo><mo>=</mo><mi>X</mi><mi>w</mi><mo>,</mo></math></span></span><script type="math/tex" id="MathJax-Element-306">f(X) = Xw,</script></span><span> где </span><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-307-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 118%; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>w</mi></math>" role="presentation"><span id="MJXc-Node-4668" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-4669" class="mjx-mrow"><span id="MJXc-Node-4670" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.215em; padding-bottom: 0.267em;">w</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>w</mi></math></span></span><script type="math/tex" id="MathJax-Element-307">w</script></span><span> — вектор весов модели, </span><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-308-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 118%; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>X</mi></math>" role="presentation"><span id="MJXc-Node-4671" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-4672" class="mjx-mrow"><span id="MJXc-Node-4673" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.267em; padding-right: 0.024em;">X</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>X</mi></math></span></span><script type="math/tex" id="MathJax-Element-308">X</script></span><span> — матрица объекты-признаки для которой мы хотим получить предсказание модели.</span></li>
<li><span>Среднеквадратичная ошибка (MSE): </span><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-309-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 118%; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>L</mi><mo stretchy=&quot;false&quot;>(</mo><mi>X</mi><mo>,</mo><mi>Y</mi><mo>,</mo><mi>f</mi><mo stretchy=&quot;false&quot;>(</mo><mi>X</mi><mo stretchy=&quot;false&quot;>)</mo><mo stretchy=&quot;false&quot;>)</mo><mo>=</mo><mfrac><mn>1</mn><mi>n</mi></mfrac><munderover><mo movablelimits=&quot;false&quot;>&amp;#x2211;</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>n</mi></munderover><mo stretchy=&quot;false&quot;>(</mo><mi>f</mi><mo stretchy=&quot;false&quot;>(</mo><msub><mi>x</mi><mi>i</mi></msub><mo stretchy=&quot;false&quot;>)</mo><mo>&amp;#x2212;</mo><msub><mi>y</mi><mi>i</mi></msub><msup><mo stretchy=&quot;false&quot;>)</mo><mn>2</mn></msup><mo>=</mo><mfrac><mn>1</mn><mi>n</mi></mfrac><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>|</mo></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>|</mo></mrow><mi>X</mi><mi>w</mi><mo>&amp;#x2212;</mo><mi>Y</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>|</mo></mrow><msubsup><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>|</mo></mrow><mn>2</mn><mn>2</mn></msubsup></math>" role="presentation"><span id="MJXc-Node-4674" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-4675" class="mjx-mrow"><span id="MJXc-Node-4676" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.267em;">L</span></span><span id="MJXc-Node-4677" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.479em; padding-bottom: 0.585em;">(</span></span><span id="MJXc-Node-4678" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.267em; padding-right: 0.024em;">X</span></span><span id="MJXc-Node-4679" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="margin-top: -0.156em; padding-bottom: 0.532em;">,</span></span><span id="MJXc-Node-4680" class="mjx-mi MJXc-space1"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.267em; padding-right: 0.182em;">Y</span></span><span id="MJXc-Node-4681" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="margin-top: -0.156em; padding-bottom: 0.532em;">,</span></span><span id="MJXc-Node-4682" class="mjx-mi MJXc-space1"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.479em; padding-right: 0.06em;">f</span></span><span id="MJXc-Node-4683" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.479em; padding-bottom: 0.585em;">(</span></span><span id="MJXc-Node-4684" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.267em; padding-right: 0.024em;">X</span></span><span id="MJXc-Node-4685" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.479em; padding-bottom: 0.585em;">)</span></span><span id="MJXc-Node-4686" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.479em; padding-bottom: 0.585em;">)</span></span><span id="MJXc-Node-4687" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.056em; padding-bottom: 0.32em;">=</span></span><span id="MJXc-Node-4688" class="mjx-mfrac MJXc-space3"><span class="mjx-box MJXc-stacked" style="width: 0.566em; padding: 0px 0.12em;"><span class="mjx-numerator" style="font-size: 70.7%; width: 0.8em; top: -1.299em;"><span id="MJXc-Node-4689" class="mjx-mn" style=""><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.373em; padding-bottom: 0.32em;">1</span></span></span><span class="mjx-denominator" style="font-size: 70.7%; width: 0.8em; bottom: -0.524em;"><span id="MJXc-Node-4690" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.215em; padding-bottom: 0.267em;">n</span></span></span><span style="border-bottom-width: 1.3px; border-bottom-style: solid; top: -0.283em; width: 0.566em;" class="mjx-line"></span></span><span style="height: 1.289em; vertical-align: -0.37em;" class="mjx-vsize"></span></span><span id="MJXc-Node-4691" class="mjx-munderover MJXc-space1"><span class="mjx-itable"><span class="mjx-row"><span class="mjx-cell"><span class="mjx-stack"><span class="mjx-over" style="font-size: 70.7%; padding-bottom: 0.247em; padding-top: 0.141em; padding-left: 0.512em;"><span id="MJXc-Node-4698" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.215em; padding-bottom: 0.267em;">n</span></span></span><span class="mjx-op" style="padding-left: 0.046em;"><span id="MJXc-Node-4692" class="mjx-mo"><span class="mjx-char MJXc-TeX-size1-R" style="padding-top: 0.532em; padding-bottom: 0.532em;">∑</span></span></span></span></span></span><span class="mjx-row"><span class="mjx-under" style="font-size: 70.7%; padding-top: 0.236em; padding-bottom: 0.141em;"><span id="MJXc-Node-4693" class="mjx-texatom" style=""><span id="MJXc-Node-4694" class="mjx-mrow"><span id="MJXc-Node-4695" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.426em; padding-bottom: 0.267em;">i</span></span><span id="MJXc-Node-4696" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.056em; padding-bottom: 0.32em;">=</span></span><span id="MJXc-Node-4697" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.373em; padding-bottom: 0.32em;">1</span></span></span></span></span></span></span></span><span id="MJXc-Node-4699" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.479em; padding-bottom: 0.585em;">(</span></span><span id="MJXc-Node-4700" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.479em; padding-right: 0.06em;">f</span></span><span id="MJXc-Node-4701" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.479em; padding-bottom: 0.585em;">(</span></span><span id="MJXc-Node-4702" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-4703" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.215em; padding-bottom: 0.267em;">x</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-4704" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.426em; padding-bottom: 0.267em;">i</span></span></span></span><span id="MJXc-Node-4705" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.479em; padding-bottom: 0.585em;">)</span></span><span id="MJXc-Node-4706" class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.32em; padding-bottom: 0.426em;">−</span></span><span id="MJXc-Node-4707" class="mjx-msubsup MJXc-space2"><span class="mjx-base" style="margin-right: -0.006em;"><span id="MJXc-Node-4708" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.215em; padding-bottom: 0.479em; padding-right: 0.006em;">y</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-4709" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.426em; padding-bottom: 0.267em;">i</span></span></span></span><span id="MJXc-Node-4710" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-4711" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.479em; padding-bottom: 0.585em;">)</span></span></span><span class="mjx-sup" style="font-size: 70.7%; vertical-align: 0.513em; padding-left: 0px; padding-right: 0.071em;"><span id="MJXc-Node-4712" class="mjx-mn" style=""><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.373em; padding-bottom: 0.32em;">2</span></span></span></span><span id="MJXc-Node-4713" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.056em; padding-bottom: 0.32em;">=</span></span><span id="MJXc-Node-4714" class="mjx-mfrac MJXc-space3"><span class="mjx-box MJXc-stacked" style="width: 0.566em; padding: 0px 0.12em;"><span class="mjx-numerator" style="font-size: 70.7%; width: 0.8em; top: -1.299em;"><span id="MJXc-Node-4715" class="mjx-mn" style=""><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.373em; padding-bottom: 0.32em;">1</span></span></span><span class="mjx-denominator" style="font-size: 70.7%; width: 0.8em; bottom: -0.524em;"><span id="MJXc-Node-4716" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.215em; padding-bottom: 0.267em;">n</span></span></span><span style="border-bottom-width: 1.3px; border-bottom-style: solid; top: -0.283em; width: 0.566em;" class="mjx-line"></span></span><span style="height: 1.289em; vertical-align: -0.37em;" class="mjx-vsize"></span></span><span id="MJXc-Node-4717" class="mjx-texatom"><span id="MJXc-Node-4718" class="mjx-mrow"><span id="MJXc-Node-4719" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.479em; padding-bottom: 0.585em;">|</span></span></span></span><span id="MJXc-Node-4720" class="mjx-texatom"><span id="MJXc-Node-4721" class="mjx-mrow"><span id="MJXc-Node-4722" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.479em; padding-bottom: 0.585em;">|</span></span></span></span><span id="MJXc-Node-4723" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.267em; padding-right: 0.024em;">X</span></span><span id="MJXc-Node-4724" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.215em; padding-bottom: 0.267em;">w</span></span><span id="MJXc-Node-4725" class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.32em; padding-bottom: 0.426em;">−</span></span><span id="MJXc-Node-4726" class="mjx-mi MJXc-space2"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.267em; padding-right: 0.182em;">Y</span></span><span id="MJXc-Node-4727" class="mjx-texatom"><span id="MJXc-Node-4728" class="mjx-mrow"><span id="MJXc-Node-4729" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.479em; padding-bottom: 0.585em;">|</span></span></span></span><span id="MJXc-Node-4730" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-4731" class="mjx-texatom"><span id="MJXc-Node-4732" class="mjx-mrow"><span id="MJXc-Node-4733" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.479em; padding-bottom: 0.585em;">|</span></span></span></span></span><span class="mjx-stack" style="vertical-align: -0.309em;"><span class="mjx-sup" style="font-size: 70.7%; padding-bottom: 0.431em; padding-left: 0px; padding-right: 0.071em;"><span id="MJXc-Node-4735" class="mjx-mn" style=""><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.373em; padding-bottom: 0.32em;">2</span></span></span><span class="mjx-sub" style="font-size: 70.7%; padding-right: 0.071em;"><span id="MJXc-Node-4734" class="mjx-mn" style=""><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.373em; padding-bottom: 0.32em;">2</span></span></span></span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>L</mi><mo stretchy="false">(</mo><mi>X</mi><mo>,</mo><mi>Y</mi><mo>,</mo><mi>f</mi><mo stretchy="false">(</mo><mi>X</mi><mo stretchy="false">)</mo><mo stretchy="false">)</mo><mo>=</mo><mfrac><mn>1</mn><mi>n</mi></mfrac><munderover><mo movablelimits="false">∑</mo><mrow class="MJX-TeXAtom-ORD"><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>n</mi></munderover><mo stretchy="false">(</mo><mi>f</mi><mo stretchy="false">(</mo><msub><mi>x</mi><mi>i</mi></msub><mo stretchy="false">)</mo><mo>−</mo><msub><mi>y</mi><mi>i</mi></msub><msup><mo stretchy="false">)</mo><mn>2</mn></msup><mo>=</mo><mfrac><mn>1</mn><mi>n</mi></mfrac><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><mi>X</mi><mi>w</mi><mo>−</mo><mi>Y</mi><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><msubsup><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><mn>2</mn><mn>2</mn></msubsup></math></span></span><script type="math/tex" id="MathJax-Element-309">L(X, Y, f(X)) = \frac{1}{n}\sum\limits_{i=1}^n(f(x_i) - y_i)^2 = \frac{1}{n} ||Xw - Y||_2^2</script></span></li>
</ul><h3 id="5-Что-такое-градиент-Какое-его-свойство-используется-при-минимизации-функций" data-id="5-Что-такое-градиент-Какое-его-свойство-используется-при-минимизации-функций"><a class="anchor hidden-xs" href="#5-Что-такое-градиент-Какое-его-свойство-используется-при-минимизации-функций" title="5-Что-такое-градиент-Какое-его-свойство-используется-при-минимизации-функций"><span class="octicon octicon-link"></span></a><span>5. Что такое градиент? Какое его свойство используется при минимизации функций?</span></h3><ul>
<li><strong><span>Градиент</span></strong><span> — вектор-функция составленная из частных производных некоторой функции. В машинном обучении обычно подразумевается градиент функции ошибки по вектору весов.</span></li>
<li><strong><span>Основное свойство градиента</span></strong><span> — значение градиента в точке показывает направление скорейшего роста функции. Соответственно, направление антиградиента показывает направление скорейшего убывания. При поиске минимума функции мы небольшими шагами двигаемся в сторону антиградиента, пересчитывая его на каждой итерации и приходим к минимуму. В этом заключается алгоритм градиентного спуска, использующегося для минимизации функций.</span>
<ul>
<li><span>Отметим, что градиентный спуск плохо работает в случае, когда у функции есть несколько локальных минимумов.</span></li>
</ul>
</li>
</ul><h3 id="6-Запишите-формулу-для-одного-шага-градиентного-спуска-Как-модифицировать-градиентный-спуск-для-очень-большой-выборки" data-id="6-Запишите-формулу-для-одного-шага-градиентного-спуска-Как-модифицировать-градиентный-спуск-для-очень-большой-выборки"><a class="anchor hidden-xs" href="#6-Запишите-формулу-для-одного-шага-градиентного-спуска-Как-модифицировать-градиентный-спуск-для-очень-большой-выборки" title="6-Запишите-формулу-для-одного-шага-градиентного-спуска-Как-модифицировать-градиентный-спуск-для-очень-большой-выборки"><span class="octicon octicon-link"></span></a><span>6. Запишите формулу для одного шага градиентного спуска. Как модифицировать градиентный спуск для очень большой выборки?</span></h3><ul>
<li><strong><span>Шаг градиентного спуска:</span></strong><br>
<span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span class="mjx-chtml MJXc-display" style="text-align: center;"><span id="MathJax-Element-310-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 118%; text-align: center; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><msup><mi>w</mi><mi>t</mi></msup><mo>=</mo><msup><mi>w</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>t</mi><mo>&amp;#x2212;</mo><mn>1</mn></mrow></msup><mo>&amp;#x2212;</mo><msub><mi>&amp;#x03B7;</mi><mi>t</mi></msub><mi mathvariant=&quot;normal&quot;>&amp;#x2207;</mi><mi>L</mi><mo stretchy=&quot;false&quot;>(</mo><msup><mi>w</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>t</mi><mo>&amp;#x2212;</mo><mn>1</mn></mrow></msup><mo>,</mo><mi>X</mi><mo stretchy=&quot;false&quot;>)</mo></math>" role="presentation"><span id="MJXc-Node-4736" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-4737" class="mjx-mrow"><span id="MJXc-Node-4738" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-4739" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.215em; padding-bottom: 0.267em;">w</span></span></span><span class="mjx-sup" style="font-size: 70.7%; vertical-align: 0.584em; padding-left: 0px; padding-right: 0.071em;"><span id="MJXc-Node-4740" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.426em; padding-bottom: 0.267em;">t</span></span></span></span><span id="MJXc-Node-4741" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.056em; padding-bottom: 0.32em;">=</span></span><span id="MJXc-Node-4742" class="mjx-msubsup MJXc-space3"><span class="mjx-base"><span id="MJXc-Node-4743" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.215em; padding-bottom: 0.267em;">w</span></span></span><span class="mjx-sup" style="font-size: 70.7%; vertical-align: 0.584em; padding-left: 0px; padding-right: 0.071em;"><span id="MJXc-Node-4744" class="mjx-texatom" style=""><span id="MJXc-Node-4745" class="mjx-mrow"><span id="MJXc-Node-4746" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.426em; padding-bottom: 0.267em;">t</span></span><span id="MJXc-Node-4747" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.32em; padding-bottom: 0.426em;">−</span></span><span id="MJXc-Node-4748" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.373em; padding-bottom: 0.32em;">1</span></span></span></span></span></span><span id="MJXc-Node-4749" class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.32em; padding-bottom: 0.426em;">−</span></span><span id="MJXc-Node-4750" class="mjx-msubsup MJXc-space2"><span class="mjx-base" style="margin-right: -0.006em;"><span id="MJXc-Node-4751" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.215em; padding-bottom: 0.479em; padding-right: 0.006em;">η</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-4752" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.426em; padding-bottom: 0.267em;">t</span></span></span></span><span id="MJXc-Node-4753" class="mjx-mi"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.373em; padding-bottom: 0.373em;">∇</span></span><span id="MJXc-Node-4754" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.267em;">L</span></span><span id="MJXc-Node-4755" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.479em; padding-bottom: 0.585em;">(</span></span><span id="MJXc-Node-4756" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-4757" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.215em; padding-bottom: 0.267em;">w</span></span></span><span class="mjx-sup" style="font-size: 70.7%; vertical-align: 0.584em; padding-left: 0px; padding-right: 0.071em;"><span id="MJXc-Node-4758" class="mjx-texatom" style=""><span id="MJXc-Node-4759" class="mjx-mrow"><span id="MJXc-Node-4760" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.426em; padding-bottom: 0.267em;">t</span></span><span id="MJXc-Node-4761" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.32em; padding-bottom: 0.426em;">−</span></span><span id="MJXc-Node-4762" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.373em; padding-bottom: 0.32em;">1</span></span></span></span></span></span><span id="MJXc-Node-4763" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="margin-top: -0.156em; padding-bottom: 0.532em;">,</span></span><span id="MJXc-Node-4764" class="mjx-mi MJXc-space1"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.267em; padding-right: 0.024em;">X</span></span><span id="MJXc-Node-4765" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.479em; padding-bottom: 0.585em;">)</span></span></span></span><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><msup><mi>w</mi><mi>t</mi></msup><mo>=</mo><msup><mi>w</mi><mrow class="MJX-TeXAtom-ORD"><mi>t</mi><mo>−</mo><mn>1</mn></mrow></msup><mo>−</mo><msub><mi>η</mi><mi>t</mi></msub><mi mathvariant="normal">∇</mi><mi>L</mi><mo stretchy="false">(</mo><msup><mi>w</mi><mrow class="MJX-TeXAtom-ORD"><mi>t</mi><mo>−</mo><mn>1</mn></mrow></msup><mo>,</mo><mi>X</mi><mo stretchy="false">)</mo></math></span></span></span><script type="math/tex; mode=display" id="MathJax-Element-310">
 w^t = w^{t - 1} - \eta_t \nabla L(w^{t-1}, X)
</script></span><br>
<span>Здесь </span><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-311-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 118%; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>t</mi></math>" role="presentation"><span id="MJXc-Node-4766" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-4767" class="mjx-mrow"><span id="MJXc-Node-4768" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.426em; padding-bottom: 0.267em;">t</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>t</mi></math></span></span><script type="math/tex" id="MathJax-Element-311">t</script></span><span> — номер шага, </span><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-312-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 118%; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>&amp;#x03B7;</mi><mi>t</mi></msub></math>" role="presentation"><span id="MJXc-Node-4769" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-4770" class="mjx-mrow"><span id="MJXc-Node-4771" class="mjx-msubsup"><span class="mjx-base" style="margin-right: -0.006em;"><span id="MJXc-Node-4772" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.215em; padding-bottom: 0.479em; padding-right: 0.006em;">η</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-4773" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.426em; padding-bottom: 0.267em;">t</span></span></span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>η</mi><mi>t</mi></msub></math></span></span><script type="math/tex" id="MathJax-Element-312">\eta_t</script></span><span> — learning rate на текущем шаге (может быть зафиксирован заранее, а может убывать с номером шага), </span><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-313-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 118%; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi mathvariant=&quot;normal&quot;>&amp;#x2207;</mi><mi>L</mi></math>" role="presentation"><span id="MJXc-Node-4774" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-4775" class="mjx-mrow"><span id="MJXc-Node-4776" class="mjx-mi"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.373em; padding-bottom: 0.373em;">∇</span></span><span id="MJXc-Node-4777" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.267em;">L</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi mathvariant="normal">∇</mi><mi>L</mi></math></span></span><script type="math/tex" id="MathJax-Element-313">\nabla L</script></span><span> — вектор градиента функции ошибки.</span><br>
<span>(перед этим стоит не забыть задать начальное приближение и точность расчета)</span></li>
<li><span>Обычно функционал L зависит от всей выборки, поэтому расчёт градиента может занимать относительно много времени. Поэтому в случае </span><strong><span>больших выборок</span></strong><span> используют </span><em><span>стохастический градиентный спуск,</span></em><span> в котором направление градиента считается не по всей выборке, а по случайно выбранной подвыборке (которую называют </span><em><span>батчом</span></em><span>). Такой алгоритм сходится медленнее, но считается быстрее в случае больших выборок.</span></li>
</ul><h3 id="7-Что-такое-кросс-валидация-На-что-влияет-количество-блоков-в-кросс-валидации" data-id="7-Что-такое-кросс-валидация-На-что-влияет-количество-блоков-в-кросс-валидации"><a class="anchor hidden-xs" href="#7-Что-такое-кросс-валидация-На-что-влияет-количество-блоков-в-кросс-валидации" title="7-Что-такое-кросс-валидация-На-что-влияет-количество-блоков-в-кросс-валидации"><span class="octicon octicon-link"></span></a><span>7. Что такое кросс-валидация? На что влияет количество блоков в кросс-валидации?</span></h3><ul>
<li><strong><span>Кросс-валидация</span></strong><span> — процесс итеративного обучения алгоритма на разных подвыборках исходной выборки для подбора гиперпараметров или получения более устойчивой оценки качества. Обычно устроен следующим образом: делим выборку на </span><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-314-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 118%; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>k</mi></math>" role="presentation"><span id="MJXc-Node-4778" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-4779" class="mjx-mrow"><span id="MJXc-Node-4780" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.267em;">k</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>k</mi></math></span></span><script type="math/tex" id="MathJax-Element-314">k</script></span><span> фолдов. </span><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-315-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 118%; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>k</mi></math>" role="presentation"><span id="MJXc-Node-4781" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-4782" class="mjx-mrow"><span id="MJXc-Node-4783" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.267em;">k</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>k</mi></math></span></span><script type="math/tex" id="MathJax-Element-315">k</script></span><span> раз обучаем алгоритм на </span><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-316-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 118%; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>k</mi><mo>&amp;#x2212;</mo><mn>1</mn></math>" role="presentation"><span id="MJXc-Node-4784" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-4785" class="mjx-mrow"><span id="MJXc-Node-4786" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.267em;">k</span></span><span id="MJXc-Node-4787" class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.32em; padding-bottom: 0.426em;">−</span></span><span id="MJXc-Node-4788" class="mjx-mn MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.373em; padding-bottom: 0.32em;">1</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>k</mi><mo>−</mo><mn>1</mn></math></span></span><script type="math/tex" id="MathJax-Element-316">k-1</script></span><span> фолде, оставшийся используем как тестовый для оценки качества. Усредняем получившиеся оценки качества.</span>
<ul>
<li><span>Обычно в качестве </span><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-317-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 118%; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>k</mi></math>" role="presentation"><span id="MJXc-Node-4789" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-4790" class="mjx-mrow"><span id="MJXc-Node-4791" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.267em;">k</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>k</mi></math></span></span><script type="math/tex" id="MathJax-Element-317">k</script></span><span> берут 3, 5, 10.</span></li>
<li><span>Для больших выборок лучше брать меньшие </span><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-318-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 118%; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>k</mi></math>" role="presentation"><span id="MJXc-Node-4792" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-4793" class="mjx-mrow"><span id="MJXc-Node-4794" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.267em;">k</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>k</mi></math></span></span><script type="math/tex" id="MathJax-Element-318">k</script></span><span> (для уменьшения времени обучения), для небольших выборок — большие </span><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-319-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 118%; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>k</mi><mo>,</mo></math>" role="presentation"><span id="MJXc-Node-4795" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-4796" class="mjx-mrow"><span id="MJXc-Node-4797" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.267em;">k</span></span><span id="MJXc-Node-4798" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="margin-top: -0.156em; padding-bottom: 0.532em;">,</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>k</mi><mo>,</mo></math></span></span><script type="math/tex" id="MathJax-Element-319">k,</script></span><span> чтобы у алгоритма было достаточно данных для обучения.</span></li>
</ul>
</li>
<li><strong><span>Количество блоков</span></strong><span> в кросс-валидации влияет на:</span>
<ul>
<li><span>Суммарное время обучения</span></li>
<li><span>Несмещённость оценки качества (чем больше блоков и данных, тем точнее оценка качества)</span></li>
</ul>
</li>
</ul><h3 id="8-Чем-гиперпараметры-отличаются-от-параметров-Что-является-параметрами-и-гиперпараметрами-в-линейных-моделях-и-в-решающих-деревьях" data-id="8-Чем-гиперпараметры-отличаются-от-параметров-Что-является-параметрами-и-гиперпараметрами-в-линейных-моделях-и-в-решающих-деревьях"><a class="anchor hidden-xs" href="#8-Чем-гиперпараметры-отличаются-от-параметров-Что-является-параметрами-и-гиперпараметрами-в-линейных-моделях-и-в-решающих-деревьях" title="8-Чем-гиперпараметры-отличаются-от-параметров-Что-является-параметрами-и-гиперпараметрами-в-линейных-моделях-и-в-решающих-деревьях"><span class="octicon octicon-link"></span></a><span>8. Чем гиперпараметры отличаются от параметров? Что является параметрами и гиперпараметрами в линейных моделях и в решающих деревьях?</span></h3><ul>
<li><strong><span>Гиперпараметр</span></strong><span> — такие параметры модели, которые нельзя подобрать во время обучения, и которые нужно зафиксировать заранее.</span></li>
<li><span>Примеры в </span><strong><span>линейных моделях</span></strong><span> — параметр регуляризации, какие признаки использовать для линейной регрессии.</span></li>
<li><span>Примеры в </span><strong><span>решающих деревьях</span></strong><span> — глубина дерева, минимальное количество объектов в листе для сплита.</span></li>
<li><span>Хороший пример гиперпараметра — </span><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-320-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 118%; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>k</mi></math>" role="presentation"><span id="MJXc-Node-4799" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-4800" class="mjx-mrow"><span id="MJXc-Node-4801" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.267em;">k</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>k</mi></math></span></span><script type="math/tex" id="MathJax-Element-320">k</script></span><span> в методе </span><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-321-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 118%; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>k</mi></math>" role="presentation"><span id="MJXc-Node-4802" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-4803" class="mjx-mrow"><span id="MJXc-Node-4804" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.267em;">k</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>k</mi></math></span></span><script type="math/tex" id="MathJax-Element-321">k</script></span><span> ближайших соседей.</span><br>
<img src="https://i.imgur.com/4KqTDBb.png" alt=""></li>
</ul><h3 id="9-Что-такое-регуляризация-Чем-на-практике-отличается-L1-регуляризация-от-L2" data-id="9-Что-такое-регуляризация-Чем-на-практике-отличается-L1-регуляризация-от-L2"><a class="anchor hidden-xs" href="#9-Что-такое-регуляризация-Чем-на-практике-отличается-L1-регуляризация-от-L2" title="9-Что-такое-регуляризация-Чем-на-практике-отличается-L1-регуляризация-от-L2"><span class="octicon octicon-link"></span></a><span>9. Что такое регуляризация? Чем на практике отличается L1-регуляризация от L2?</span></h3><ul>
<li><strong><span>Регуляризация:</span></strong><span> один из методов борьбы с переобучением, который заключается в “штрафе” модели за излишнюю сложность. Например, в линейной модели признаком переобучения считаются большие (по модулю) веса модели, поэтому в функционал ошибки добавляется слагаемое, зависящее от весов модели. Тогда с применением регуляризации, мы “прижимаем” веса модели ближе к нулю.</span></li>
<li><span>L2-регуляриация (Ridge regression, регуляризация Тихонова): </span><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-322-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 118%; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>L</mi><mo>=</mo><mfrac><mn>1</mn><mi>n</mi></mfrac><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>|</mo></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>|</mo></mrow><mi>X</mi><mi>w</mi><mo>&amp;#x2212;</mo><mi>Y</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>|</mo></mrow><msubsup><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>|</mo></mrow><mn>2</mn><mn>2</mn></msubsup><mo>+</mo><msup><mi>&amp;#x03BB;</mi><mn>2</mn></msup><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>|</mo></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>|</mo></mrow><mi>w</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>|</mo></mrow><msubsup><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>|</mo></mrow><mn>2</mn><mn>2</mn></msubsup></math>" role="presentation"><span id="MJXc-Node-4805" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-4806" class="mjx-mrow"><span id="MJXc-Node-4807" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.267em;">L</span></span><span id="MJXc-Node-4808" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.056em; padding-bottom: 0.32em;">=</span></span><span id="MJXc-Node-4809" class="mjx-mfrac MJXc-space3"><span class="mjx-box MJXc-stacked" style="width: 0.566em; padding: 0px 0.12em;"><span class="mjx-numerator" style="font-size: 70.7%; width: 0.8em; top: -1.299em;"><span id="MJXc-Node-4810" class="mjx-mn" style=""><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.373em; padding-bottom: 0.32em;">1</span></span></span><span class="mjx-denominator" style="font-size: 70.7%; width: 0.8em; bottom: -0.524em;"><span id="MJXc-Node-4811" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.215em; padding-bottom: 0.267em;">n</span></span></span><span style="border-bottom-width: 1.3px; border-bottom-style: solid; top: -0.283em; width: 0.566em;" class="mjx-line"></span></span><span style="height: 1.289em; vertical-align: -0.37em;" class="mjx-vsize"></span></span><span id="MJXc-Node-4812" class="mjx-texatom"><span id="MJXc-Node-4813" class="mjx-mrow"><span id="MJXc-Node-4814" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.479em; padding-bottom: 0.585em;">|</span></span></span></span><span id="MJXc-Node-4815" class="mjx-texatom"><span id="MJXc-Node-4816" class="mjx-mrow"><span id="MJXc-Node-4817" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.479em; padding-bottom: 0.585em;">|</span></span></span></span><span id="MJXc-Node-4818" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.267em; padding-right: 0.024em;">X</span></span><span id="MJXc-Node-4819" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.215em; padding-bottom: 0.267em;">w</span></span><span id="MJXc-Node-4820" class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.32em; padding-bottom: 0.426em;">−</span></span><span id="MJXc-Node-4821" class="mjx-mi MJXc-space2"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.267em; padding-right: 0.182em;">Y</span></span><span id="MJXc-Node-4822" class="mjx-texatom"><span id="MJXc-Node-4823" class="mjx-mrow"><span id="MJXc-Node-4824" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.479em; padding-bottom: 0.585em;">|</span></span></span></span><span id="MJXc-Node-4825" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-4826" class="mjx-texatom"><span id="MJXc-Node-4827" class="mjx-mrow"><span id="MJXc-Node-4828" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.479em; padding-bottom: 0.585em;">|</span></span></span></span></span><span class="mjx-stack" style="vertical-align: -0.309em;"><span class="mjx-sup" style="font-size: 70.7%; padding-bottom: 0.431em; padding-left: 0px; padding-right: 0.071em;"><span id="MJXc-Node-4830" class="mjx-mn" style=""><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.373em; padding-bottom: 0.32em;">2</span></span></span><span class="mjx-sub" style="font-size: 70.7%; padding-right: 0.071em;"><span id="MJXc-Node-4829" class="mjx-mn" style=""><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.373em; padding-bottom: 0.32em;">2</span></span></span></span></span><span id="MJXc-Node-4831" class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.32em; padding-bottom: 0.426em;">+</span></span><span id="MJXc-Node-4832" class="mjx-msubsup MJXc-space2"><span class="mjx-base"><span id="MJXc-Node-4833" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.267em;">λ</span></span></span><span class="mjx-sup" style="font-size: 70.7%; vertical-align: 0.513em; padding-left: 0px; padding-right: 0.071em;"><span id="MJXc-Node-4834" class="mjx-mn" style=""><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.373em; padding-bottom: 0.32em;">2</span></span></span></span><span id="MJXc-Node-4835" class="mjx-texatom"><span id="MJXc-Node-4836" class="mjx-mrow"><span id="MJXc-Node-4837" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.479em; padding-bottom: 0.585em;">|</span></span></span></span><span id="MJXc-Node-4838" class="mjx-texatom"><span id="MJXc-Node-4839" class="mjx-mrow"><span id="MJXc-Node-4840" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.479em; padding-bottom: 0.585em;">|</span></span></span></span><span id="MJXc-Node-4841" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.215em; padding-bottom: 0.267em;">w</span></span><span id="MJXc-Node-4842" class="mjx-texatom"><span id="MJXc-Node-4843" class="mjx-mrow"><span id="MJXc-Node-4844" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.479em; padding-bottom: 0.585em;">|</span></span></span></span><span id="MJXc-Node-4845" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-4846" class="mjx-texatom"><span id="MJXc-Node-4847" class="mjx-mrow"><span id="MJXc-Node-4848" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.479em; padding-bottom: 0.585em;">|</span></span></span></span></span><span class="mjx-stack" style="vertical-align: -0.309em;"><span class="mjx-sup" style="font-size: 70.7%; padding-bottom: 0.431em; padding-left: 0px; padding-right: 0.071em;"><span id="MJXc-Node-4850" class="mjx-mn" style=""><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.373em; padding-bottom: 0.32em;">2</span></span></span><span class="mjx-sub" style="font-size: 70.7%; padding-right: 0.071em;"><span id="MJXc-Node-4849" class="mjx-mn" style=""><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.373em; padding-bottom: 0.32em;">2</span></span></span></span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>L</mi><mo>=</mo><mfrac><mn>1</mn><mi>n</mi></mfrac><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><mi>X</mi><mi>w</mi><mo>−</mo><mi>Y</mi><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><msubsup><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><mn>2</mn><mn>2</mn></msubsup><mo>+</mo><msup><mi>λ</mi><mn>2</mn></msup><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><mi>w</mi><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><msubsup><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><mn>2</mn><mn>2</mn></msubsup></math></span></span><script type="math/tex" id="MathJax-Element-322">L = \frac{1}{n} ||Xw - Y||_2^2 + \lambda^2||w||_2^2</script></span>
<ul>
<li><span>Отметим также другую интерпретацию L2 регуляризации — если выписать аналитическое решение для такого функционала, то вместо не всегда обратимой матрицы </span><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-323-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 118%; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msup><mi>X</mi><mi>T</mi></msup><mi>X</mi></math>" role="presentation"><span id="MJXc-Node-4851" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-4852" class="mjx-mrow"><span id="MJXc-Node-4853" class="mjx-msubsup"><span class="mjx-base" style="margin-right: -0.024em;"><span id="MJXc-Node-4854" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.267em; padding-right: 0.024em;">X</span></span></span><span class="mjx-sup" style="font-size: 70.7%; vertical-align: 0.513em; padding-left: 0.115em; padding-right: 0.071em;"><span id="MJXc-Node-4855" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.267em; padding-right: 0.12em;">T</span></span></span></span><span id="MJXc-Node-4856" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.267em; padding-right: 0.024em;">X</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msup><mi>X</mi><mi>T</mi></msup><mi>X</mi></math></span></span><script type="math/tex" id="MathJax-Element-323">X^TX</script></span><span> в формуле будет </span><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-324-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 118%; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mo stretchy=&quot;false&quot;>(</mo><msup><mi>X</mi><mi>T</mi></msup><mi>X</mi><mo>+</mo><msup><mi>&amp;#x03BB;</mi><mn>2</mn></msup><mi>I</mi><mo stretchy=&quot;false&quot;>)</mo></math>" role="presentation"><span id="MJXc-Node-4857" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-4858" class="mjx-mrow"><span id="MJXc-Node-4859" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.479em; padding-bottom: 0.585em;">(</span></span><span id="MJXc-Node-4860" class="mjx-msubsup"><span class="mjx-base" style="margin-right: -0.024em;"><span id="MJXc-Node-4861" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.267em; padding-right: 0.024em;">X</span></span></span><span class="mjx-sup" style="font-size: 70.7%; vertical-align: 0.513em; padding-left: 0.115em; padding-right: 0.071em;"><span id="MJXc-Node-4862" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.267em; padding-right: 0.12em;">T</span></span></span></span><span id="MJXc-Node-4863" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.267em; padding-right: 0.024em;">X</span></span><span id="MJXc-Node-4864" class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.32em; padding-bottom: 0.426em;">+</span></span><span id="MJXc-Node-4865" class="mjx-msubsup MJXc-space2"><span class="mjx-base"><span id="MJXc-Node-4866" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.267em;">λ</span></span></span><span class="mjx-sup" style="font-size: 70.7%; vertical-align: 0.513em; padding-left: 0px; padding-right: 0.071em;"><span id="MJXc-Node-4867" class="mjx-mn" style=""><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.373em; padding-bottom: 0.32em;">2</span></span></span></span><span id="MJXc-Node-4868" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.267em; padding-right: 0.064em;">I</span></span><span id="MJXc-Node-4869" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.479em; padding-bottom: 0.585em;">)</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo stretchy="false">(</mo><msup><mi>X</mi><mi>T</mi></msup><mi>X</mi><mo>+</mo><msup><mi>λ</mi><mn>2</mn></msup><mi>I</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-324">(X^TX + \lambda^2I)</script></span><span> и такая матрица (при достаточно больших значениях </span><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-325-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 118%; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>&amp;#x03BB;</mi></math>" role="presentation"><span id="MJXc-Node-4870" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-4871" class="mjx-mrow"><span id="MJXc-Node-4872" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.267em;">λ</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>λ</mi></math></span></span><script type="math/tex" id="MathJax-Element-325">\lambda</script></span><span>) будет устойчива к обращению.</span></li>
<li><span>Заметим, что при L2-регуляризации функционал ошибки остаётся непрерывно дифференцируемым</span></li>
</ul>
</li>
<li><span>L1-регуляризация (LASSO): </span><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-326-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 118%; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>L</mi><mo>=</mo><mfrac><mn>1</mn><mi>n</mi></mfrac><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>|</mo></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>|</mo></mrow><mi>X</mi><mi>w</mi><mo>&amp;#x2212;</mo><mi>Y</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>|</mo></mrow><msubsup><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>|</mo></mrow><mn>2</mn><mn>2</mn></msubsup><mo>+</mo><msup><mi>&amp;#x03BB;</mi><mn>2</mn></msup><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>|</mo></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>|</mo></mrow><mi>w</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>|</mo></mrow><msub><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>|</mo></mrow><mn>1</mn></msub></math>" role="presentation"><span id="MJXc-Node-4873" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-4874" class="mjx-mrow"><span id="MJXc-Node-4875" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.267em;">L</span></span><span id="MJXc-Node-4876" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.056em; padding-bottom: 0.32em;">=</span></span><span id="MJXc-Node-4877" class="mjx-mfrac MJXc-space3"><span class="mjx-box MJXc-stacked" style="width: 0.566em; padding: 0px 0.12em;"><span class="mjx-numerator" style="font-size: 70.7%; width: 0.8em; top: -1.299em;"><span id="MJXc-Node-4878" class="mjx-mn" style=""><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.373em; padding-bottom: 0.32em;">1</span></span></span><span class="mjx-denominator" style="font-size: 70.7%; width: 0.8em; bottom: -0.524em;"><span id="MJXc-Node-4879" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.215em; padding-bottom: 0.267em;">n</span></span></span><span style="border-bottom-width: 1.3px; border-bottom-style: solid; top: -0.283em; width: 0.566em;" class="mjx-line"></span></span><span style="height: 1.289em; vertical-align: -0.37em;" class="mjx-vsize"></span></span><span id="MJXc-Node-4880" class="mjx-texatom"><span id="MJXc-Node-4881" class="mjx-mrow"><span id="MJXc-Node-4882" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.479em; padding-bottom: 0.585em;">|</span></span></span></span><span id="MJXc-Node-4883" class="mjx-texatom"><span id="MJXc-Node-4884" class="mjx-mrow"><span id="MJXc-Node-4885" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.479em; padding-bottom: 0.585em;">|</span></span></span></span><span id="MJXc-Node-4886" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.267em; padding-right: 0.024em;">X</span></span><span id="MJXc-Node-4887" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.215em; padding-bottom: 0.267em;">w</span></span><span id="MJXc-Node-4888" class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.32em; padding-bottom: 0.426em;">−</span></span><span id="MJXc-Node-4889" class="mjx-mi MJXc-space2"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.267em; padding-right: 0.182em;">Y</span></span><span id="MJXc-Node-4890" class="mjx-texatom"><span id="MJXc-Node-4891" class="mjx-mrow"><span id="MJXc-Node-4892" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.479em; padding-bottom: 0.585em;">|</span></span></span></span><span id="MJXc-Node-4893" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-4894" class="mjx-texatom"><span id="MJXc-Node-4895" class="mjx-mrow"><span id="MJXc-Node-4896" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.479em; padding-bottom: 0.585em;">|</span></span></span></span></span><span class="mjx-stack" style="vertical-align: -0.309em;"><span class="mjx-sup" style="font-size: 70.7%; padding-bottom: 0.431em; padding-left: 0px; padding-right: 0.071em;"><span id="MJXc-Node-4898" class="mjx-mn" style=""><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.373em; padding-bottom: 0.32em;">2</span></span></span><span class="mjx-sub" style="font-size: 70.7%; padding-right: 0.071em;"><span id="MJXc-Node-4897" class="mjx-mn" style=""><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.373em; padding-bottom: 0.32em;">2</span></span></span></span></span><span id="MJXc-Node-4899" class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.32em; padding-bottom: 0.426em;">+</span></span><span id="MJXc-Node-4900" class="mjx-msubsup MJXc-space2"><span class="mjx-base"><span id="MJXc-Node-4901" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.267em;">λ</span></span></span><span class="mjx-sup" style="font-size: 70.7%; vertical-align: 0.513em; padding-left: 0px; padding-right: 0.071em;"><span id="MJXc-Node-4902" class="mjx-mn" style=""><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.373em; padding-bottom: 0.32em;">2</span></span></span></span><span id="MJXc-Node-4903" class="mjx-texatom"><span id="MJXc-Node-4904" class="mjx-mrow"><span id="MJXc-Node-4905" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.479em; padding-bottom: 0.585em;">|</span></span></span></span><span id="MJXc-Node-4906" class="mjx-texatom"><span id="MJXc-Node-4907" class="mjx-mrow"><span id="MJXc-Node-4908" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.479em; padding-bottom: 0.585em;">|</span></span></span></span><span id="MJXc-Node-4909" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.215em; padding-bottom: 0.267em;">w</span></span><span id="MJXc-Node-4910" class="mjx-texatom"><span id="MJXc-Node-4911" class="mjx-mrow"><span id="MJXc-Node-4912" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.479em; padding-bottom: 0.585em;">|</span></span></span></span><span id="MJXc-Node-4913" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-4914" class="mjx-texatom"><span id="MJXc-Node-4915" class="mjx-mrow"><span id="MJXc-Node-4916" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.479em; padding-bottom: 0.585em;">|</span></span></span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.437em; padding-right: 0.071em;"><span id="MJXc-Node-4917" class="mjx-mn" style=""><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.373em; padding-bottom: 0.32em;">1</span></span></span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>L</mi><mo>=</mo><mfrac><mn>1</mn><mi>n</mi></mfrac><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><mi>X</mi><mi>w</mi><mo>−</mo><mi>Y</mi><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><msubsup><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><mn>2</mn><mn>2</mn></msubsup><mo>+</mo><msup><mi>λ</mi><mn>2</mn></msup><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><mi>w</mi><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><msub><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><mn>1</mn></msub></math></span></span><script type="math/tex" id="MathJax-Element-326">L = \frac{1}{n} ||Xw - Y||_2^2 + \lambda^2||w||_1</script></span>
<ul>
<li><span>Если аккуратно выписать формулу для весов модели с L1-регуляризацией, можно заметить что некоторые веса обращаются в ноль. Поэтому говорят, что L1-регуляризация делает </span><em><span>отбор признаков,</span></em><span> т.к. он “выбирает” самые важные признаки и оставляет из в модели.</span></li>
</ul>
</li>
<li><span>ElasticNet: </span><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-327-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 118%; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>L</mi><mo>=</mo><mfrac><mn>1</mn><mi>n</mi></mfrac><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>|</mo></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>|</mo></mrow><mi>X</mi><mi>w</mi><mo>&amp;#x2212;</mo><mi>Y</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>|</mo></mrow><msubsup><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>|</mo></mrow><mn>2</mn><mn>2</mn></msubsup><mo>+</mo><msubsup><mi>&amp;#x03BB;</mi><mn>1</mn><mn>2</mn></msubsup><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>|</mo></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>|</mo></mrow><mi>w</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>|</mo></mrow><msub><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>|</mo></mrow><mn>1</mn></msub><mo>+</mo><msubsup><mi>&amp;#x03BB;</mi><mn>2</mn><mn>2</mn></msubsup><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>|</mo></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>|</mo></mrow><mi>w</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>|</mo></mrow><msubsup><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>|</mo></mrow><mn>2</mn><mn>2</mn></msubsup></math>" role="presentation"><span id="MJXc-Node-4918" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-4919" class="mjx-mrow"><span id="MJXc-Node-4920" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.267em;">L</span></span><span id="MJXc-Node-4921" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.056em; padding-bottom: 0.32em;">=</span></span><span id="MJXc-Node-4922" class="mjx-mfrac MJXc-space3"><span class="mjx-box MJXc-stacked" style="width: 0.566em; padding: 0px 0.12em;"><span class="mjx-numerator" style="font-size: 70.7%; width: 0.8em; top: -1.299em;"><span id="MJXc-Node-4923" class="mjx-mn" style=""><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.373em; padding-bottom: 0.32em;">1</span></span></span><span class="mjx-denominator" style="font-size: 70.7%; width: 0.8em; bottom: -0.524em;"><span id="MJXc-Node-4924" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.215em; padding-bottom: 0.267em;">n</span></span></span><span style="border-bottom-width: 1.3px; border-bottom-style: solid; top: -0.283em; width: 0.566em;" class="mjx-line"></span></span><span style="height: 1.289em; vertical-align: -0.37em;" class="mjx-vsize"></span></span><span id="MJXc-Node-4925" class="mjx-texatom"><span id="MJXc-Node-4926" class="mjx-mrow"><span id="MJXc-Node-4927" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.479em; padding-bottom: 0.585em;">|</span></span></span></span><span id="MJXc-Node-4928" class="mjx-texatom"><span id="MJXc-Node-4929" class="mjx-mrow"><span id="MJXc-Node-4930" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.479em; padding-bottom: 0.585em;">|</span></span></span></span><span id="MJXc-Node-4931" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.267em; padding-right: 0.024em;">X</span></span><span id="MJXc-Node-4932" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.215em; padding-bottom: 0.267em;">w</span></span><span id="MJXc-Node-4933" class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.32em; padding-bottom: 0.426em;">−</span></span><span id="MJXc-Node-4934" class="mjx-mi MJXc-space2"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.267em; padding-right: 0.182em;">Y</span></span><span id="MJXc-Node-4935" class="mjx-texatom"><span id="MJXc-Node-4936" class="mjx-mrow"><span id="MJXc-Node-4937" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.479em; padding-bottom: 0.585em;">|</span></span></span></span><span id="MJXc-Node-4938" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-4939" class="mjx-texatom"><span id="MJXc-Node-4940" class="mjx-mrow"><span id="MJXc-Node-4941" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.479em; padding-bottom: 0.585em;">|</span></span></span></span></span><span class="mjx-stack" style="vertical-align: -0.309em;"><span class="mjx-sup" style="font-size: 70.7%; padding-bottom: 0.431em; padding-left: 0px; padding-right: 0.071em;"><span id="MJXc-Node-4943" class="mjx-mn" style=""><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.373em; padding-bottom: 0.32em;">2</span></span></span><span class="mjx-sub" style="font-size: 70.7%; padding-right: 0.071em;"><span id="MJXc-Node-4942" class="mjx-mn" style=""><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.373em; padding-bottom: 0.32em;">2</span></span></span></span></span><span id="MJXc-Node-4944" class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.32em; padding-bottom: 0.426em;">+</span></span><span id="MJXc-Node-4945" class="mjx-msubsup MJXc-space2"><span class="mjx-base"><span id="MJXc-Node-4946" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.267em;">λ</span></span></span><span class="mjx-stack" style="vertical-align: -0.315em;"><span class="mjx-sup" style="font-size: 70.7%; padding-bottom: 0.255em; padding-left: 0px; padding-right: 0.071em;"><span id="MJXc-Node-4948" class="mjx-mn" style=""><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.373em; padding-bottom: 0.32em;">2</span></span></span><span class="mjx-sub" style="font-size: 70.7%; padding-right: 0.071em;"><span id="MJXc-Node-4947" class="mjx-mn" style=""><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.373em; padding-bottom: 0.32em;">1</span></span></span></span></span><span id="MJXc-Node-4949" class="mjx-texatom"><span id="MJXc-Node-4950" class="mjx-mrow"><span id="MJXc-Node-4951" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.479em; padding-bottom: 0.585em;">|</span></span></span></span><span id="MJXc-Node-4952" class="mjx-texatom"><span id="MJXc-Node-4953" class="mjx-mrow"><span id="MJXc-Node-4954" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.479em; padding-bottom: 0.585em;">|</span></span></span></span><span id="MJXc-Node-4955" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.215em; padding-bottom: 0.267em;">w</span></span><span id="MJXc-Node-4956" class="mjx-texatom"><span id="MJXc-Node-4957" class="mjx-mrow"><span id="MJXc-Node-4958" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.479em; padding-bottom: 0.585em;">|</span></span></span></span><span id="MJXc-Node-4959" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-4960" class="mjx-texatom"><span id="MJXc-Node-4961" class="mjx-mrow"><span id="MJXc-Node-4962" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.479em; padding-bottom: 0.585em;">|</span></span></span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.437em; padding-right: 0.071em;"><span id="MJXc-Node-4963" class="mjx-mn" style=""><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.373em; padding-bottom: 0.32em;">1</span></span></span></span><span id="MJXc-Node-4964" class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.32em; padding-bottom: 0.426em;">+</span></span><span id="MJXc-Node-4965" class="mjx-msubsup MJXc-space2"><span class="mjx-base"><span id="MJXc-Node-4966" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.267em;">λ</span></span></span><span class="mjx-stack" style="vertical-align: -0.315em;"><span class="mjx-sup" style="font-size: 70.7%; padding-bottom: 0.255em; padding-left: 0px; padding-right: 0.071em;"><span id="MJXc-Node-4968" class="mjx-mn" style=""><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.373em; padding-bottom: 0.32em;">2</span></span></span><span class="mjx-sub" style="font-size: 70.7%; padding-right: 0.071em;"><span id="MJXc-Node-4967" class="mjx-mn" style=""><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.373em; padding-bottom: 0.32em;">2</span></span></span></span></span><span id="MJXc-Node-4969" class="mjx-texatom"><span id="MJXc-Node-4970" class="mjx-mrow"><span id="MJXc-Node-4971" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.479em; padding-bottom: 0.585em;">|</span></span></span></span><span id="MJXc-Node-4972" class="mjx-texatom"><span id="MJXc-Node-4973" class="mjx-mrow"><span id="MJXc-Node-4974" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.479em; padding-bottom: 0.585em;">|</span></span></span></span><span id="MJXc-Node-4975" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.215em; padding-bottom: 0.267em;">w</span></span><span id="MJXc-Node-4976" class="mjx-texatom"><span id="MJXc-Node-4977" class="mjx-mrow"><span id="MJXc-Node-4978" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.479em; padding-bottom: 0.585em;">|</span></span></span></span><span id="MJXc-Node-4979" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-4980" class="mjx-texatom"><span id="MJXc-Node-4981" class="mjx-mrow"><span id="MJXc-Node-4982" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.479em; padding-bottom: 0.585em;">|</span></span></span></span></span><span class="mjx-stack" style="vertical-align: -0.309em;"><span class="mjx-sup" style="font-size: 70.7%; padding-bottom: 0.431em; padding-left: 0px; padding-right: 0.071em;"><span id="MJXc-Node-4984" class="mjx-mn" style=""><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.373em; padding-bottom: 0.32em;">2</span></span></span><span class="mjx-sub" style="font-size: 70.7%; padding-right: 0.071em;"><span id="MJXc-Node-4983" class="mjx-mn" style=""><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.373em; padding-bottom: 0.32em;">2</span></span></span></span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>L</mi><mo>=</mo><mfrac><mn>1</mn><mi>n</mi></mfrac><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><mi>X</mi><mi>w</mi><mo>−</mo><mi>Y</mi><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><msubsup><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><mn>2</mn><mn>2</mn></msubsup><mo>+</mo><msubsup><mi>λ</mi><mn>1</mn><mn>2</mn></msubsup><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><mi>w</mi><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><msub><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><mn>1</mn></msub><mo>+</mo><msubsup><mi>λ</mi><mn>2</mn><mn>2</mn></msubsup><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><mi>w</mi><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><msubsup><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><mn>2</mn><mn>2</mn></msubsup></math></span></span><script type="math/tex" id="MathJax-Element-327">L = \frac{1}{n} ||Xw - Y||_2^2 + \lambda_1^2||w||_1 + \lambda_2^2||w||_2^2</script></span><span> — комбинация L1 и L2 регуляризации.</span>
<ul>
<li><span>Слагаемое, добавляемое к исходному функционалу ошибки называется </span><em><span>регуляризатором.</span></em><span> Его можно прибавлять не только к среднеквадратичной ошибке, как написано выше, но и к другим функционалам ошибки.</span></li>
</ul>
</li>
</ul><h3 id="10-Запишите-формулу-для-линейной-модели-классификации-Что-такое-отступ" data-id="10-Запишите-формулу-для-линейной-модели-классификации-Что-такое-отступ"><a class="anchor hidden-xs" href="#10-Запишите-формулу-для-линейной-модели-классификации-Что-такое-отступ" title="10-Запишите-формулу-для-линейной-модели-классификации-Что-такое-отступ"><span class="octicon octicon-link"></span></a><span>10. Запишите формулу для линейной модели классификации. Что такое отступ?</span></h3><ul>
<li><strong><span>Модель линейного классификатора</span></strong><span> (в задаче бинарной классификации с метками </span><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-328-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 118%; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mo fence=&quot;false&quot; stretchy=&quot;false&quot;>{</mo><mo>&amp;#x2212;</mo><mn>1</mn><mo>,</mo><mn>1</mn><mo fence=&quot;false&quot; stretchy=&quot;false&quot;>}</mo></math>" role="presentation"><span id="MJXc-Node-4985" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-4986" class="mjx-mrow"><span id="MJXc-Node-4987" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.479em; padding-bottom: 0.585em;">{</span></span><span id="MJXc-Node-4988" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.32em; padding-bottom: 0.426em;">−</span></span><span id="MJXc-Node-4989" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.373em; padding-bottom: 0.32em;">1</span></span><span id="MJXc-Node-4990" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="margin-top: -0.156em; padding-bottom: 0.532em;">,</span></span><span id="MJXc-Node-4991" class="mjx-mn MJXc-space1"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.373em; padding-bottom: 0.32em;">1</span></span><span id="MJXc-Node-4992" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.479em; padding-bottom: 0.585em;">}</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo fence="false" stretchy="false">{</mo><mo>−</mo><mn>1</mn><mo>,</mo><mn>1</mn><mo fence="false" stretchy="false">}</mo></math></span></span><script type="math/tex" id="MathJax-Element-328">\{-1, 1\}</script></span><span>):</span><br>
<span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span class="mjx-chtml MJXc-display" style="text-align: center;"><span id="MathJax-Element-329-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 118%; text-align: center; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><mi>c</mi><mo stretchy=&quot;false&quot;>(</mo><mi>x</mi><mo stretchy=&quot;false&quot;>)</mo><mo>=</mo><mtext>sign</mtext><mo stretchy=&quot;false&quot;>(</mo><mi>f</mi><mo stretchy=&quot;false&quot;>(</mo><mi>x</mi><mo stretchy=&quot;false&quot;>)</mo><mo stretchy=&quot;false&quot;>)</mo><mo>=</mo><mtext>sign</mtext><mo stretchy=&quot;false&quot;>(</mo><msup><mi>w</mi><mi>T</mi></msup><mi>x</mi><mo stretchy=&quot;false&quot;>)</mo></math>" role="presentation"><span id="MJXc-Node-4993" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-4994" class="mjx-mrow"><span id="MJXc-Node-4995" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.215em; padding-bottom: 0.267em;">c</span></span><span id="MJXc-Node-4996" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.479em; padding-bottom: 0.585em;">(</span></span><span id="MJXc-Node-4997" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.215em; padding-bottom: 0.267em;">x</span></span><span id="MJXc-Node-4998" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.479em; padding-bottom: 0.585em;">)</span></span><span id="MJXc-Node-4999" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.056em; padding-bottom: 0.32em;">=</span></span><span id="MJXc-Node-5000" class="mjx-mtext MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.373em; padding-bottom: 0.532em;">sign</span></span><span id="MJXc-Node-5001" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.479em; padding-bottom: 0.585em;">(</span></span><span id="MJXc-Node-5002" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.479em; padding-right: 0.06em;">f</span></span><span id="MJXc-Node-5003" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.479em; padding-bottom: 0.585em;">(</span></span><span id="MJXc-Node-5004" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.215em; padding-bottom: 0.267em;">x</span></span><span id="MJXc-Node-5005" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.479em; padding-bottom: 0.585em;">)</span></span><span id="MJXc-Node-5006" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.479em; padding-bottom: 0.585em;">)</span></span><span id="MJXc-Node-5007" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.056em; padding-bottom: 0.32em;">=</span></span><span id="MJXc-Node-5008" class="mjx-mtext MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.373em; padding-bottom: 0.532em;">sign</span></span><span id="MJXc-Node-5009" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.479em; padding-bottom: 0.585em;">(</span></span><span id="MJXc-Node-5010" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-5011" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.215em; padding-bottom: 0.267em;">w</span></span></span><span class="mjx-sup" style="font-size: 70.7%; vertical-align: 0.584em; padding-left: 0px; padding-right: 0.071em;"><span id="MJXc-Node-5012" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.267em; padding-right: 0.12em;">T</span></span></span></span><span id="MJXc-Node-5013" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.215em; padding-bottom: 0.267em;">x</span></span><span id="MJXc-Node-5014" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.479em; padding-bottom: 0.585em;">)</span></span></span></span><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mi>c</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mo>=</mo><mtext>sign</mtext><mo stretchy="false">(</mo><mi>f</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mo stretchy="false">)</mo><mo>=</mo><mtext>sign</mtext><mo stretchy="false">(</mo><msup><mi>w</mi><mi>T</mi></msup><mi>x</mi><mo stretchy="false">)</mo></math></span></span></span><script type="math/tex; mode=display" id="MathJax-Element-329">
 c(x) = \text{sign}(f(x)) = \text{sign}(w^Tx)
</script></span><br>
<span>Т.е. мы смотрим на знак скалярного произведения вектора весов модели и вектора признаков объекта. По этому знаку “присваем” объекту один из двух классов.</span>
<ul>
<li><span>Геометрическая интерпретация: вектор </span><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-330-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 118%; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>w</mi></math>" role="presentation"><span id="MJXc-Node-5015" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-5016" class="mjx-mrow"><span id="MJXc-Node-5017" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.215em; padding-bottom: 0.267em;">w</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>w</mi></math></span></span><script type="math/tex" id="MathJax-Element-330">w</script></span><span> является нормалью к разделяющей гиперплоскости в пространстве признаков.</span></li>
</ul>
</li>
<li><strong><span>Отступ</span></strong><span> (Margin):</span><br>
<span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span class="mjx-chtml MJXc-display" style="text-align: center;"><span id="MathJax-Element-331-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 118%; text-align: center; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><msub><mi>M</mi><mi>i</mi></msub><mo>=</mo><msub><mi>y</mi><mi>i</mi></msub><mo>&amp;#x22C5;</mo><mi>f</mi><mo stretchy=&quot;false&quot;>(</mo><msub><mi>x</mi><mi>i</mi></msub><mo stretchy=&quot;false&quot;>)</mo><mo>=</mo><msub><mi>y</mi><mi>i</mi></msub><mo>&amp;#x22C5;</mo><msup><mi>w</mi><mi>T</mi></msup><msub><mi>x</mi><mi>i</mi></msub></math>" role="presentation"><span id="MJXc-Node-5018" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-5019" class="mjx-mrow"><span id="MJXc-Node-5020" class="mjx-msubsup"><span class="mjx-base" style="margin-right: -0.081em;"><span id="MJXc-Node-5021" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.267em; padding-right: 0.081em;">M</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-5022" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.426em; padding-bottom: 0.267em;">i</span></span></span></span><span id="MJXc-Node-5023" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.056em; padding-bottom: 0.32em;">=</span></span><span id="MJXc-Node-5024" class="mjx-msubsup MJXc-space3"><span class="mjx-base" style="margin-right: -0.006em;"><span id="MJXc-Node-5025" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.215em; padding-bottom: 0.479em; padding-right: 0.006em;">y</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-5026" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.426em; padding-bottom: 0.267em;">i</span></span></span></span><span id="MJXc-Node-5027" class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.003em; padding-bottom: 0.32em;">⋅</span></span><span id="MJXc-Node-5028" class="mjx-mi MJXc-space2"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.479em; padding-right: 0.06em;">f</span></span><span id="MJXc-Node-5029" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.479em; padding-bottom: 0.585em;">(</span></span><span id="MJXc-Node-5030" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-5031" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.215em; padding-bottom: 0.267em;">x</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-5032" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.426em; padding-bottom: 0.267em;">i</span></span></span></span><span id="MJXc-Node-5033" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.479em; padding-bottom: 0.585em;">)</span></span><span id="MJXc-Node-5034" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.056em; padding-bottom: 0.32em;">=</span></span><span id="MJXc-Node-5035" class="mjx-msubsup MJXc-space3"><span class="mjx-base" style="margin-right: -0.006em;"><span id="MJXc-Node-5036" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.215em; padding-bottom: 0.479em; padding-right: 0.006em;">y</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-5037" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.426em; padding-bottom: 0.267em;">i</span></span></span></span><span id="MJXc-Node-5038" class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.003em; padding-bottom: 0.32em;">⋅</span></span><span id="MJXc-Node-5039" class="mjx-msubsup MJXc-space2"><span class="mjx-base"><span id="MJXc-Node-5040" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.215em; padding-bottom: 0.267em;">w</span></span></span><span class="mjx-sup" style="font-size: 70.7%; vertical-align: 0.584em; padding-left: 0px; padding-right: 0.071em;"><span id="MJXc-Node-5041" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.267em; padding-right: 0.12em;">T</span></span></span></span><span id="MJXc-Node-5042" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-5043" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.215em; padding-bottom: 0.267em;">x</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-5044" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.426em; padding-bottom: 0.267em;">i</span></span></span></span></span></span><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><msub><mi>M</mi><mi>i</mi></msub><mo>=</mo><msub><mi>y</mi><mi>i</mi></msub><mo>⋅</mo><mi>f</mi><mo stretchy="false">(</mo><msub><mi>x</mi><mi>i</mi></msub><mo stretchy="false">)</mo><mo>=</mo><msub><mi>y</mi><mi>i</mi></msub><mo>⋅</mo><msup><mi>w</mi><mi>T</mi></msup><msub><mi>x</mi><mi>i</mi></msub></math></span></span></span><script type="math/tex; mode=display" id="MathJax-Element-331">
 M_i = y_i\cdot f(x_i) = y_i \cdot w^Tx_i
</script></span><br>
<span>Основное свойство отступа: если объект классифицирован правильно, то значение </span><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-332-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 118%; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>M</mi><mi>i</mi></msub><mo>&amp;gt;</mo><mn>0</mn><mo>,</mo></math>" role="presentation"><span id="MJXc-Node-5045" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-5046" class="mjx-mrow"><span id="MJXc-Node-5047" class="mjx-msubsup"><span class="mjx-base" style="margin-right: -0.081em;"><span id="MJXc-Node-5048" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.267em; padding-right: 0.081em;">M</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-5049" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.426em; padding-bottom: 0.267em;">i</span></span></span></span><span id="MJXc-Node-5050" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.267em; padding-bottom: 0.373em;">&gt;</span></span><span id="MJXc-Node-5051" class="mjx-mn MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.373em; padding-bottom: 0.373em;">0</span></span><span id="MJXc-Node-5052" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="margin-top: -0.156em; padding-bottom: 0.532em;">,</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>M</mi><mi>i</mi></msub><mo>&gt;</mo><mn>0</mn><mo>,</mo></math></span></span><script type="math/tex" id="MathJax-Element-332">M_i > 0,</script></span><span> иначе значение </span><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-333-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 118%; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>M</mi><mi>i</mi></msub><mo>&amp;#x2264;</mo><mn>0.</mn></math>" role="presentation"><span id="MJXc-Node-5053" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-5054" class="mjx-mrow"><span id="MJXc-Node-5055" class="mjx-msubsup"><span class="mjx-base" style="margin-right: -0.081em;"><span id="MJXc-Node-5056" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.267em; padding-right: 0.081em;">M</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-5057" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.426em; padding-bottom: 0.267em;">i</span></span></span></span><span id="MJXc-Node-5058" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.373em; padding-bottom: 0.479em;">≤</span></span><span id="MJXc-Node-5059" class="mjx-mn MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.373em; padding-bottom: 0.373em;">0.</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>M</mi><mi>i</mi></msub><mo>≤</mo><mn>0.</mn></math></span></span><script type="math/tex" id="MathJax-Element-333">M_i \leq 0.</script></span></li>
</ul><h3 id="11-Что-такое-точность-и-полнота" data-id="11-Что-такое-точность-и-полнота"><a class="anchor hidden-xs" href="#11-Что-такое-точность-и-полнота" title="11-Что-такое-точность-и-полнота"><span class="octicon octicon-link"></span></a><span>11. Что такое точность и полнота?</span></h3><p><span>Метрики качества классификации (обычно бинарной, но можно с помощью усреднения по классам получить аналогичные метрики для мультиклассового случая)</span></p><ul>
<li><strong><span>Precision</span></strong><span> (точность): </span><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-334-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 118%; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mfrac><mrow><mi>T</mi><mi>P</mi></mrow><mrow><mi>T</mi><mi>P</mi><mo>+</mo><mi>F</mi><mi>P</mi></mrow></mfrac></math>" role="presentation"><span id="MJXc-Node-5060" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-5061" class="mjx-mrow"><span id="MJXc-Node-5062" class="mjx-mfrac"><span class="mjx-box MJXc-stacked" style="width: 2.781em; padding: 0px 0.12em;"><span class="mjx-numerator" style="font-size: 70.7%; width: 3.933em; top: -1.316em;"><span id="MJXc-Node-5063" class="mjx-mrow" style=""><span id="MJXc-Node-5064" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.267em; padding-right: 0.12em;">T</span></span><span id="MJXc-Node-5065" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.267em; padding-right: 0.109em;">P</span></span></span></span><span class="mjx-denominator" style="font-size: 70.7%; width: 3.933em; bottom: -0.691em;"><span id="MJXc-Node-5066" class="mjx-mrow" style=""><span id="MJXc-Node-5067" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.267em; padding-right: 0.12em;">T</span></span><span id="MJXc-Node-5068" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.267em; padding-right: 0.109em;">P</span></span><span id="MJXc-Node-5069" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.32em; padding-bottom: 0.426em;">+</span></span><span id="MJXc-Node-5070" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.267em; padding-right: 0.106em;">F</span></span><span id="MJXc-Node-5071" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.267em; padding-right: 0.109em;">P</span></span></span></span><span style="border-bottom-width: 1.3px; border-bottom-style: solid; top: -0.283em; width: 2.781em;" class="mjx-line"></span></span><span style="height: 1.419em; vertical-align: -0.489em;" class="mjx-vsize"></span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mfrac><mrow><mi>T</mi><mi>P</mi></mrow><mrow><mi>T</mi><mi>P</mi><mo>+</mo><mi>F</mi><mi>P</mi></mrow></mfrac></math></span></span><script type="math/tex" id="MathJax-Element-334">\frac{TP}{TP + FP}</script></span><span> — доля правильно классифицированных объектов из тех, которые алгоритм отнёс к первому (положительному) классу.</span>
<ul>
<li><span>Под точностью также можно понимать </span><em><span>accuracy</span></em><span> — общую долю правильно классифицированных объектов.</span></li>
</ul>
</li>
<li><strong><span>Recall</span></strong><span> (полнота): </span><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-335-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 118%; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mfrac><mrow><mi>T</mi><mi>P</mi></mrow><mrow><mi>T</mi><mi>P</mi><mo>+</mo><mi>F</mi><mi>N</mi></mrow></mfrac></math>" role="presentation"><span id="MJXc-Node-5072" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-5073" class="mjx-mrow"><span id="MJXc-Node-5074" class="mjx-mfrac"><span class="mjx-box MJXc-stacked" style="width: 2.878em; padding: 0px 0.12em;"><span class="mjx-numerator" style="font-size: 70.7%; width: 4.07em; top: -1.316em;"><span id="MJXc-Node-5075" class="mjx-mrow" style=""><span id="MJXc-Node-5076" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.267em; padding-right: 0.12em;">T</span></span><span id="MJXc-Node-5077" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.267em; padding-right: 0.109em;">P</span></span></span></span><span class="mjx-denominator" style="font-size: 70.7%; width: 4.07em; bottom: -0.691em;"><span id="MJXc-Node-5078" class="mjx-mrow" style=""><span id="MJXc-Node-5079" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.267em; padding-right: 0.12em;">T</span></span><span id="MJXc-Node-5080" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.267em; padding-right: 0.109em;">P</span></span><span id="MJXc-Node-5081" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.32em; padding-bottom: 0.426em;">+</span></span><span id="MJXc-Node-5082" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.267em; padding-right: 0.106em;">F</span></span><span id="MJXc-Node-5083" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.267em; padding-right: 0.085em;">N</span></span></span></span><span style="border-bottom-width: 1.3px; border-bottom-style: solid; top: -0.283em; width: 2.878em;" class="mjx-line"></span></span><span style="height: 1.419em; vertical-align: -0.489em;" class="mjx-vsize"></span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mfrac><mrow><mi>T</mi><mi>P</mi></mrow><mrow><mi>T</mi><mi>P</mi><mo>+</mo><mi>F</mi><mi>N</mi></mrow></mfrac></math></span></span><script type="math/tex" id="MathJax-Element-335">\frac{TP}{TP + FN}</script></span><span> — доля объектов положительного класса, которые алгоритм правильно классифицировал (т.е. какой процент положительного класса он классифицировать верно).</span></li>
</ul><p><span>Здесь использованы следующие обозначения:</span></p><ul>
<li><span>TP (True positive) — количество правильно угаданных меток позитивного класса (обычно класса с меткой </span><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-336-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 118%; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mo>+</mo><mn>1</mn></math>" role="presentation"><span id="MJXc-Node-5084" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-5085" class="mjx-mrow"><span id="MJXc-Node-5086" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.32em; padding-bottom: 0.426em;">+</span></span><span id="MJXc-Node-5087" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.373em; padding-bottom: 0.32em;">1</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo>+</mo><mn>1</mn></math></span></span><script type="math/tex" id="MathJax-Element-336">+1</script></span><span>).</span></li>
<li><span>TN (True negative) — количество правильно угаданных меток негативного класса (обычно класса с меткой </span><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-337-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 118%; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mn>0</mn></math>" role="presentation"><span id="MJXc-Node-5088" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-5089" class="mjx-mrow"><span id="MJXc-Node-5090" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.373em; padding-bottom: 0.373em;">0</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mn>0</mn></math></span></span><script type="math/tex" id="MathJax-Element-337">0</script></span><span> или </span><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-338-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 118%; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mo>&amp;#x2212;</mo><mn>1</mn></math>" role="presentation"><span id="MJXc-Node-5091" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-5092" class="mjx-mrow"><span id="MJXc-Node-5093" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.32em; padding-bottom: 0.426em;">−</span></span><span id="MJXc-Node-5094" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.373em; padding-bottom: 0.32em;">1</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo>−</mo><mn>1</mn></math></span></span><script type="math/tex" id="MathJax-Element-338">-1</script></span><span>).</span></li>
<li><span>FP (False positive) — количество объектов негативного класса, которые классификатор назвал позитивными.</span></li>
<li><span>FN (False negative) — количество объектов позитивного класса, которые классификатор назвал негативными.</span><br>
<img src="https://i.imgur.com/TNMb7k7.png" alt=""></li>
</ul><h3 id="12-Что-такое-ROC-AUC-Как-построить-ROC-кривую" data-id="12-Что-такое-ROC-AUC-Как-построить-ROC-кривую"><a class="anchor hidden-xs" href="#12-Что-такое-ROC-AUC-Как-построить-ROC-кривую" title="12-Что-такое-ROC-AUC-Как-построить-ROC-кривую"><span class="octicon octicon-link"></span></a><span>12. Что такое ROC-AUC? Как построить ROC-кривую?</span></h3><ul>
<li><strong><span>ROC-curve</span></strong><span> — график в осях FPR (False Positive Rate, ось </span><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-339-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 118%; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>x</mi></math>" role="presentation"><span id="MJXc-Node-5095" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-5096" class="mjx-mrow"><span id="MJXc-Node-5097" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.215em; padding-bottom: 0.267em;">x</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>x</mi></math></span></span><script type="math/tex" id="MathJax-Element-339">x</script></span><span>) и TPR (True Positive Rate, ось </span><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-340-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 118%; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>y</mi></math>" role="presentation"><span id="MJXc-Node-5098" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-5099" class="mjx-mrow"><span id="MJXc-Node-5100" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.215em; padding-bottom: 0.479em; padding-right: 0.006em;">y</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>y</mi></math></span></span><script type="math/tex" id="MathJax-Element-340">y</script></span><span>).</span><br>
<span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span class="mjx-chtml MJXc-display" style="text-align: center;"><span id="MathJax-Element-341-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 118%; text-align: center; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><mtext>FPR</mtext><mo>=</mo><mfrac><mrow><mi>F</mi><mi>P</mi></mrow><mrow><mi>F</mi><mi>P</mi><mo>+</mo><mi>T</mi><mi>N</mi></mrow></mfrac><mo>,</mo><mspace width=&quot;thickmathspace&quot; /><mtext>TPR</mtext><mo>=</mo><mfrac><mrow><mi>T</mi><mi>P</mi></mrow><mrow><mi>T</mi><mi>P</mi><mo>+</mo><mi>F</mi><mi>N</mi></mrow></mfrac><mo stretchy=&quot;false&quot;>(</mo><mo>=</mo><mtext>Recall</mtext><mo stretchy=&quot;false&quot;>)</mo></math>" role="presentation"><span id="MJXc-Node-5101" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-5102" class="mjx-mrow"><span id="MJXc-Node-5103" class="mjx-mtext"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.373em; padding-bottom: 0.373em;">FPR</span></span><span id="MJXc-Node-5104" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.056em; padding-bottom: 0.32em;">=</span></span><span id="MJXc-Node-5105" class="mjx-mfrac MJXc-space3"><span class="mjx-box MJXc-stacked" style="width: 4.514em; padding: 0px 0.12em;"><span class="mjx-numerator" style="width: 4.514em; top: -1.385em;"><span id="MJXc-Node-5106" class="mjx-mrow"><span id="MJXc-Node-5107" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.267em; padding-right: 0.106em;">F</span></span><span id="MJXc-Node-5108" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.267em; padding-right: 0.109em;">P</span></span></span></span><span class="mjx-denominator" style="width: 4.514em; bottom: -0.793em;"><span id="MJXc-Node-5109" class="mjx-mrow"><span id="MJXc-Node-5110" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.267em; padding-right: 0.106em;">F</span></span><span id="MJXc-Node-5111" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.267em; padding-right: 0.109em;">P</span></span><span id="MJXc-Node-5112" class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.32em; padding-bottom: 0.426em;">+</span></span><span id="MJXc-Node-5113" class="mjx-mi MJXc-space2"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.267em; padding-right: 0.12em;">T</span></span><span id="MJXc-Node-5114" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.267em; padding-right: 0.085em;">N</span></span></span></span><span style="border-bottom-width: 1.3px; border-bottom-style: solid; top: -0.283em; width: 4.514em;" class="mjx-line"></span></span><span style="height: 2.177em; vertical-align: -0.793em;" class="mjx-vsize"></span></span><span id="MJXc-Node-5115" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="margin-top: -0.156em; padding-bottom: 0.532em;">,</span></span><span id="MJXc-Node-5116" class="mjx-mspace" style="width: 0.278em; height: 0px;"></span><span id="MJXc-Node-5117" class="mjx-mtext MJXc-space1"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.373em; padding-bottom: 0.373em;">TPR</span></span><span id="MJXc-Node-5118" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.056em; padding-bottom: 0.32em;">=</span></span><span id="MJXc-Node-5119" class="mjx-mfrac MJXc-space3"><span class="mjx-box MJXc-stacked" style="width: 4.514em; padding: 0px 0.12em;"><span class="mjx-numerator" style="width: 4.514em; top: -1.385em;"><span id="MJXc-Node-5120" class="mjx-mrow"><span id="MJXc-Node-5121" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.267em; padding-right: 0.12em;">T</span></span><span id="MJXc-Node-5122" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.267em; padding-right: 0.109em;">P</span></span></span></span><span class="mjx-denominator" style="width: 4.514em; bottom: -0.793em;"><span id="MJXc-Node-5123" class="mjx-mrow"><span id="MJXc-Node-5124" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.267em; padding-right: 0.12em;">T</span></span><span id="MJXc-Node-5125" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.267em; padding-right: 0.109em;">P</span></span><span id="MJXc-Node-5126" class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.32em; padding-bottom: 0.426em;">+</span></span><span id="MJXc-Node-5127" class="mjx-mi MJXc-space2"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.267em; padding-right: 0.106em;">F</span></span><span id="MJXc-Node-5128" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.267em; padding-right: 0.085em;">N</span></span></span></span><span style="border-bottom-width: 1.3px; border-bottom-style: solid; top: -0.283em; width: 4.514em;" class="mjx-line"></span></span><span style="height: 2.177em; vertical-align: -0.793em;" class="mjx-vsize"></span></span><span id="MJXc-Node-5129" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.479em; padding-bottom: 0.585em;">(</span></span><span id="MJXc-Node-5130" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.056em; padding-bottom: 0.32em;">=</span></span><span id="MJXc-Node-5131" class="mjx-mtext MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.426em; padding-bottom: 0.373em;">Recall</span></span><span id="MJXc-Node-5132" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.479em; padding-bottom: 0.585em;">)</span></span></span></span><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mtext>FPR</mtext><mo>=</mo><mfrac><mrow><mi>F</mi><mi>P</mi></mrow><mrow><mi>F</mi><mi>P</mi><mo>+</mo><mi>T</mi><mi>N</mi></mrow></mfrac><mo>,</mo><mspace width="thickmathspace"></mspace><mtext>TPR</mtext><mo>=</mo><mfrac><mrow><mi>T</mi><mi>P</mi></mrow><mrow><mi>T</mi><mi>P</mi><mo>+</mo><mi>F</mi><mi>N</mi></mrow></mfrac><mo stretchy="false">(</mo><mo>=</mo><mtext>Recall</mtext><mo stretchy="false">)</mo></math></span></span></span><script type="math/tex; mode=display" id="MathJax-Element-341">
 \text{FPR} = \frac{FP}{FP + TN}, \; \text{TPR} = \frac{TP}{TP + FN} (= \text{Recall})
</script></span>
<ul>
<li><span>FPR — доля неправильно угаданных объектов негативного класса.</span></li>
<li><span>TPR — доля правильно угаданных объектов позитивного класса.</span></li>
<li><span>Используется для классификаторов, предсказывающих вероятность позитивного класса (обычно класс с меткой </span><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-342-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 118%; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mo>+</mo><mn>1</mn></math>" role="presentation"><span id="MJXc-Node-5133" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-5134" class="mjx-mrow"><span id="MJXc-Node-5135" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.32em; padding-bottom: 0.426em;">+</span></span><span id="MJXc-Node-5136" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.373em; padding-bottom: 0.32em;">1</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo>+</mo><mn>1</mn></math></span></span><script type="math/tex" id="MathJax-Element-342">+1</script></span><span>).</span></li>
<li><strong><span>Построение:</span></strong>
<ul>
<li><span>После получения вероятностей для объектов выбирается граница (threshold) для вероятности. Если вероятность объекта выше этой границы, он относится к позитивному классу, иначе — к негативному.</span></li>
<li><span>Построение начинается с threshold </span><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-343-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 118%; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mo>=</mo><mn>0</mn></math>" role="presentation"><span id="MJXc-Node-5137" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-5138" class="mjx-mrow"><span id="MJXc-Node-5139" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.056em; padding-bottom: 0.32em;">=</span></span><span id="MJXc-Node-5140" class="mjx-mn MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.373em; padding-bottom: 0.373em;">0</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo>=</mo><mn>0</mn></math></span></span><script type="math/tex" id="MathJax-Element-343">= 0</script></span><span>. В этом случае, так как для любого объекта вероятность принадлежности первому классу </span><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-344-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 118%; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mo>&amp;#x2265;</mo><mn>0</mn></math>" role="presentation"><span id="MJXc-Node-5141" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-5142" class="mjx-mrow"><span id="MJXc-Node-5143" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.373em; padding-bottom: 0.479em;">≥</span></span><span id="MJXc-Node-5144" class="mjx-mn MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.373em; padding-bottom: 0.373em;">0</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo>≥</mo><mn>0</mn></math></span></span><script type="math/tex" id="MathJax-Element-344">\geq 0</script></span><span> все объекты будут отнесены к нему. </span><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-345-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 118%; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mtext>TN</mtext><mo>=</mo><mtext>FN</mtext><mo>=</mo><mn>0</mn><mo>,</mo></math>" role="presentation"><span id="MJXc-Node-5145" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-5146" class="mjx-mrow"><span id="MJXc-Node-5147" class="mjx-mtext"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.373em; padding-bottom: 0.32em;">TN</span></span><span id="MJXc-Node-5148" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.056em; padding-bottom: 0.32em;">=</span></span><span id="MJXc-Node-5149" class="mjx-mtext MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.373em; padding-bottom: 0.32em;">FN</span></span><span id="MJXc-Node-5150" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.056em; padding-bottom: 0.32em;">=</span></span><span id="MJXc-Node-5151" class="mjx-mn MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.373em; padding-bottom: 0.373em;">0</span></span><span id="MJXc-Node-5152" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="margin-top: -0.156em; padding-bottom: 0.532em;">,</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mtext>TN</mtext><mo>=</mo><mtext>FN</mtext><mo>=</mo><mn>0</mn><mo>,</mo></math></span></span><script type="math/tex" id="MathJax-Element-345">\text{TN} = \text{FN} = 0,</script></span><span> так как ни один объект не относится к негативному классу. Соответственно </span><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-346-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 118%; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mtext>FPR</mtext><mo>=</mo><mtext>TPR</mtext><mo>=</mo><mn>1</mn><mo>,</mo></math>" role="presentation"><span id="MJXc-Node-5153" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-5154" class="mjx-mrow"><span id="MJXc-Node-5155" class="mjx-mtext"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.373em; padding-bottom: 0.373em;">FPR</span></span><span id="MJXc-Node-5156" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.056em; padding-bottom: 0.32em;">=</span></span><span id="MJXc-Node-5157" class="mjx-mtext MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.373em; padding-bottom: 0.373em;">TPR</span></span><span id="MJXc-Node-5158" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.056em; padding-bottom: 0.32em;">=</span></span><span id="MJXc-Node-5159" class="mjx-mn MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.373em; padding-bottom: 0.32em;">1</span></span><span id="MJXc-Node-5160" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="margin-top: -0.156em; padding-bottom: 0.532em;">,</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mtext>FPR</mtext><mo>=</mo><mtext>TPR</mtext><mo>=</mo><mn>1</mn><mo>,</mo></math></span></span><script type="math/tex" id="MathJax-Element-346">\text{FPR} = \text{TPR} = 1,</script></span><span> т.е. построение начинается справа — с точки </span><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-347-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 118%; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mo stretchy=&quot;false&quot;>(</mo><mn>1</mn><mo>,</mo><mn>1</mn><mo stretchy=&quot;false&quot;>)</mo></math>" role="presentation"><span id="MJXc-Node-5161" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-5162" class="mjx-mrow"><span id="MJXc-Node-5163" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.479em; padding-bottom: 0.585em;">(</span></span><span id="MJXc-Node-5164" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.373em; padding-bottom: 0.32em;">1</span></span><span id="MJXc-Node-5165" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="margin-top: -0.156em; padding-bottom: 0.532em;">,</span></span><span id="MJXc-Node-5166" class="mjx-mn MJXc-space1"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.373em; padding-bottom: 0.32em;">1</span></span><span id="MJXc-Node-5167" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.479em; padding-bottom: 0.585em;">)</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo stretchy="false">(</mo><mn>1</mn><mo>,</mo><mn>1</mn><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-347">(1, 1)</script></span></li>
<li><span>Далее мы постепенно увеличиваем threshold. Когда он “переваливается” через вероятность очереденого объекта соотношение FPR и TPR меняется </span><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-348-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 118%; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mo stretchy=&quot;false&quot;>&amp;#x21D2;</mo></math>" role="presentation"><span id="MJXc-Node-5168" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-5169" class="mjx-mrow"><span id="MJXc-Node-5170" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.215em; padding-bottom: 0.373em;">⇒</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo stretchy="false">⇒</mo></math></span></span><script type="math/tex" id="MathJax-Element-348">\Rightarrow</script></span><span> появляется новая точка на графике. Соединяем её с предыдущей точкой.</span></li>
<li><span>Процесс остановится, когда мы дойдём до threshold </span><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-349-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 118%; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mo>=</mo><mn>1.</mn></math>" role="presentation"><span id="MJXc-Node-5171" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-5172" class="mjx-mrow"><span id="MJXc-Node-5173" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.056em; padding-bottom: 0.32em;">=</span></span><span id="MJXc-Node-5174" class="mjx-mn MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.373em; padding-bottom: 0.32em;">1.</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo>=</mo><mn>1.</mn></math></span></span><script type="math/tex" id="MathJax-Element-349">= 1.</script></span><span> Тогда все объекты наоборот будут отнесены к негативному классу, т.е. на графике появляется финальная точка </span><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-350-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 118%; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mo stretchy=&quot;false&quot;>(</mo><mn>0</mn><mo>,</mo><mn>0</mn><mo stretchy=&quot;false&quot;>)</mo><mo>.</mo></math>" role="presentation"><span id="MJXc-Node-5175" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-5176" class="mjx-mrow"><span id="MJXc-Node-5177" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.479em; padding-bottom: 0.585em;">(</span></span><span id="MJXc-Node-5178" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.373em; padding-bottom: 0.373em;">0</span></span><span id="MJXc-Node-5179" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="margin-top: -0.156em; padding-bottom: 0.532em;">,</span></span><span id="MJXc-Node-5180" class="mjx-mn MJXc-space1"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.373em; padding-bottom: 0.373em;">0</span></span><span id="MJXc-Node-5181" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.479em; padding-bottom: 0.585em;">)</span></span><span id="MJXc-Node-5182" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="margin-top: -0.156em; padding-bottom: 0.32em;">.</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo stretchy="false">(</mo><mn>0</mn><mo>,</mo><mn>0</mn><mo stretchy="false">)</mo><mo>.</mo></math></span></span><script type="math/tex" id="MathJax-Element-350">(0, 0).</script></span></li>
</ul>
</li>
<li><strong><span>ROC-AUC</span></strong><span> — площадь под ROC кривой. Также является метрикой качества (т.к. чем выше кривая, тем лучше алгоритм и тем больше площадь)</span></li>
<li><span>Пример ROC-кривой:</span><br>
<img src="https://scikit-learn.org/stable/_images/sphx_glr_plot_roc_001.png" alt=""></li>
</ul>
</li>
</ul><h3 id="13-Запишите-функционал-логистической-регрессии-Как-он-связан-с-методом-максимума-правдоподобия" data-id="13-Запишите-функционал-логистической-регрессии-Как-он-связан-с-методом-максимума-правдоподобия"><a class="anchor hidden-xs" href="#13-Запишите-функционал-логистической-регрессии-Как-он-связан-с-методом-максимума-правдоподобия" title="13-Запишите-функционал-логистической-регрессии-Как-он-связан-с-методом-максимума-правдоподобия"><span class="octicon octicon-link"></span></a><span>13. Запишите функционал логистической регрессии. Как он связан с методом максимума правдоподобия?</span></h3><ul>
<li><span>Функционал ошибки для лог. регрессии (LogLoss):</span><br>
<span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span class="mjx-chtml MJXc-display" style="text-align: center;"><span id="MathJax-Element-351-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 118%; text-align: center; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><mi>L</mi><mo>=</mo><munderover><mo movablelimits=&quot;false&quot;>&amp;#x2211;</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>n</mi></munderover><mi>log</mi><mo>&amp;#x2061;</mo><mo stretchy=&quot;false&quot;>(</mo><mn>1</mn><mo>+</mo><mi>exp</mi><mo>&amp;#x2061;</mo><mo stretchy=&quot;false&quot;>(</mo><mo>&amp;#x2212;</mo><msub><mi>y</mi><mi>i</mi></msub><mo>&amp;#x22C5;</mo><msup><mi>w</mi><mi>T</mi></msup><msub><mi>x</mi><mi>i</mi></msub><mo stretchy=&quot;false&quot;>)</mo><mo stretchy=&quot;false&quot;>)</mo></math>" role="presentation"><span id="MJXc-Node-5183" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-5184" class="mjx-mrow"><span id="MJXc-Node-5185" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.267em;">L</span></span><span id="MJXc-Node-5186" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.056em; padding-bottom: 0.32em;">=</span></span><span id="MJXc-Node-5187" class="mjx-munderover MJXc-space3"><span class="mjx-itable"><span class="mjx-row"><span class="mjx-cell"><span class="mjx-stack"><span class="mjx-over" style="font-size: 70.7%; padding-bottom: 0.247em; padding-top: 0.141em; padding-left: 0.721em;"><span id="MJXc-Node-5194" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.215em; padding-bottom: 0.267em;">n</span></span></span><span class="mjx-op"><span id="MJXc-Node-5188" class="mjx-mo"><span class="mjx-char MJXc-TeX-size2-R" style="padding-top: 0.744em; padding-bottom: 0.744em;">∑</span></span></span></span></span></span><span class="mjx-row"><span class="mjx-under" style="font-size: 70.7%; padding-top: 0.236em; padding-bottom: 0.141em; padding-left: 0.21em;"><span id="MJXc-Node-5189" class="mjx-texatom" style=""><span id="MJXc-Node-5190" class="mjx-mrow"><span id="MJXc-Node-5191" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.426em; padding-bottom: 0.267em;">i</span></span><span id="MJXc-Node-5192" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.056em; padding-bottom: 0.32em;">=</span></span><span id="MJXc-Node-5193" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.373em; padding-bottom: 0.32em;">1</span></span></span></span></span></span></span></span><span id="MJXc-Node-5195" class="mjx-mi MJXc-space1"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.426em; padding-bottom: 0.532em;">log</span></span><span id="MJXc-Node-5196" class="mjx-mo"><span class="mjx-char"></span></span><span id="MJXc-Node-5197" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.479em; padding-bottom: 0.585em;">(</span></span><span id="MJXc-Node-5198" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.373em; padding-bottom: 0.32em;">1</span></span><span id="MJXc-Node-5199" class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.32em; padding-bottom: 0.426em;">+</span></span><span id="MJXc-Node-5200" class="mjx-mi MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.162em; padding-bottom: 0.532em;">exp</span></span><span id="MJXc-Node-5201" class="mjx-mo"><span class="mjx-char"></span></span><span id="MJXc-Node-5202" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.479em; padding-bottom: 0.585em;">(</span></span><span id="MJXc-Node-5203" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.32em; padding-bottom: 0.426em;">−</span></span><span id="MJXc-Node-5204" class="mjx-msubsup"><span class="mjx-base" style="margin-right: -0.006em;"><span id="MJXc-Node-5205" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.215em; padding-bottom: 0.479em; padding-right: 0.006em;">y</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-5206" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.426em; padding-bottom: 0.267em;">i</span></span></span></span><span id="MJXc-Node-5207" class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.003em; padding-bottom: 0.32em;">⋅</span></span><span id="MJXc-Node-5208" class="mjx-msubsup MJXc-space2"><span class="mjx-base"><span id="MJXc-Node-5209" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.215em; padding-bottom: 0.267em;">w</span></span></span><span class="mjx-sup" style="font-size: 70.7%; vertical-align: 0.584em; padding-left: 0px; padding-right: 0.071em;"><span id="MJXc-Node-5210" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.267em; padding-right: 0.12em;">T</span></span></span></span><span id="MJXc-Node-5211" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-5212" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.215em; padding-bottom: 0.267em;">x</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-5213" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.426em; padding-bottom: 0.267em;">i</span></span></span></span><span id="MJXc-Node-5214" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.479em; padding-bottom: 0.585em;">)</span></span><span id="MJXc-Node-5215" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.479em; padding-bottom: 0.585em;">)</span></span></span></span><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mi>L</mi><mo>=</mo><munderover><mo movablelimits="false">∑</mo><mrow class="MJX-TeXAtom-ORD"><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>n</mi></munderover><mi>log</mi><mo>⁡</mo><mo stretchy="false">(</mo><mn>1</mn><mo>+</mo><mi>exp</mi><mo>⁡</mo><mo stretchy="false">(</mo><mo>−</mo><msub><mi>y</mi><mi>i</mi></msub><mo>⋅</mo><msup><mi>w</mi><mi>T</mi></msup><msub><mi>x</mi><mi>i</mi></msub><mo stretchy="false">)</mo><mo stretchy="false">)</mo></math></span></span></span><script type="math/tex; mode=display" id="MathJax-Element-351">
 L = \sum\limits_{i = 1}^n\log(1 + \exp(-y_i\cdot w^Tx_i))
</script></span></li>
<li><span>Минимизация этого функционала эквивалентна максимизации правдоподобия выборки:</span><br>
<span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span class="mjx-chtml MJXc-display" style="text-align: center;"><span id="MathJax-Element-352-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 118%; text-align: center; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><mtext>Likelihood</mtext><mo>=</mo><munderover><mo movablelimits=&quot;false&quot;>&amp;#x220F;</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>n</mi></munderover><mi>P</mi><mo stretchy=&quot;false&quot;>(</mo><msub><mi>x</mi><mi>i</mi></msub><mspace width=&quot;thickmathspace&quot; /><mtext>&amp;#x43F;&amp;#x440;&amp;#x438;&amp;#x43D;&amp;#x430;&amp;#x434;&amp;#x43B;&amp;#x435;&amp;#x436;&amp;#x438;&amp;#x442; &amp;#x43A;&amp;#x43B;&amp;#x430;&amp;#x441;&amp;#x441;&amp;#x443;</mtext><mspace width=&quot;thickmathspace&quot; /><msub><mi>y</mi><mi>i</mi></msub><mo stretchy=&quot;false&quot;>)</mo></math>" role="presentation"><span id="MJXc-Node-5216" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-5217" class="mjx-mrow"><span id="MJXc-Node-5218" class="mjx-mtext"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.426em; padding-bottom: 0.373em;">Likelihood</span></span><span id="MJXc-Node-5219" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.056em; padding-bottom: 0.32em;">=</span></span><span id="MJXc-Node-5220" class="mjx-munderover MJXc-space3"><span class="mjx-itable"><span class="mjx-row"><span class="mjx-cell"><span class="mjx-stack"><span class="mjx-over" style="font-size: 70.7%; padding-bottom: 0.247em; padding-top: 0.141em; padding-left: 0.604em;"><span id="MJXc-Node-5227" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.215em; padding-bottom: 0.267em;">n</span></span></span><span class="mjx-op"><span id="MJXc-Node-5221" class="mjx-mo"><span class="mjx-char MJXc-TeX-size2-R" style="padding-top: 0.744em; padding-bottom: 0.744em;">∏</span></span></span></span></span></span><span class="mjx-row"><span class="mjx-under" style="font-size: 70.7%; padding-top: 0.236em; padding-bottom: 0.141em; padding-left: 0.092em;"><span id="MJXc-Node-5222" class="mjx-texatom" style=""><span id="MJXc-Node-5223" class="mjx-mrow"><span id="MJXc-Node-5224" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.426em; padding-bottom: 0.267em;">i</span></span><span id="MJXc-Node-5225" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.056em; padding-bottom: 0.32em;">=</span></span><span id="MJXc-Node-5226" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.373em; padding-bottom: 0.32em;">1</span></span></span></span></span></span></span></span><span id="MJXc-Node-5228" class="mjx-mi MJXc-space1"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.267em; padding-right: 0.109em;">P</span></span><span id="MJXc-Node-5229" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.479em; padding-bottom: 0.585em;">(</span></span><span id="MJXc-Node-5230" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-5231" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.215em; padding-bottom: 0.267em;">x</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-5232" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.426em; padding-bottom: 0.267em;">i</span></span></span></span><span id="MJXc-Node-5233" class="mjx-mspace" style="width: 0.278em; height: 0px;"></span><span id="MJXc-Node-5234" class="mjx-mtext"><span class="mjx-char" style="padding-top: 0.532em; padding-bottom: 0.215em;"><span class="mjx-charbox MJXc-TeX-unknown-R" style="padding-bottom: 0.297em; width: 0.519em;">п</span><span class="mjx-charbox MJXc-TeX-unknown-R" style="padding-bottom: 0.297em; width: 0.498em;">р</span><span class="mjx-charbox MJXc-TeX-unknown-R" style="padding-bottom: 0.297em; width: 0.519em;">и</span><span class="mjx-charbox MJXc-TeX-unknown-R" style="padding-bottom: 0.297em; width: 0.519em;">н</span><span class="mjx-charbox MJXc-TeX-unknown-R" style="padding-bottom: 0.297em; width: 0.445em;">а</span><span class="mjx-charbox MJXc-TeX-unknown-R" style="padding-bottom: 0.297em; width: 0.456em;">д</span><span class="mjx-charbox MJXc-TeX-unknown-R" style="padding-bottom: 0.297em; width: 0.498em;">л</span><span class="mjx-charbox MJXc-TeX-unknown-R" style="padding-bottom: 0.297em; width: 0.466em;">е</span><span class="mjx-charbox MJXc-TeX-unknown-R" style="padding-bottom: 0.297em; width: 0.72em;">ж</span><span class="mjx-charbox MJXc-TeX-unknown-R" style="padding-bottom: 0.297em; width: 0.519em;">и</span><span class="mjx-charbox MJXc-TeX-unknown-R" style="padding-bottom: 0.297em; width: 0.434em;">т</span><span class="mjx-charbox MJXc-TeX-main-R" style="padding-bottom: 0.314em;"> </span><span class="mjx-charbox MJXc-TeX-unknown-R" style="padding-bottom: 0.297em; width: 0.498em;">к</span><span class="mjx-charbox MJXc-TeX-unknown-R" style="padding-bottom: 0.297em; width: 0.498em;">л</span><span class="mjx-charbox MJXc-TeX-unknown-R" style="padding-bottom: 0.297em; width: 0.445em;">а</span><span class="mjx-charbox MJXc-TeX-unknown-R" style="padding-bottom: 0.297em; width: 0.456em;">с</span><span class="mjx-charbox MJXc-TeX-unknown-R" style="padding-bottom: 0.297em; width: 0.456em;">с</span><span class="mjx-charbox MJXc-TeX-unknown-R" style="padding-bottom: 0.297em; width: 0.487em;">у</span></span></span><span id="MJXc-Node-5235" class="mjx-mspace" style="width: 0.278em; height: 0px;"></span><span id="MJXc-Node-5236" class="mjx-msubsup"><span class="mjx-base" style="margin-right: -0.006em;"><span id="MJXc-Node-5237" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.215em; padding-bottom: 0.479em; padding-right: 0.006em;">y</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-5238" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.426em; padding-bottom: 0.267em;">i</span></span></span></span><span id="MJXc-Node-5239" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.479em; padding-bottom: 0.585em;">)</span></span></span></span><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mtext>Likelihood</mtext><mo>=</mo><munderover><mo movablelimits="false">∏</mo><mrow class="MJX-TeXAtom-ORD"><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>n</mi></munderover><mi>P</mi><mo stretchy="false">(</mo><msub><mi>x</mi><mi>i</mi></msub><mspace width="thickmathspace"></mspace><mtext>принадлежит классу</mtext><mspace width="thickmathspace"></mspace><msub><mi>y</mi><mi>i</mi></msub><mo stretchy="false">)</mo></math></span></span></span><script type="math/tex; mode=display" id="MathJax-Element-352">
 \text{Likelihood} = \prod\limits_{i = 1}^n P(x_i\;\text{принадлежит классу}\;y_i)
</script></span></li>
<li><span>Доказательство этого утверждения можно посмотреть </span><a href="#4-%D0%9B%D0%BE%D0%B3%D0%B8%D1%81%D1%82%D0%B8%D1%87%D0%B5%D1%81%D0%BA%D0%B0%D1%8F-%D1%80%D0%B5%D0%B3%D1%80%D0%B5%D1%81%D1%81%D0%B8%D1%8F-%D0%AD%D0%BA%D0%B2%D0%B8%D0%B2%D0%B0%D0%BB%D0%B5%D0%BD%D1%82%D0%BD%D0%BE%D1%81%D1%82%D1%8C-%D1%80%D0%B5%D1%88%D0%B5%D0%BD%D0%B8%D0%B9-%D0%BF%D0%BE%D0%BB%D1%83%D1%87%D0%B5%D0%BD%D0%BD%D1%8B%D1%85-%D0%BC%D0%B5%D1%82%D0%BE%D0%B4%D0%BE%D0%BC-%D0%BC%D0%B0%D0%BA%D1%81%D0%B8%D0%BC%D0%B0%D0%BB%D1%8C%D0%BD%D0%BE%D0%B3%D0%BE-%D0%BF%D1%80%D0%B0%D0%B2%D0%B4%D0%BE%D0%BF%D0%BE%D0%B4%D0%BE%D0%B1%D0%B8%D1%8F-%D0%B8-%D0%BC%D0%B8%D0%BD%D0%B8%D0%BC%D0%B8%D0%B7%D0%B0%D1%86%D0%B8%D0%B8-%D0%BB%D0%BE%D0%B3%D0%B8%D1%81%D1%82%D0%B8%D1%87%D0%B5%D1%81%D0%BA%D0%BE%D0%B9-%D1%84%D1%83%D0%BD%D0%BA%D1%86%D0%B8%D0%B8-%D0%BF%D0%BE%D1%82%D0%B5%D1%80%D1%8C"><span>тут</span></a><span>.</span></li>
</ul><h3 id="14-Опишите-жадный-алгоритм-обучения-решающего-дерева" data-id="14-Опишите-жадный-алгоритм-обучения-решающего-дерева"><a class="anchor hidden-xs" href="#14-Опишите-жадный-алгоритм-обучения-решающего-дерева" title="14-Опишите-жадный-алгоритм-обучения-решающего-дерева"><span class="octicon octicon-link"></span></a><span>14. Опишите жадный алгоритм обучения решающего дерева.</span></h3><ul>
<li><span>Построение начинается с корня. В каждой ноде дерева мы делим выборку на две части по следующему принципу: если значение </span><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-353-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 118%; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>j</mi></math>" role="presentation"><span id="MJXc-Node-5240" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-5241" class="mjx-mrow"><span id="MJXc-Node-5242" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.426em; padding-bottom: 0.479em;">j</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>j</mi></math></span></span><script type="math/tex" id="MathJax-Element-353">j</script></span><span>-ого признака объекта </span><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-354-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 118%; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>x</mi></math>" role="presentation"><span id="MJXc-Node-5243" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-5244" class="mjx-mrow"><span id="MJXc-Node-5245" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.215em; padding-bottom: 0.267em;">x</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>x</mi></math></span></span><script type="math/tex" id="MathJax-Element-354">x</script></span><span> меньше чем граница </span><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-355-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 118%; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>t</mi><mo>,</mo></math>" role="presentation"><span id="MJXc-Node-5246" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-5247" class="mjx-mrow"><span id="MJXc-Node-5248" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.426em; padding-bottom: 0.267em;">t</span></span><span id="MJXc-Node-5249" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="margin-top: -0.156em; padding-bottom: 0.532em;">,</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>t</mi><mo>,</mo></math></span></span><script type="math/tex" id="MathJax-Element-355">t,</script></span><span> то объект попадает в правое поддерево, иначе — в левое. Числа </span><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-356-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 118%; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>j</mi></math>" role="presentation"><span id="MJXc-Node-5250" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-5251" class="mjx-mrow"><span id="MJXc-Node-5252" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.426em; padding-bottom: 0.479em;">j</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>j</mi></math></span></span><script type="math/tex" id="MathJax-Element-356">j</script></span><span> и </span><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-357-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 118%; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>t</mi></math>" role="presentation"><span id="MJXc-Node-5253" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-5254" class="mjx-mrow"><span id="MJXc-Node-5255" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.426em; padding-bottom: 0.267em;">t</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>t</mi></math></span></span><script type="math/tex" id="MathJax-Element-357">t</script></span><span> необходимо подобрать для каждой ноды. Так, выборка в текущей ноде разделится на две подвыборки — одна окажется в правом поддереве, другая в левом.</span></li>
<li><span>Заметим, что признаков и объектов (а значит и значений каждого признака) — конечное число. Тогда мы можем перебрать все возможные пары </span><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-358-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 118%; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mo stretchy=&quot;false&quot;>(</mo><mi>j</mi><mo>,</mo><mi>t</mi><mo stretchy=&quot;false&quot;>)</mo><mo>,</mo></math>" role="presentation"><span id="MJXc-Node-5256" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-5257" class="mjx-mrow"><span id="MJXc-Node-5258" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.479em; padding-bottom: 0.585em;">(</span></span><span id="MJXc-Node-5259" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.426em; padding-bottom: 0.479em;">j</span></span><span id="MJXc-Node-5260" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="margin-top: -0.156em; padding-bottom: 0.532em;">,</span></span><span id="MJXc-Node-5261" class="mjx-mi MJXc-space1"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.426em; padding-bottom: 0.267em;">t</span></span><span id="MJXc-Node-5262" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.479em; padding-bottom: 0.585em;">)</span></span><span id="MJXc-Node-5263" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="margin-top: -0.156em; padding-bottom: 0.532em;">,</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo stretchy="false">(</mo><mi>j</mi><mo>,</mo><mi>t</mi><mo stretchy="false">)</mo><mo>,</mo></math></span></span><script type="math/tex" id="MathJax-Element-358">(j, t),</script></span><span> которые делят выборку на две части. Определим принцип, по которому будем сравнивать эти пары между собой.</span></li>
<li><span>Введём критерий информативности </span><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-359-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 118%; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>H</mi><mo stretchy=&quot;false&quot;>(</mo><mi>X</mi><mo stretchy=&quot;false&quot;>)</mo><mo>,</mo></math>" role="presentation"><span id="MJXc-Node-5264" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-5265" class="mjx-mrow"><span id="MJXc-Node-5266" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.267em; padding-right: 0.057em;">H</span></span><span id="MJXc-Node-5267" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.479em; padding-bottom: 0.585em;">(</span></span><span id="MJXc-Node-5268" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.267em; padding-right: 0.024em;">X</span></span><span id="MJXc-Node-5269" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.479em; padding-bottom: 0.585em;">)</span></span><span id="MJXc-Node-5270" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="margin-top: -0.156em; padding-bottom: 0.532em;">,</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>H</mi><mo stretchy="false">(</mo><mi>X</mi><mo stretchy="false">)</mo><mo>,</mo></math></span></span><script type="math/tex" id="MathJax-Element-359">H(X),</script></span><span> где </span><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-360-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 118%; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>X</mi></math>" role="presentation"><span id="MJXc-Node-5271" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-5272" class="mjx-mrow"><span id="MJXc-Node-5273" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.267em; padding-right: 0.024em;">X</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>X</mi></math></span></span><script type="math/tex" id="MathJax-Element-360">X</script></span><span> — некоторое подмножество объектов. Чем более “однородны” объекты в </span><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-361-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 118%; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>X</mi></math>" role="presentation"><span id="MJXc-Node-5274" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-5275" class="mjx-mrow"><span id="MJXc-Node-5276" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.267em; padding-right: 0.024em;">X</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>X</mi></math></span></span><script type="math/tex" id="MathJax-Element-361">X</script></span><span> (например, почти все объекты одного класса в случае классификации, или дисперсия выборки близка к нулю в случае регрессии) тем меньше значение критерия.</span><br>
<strong><span>Примеры критериев</span></strong><span> (</span><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-362-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 118%; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>K</mi></math>" role="presentation"><span id="MJXc-Node-5277" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-5278" class="mjx-mrow"><span id="MJXc-Node-5279" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.267em; padding-right: 0.04em;">K</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>K</mi></math></span></span><script type="math/tex" id="MathJax-Element-362">K</script></span><span> — число классов, </span><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-363-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 118%; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>p</mi><mi>k</mi></msub></math>" role="presentation"><span id="MJXc-Node-5280" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-5281" class="mjx-mrow"><span id="MJXc-Node-5282" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-5283" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.215em; padding-bottom: 0.479em;">p</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.219em; padding-right: 0.071em;"><span id="MJXc-Node-5284" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.267em;">k</span></span></span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>p</mi><mi>k</mi></msub></math></span></span><script type="math/tex" id="MathJax-Element-363">p_k</script></span><span> — доля объектов класса </span><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-364-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 118%; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>k</mi></math>" role="presentation"><span id="MJXc-Node-5285" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-5286" class="mjx-mrow"><span id="MJXc-Node-5287" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.267em;">k</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>k</mi></math></span></span><script type="math/tex" id="MathJax-Element-364">k</script></span><span> в выборке </span><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-365-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 118%; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>X</mi></math>" role="presentation"><span id="MJXc-Node-5288" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-5289" class="mjx-mrow"><span id="MJXc-Node-5290" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.267em; padding-right: 0.024em;">X</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>X</mi></math></span></span><script type="math/tex" id="MathJax-Element-365">X</script></span><span>):</span>
<ul>
<li><span>Энтропийный критерий (классификация) - мера детерминированности/упорядоченности: </span><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-366-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 118%; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>H</mi><mo stretchy=&quot;false&quot;>(</mo><mi>X</mi><mo stretchy=&quot;false&quot;>)</mo><mo>=</mo><mo>&amp;#x2212;</mo><munderover><mo movablelimits=&quot;false&quot;>&amp;#x2211;</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>k</mi><mo>=</mo><mn>1</mn></mrow><mi>K</mi></munderover><msub><mi>p</mi><mi>k</mi></msub><mi>log</mi><mo>&amp;#x2061;</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><msub><mi>p</mi><mi>k</mi></msub></mrow></math>" role="presentation"><span id="MJXc-Node-5291" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-5292" class="mjx-mrow"><span id="MJXc-Node-5293" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.267em; padding-right: 0.057em;">H</span></span><span id="MJXc-Node-5294" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.479em; padding-bottom: 0.585em;">(</span></span><span id="MJXc-Node-5295" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.267em; padding-right: 0.024em;">X</span></span><span id="MJXc-Node-5296" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.479em; padding-bottom: 0.585em;">)</span></span><span id="MJXc-Node-5297" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.056em; padding-bottom: 0.32em;">=</span></span><span id="MJXc-Node-5298" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.32em; padding-bottom: 0.426em;">−</span></span><span id="MJXc-Node-5299" class="mjx-munderover MJXc-space1"><span class="mjx-itable"><span class="mjx-row"><span class="mjx-cell"><span class="mjx-stack"><span class="mjx-over" style="font-size: 70.7%; padding-bottom: 0.258em; padding-top: 0.141em; padding-left: 0.455em;"><span id="MJXc-Node-5306" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.267em; padding-right: 0.04em;">K</span></span></span><span class="mjx-op" style="padding-left: 0.108em;"><span id="MJXc-Node-5300" class="mjx-mo"><span class="mjx-char MJXc-TeX-size1-R" style="padding-top: 0.532em; padding-bottom: 0.532em;">∑</span></span></span></span></span></span><span class="mjx-row"><span class="mjx-under" style="font-size: 70.7%; padding-top: 0.236em; padding-bottom: 0.141em;"><span id="MJXc-Node-5301" class="mjx-texatom" style=""><span id="MJXc-Node-5302" class="mjx-mrow"><span id="MJXc-Node-5303" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.267em;">k</span></span><span id="MJXc-Node-5304" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.056em; padding-bottom: 0.32em;">=</span></span><span id="MJXc-Node-5305" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.373em; padding-bottom: 0.32em;">1</span></span></span></span></span></span></span></span><span id="MJXc-Node-5307" class="mjx-msubsup MJXc-space1"><span class="mjx-base"><span id="MJXc-Node-5308" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.215em; padding-bottom: 0.479em;">p</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.219em; padding-right: 0.071em;"><span id="MJXc-Node-5309" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.267em;">k</span></span></span></span><span id="MJXc-Node-5310" class="mjx-mi MJXc-space1"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.426em; padding-bottom: 0.532em;">log</span></span><span id="MJXc-Node-5311" class="mjx-mo"><span class="mjx-char"></span></span><span id="MJXc-Node-5312" class="mjx-texatom MJXc-space1"><span id="MJXc-Node-5313" class="mjx-mrow"><span id="MJXc-Node-5314" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-5315" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.215em; padding-bottom: 0.479em;">p</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.219em; padding-right: 0.071em;"><span id="MJXc-Node-5316" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.267em;">k</span></span></span></span></span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>H</mi><mo stretchy="false">(</mo><mi>X</mi><mo stretchy="false">)</mo><mo>=</mo><mo>−</mo><munderover><mo movablelimits="false">∑</mo><mrow class="MJX-TeXAtom-ORD"><mi>k</mi><mo>=</mo><mn>1</mn></mrow><mi>K</mi></munderover><msub><mi>p</mi><mi>k</mi></msub><mi>log</mi><mo>⁡</mo><mrow class="MJX-TeXAtom-ORD"><msub><mi>p</mi><mi>k</mi></msub></mrow></math></span></span><script type="math/tex" id="MathJax-Element-366">H(X) = -\sum\limits_{k = 1}^Kp_k\log{p_k}</script></span></li>
<li><span>Критерий Джини (классификация) - вероятность того, что мы ошибёмся, предсказывая метки классов согласно выборочным вероятностям: </span><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-367-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 118%; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>H</mi><mo stretchy=&quot;false&quot;>(</mo><mi>X</mi><mo stretchy=&quot;false&quot;>)</mo><mo>=</mo><mn>1</mn><mo>&amp;#x2212;</mo><munderover><mo movablelimits=&quot;false&quot;>&amp;#x2211;</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>k</mi><mo>=</mo><mn>1</mn></mrow><mi>K</mi></munderover><msubsup><mi>p</mi><mi>k</mi><mn>2</mn></msubsup></math>" role="presentation"><span id="MJXc-Node-5317" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-5318" class="mjx-mrow"><span id="MJXc-Node-5319" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.267em; padding-right: 0.057em;">H</span></span><span id="MJXc-Node-5320" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.479em; padding-bottom: 0.585em;">(</span></span><span id="MJXc-Node-5321" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.267em; padding-right: 0.024em;">X</span></span><span id="MJXc-Node-5322" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.479em; padding-bottom: 0.585em;">)</span></span><span id="MJXc-Node-5323" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.056em; padding-bottom: 0.32em;">=</span></span><span id="MJXc-Node-5324" class="mjx-mn MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.373em; padding-bottom: 0.32em;">1</span></span><span id="MJXc-Node-5325" class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.32em; padding-bottom: 0.426em;">−</span></span><span id="MJXc-Node-5326" class="mjx-munderover MJXc-space2"><span class="mjx-itable"><span class="mjx-row"><span class="mjx-cell"><span class="mjx-stack"><span class="mjx-over" style="font-size: 70.7%; padding-bottom: 0.258em; padding-top: 0.141em; padding-left: 0.455em;"><span id="MJXc-Node-5333" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.267em; padding-right: 0.04em;">K</span></span></span><span class="mjx-op" style="padding-left: 0.108em;"><span id="MJXc-Node-5327" class="mjx-mo"><span class="mjx-char MJXc-TeX-size1-R" style="padding-top: 0.532em; padding-bottom: 0.532em;">∑</span></span></span></span></span></span><span class="mjx-row"><span class="mjx-under" style="font-size: 70.7%; padding-top: 0.236em; padding-bottom: 0.141em;"><span id="MJXc-Node-5328" class="mjx-texatom" style=""><span id="MJXc-Node-5329" class="mjx-mrow"><span id="MJXc-Node-5330" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.267em;">k</span></span><span id="MJXc-Node-5331" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.056em; padding-bottom: 0.32em;">=</span></span><span id="MJXc-Node-5332" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.373em; padding-bottom: 0.32em;">1</span></span></span></span></span></span></span></span><span id="MJXc-Node-5334" class="mjx-msubsup MJXc-space1"><span class="mjx-base"><span id="MJXc-Node-5335" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.215em; padding-bottom: 0.479em;">p</span></span></span><span class="mjx-stack" style="vertical-align: -0.335em;"><span class="mjx-sup" style="font-size: 70.7%; padding-bottom: 0.255em; padding-left: 0px; padding-right: 0.071em;"><span id="MJXc-Node-5337" class="mjx-mn" style=""><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.373em; padding-bottom: 0.32em;">2</span></span></span><span class="mjx-sub" style="font-size: 70.7%; padding-right: 0.071em;"><span id="MJXc-Node-5336" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.267em;">k</span></span></span></span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>H</mi><mo stretchy="false">(</mo><mi>X</mi><mo stretchy="false">)</mo><mo>=</mo><mn>1</mn><mo>−</mo><munderover><mo movablelimits="false">∑</mo><mrow class="MJX-TeXAtom-ORD"><mi>k</mi><mo>=</mo><mn>1</mn></mrow><mi>K</mi></munderover><msubsup><mi>p</mi><mi>k</mi><mn>2</mn></msubsup></math></span></span><script type="math/tex" id="MathJax-Element-367">H(X) = 1 - \sum\limits_{k = 1}^Kp_k^2</script></span></li>
<li><span>MSE (регрессия): </span><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-368-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 118%; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>H</mi><mo stretchy=&quot;false&quot;>(</mo><mi>X</mi><mo stretchy=&quot;false&quot;>)</mo><mo>=</mo><mfrac><mn>1</mn><mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>|</mo></mrow><mi>X</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>|</mo></mrow></mrow></mfrac><munderover><mo movablelimits=&quot;false&quot;>&amp;#x2211;</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>n</mi></munderover><mo stretchy=&quot;false&quot;>(</mo><msub><mi>y</mi><mi>i</mi></msub><mo>&amp;#x2212;</mo><mover><mi>y</mi><mo accent=&quot;false&quot;>&amp;#x00AF;</mo></mover><msup><mo stretchy=&quot;false&quot;>)</mo><mn>2</mn></msup></math>" role="presentation"><span id="MJXc-Node-5338" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-5339" class="mjx-mrow"><span id="MJXc-Node-5340" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.267em; padding-right: 0.057em;">H</span></span><span id="MJXc-Node-5341" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.479em; padding-bottom: 0.585em;">(</span></span><span id="MJXc-Node-5342" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.267em; padding-right: 0.024em;">X</span></span><span id="MJXc-Node-5343" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.479em; padding-bottom: 0.585em;">)</span></span><span id="MJXc-Node-5344" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.056em; padding-bottom: 0.32em;">=</span></span><span id="MJXc-Node-5345" class="mjx-mfrac MJXc-space3"><span class="mjx-box MJXc-stacked" style="width: 1.137em; padding: 0px 0.12em;"><span class="mjx-numerator" style="font-size: 70.7%; width: 1.608em; top: -1.299em;"><span id="MJXc-Node-5346" class="mjx-mn" style=""><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.373em; padding-bottom: 0.32em;">1</span></span></span><span class="mjx-denominator" style="font-size: 70.7%; width: 1.608em; bottom: -0.925em;"><span id="MJXc-Node-5347" class="mjx-mrow" style=""><span id="MJXc-Node-5348" class="mjx-texatom"><span id="MJXc-Node-5349" class="mjx-mrow"><span id="MJXc-Node-5350" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.479em; padding-bottom: 0.585em;">|</span></span></span></span><span id="MJXc-Node-5351" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.267em; padding-right: 0.024em;">X</span></span><span id="MJXc-Node-5352" class="mjx-texatom"><span id="MJXc-Node-5353" class="mjx-mrow"><span id="MJXc-Node-5354" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.479em; padding-bottom: 0.585em;">|</span></span></span></span></span></span><span style="border-bottom-width: 1.3px; border-bottom-style: solid; top: -0.283em; width: 1.137em;" class="mjx-line"></span></span><span style="height: 1.573em; vertical-align: -0.654em;" class="mjx-vsize"></span></span><span id="MJXc-Node-5355" class="mjx-munderover MJXc-space1"><span class="mjx-itable"><span class="mjx-row"><span class="mjx-cell"><span class="mjx-stack"><span class="mjx-over" style="font-size: 70.7%; padding-bottom: 0.247em; padding-top: 0.141em; padding-left: 0.512em;"><span id="MJXc-Node-5362" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.215em; padding-bottom: 0.267em;">n</span></span></span><span class="mjx-op" style="padding-left: 0.046em;"><span id="MJXc-Node-5356" class="mjx-mo"><span class="mjx-char MJXc-TeX-size1-R" style="padding-top: 0.532em; padding-bottom: 0.532em;">∑</span></span></span></span></span></span><span class="mjx-row"><span class="mjx-under" style="font-size: 70.7%; padding-top: 0.236em; padding-bottom: 0.141em;"><span id="MJXc-Node-5357" class="mjx-texatom" style=""><span id="MJXc-Node-5358" class="mjx-mrow"><span id="MJXc-Node-5359" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.426em; padding-bottom: 0.267em;">i</span></span><span id="MJXc-Node-5360" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.056em; padding-bottom: 0.32em;">=</span></span><span id="MJXc-Node-5361" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.373em; padding-bottom: 0.32em;">1</span></span></span></span></span></span></span></span><span id="MJXc-Node-5363" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.479em; padding-bottom: 0.585em;">(</span></span><span id="MJXc-Node-5364" class="mjx-msubsup"><span class="mjx-base" style="margin-right: -0.006em;"><span id="MJXc-Node-5365" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.215em; padding-bottom: 0.479em; padding-right: 0.006em;">y</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-5366" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.426em; padding-bottom: 0.267em;">i</span></span></span></span><span id="MJXc-Node-5367" class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.32em; padding-bottom: 0.426em;">−</span></span><span id="MJXc-Node-5368" class="mjx-munderover MJXc-space2"><span class="mjx-stack"><span class="mjx-over" style="font-size: 70.7%; height: 0.096em; padding-bottom: 0.283em; padding-top: 0.141em; padding-left: 0.041em;"><span id="MJXc-Node-5370" class="mjx-mo" style="vertical-align: top;"><span class="mjx-delim-h"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.301em; padding-bottom: 0.833em; margin: 0px -0.07em 0px -0.069em;">¯</span><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.301em; padding-bottom: 0.833em; margin: 0px 0.121em 0px -0.26em; letter-spacing: -0.421em;">¯</span><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.301em; padding-bottom: 0.833em; margin-right: -0.07em; margin-bottom: 0px; margin-top: 0px;">¯</span></span></span></span><span class="mjx-op"><span id="MJXc-Node-5369" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.215em; padding-bottom: 0.479em; padding-right: 0.006em;">y</span></span></span></span></span><span id="MJXc-Node-5371" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-5372" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.479em; padding-bottom: 0.585em;">)</span></span></span><span class="mjx-sup" style="font-size: 70.7%; vertical-align: 0.513em; padding-left: 0px; padding-right: 0.071em;"><span id="MJXc-Node-5373" class="mjx-mn" style=""><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.373em; padding-bottom: 0.32em;">2</span></span></span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>H</mi><mo stretchy="false">(</mo><mi>X</mi><mo stretchy="false">)</mo><mo>=</mo><mfrac><mn>1</mn><mrow><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><mi>X</mi><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow></mrow></mfrac><munderover><mo movablelimits="false">∑</mo><mrow class="MJX-TeXAtom-ORD"><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>n</mi></munderover><mo stretchy="false">(</mo><msub><mi>y</mi><mi>i</mi></msub><mo>−</mo><mover><mi>y</mi><mo accent="false">¯</mo></mover><msup><mo stretchy="false">)</mo><mn>2</mn></msup></math></span></span><script type="math/tex" id="MathJax-Element-368">H(X) = \frac{1}{|X|}\sum\limits_{i = 1}^n(y_i - \overline{y})^2</script></span></li>
<li><span>MAE (регрессия): </span><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-369-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 118%; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>H</mi><mo stretchy=&quot;false&quot;>(</mo><mi>X</mi><mo stretchy=&quot;false&quot;>)</mo><mo>=</mo><mfrac><mn>1</mn><mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>|</mo></mrow><mi>X</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>|</mo></mrow></mrow></mfrac><munderover><mo movablelimits=&quot;false&quot;>&amp;#x2211;</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>n</mi></munderover><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>|</mo></mrow><msub><mi>y</mi><mi>i</mi></msub><mo>&amp;#x2212;</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mover><mi>y</mi><mo stretchy=&quot;false&quot;>&amp;#x005E;</mo></mover></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>|</mo></mrow><mo>,</mo><mspace width=&quot;thickmathspace&quot; /><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mover><mi>y</mi><mo stretchy=&quot;false&quot;>&amp;#x005E;</mo></mover></mrow></math>" role="presentation"><span id="MJXc-Node-5374" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-5375" class="mjx-mrow"><span id="MJXc-Node-5376" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.267em; padding-right: 0.057em;">H</span></span><span id="MJXc-Node-5377" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.479em; padding-bottom: 0.585em;">(</span></span><span id="MJXc-Node-5378" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.267em; padding-right: 0.024em;">X</span></span><span id="MJXc-Node-5379" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.479em; padding-bottom: 0.585em;">)</span></span><span id="MJXc-Node-5380" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.056em; padding-bottom: 0.32em;">=</span></span><span id="MJXc-Node-5381" class="mjx-mfrac MJXc-space3"><span class="mjx-box MJXc-stacked" style="width: 1.137em; padding: 0px 0.12em;"><span class="mjx-numerator" style="font-size: 70.7%; width: 1.608em; top: -1.299em;"><span id="MJXc-Node-5382" class="mjx-mn" style=""><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.373em; padding-bottom: 0.32em;">1</span></span></span><span class="mjx-denominator" style="font-size: 70.7%; width: 1.608em; bottom: -0.925em;"><span id="MJXc-Node-5383" class="mjx-mrow" style=""><span id="MJXc-Node-5384" class="mjx-texatom"><span id="MJXc-Node-5385" class="mjx-mrow"><span id="MJXc-Node-5386" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.479em; padding-bottom: 0.585em;">|</span></span></span></span><span id="MJXc-Node-5387" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.267em; padding-right: 0.024em;">X</span></span><span id="MJXc-Node-5388" class="mjx-texatom"><span id="MJXc-Node-5389" class="mjx-mrow"><span id="MJXc-Node-5390" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.479em; padding-bottom: 0.585em;">|</span></span></span></span></span></span><span style="border-bottom-width: 1.3px; border-bottom-style: solid; top: -0.283em; width: 1.137em;" class="mjx-line"></span></span><span style="height: 1.573em; vertical-align: -0.654em;" class="mjx-vsize"></span></span><span id="MJXc-Node-5391" class="mjx-munderover MJXc-space1"><span class="mjx-itable"><span class="mjx-row"><span class="mjx-cell"><span class="mjx-stack"><span class="mjx-over" style="font-size: 70.7%; padding-bottom: 0.247em; padding-top: 0.141em; padding-left: 0.512em;"><span id="MJXc-Node-5398" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.215em; padding-bottom: 0.267em;">n</span></span></span><span class="mjx-op" style="padding-left: 0.046em;"><span id="MJXc-Node-5392" class="mjx-mo"><span class="mjx-char MJXc-TeX-size1-R" style="padding-top: 0.532em; padding-bottom: 0.532em;">∑</span></span></span></span></span></span><span class="mjx-row"><span class="mjx-under" style="font-size: 70.7%; padding-top: 0.236em; padding-bottom: 0.141em;"><span id="MJXc-Node-5393" class="mjx-texatom" style=""><span id="MJXc-Node-5394" class="mjx-mrow"><span id="MJXc-Node-5395" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.426em; padding-bottom: 0.267em;">i</span></span><span id="MJXc-Node-5396" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.056em; padding-bottom: 0.32em;">=</span></span><span id="MJXc-Node-5397" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.373em; padding-bottom: 0.32em;">1</span></span></span></span></span></span></span></span><span id="MJXc-Node-5399" class="mjx-texatom MJXc-space1"><span id="MJXc-Node-5400" class="mjx-mrow"><span id="MJXc-Node-5401" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.479em; padding-bottom: 0.585em;">|</span></span></span></span><span id="MJXc-Node-5402" class="mjx-msubsup"><span class="mjx-base" style="margin-right: -0.006em;"><span id="MJXc-Node-5403" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.215em; padding-bottom: 0.479em; padding-right: 0.006em;">y</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-5404" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.426em; padding-bottom: 0.267em;">i</span></span></span></span><span id="MJXc-Node-5405" class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.32em; padding-bottom: 0.426em;">−</span></span><span id="MJXc-Node-5406" class="mjx-texatom MJXc-space2"><span id="MJXc-Node-5407" class="mjx-mrow"><span id="MJXc-Node-5408" class="mjx-munderover"><span class="mjx-stack"><span class="mjx-over" style="height: 0.213em; padding-bottom: 0.06em; padding-left: 0.083em;"><span id="MJXc-Node-5410" class="mjx-mo" style="vertical-align: top;"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.426em; padding-bottom: 0.32em;">^</span></span></span><span class="mjx-op"><span id="MJXc-Node-5409" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.215em; padding-bottom: 0.479em; padding-right: 0.006em;">y</span></span></span></span></span></span></span><span id="MJXc-Node-5411" class="mjx-texatom"><span id="MJXc-Node-5412" class="mjx-mrow"><span id="MJXc-Node-5413" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.479em; padding-bottom: 0.585em;">|</span></span></span></span><span id="MJXc-Node-5414" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="margin-top: -0.156em; padding-bottom: 0.532em;">,</span></span><span id="MJXc-Node-5415" class="mjx-mspace" style="width: 0.278em; height: 0px;"></span><span id="MJXc-Node-5416" class="mjx-texatom MJXc-space1"><span id="MJXc-Node-5417" class="mjx-mrow"><span id="MJXc-Node-5418" class="mjx-munderover"><span class="mjx-stack"><span class="mjx-over" style="height: 0.213em; padding-bottom: 0.06em; padding-left: 0.083em;"><span id="MJXc-Node-5420" class="mjx-mo" style="vertical-align: top;"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.426em; padding-bottom: 0.32em;">^</span></span></span><span class="mjx-op"><span id="MJXc-Node-5419" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.215em; padding-bottom: 0.479em; padding-right: 0.006em;">y</span></span></span></span></span></span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>H</mi><mo stretchy="false">(</mo><mi>X</mi><mo stretchy="false">)</mo><mo>=</mo><mfrac><mn>1</mn><mrow><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><mi>X</mi><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow></mrow></mfrac><munderover><mo movablelimits="false">∑</mo><mrow class="MJX-TeXAtom-ORD"><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>n</mi></munderover><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><msub><mi>y</mi><mi>i</mi></msub><mo>−</mo><mrow class="MJX-TeXAtom-ORD"><mover><mi>y</mi><mo stretchy="false">^</mo></mover></mrow><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><mo>,</mo><mspace width="thickmathspace"></mspace><mrow class="MJX-TeXAtom-ORD"><mover><mi>y</mi><mo stretchy="false">^</mo></mover></mrow></math></span></span><script type="math/tex" id="MathJax-Element-369">H(X) = \frac{1}{|X|}\sum\limits_{i = 1}^n|y_i - \hat{y}|,\;\hat{y}</script></span><span> — медиана таргета в подвыборке </span><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-370-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 118%; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>X</mi><mo>.</mo></math>" role="presentation"><span id="MJXc-Node-5421" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-5422" class="mjx-mrow"><span id="MJXc-Node-5423" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.267em; padding-right: 0.024em;">X</span></span><span id="MJXc-Node-5424" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="margin-top: -0.156em; padding-bottom: 0.32em;">.</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>X</mi><mo>.</mo></math></span></span><script type="math/tex" id="MathJax-Element-370">X.</script></span></li>
</ul>
</li>
<li><span>Положим в текущей вершине </span><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-371-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 118%; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mo stretchy=&quot;false&quot;>(</mo><mi>j</mi><mo>,</mo><mi>t</mi><mo stretchy=&quot;false&quot;>)</mo><mo>=</mo><mtext>arg</mtext><munder><mo form=&quot;prefix&quot;>min</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>j</mi><mo>,</mo><mi>t</mi></mrow></munder><mi>G</mi><mo stretchy=&quot;false&quot;>(</mo><mi>j</mi><mo>,</mo><mi>t</mi><mo stretchy=&quot;false&quot;>)</mo><mo>,</mo></math>" role="presentation"><span id="MJXc-Node-5425" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-5426" class="mjx-mrow"><span id="MJXc-Node-5427" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.479em; padding-bottom: 0.585em;">(</span></span><span id="MJXc-Node-5428" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.426em; padding-bottom: 0.479em;">j</span></span><span id="MJXc-Node-5429" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="margin-top: -0.156em; padding-bottom: 0.532em;">,</span></span><span id="MJXc-Node-5430" class="mjx-mi MJXc-space1"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.426em; padding-bottom: 0.267em;">t</span></span><span id="MJXc-Node-5431" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.479em; padding-bottom: 0.585em;">)</span></span><span id="MJXc-Node-5432" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.056em; padding-bottom: 0.32em;">=</span></span><span id="MJXc-Node-5433" class="mjx-mtext MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.162em; padding-bottom: 0.532em;">arg</span></span><span id="MJXc-Node-5434" class="mjx-munderover MJXc-space1"><span class="mjx-itable"><span class="mjx-row"><span class="mjx-cell"><span class="mjx-op"><span id="MJXc-Node-5435" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.373em; padding-bottom: 0.32em;">min</span></span></span></span></span><span class="mjx-row"><span class="mjx-under" style="font-size: 70.7%; padding-top: 0.236em; padding-bottom: 0.141em; padding-left: 0.653em;"><span id="MJXc-Node-5436" class="mjx-texatom" style=""><span id="MJXc-Node-5437" class="mjx-mrow"><span id="MJXc-Node-5438" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.426em; padding-bottom: 0.479em;">j</span></span><span id="MJXc-Node-5439" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="margin-top: -0.156em; padding-bottom: 0.532em;">,</span></span><span id="MJXc-Node-5440" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.426em; padding-bottom: 0.267em;">t</span></span></span></span></span></span></span></span><span id="MJXc-Node-5441" class="mjx-mi MJXc-space1"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.32em;">G</span></span><span id="MJXc-Node-5442" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.479em; padding-bottom: 0.585em;">(</span></span><span id="MJXc-Node-5443" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.426em; padding-bottom: 0.479em;">j</span></span><span id="MJXc-Node-5444" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="margin-top: -0.156em; padding-bottom: 0.532em;">,</span></span><span id="MJXc-Node-5445" class="mjx-mi MJXc-space1"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.426em; padding-bottom: 0.267em;">t</span></span><span id="MJXc-Node-5446" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.479em; padding-bottom: 0.585em;">)</span></span><span id="MJXc-Node-5447" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="margin-top: -0.156em; padding-bottom: 0.532em;">,</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo stretchy="false">(</mo><mi>j</mi><mo>,</mo><mi>t</mi><mo stretchy="false">)</mo><mo>=</mo><mtext>arg</mtext><munder><mo form="prefix">min</mo><mrow class="MJX-TeXAtom-ORD"><mi>j</mi><mo>,</mo><mi>t</mi></mrow></munder><mi>G</mi><mo stretchy="false">(</mo><mi>j</mi><mo>,</mo><mi>t</mi><mo stretchy="false">)</mo><mo>,</mo></math></span></span><script type="math/tex" id="MathJax-Element-371">(j, t) = \text{arg}\min\limits_{j, t} G(j, t),</script></span><span> где</span><br>
<span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span class="mjx-chtml MJXc-display" style="text-align: center;"><span id="MathJax-Element-372-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 118%; text-align: center; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><mi>G</mi><mo stretchy=&quot;false&quot;>(</mo><mi>j</mi><mo>,</mo><mi>t</mi><mo stretchy=&quot;false&quot;>)</mo><mo>=</mo><mfrac><mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>|</mo></mrow><mi>L</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>|</mo></mrow></mrow><mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>|</mo></mrow><mi>X</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>|</mo></mrow></mrow></mfrac><mi>H</mi><mo stretchy=&quot;false&quot;>(</mo><mi>L</mi><mo stretchy=&quot;false&quot;>)</mo><mo>+</mo><mfrac><mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>|</mo></mrow><mi>R</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>|</mo></mrow></mrow><mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>|</mo></mrow><mi>X</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>|</mo></mrow></mrow></mfrac><mi>H</mi><mo stretchy=&quot;false&quot;>(</mo><mi>R</mi><mo stretchy=&quot;false&quot;>)</mo><mo>,</mo></math>" role="presentation"><span id="MJXc-Node-5448" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-5449" class="mjx-mrow"><span id="MJXc-Node-5450" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.32em;">G</span></span><span id="MJXc-Node-5451" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.479em; padding-bottom: 0.585em;">(</span></span><span id="MJXc-Node-5452" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.426em; padding-bottom: 0.479em;">j</span></span><span id="MJXc-Node-5453" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="margin-top: -0.156em; padding-bottom: 0.532em;">,</span></span><span id="MJXc-Node-5454" class="mjx-mi MJXc-space1"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.426em; padding-bottom: 0.267em;">t</span></span><span id="MJXc-Node-5455" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.479em; padding-bottom: 0.585em;">)</span></span><span id="MJXc-Node-5456" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.056em; padding-bottom: 0.32em;">=</span></span><span id="MJXc-Node-5457" class="mjx-mfrac MJXc-space3"><span class="mjx-box MJXc-stacked" style="width: 1.608em; padding: 0px 0.12em;"><span class="mjx-numerator" style="width: 1.608em; top: -1.525em;"><span id="MJXc-Node-5458" class="mjx-mrow"><span id="MJXc-Node-5459" class="mjx-texatom"><span id="MJXc-Node-5460" class="mjx-mrow"><span id="MJXc-Node-5461" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.479em; padding-bottom: 0.585em;">|</span></span></span></span><span id="MJXc-Node-5462" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.267em;">L</span></span><span id="MJXc-Node-5463" class="mjx-texatom"><span id="MJXc-Node-5464" class="mjx-mrow"><span id="MJXc-Node-5465" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.479em; padding-bottom: 0.585em;">|</span></span></span></span></span></span><span class="mjx-denominator" style="width: 1.608em; bottom: -1.025em;"><span id="MJXc-Node-5466" class="mjx-mrow"><span id="MJXc-Node-5467" class="mjx-texatom"><span id="MJXc-Node-5468" class="mjx-mrow"><span id="MJXc-Node-5469" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.479em; padding-bottom: 0.585em;">|</span></span></span></span><span id="MJXc-Node-5470" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.267em; padding-right: 0.024em;">X</span></span><span id="MJXc-Node-5471" class="mjx-texatom"><span id="MJXc-Node-5472" class="mjx-mrow"><span id="MJXc-Node-5473" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.479em; padding-bottom: 0.585em;">|</span></span></span></span></span></span><span style="border-bottom-width: 1.3px; border-bottom-style: solid; top: -0.283em; width: 1.608em;" class="mjx-line"></span></span><span style="height: 2.549em; vertical-align: -1.025em;" class="mjx-vsize"></span></span><span id="MJXc-Node-5474" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.267em; padding-right: 0.057em;">H</span></span><span id="MJXc-Node-5475" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.479em; padding-bottom: 0.585em;">(</span></span><span id="MJXc-Node-5476" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.267em;">L</span></span><span id="MJXc-Node-5477" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.479em; padding-bottom: 0.585em;">)</span></span><span id="MJXc-Node-5478" class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.32em; padding-bottom: 0.426em;">+</span></span><span id="MJXc-Node-5479" class="mjx-mfrac MJXc-space2"><span class="mjx-box MJXc-stacked" style="width: 1.608em; padding: 0px 0.12em;"><span class="mjx-numerator" style="width: 1.608em; top: -1.525em;"><span id="MJXc-Node-5480" class="mjx-mrow"><span id="MJXc-Node-5481" class="mjx-texatom"><span id="MJXc-Node-5482" class="mjx-mrow"><span id="MJXc-Node-5483" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.479em; padding-bottom: 0.585em;">|</span></span></span></span><span id="MJXc-Node-5484" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.32em;">R</span></span><span id="MJXc-Node-5485" class="mjx-texatom"><span id="MJXc-Node-5486" class="mjx-mrow"><span id="MJXc-Node-5487" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.479em; padding-bottom: 0.585em;">|</span></span></span></span></span></span><span class="mjx-denominator" style="width: 1.608em; bottom: -1.025em;"><span id="MJXc-Node-5488" class="mjx-mrow"><span id="MJXc-Node-5489" class="mjx-texatom"><span id="MJXc-Node-5490" class="mjx-mrow"><span id="MJXc-Node-5491" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.479em; padding-bottom: 0.585em;">|</span></span></span></span><span id="MJXc-Node-5492" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.267em; padding-right: 0.024em;">X</span></span><span id="MJXc-Node-5493" class="mjx-texatom"><span id="MJXc-Node-5494" class="mjx-mrow"><span id="MJXc-Node-5495" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.479em; padding-bottom: 0.585em;">|</span></span></span></span></span></span><span style="border-bottom-width: 1.3px; border-bottom-style: solid; top: -0.283em; width: 1.608em;" class="mjx-line"></span></span><span style="height: 2.549em; vertical-align: -1.025em;" class="mjx-vsize"></span></span><span id="MJXc-Node-5496" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.267em; padding-right: 0.057em;">H</span></span><span id="MJXc-Node-5497" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.479em; padding-bottom: 0.585em;">(</span></span><span id="MJXc-Node-5498" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.32em;">R</span></span><span id="MJXc-Node-5499" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.479em; padding-bottom: 0.585em;">)</span></span><span id="MJXc-Node-5500" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="margin-top: -0.156em; padding-bottom: 0.532em;">,</span></span></span></span><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mi>G</mi><mo stretchy="false">(</mo><mi>j</mi><mo>,</mo><mi>t</mi><mo stretchy="false">)</mo><mo>=</mo><mfrac><mrow><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><mi>L</mi><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow></mrow><mrow><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><mi>X</mi><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow></mrow></mfrac><mi>H</mi><mo stretchy="false">(</mo><mi>L</mi><mo stretchy="false">)</mo><mo>+</mo><mfrac><mrow><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><mi>R</mi><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow></mrow><mrow><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><mi>X</mi><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow></mrow></mfrac><mi>H</mi><mo stretchy="false">(</mo><mi>R</mi><mo stretchy="false">)</mo><mo>,</mo></math></span></span></span><script type="math/tex; mode=display" id="MathJax-Element-372">
 G(j,t) = \frac{|L|}{|X|}H(L) + \frac{|R|}{|X|}H(R),
</script></span><br>
<span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-373-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 118%; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>X</mi></math>" role="presentation"><span id="MJXc-Node-5501" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-5502" class="mjx-mrow"><span id="MJXc-Node-5503" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.267em; padding-right: 0.024em;">X</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>X</mi></math></span></span><script type="math/tex" id="MathJax-Element-373">X</script></span><span> — подвыборка в текущей ноде, </span><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-374-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 118%; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>L</mi></math>" role="presentation"><span id="MJXc-Node-5504" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-5505" class="mjx-mrow"><span id="MJXc-Node-5506" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.267em;">L</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>L</mi></math></span></span><script type="math/tex" id="MathJax-Element-374">L</script></span><span> — выборка в левом поддереве при фиксированных </span><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-375-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 118%; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>j</mi><mo>,</mo><mi>t</mi><mo>,</mo></math>" role="presentation"><span id="MJXc-Node-5507" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-5508" class="mjx-mrow"><span id="MJXc-Node-5509" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.426em; padding-bottom: 0.479em;">j</span></span><span id="MJXc-Node-5510" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="margin-top: -0.156em; padding-bottom: 0.532em;">,</span></span><span id="MJXc-Node-5511" class="mjx-mi MJXc-space1"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.426em; padding-bottom: 0.267em;">t</span></span><span id="MJXc-Node-5512" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="margin-top: -0.156em; padding-bottom: 0.532em;">,</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>j</mi><mo>,</mo><mi>t</mi><mo>,</mo></math></span></span><script type="math/tex" id="MathJax-Element-375">j, t,</script></span><span> </span><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-376-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 118%; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>R</mi></math>" role="presentation"><span id="MJXc-Node-5513" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-5514" class="mjx-mrow"><span id="MJXc-Node-5515" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.32em;">R</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>R</mi></math></span></span><script type="math/tex" id="MathJax-Element-376">R</script></span><span> — выборка в правом.</span>
<ul>
<li><span>Для категориальных признаков можно делить выборку не на две подвыборки, а на число, равное количеству значений категориального признака.</span></li>
</ul>
</li>
<li><span>Т.к. дерево можно строить “до упора” (пока в каждом листе не окажется единственный объект/единственный класс), то перед построением дерева обычно определяется некоторый </span><em><span>критерий останова,</span></em><span> если нам не нужно переобученное дерево. Вот некоторые из них:</span>
<ul>
<li><span>Максимальную глубину дерева.</span></li>
<li><span>Минимальное число объектов в листе для сплита. Если объектов меньше чем это число — прекращаем строить это поддерево.</span></li>
<li><span>Максимальное суммарное число листьев в дереве.</span></li>
</ul>
</li>
<li><span>После построения в листе предсказывам среднее значение подвыборки, попавшей в этот лист (в случае регрессии и MSE); в случае MAE - медиану; или же доминирующий класс и выборочные вероятности в случае классификации).</span>
<ul>
<li><span>Можно формально показать (с помощью метода множителей Лагранжа), что выборочные вероятности максимизируют правдоподобие данной подвыборки.</span></li>
</ul>
</li>
</ul><h3 id="15-Почему-с-помощью-решающего-дерева-можно-достичь-нулевой-ошибки-на-обучающей-выборке-без-повторяющихся-объектов" data-id="15-Почему-с-помощью-решающего-дерева-можно-достичь-нулевой-ошибки-на-обучающей-выборке-без-повторяющихся-объектов"><a class="anchor hidden-xs" href="#15-Почему-с-помощью-решающего-дерева-можно-достичь-нулевой-ошибки-на-обучающей-выборке-без-повторяющихся-объектов" title="15-Почему-с-помощью-решающего-дерева-можно-достичь-нулевой-ошибки-на-обучающей-выборке-без-повторяющихся-объектов"><span class="octicon octicon-link"></span></a><span>15. Почему с помощью решающего дерева можно достичь нулевой ошибки на обучающей выборке без повторяющихся объектов?</span></h3><p><span>Если не задавать никакого критерия останова, то дерево будет строиться до тех пор, пока в каждом листе не останется один объект (или пока в каждом листе все объекты не будут принадлежать к одному классу). Тогда, для каждого объекта из обучающей выборки решающее дерево будет предсказывать метку этого объекта, так как объектов с другими метками в листе нету. То есть дерево просто запомнит нашу обучающую выборку и поэтому ошибка будет нулевая.</span></p><h3 id="16-Что-такое-bagging" data-id="16-Что-такое-bagging"><a class="anchor hidden-xs" href="#16-Что-такое-bagging" title="16-Что-такое-bagging"><span class="octicon octicon-link"></span></a><span>16. Что такое bagging?</span></h3><ul>
<li><strong><span>Bagging</span></strong><span> (Bootstrap aggregating) — метод ансамблирования алгоритмов, который заключается в обучении </span><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-377-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 118%; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>N</mi></math>" role="presentation"><span id="MJXc-Node-5516" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-5517" class="mjx-mrow"><span id="MJXc-Node-5518" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.267em; padding-right: 0.085em;">N</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>N</mi></math></span></span><script type="math/tex" id="MathJax-Element-377">N</script></span><span> базовых моделей на бутстрапированных выборках и усреднении их ответа.</span>
<ul>
<li><span>Если предположить, что ошибки базовых алгоритмов не скоррелированы (что, очевидно, неправда, так как обучающие выборки бустрапировались из общего множества объектов), и их дисперсии равны между собой, то бэггинг уменьшает разброс базового алгоритма в </span><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-378-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 118%; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>N</mi></math>" role="presentation"><span id="MJXc-Node-5519" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-5520" class="mjx-mrow"><span id="MJXc-Node-5521" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.267em; padding-right: 0.085em;">N</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>N</mi></math></span></span><script type="math/tex" id="MathJax-Element-378">N</script></span><span> раз.</span>
<ul>
<li><span>Т.е. бэггинг не меняет bias базовых алгоритмов, но уменьшает их дисперсию. Поэтому он сильно увеличивает качество деревьев, которые обладают низким смещением, но высоким разбросом.</span></li>
</ul>
</li>
</ul>
</li>
</ul><h3 id="17-Что-такое-случайный-лес-Чем-он-отличается-от-бэггинга-над-решающими-деревьями" data-id="17-Что-такое-случайный-лес-Чем-он-отличается-от-бэггинга-над-решающими-деревьями"><a class="anchor hidden-xs" href="#17-Что-такое-случайный-лес-Чем-он-отличается-от-бэггинга-над-решающими-деревьями" title="17-Что-такое-случайный-лес-Чем-он-отличается-от-бэггинга-над-решающими-деревьями"><span class="octicon octicon-link"></span></a><span>17. Что такое случайный лес? Чем он отличается от бэггинга над решающими деревьями?</span></h3><p><strong><span>Random Forest</span></strong><span> (Случайный лес) — модель, являющаяся ансамблем деревьев, который обучается с помощью бэггинга и метода случайных подпространств одновременно. Т.е. каждый базовый алгоритм обучается на бутстрапированной подвыборке со случайно выбранным подмножеством признаков.</span></p><ul>
<li><strong><span>Отличие от бэггинга на решающих деревьях</span></strong><span> заключается в использовании метода случайных подпространств для обучения каждого базового алгоритма.</span>
<ul>
<li><em><span>Random Subspace Method</span></em><span> (RSM) — метод случайных подпространств. Аналогично бэггингу, обучаем каждый базовый алгоритм используя только случайное подмножество признаков. При таком подходе алгоритмы становятся ещё более нескорелированными.</span></li>
</ul>
</li>
<li><span>Т.к. деревья очень слабо скорелированы друг с другом при таком подходе, реальный разброс сильнее приближается к оценке </span><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-379-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 118%; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mfrac><mtext>&amp;#x420;&amp;#x430;&amp;#x437;&amp;#x431;&amp;#x440;&amp;#x43E;&amp;#x441; &amp;#x431;&amp;#x430;&amp;#x437;&amp;#x43E;&amp;#x432;&amp;#x43E;&amp;#x433;&amp;#x43E; &amp;#x430;&amp;#x43B;&amp;#x433;&amp;#x43E;&amp;#x440;&amp;#x438;&amp;#x442;&amp;#x43C;&amp;#x430;</mtext><mi>N</mi></mfrac><mo>.</mo></math>" role="presentation"><span id="MJXc-Node-5522" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-5523" class="mjx-mrow"><span id="MJXc-Node-5524" class="mjx-mfrac"><span class="mjx-box MJXc-stacked" style="width: 8.607em; padding: 0px 0.12em;"><span class="mjx-numerator" style="font-size: 70.7%; width: 12.172em; top: -1.633em;"><span id="MJXc-Node-5525" class="mjx-mtext" style=""><span class="mjx-char" style="padding-top: 0.532em; padding-bottom: 0.215em;"><span class="mjx-charbox MJXc-TeX-unknown-R" style="padding-bottom: 0.297em; width: 0.572em;">Р</span><span class="mjx-charbox MJXc-TeX-unknown-R" style="padding-bottom: 0.297em; width: 0.445em;">а</span><span class="mjx-charbox MJXc-TeX-unknown-R" style="padding-bottom: 0.297em; width: 0.392em;">з</span><span class="mjx-charbox MJXc-TeX-unknown-R" style="padding-bottom: 0.297em; width: 0.508em;">б</span><span class="mjx-charbox MJXc-TeX-unknown-R" style="padding-bottom: 0.297em; width: 0.498em;">р</span><span class="mjx-charbox MJXc-TeX-unknown-R" style="padding-bottom: 0.297em; width: 0.508em;">о</span><span class="mjx-charbox MJXc-TeX-unknown-R" style="padding-bottom: 0.297em; width: 0.456em;">с</span><span class="mjx-charbox MJXc-TeX-main-R" style="padding-bottom: 0.314em;"> </span><span class="mjx-charbox MJXc-TeX-unknown-R" style="padding-bottom: 0.297em; width: 0.508em;">б</span><span class="mjx-charbox MJXc-TeX-unknown-R" style="padding-bottom: 0.297em; width: 0.445em;">а</span><span class="mjx-charbox MJXc-TeX-unknown-R" style="padding-bottom: 0.297em; width: 0.392em;">з</span><span class="mjx-charbox MJXc-TeX-unknown-R" style="padding-bottom: 0.297em; width: 0.508em;">о</span><span class="mjx-charbox MJXc-TeX-unknown-R" style="padding-bottom: 0.297em; width: 0.477em;">в</span><span class="mjx-charbox MJXc-TeX-unknown-R" style="padding-bottom: 0.297em; width: 0.508em;">о</span><span class="mjx-charbox MJXc-TeX-unknown-R" style="padding-bottom: 0.297em; width: 0.392em;">г</span><span class="mjx-charbox MJXc-TeX-unknown-R" style="padding-bottom: 0.297em; width: 0.508em;">о</span><span class="mjx-charbox MJXc-TeX-main-R" style="padding-bottom: 0.314em;"> </span><span class="mjx-charbox MJXc-TeX-unknown-R" style="padding-bottom: 0.297em; width: 0.445em;">а</span><span class="mjx-charbox MJXc-TeX-unknown-R" style="padding-bottom: 0.297em; width: 0.498em;">л</span><span class="mjx-charbox MJXc-TeX-unknown-R" style="padding-bottom: 0.297em; width: 0.392em;">г</span><span class="mjx-charbox MJXc-TeX-unknown-R" style="padding-bottom: 0.297em; width: 0.508em;">о</span><span class="mjx-charbox MJXc-TeX-unknown-R" style="padding-bottom: 0.297em; width: 0.498em;">р</span><span class="mjx-charbox MJXc-TeX-unknown-R" style="padding-bottom: 0.297em; width: 0.519em;">и</span><span class="mjx-charbox MJXc-TeX-unknown-R" style="padding-bottom: 0.297em; width: 0.434em;">т</span><span class="mjx-charbox MJXc-TeX-unknown-R" style="padding-bottom: 0.297em; width: 0.614em;">м</span><span class="mjx-charbox MJXc-TeX-unknown-R" style="padding-bottom: 0.297em; width: 0.445em;">а</span></span></span></span><span class="mjx-denominator" style="font-size: 70.7%; width: 12.172em; bottom: -0.609em;"><span id="MJXc-Node-5526" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.267em; padding-right: 0.085em;">N</span></span></span><span style="border-bottom-width: 1.3px; border-bottom-style: solid; top: -0.283em; width: 8.607em;" class="mjx-line"></span></span><span style="height: 1.586em; vertical-align: -0.431em;" class="mjx-vsize"></span></span><span id="MJXc-Node-5527" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="margin-top: -0.156em; padding-bottom: 0.32em;">.</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mfrac><mtext>Разброс базового алгоритма</mtext><mi>N</mi></mfrac><mo>.</mo></math></span></span><script type="math/tex" id="MathJax-Element-379">\frac{\text{Разброс базового алгоритма}}{N}.</script></span></li>
<li><span>Такой метод обучения очень эффективен именно для деревьев, потому что деревья легко переобучаются и, как следствие, обладают низким смещением и высоким разбросом. Уменьшая разброс с помощью бэггинга и RSM, мы получаем модель с низкими смещением и разбросом.</span></li>
</ul><h3 id="18-Как-в-градиентном-бустинге-обучаются-базовые-алгоритмы" data-id="18-Как-в-градиентном-бустинге-обучаются-базовые-алгоритмы"><a class="anchor hidden-xs" href="#18-Как-в-градиентном-бустинге-обучаются-базовые-алгоритмы" title="18-Как-в-градиентном-бустинге-обучаются-базовые-алгоритмы"><span class="octicon octicon-link"></span></a><span>18. Как в градиентном бустинге обучаются базовые алгоритмы?</span></h3><p><strong><span>Бустинг</span></strong><span> — метод ансамблирования алгоримтов.</span><br>
<em><span>Идея бустинга:</span></em></p><ol start="0">
<li><span>Будем строить итоговый алгоритм как сумму базовых алгоритмов из одного семейства.</span><br>
<span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span class="mjx-chtml MJXc-display" style="text-align: center;"><span id="MathJax-Element-380-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 118%; text-align: center; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><msub><mi>a</mi><mi>N</mi></msub><mo stretchy=&quot;false&quot;>(</mo><mi>x</mi><mo stretchy=&quot;false&quot;>)</mo><mo>=</mo><munderover><mo movablelimits=&quot;false&quot;>&amp;#x2211;</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>N</mi></munderover><msub><mi>b</mi><mi>i</mi></msub><mo stretchy=&quot;false&quot;>(</mo><mi>x</mi><mo stretchy=&quot;false&quot;>)</mo></math>" role="presentation"><span id="MJXc-Node-5528" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-5529" class="mjx-mrow"><span id="MJXc-Node-5530" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-5531" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.215em; padding-bottom: 0.267em;">a</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-5532" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.267em; padding-right: 0.085em;">N</span></span></span></span><span id="MJXc-Node-5533" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.479em; padding-bottom: 0.585em;">(</span></span><span id="MJXc-Node-5534" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.215em; padding-bottom: 0.267em;">x</span></span><span id="MJXc-Node-5535" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.479em; padding-bottom: 0.585em;">)</span></span><span id="MJXc-Node-5536" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.056em; padding-bottom: 0.32em;">=</span></span><span id="MJXc-Node-5537" class="mjx-munderover MJXc-space3"><span class="mjx-itable"><span class="mjx-row"><span class="mjx-cell"><span class="mjx-stack"><span class="mjx-over" style="font-size: 70.7%; padding-bottom: 0.258em; padding-top: 0.141em; padding-left: 0.577em;"><span id="MJXc-Node-5544" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.267em; padding-right: 0.085em;">N</span></span></span><span class="mjx-op"><span id="MJXc-Node-5538" class="mjx-mo"><span class="mjx-char MJXc-TeX-size2-R" style="padding-top: 0.744em; padding-bottom: 0.744em;">∑</span></span></span></span></span></span><span class="mjx-row"><span class="mjx-under" style="font-size: 70.7%; padding-top: 0.236em; padding-bottom: 0.141em; padding-left: 0.21em;"><span id="MJXc-Node-5539" class="mjx-texatom" style=""><span id="MJXc-Node-5540" class="mjx-mrow"><span id="MJXc-Node-5541" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.426em; padding-bottom: 0.267em;">i</span></span><span id="MJXc-Node-5542" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.056em; padding-bottom: 0.32em;">=</span></span><span id="MJXc-Node-5543" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.373em; padding-bottom: 0.32em;">1</span></span></span></span></span></span></span></span><span id="MJXc-Node-5545" class="mjx-msubsup MJXc-space1"><span class="mjx-base"><span id="MJXc-Node-5546" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.267em;">b</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-5547" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.426em; padding-bottom: 0.267em;">i</span></span></span></span><span id="MJXc-Node-5548" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.479em; padding-bottom: 0.585em;">(</span></span><span id="MJXc-Node-5549" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.215em; padding-bottom: 0.267em;">x</span></span><span id="MJXc-Node-5550" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.479em; padding-bottom: 0.585em;">)</span></span></span></span><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><msub><mi>a</mi><mi>N</mi></msub><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mo>=</mo><munderover><mo movablelimits="false">∑</mo><mrow class="MJX-TeXAtom-ORD"><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>N</mi></munderover><msub><mi>b</mi><mi>i</mi></msub><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo></math></span></span></span><script type="math/tex; mode=display" id="MathJax-Element-380">
 a_N(x) = \sum\limits_{i = 1}^N b_i(x) 
</script></span></li>
<li><span>Фиксируем некоторый начальный алгоритм </span><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-381-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 118%; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>b</mi><mn>0</mn></msub><mo stretchy=&quot;false&quot;>(</mo><mi>x</mi><mo stretchy=&quot;false&quot;>)</mo><mo>.</mo></math>" role="presentation"><span id="MJXc-Node-5551" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-5552" class="mjx-mrow"><span id="MJXc-Node-5553" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-5554" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.267em;">b</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-5555" class="mjx-mn" style=""><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.373em; padding-bottom: 0.373em;">0</span></span></span></span><span id="MJXc-Node-5556" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.479em; padding-bottom: 0.585em;">(</span></span><span id="MJXc-Node-5557" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.215em; padding-bottom: 0.267em;">x</span></span><span id="MJXc-Node-5558" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.479em; padding-bottom: 0.585em;">)</span></span><span id="MJXc-Node-5559" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="margin-top: -0.156em; padding-bottom: 0.32em;">.</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>b</mi><mn>0</mn></msub><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mo>.</mo></math></span></span><script type="math/tex" id="MathJax-Element-381">b_0(x).</script></span></li>
<li><span>Каждый следующий алгоритм строится так, чтобы исправить ошибку уже построенной композиции (уменьшая некоторую функцию потерь L):</span><br>
<span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span class="mjx-chtml MJXc-display" style="text-align: center;"><span id="MathJax-Element-382-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 118%; text-align: center; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><mtable rowspacing=&quot;3pt&quot; columnspacing=&quot;1em&quot; displaystyle=&quot;true&quot;><mtr><mtd><msub><mi>b</mi><mi>N</mi></msub><mo stretchy=&quot;false&quot;>(</mo><mi>x</mi><mo stretchy=&quot;false&quot;>)</mo><mo>=</mo><mtext>arg</mtext><munder><mo form=&quot;prefix&quot;>min</mo><mi>b</mi></munder><mi>L</mi><mo stretchy=&quot;false&quot;>(</mo><mi>x</mi><mo>,</mo><msub><mi>a</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>N</mi><mo>&amp;#x2212;</mo><mn>1</mn></mrow></msub><mo stretchy=&quot;false&quot;>(</mo><mi>x</mi><mo stretchy=&quot;false&quot;>)</mo><mo>+</mo><mi>b</mi><mo stretchy=&quot;false&quot;>(</mo><mi>x</mi><mo stretchy=&quot;false&quot;>)</mo><mo stretchy=&quot;false&quot;>)</mo></mtd></mtr><mtr><mtd><msub><mi>a</mi><mi>N</mi></msub><mo stretchy=&quot;false&quot;>(</mo><mi>x</mi><mo stretchy=&quot;false&quot;>)</mo><mo>=</mo><msub><mi>a</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>N</mi><mo>&amp;#x2212;</mo><mn>1</mn></mrow></msub><mo stretchy=&quot;false&quot;>(</mo><mi>x</mi><mo stretchy=&quot;false&quot;>)</mo><mo>+</mo><msub><mi>b</mi><mi>N</mi></msub><mo stretchy=&quot;false&quot;>(</mo><mi>x</mi><mo stretchy=&quot;false&quot;>)</mo></mtd></mtr></mtable></math>" role="presentation"><span id="MJXc-Node-5560" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-5561" class="mjx-mrow"><span id="MJXc-Node-5562" class="mjx-mtable" style="vertical-align: -1.25em; padding: 0px 0.167em;"><span class="mjx-table"><span id="MJXc-Node-5563" class="mjx-mtr" style="height: 1.776em;"><span id="MJXc-Node-5564" class="mjx-mtd" style="padding: 0px; width: 15.925em;"><span id="MJXc-Node-5565" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-5566" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-5567" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.267em;">b</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-5568" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.267em; padding-right: 0.085em;">N</span></span></span></span><span id="MJXc-Node-5569" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.479em; padding-bottom: 0.585em;">(</span></span><span id="MJXc-Node-5570" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.215em; padding-bottom: 0.267em;">x</span></span><span id="MJXc-Node-5571" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.479em; padding-bottom: 0.585em;">)</span></span><span id="MJXc-Node-5572" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.056em; padding-bottom: 0.32em;">=</span></span><span id="MJXc-Node-5573" class="mjx-mtext MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.162em; padding-bottom: 0.532em;">arg</span></span><span id="MJXc-Node-5574" class="mjx-munderover MJXc-space1"><span class="mjx-itable"><span class="mjx-row"><span class="mjx-cell"><span class="mjx-op"><span id="MJXc-Node-5575" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.373em; padding-bottom: 0.32em;">min</span></span></span></span></span><span class="mjx-row"><span class="mjx-under" style="font-size: 70.7%; padding-top: 0.236em; padding-bottom: 0.141em; padding-left: 0.964em;"><span id="MJXc-Node-5576" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.267em;">b</span></span></span></span></span></span><span id="MJXc-Node-5577" class="mjx-mi MJXc-space1"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.267em;">L</span></span><span id="MJXc-Node-5578" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.479em; padding-bottom: 0.585em;">(</span></span><span id="MJXc-Node-5579" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.215em; padding-bottom: 0.267em;">x</span></span><span id="MJXc-Node-5580" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="margin-top: -0.156em; padding-bottom: 0.532em;">,</span></span><span id="MJXc-Node-5581" class="mjx-msubsup MJXc-space1"><span class="mjx-base"><span id="MJXc-Node-5582" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.215em; padding-bottom: 0.267em;">a</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-5583" class="mjx-texatom" style=""><span id="MJXc-Node-5584" class="mjx-mrow"><span id="MJXc-Node-5585" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.267em; padding-right: 0.085em;">N</span></span><span id="MJXc-Node-5586" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.32em; padding-bottom: 0.426em;">−</span></span><span id="MJXc-Node-5587" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.373em; padding-bottom: 0.32em;">1</span></span></span></span></span></span><span id="MJXc-Node-5588" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.479em; padding-bottom: 0.585em;">(</span></span><span id="MJXc-Node-5589" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.215em; padding-bottom: 0.267em;">x</span></span><span id="MJXc-Node-5590" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.479em; padding-bottom: 0.585em;">)</span></span><span id="MJXc-Node-5591" class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.32em; padding-bottom: 0.426em;">+</span></span><span id="MJXc-Node-5592" class="mjx-mi MJXc-space2"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.267em;">b</span></span><span id="MJXc-Node-5593" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.479em; padding-bottom: 0.585em;">(</span></span><span id="MJXc-Node-5594" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.215em; padding-bottom: 0.267em;">x</span></span><span id="MJXc-Node-5595" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.479em; padding-bottom: 0.585em;">)</span></span><span id="MJXc-Node-5596" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.479em; padding-bottom: 0.585em;">)</span></span><span class="mjx-strut"></span></span></span></span><span id="MJXc-Node-5597" class="mjx-mtr" style="height: 1.225em;"><span id="MJXc-Node-5598" class="mjx-mtd" style="padding: 0.15em 0px 0px;"><span id="MJXc-Node-5599" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-5600" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-5601" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.215em; padding-bottom: 0.267em;">a</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-5602" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.267em; padding-right: 0.085em;">N</span></span></span></span><span id="MJXc-Node-5603" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.479em; padding-bottom: 0.585em;">(</span></span><span id="MJXc-Node-5604" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.215em; padding-bottom: 0.267em;">x</span></span><span id="MJXc-Node-5605" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.479em; padding-bottom: 0.585em;">)</span></span><span id="MJXc-Node-5606" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.056em; padding-bottom: 0.32em;">=</span></span><span id="MJXc-Node-5607" class="mjx-msubsup MJXc-space3"><span class="mjx-base"><span id="MJXc-Node-5608" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.215em; padding-bottom: 0.267em;">a</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-5609" class="mjx-texatom" style=""><span id="MJXc-Node-5610" class="mjx-mrow"><span id="MJXc-Node-5611" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.267em; padding-right: 0.085em;">N</span></span><span id="MJXc-Node-5612" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.32em; padding-bottom: 0.426em;">−</span></span><span id="MJXc-Node-5613" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.373em; padding-bottom: 0.32em;">1</span></span></span></span></span></span><span id="MJXc-Node-5614" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.479em; padding-bottom: 0.585em;">(</span></span><span id="MJXc-Node-5615" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.215em; padding-bottom: 0.267em;">x</span></span><span id="MJXc-Node-5616" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.479em; padding-bottom: 0.585em;">)</span></span><span id="MJXc-Node-5617" class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.32em; padding-bottom: 0.426em;">+</span></span><span id="MJXc-Node-5618" class="mjx-msubsup MJXc-space2"><span class="mjx-base"><span id="MJXc-Node-5619" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.267em;">b</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-5620" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.267em; padding-right: 0.085em;">N</span></span></span></span><span id="MJXc-Node-5621" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.479em; padding-bottom: 0.585em;">(</span></span><span id="MJXc-Node-5622" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.215em; padding-bottom: 0.267em;">x</span></span><span id="MJXc-Node-5623" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.479em; padding-bottom: 0.585em;">)</span></span><span class="mjx-strut"></span></span></span></span></span></span></span></span><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mtable rowspacing="3pt" columnspacing="1em" displaystyle="true"><mtr><mtd><msub><mi>b</mi><mi>N</mi></msub><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mo>=</mo><mtext>arg</mtext><munder><mo form="prefix">min</mo><mi>b</mi></munder><mi>L</mi><mo stretchy="false">(</mo><mi>x</mi><mo>,</mo><msub><mi>a</mi><mrow class="MJX-TeXAtom-ORD"><mi>N</mi><mo>−</mo><mn>1</mn></mrow></msub><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mo>+</mo><mi>b</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mo stretchy="false">)</mo></mtd></mtr><mtr><mtd><msub><mi>a</mi><mi>N</mi></msub><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mo>=</mo><msub><mi>a</mi><mrow class="MJX-TeXAtom-ORD"><mi>N</mi><mo>−</mo><mn>1</mn></mrow></msub><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mo>+</mo><msub><mi>b</mi><mi>N</mi></msub><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo></mtd></mtr></mtable></math></span></span></span><script type="math/tex; mode=display" id="MathJax-Element-382">
\begin{gather}
 b_N(x) = \text{arg}\min\limits_b L(x, a_{N - 1}(x) + b(x)) \\
 a_N(x) = a_{N - 1}(x) + b_N(x) 
\end{gather}
</script></span></li>
</ol><p><span>Градиентный бустинг — алгоритм для построения бустинга, использующий градиенты для уменьшения ошибки.</span><br>
<em><span>Алгоритм градиентого бустинга</span></em><span>:</span></p><ol>
<li><span>Выбираем константный базовый алгоритм (среднее в задаче регрессии, доминирующий класс/выборочные вероятности в задаче классификации).</span></li>
<li><span>Вычисляем вектор антиградиента функции потерь (производную по возвращаемым значениям уже обученной части ансамбля как по независимой перменной) </span><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-383-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 118%; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>s</mi><mo>=</mo><mo>&amp;#x2212;</mo><mi mathvariant=&quot;normal&quot;>&amp;#x2207;</mi><mi>L</mi><mo>=</mo><mrow><mo>(</mo><mtable rowspacing=&quot;4pt&quot; columnspacing=&quot;1em&quot;><mtr><mtd><mo>&amp;#x2212;</mo><msubsup><mi>L</mi><mi>z</mi><mo>&amp;#x2032;</mo></msubsup><mo stretchy=&quot;false&quot;>(</mo><msub><mi>y</mi><mn>1</mn></msub><mo>,</mo><msub><mi>a</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>N</mi><mo>&amp;#x2212;</mo><mn>1</mn></mrow></msub><mo stretchy=&quot;false&quot;>(</mo><msub><mi>x</mi><mn>1</mn></msub><mo stretchy=&quot;false&quot;>)</mo><mo stretchy=&quot;false&quot;>)</mo></mtd></mtr><mtr><mtd><mo>.</mo><mo>.</mo><mo>.</mo></mtd></mtr><mtr><mtd><mo>&amp;#x2212;</mo><msubsup><mi>L</mi><mi>z</mi><mo>&amp;#x2032;</mo></msubsup><mo stretchy=&quot;false&quot;>(</mo><msub><mi>y</mi><mi>l</mi></msub><mo>,</mo><msub><mi>a</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>N</mi><mo>&amp;#x2212;</mo><mn>1</mn></mrow></msub><mo stretchy=&quot;false&quot;>(</mo><msub><mi>x</mi><mi>l</mi></msub><mo stretchy=&quot;false&quot;>)</mo><mo stretchy=&quot;false&quot;>)</mo></mtd></mtr></mtable><mo>)</mo></mrow></math>" role="presentation"><span id="MJXc-Node-5624" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-5625" class="mjx-mrow"><span id="MJXc-Node-5626" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.215em; padding-bottom: 0.267em;">s</span></span><span id="MJXc-Node-5627" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.056em; padding-bottom: 0.32em;">=</span></span><span id="MJXc-Node-5628" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.32em; padding-bottom: 0.426em;">−</span></span><span id="MJXc-Node-5629" class="mjx-mi"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.373em; padding-bottom: 0.373em;">∇</span></span><span id="MJXc-Node-5630" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.267em;">L</span></span><span id="MJXc-Node-5631" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.056em; padding-bottom: 0.32em;">=</span></span><span id="MJXc-Node-5632" class="mjx-mrow MJXc-space3"><span id="MJXc-Node-5633" class="mjx-mo" style="vertical-align: -1.056em;"><span class="mjx-delim-v"><span class="mjx-char MJXc-TeX-size4-R" style="padding-top: 0.956em; padding-bottom: 0.956em;">⎛</span><span class="mjx-char MJXc-TeX-size4-R" style="line-height: 0.332em; margin-bottom: -0.1em; margin-top: 0px;">⎜</span><span class="mjx-char MJXc-TeX-size4-R" style="padding-top: 0.956em; padding-bottom: 0.903em;">⎝</span></span></span><span id="MJXc-Node-5634" class="mjx-mtable" style="vertical-align: -1.725em; padding: 0px 0.167em;"><span class="mjx-table"><span id="MJXc-Node-5635" class="mjx-mtr" style="height: 1.275em;"><span id="MJXc-Node-5636" class="mjx-mtd" style="padding: 0px; width: 7.762em;"><span id="MJXc-Node-5637" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-5638" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.32em; padding-bottom: 0.426em;">−</span></span><span id="MJXc-Node-5639" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-5640" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.267em;">L</span></span></span><span class="mjx-stack" style="vertical-align: -0.157em;"><span class="mjx-sup" style="font-size: 70.7%; padding-bottom: 0.255em; padding-left: 0px; padding-right: 0.071em;"><span id="MJXc-Node-5642" class="mjx-mo" style=""><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.267em; padding-bottom: 0.32em;">′</span></span></span><span class="mjx-sub" style="font-size: 70.7%; padding-right: 0.071em;"><span id="MJXc-Node-5641" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.215em; padding-bottom: 0.267em; padding-right: 0.003em;">z</span></span></span></span></span><span id="MJXc-Node-5643" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.479em; padding-bottom: 0.585em;">(</span></span><span id="MJXc-Node-5644" class="mjx-msubsup"><span class="mjx-base" style="margin-right: -0.006em;"><span id="MJXc-Node-5645" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.215em; padding-bottom: 0.479em; padding-right: 0.006em;">y</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-5646" class="mjx-mn" style=""><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.373em; padding-bottom: 0.32em;">1</span></span></span></span><span id="MJXc-Node-5647" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="margin-top: -0.156em; padding-bottom: 0.532em;">,</span></span><span id="MJXc-Node-5648" class="mjx-msubsup MJXc-space1"><span class="mjx-base"><span id="MJXc-Node-5649" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.215em; padding-bottom: 0.267em;">a</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-5650" class="mjx-texatom" style=""><span id="MJXc-Node-5651" class="mjx-mrow"><span id="MJXc-Node-5652" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.267em; padding-right: 0.085em;">N</span></span><span id="MJXc-Node-5653" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.32em; padding-bottom: 0.426em;">−</span></span><span id="MJXc-Node-5654" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.373em; padding-bottom: 0.32em;">1</span></span></span></span></span></span><span id="MJXc-Node-5655" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.479em; padding-bottom: 0.585em;">(</span></span><span id="MJXc-Node-5656" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-5657" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.215em; padding-bottom: 0.267em;">x</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-5658" class="mjx-mn" style=""><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.373em; padding-bottom: 0.32em;">1</span></span></span></span><span id="MJXc-Node-5659" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.479em; padding-bottom: 0.585em;">)</span></span><span id="MJXc-Node-5660" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.479em; padding-bottom: 0.585em;">)</span></span><span class="mjx-strut"></span></span></span></span><span id="MJXc-Node-5661" class="mjx-mtr" style="height: 1.4em;"><span id="MJXc-Node-5662" class="mjx-mtd" style="padding: 0.2em 0px 0px;"><span id="MJXc-Node-5663" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-5664" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="margin-top: -0.156em; padding-bottom: 0.32em;">.</span></span><span id="MJXc-Node-5665" class="mjx-mo MJXc-space1"><span class="mjx-char MJXc-TeX-main-R" style="margin-top: -0.156em; padding-bottom: 0.32em;">.</span></span><span id="MJXc-Node-5666" class="mjx-mo MJXc-space1"><span class="mjx-char MJXc-TeX-main-R" style="margin-top: -0.156em; padding-bottom: 0.32em;">.</span></span><span class="mjx-strut"></span></span></span></span><span id="MJXc-Node-5667" class="mjx-mtr" style="height: 1.275em;"><span id="MJXc-Node-5668" class="mjx-mtd" style="padding: 0.2em 0px 0px;"><span id="MJXc-Node-5669" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-5670" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.32em; padding-bottom: 0.426em;">−</span></span><span id="MJXc-Node-5671" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-5672" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.267em;">L</span></span></span><span class="mjx-stack" style="vertical-align: -0.157em;"><span class="mjx-sup" style="font-size: 70.7%; padding-bottom: 0.255em; padding-left: 0px; padding-right: 0.071em;"><span id="MJXc-Node-5674" class="mjx-mo" style=""><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.267em; padding-bottom: 0.32em;">′</span></span></span><span class="mjx-sub" style="font-size: 70.7%; padding-right: 0.071em;"><span id="MJXc-Node-5673" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.215em; padding-bottom: 0.267em; padding-right: 0.003em;">z</span></span></span></span></span><span id="MJXc-Node-5675" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.479em; padding-bottom: 0.585em;">(</span></span><span id="MJXc-Node-5676" class="mjx-msubsup"><span class="mjx-base" style="margin-right: -0.006em;"><span id="MJXc-Node-5677" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.215em; padding-bottom: 0.479em; padding-right: 0.006em;">y</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.219em; padding-right: 0.071em;"><span id="MJXc-Node-5678" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.267em;">l</span></span></span></span><span id="MJXc-Node-5679" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="margin-top: -0.156em; padding-bottom: 0.532em;">,</span></span><span id="MJXc-Node-5680" class="mjx-msubsup MJXc-space1"><span class="mjx-base"><span id="MJXc-Node-5681" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.215em; padding-bottom: 0.267em;">a</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-5682" class="mjx-texatom" style=""><span id="MJXc-Node-5683" class="mjx-mrow"><span id="MJXc-Node-5684" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.267em; padding-right: 0.085em;">N</span></span><span id="MJXc-Node-5685" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.32em; padding-bottom: 0.426em;">−</span></span><span id="MJXc-Node-5686" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.373em; padding-bottom: 0.32em;">1</span></span></span></span></span></span><span id="MJXc-Node-5687" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.479em; padding-bottom: 0.585em;">(</span></span><span id="MJXc-Node-5688" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-5689" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.215em; padding-bottom: 0.267em;">x</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.219em; padding-right: 0.071em;"><span id="MJXc-Node-5690" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.267em;">l</span></span></span></span><span id="MJXc-Node-5691" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.479em; padding-bottom: 0.585em;">)</span></span><span id="MJXc-Node-5692" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.479em; padding-bottom: 0.585em;">)</span></span><span class="mjx-strut"></span></span></span></span></span></span><span id="MJXc-Node-5693" class="mjx-mo" style="vertical-align: -1.056em;"><span class="mjx-delim-v"><span class="mjx-char MJXc-TeX-size4-R" style="padding-top: 0.956em; padding-bottom: 0.956em;">⎞</span><span class="mjx-char MJXc-TeX-size4-R" style="line-height: 0.332em; margin-bottom: -0.1em; margin-top: 0px;">⎟</span><span class="mjx-char MJXc-TeX-size4-R" style="padding-top: 0.956em; padding-bottom: 0.903em;">⎠</span></span></span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>s</mi><mo>=</mo><mo>−</mo><mi mathvariant="normal">∇</mi><mi>L</mi><mo>=</mo><mrow><mo>(</mo><mtable rowspacing="4pt" columnspacing="1em"><mtr><mtd><mo>−</mo><msubsup><mi>L</mi><mi>z</mi><mo>′</mo></msubsup><mo stretchy="false">(</mo><msub><mi>y</mi><mn>1</mn></msub><mo>,</mo><msub><mi>a</mi><mrow class="MJX-TeXAtom-ORD"><mi>N</mi><mo>−</mo><mn>1</mn></mrow></msub><mo stretchy="false">(</mo><msub><mi>x</mi><mn>1</mn></msub><mo stretchy="false">)</mo><mo stretchy="false">)</mo></mtd></mtr><mtr><mtd><mo>.</mo><mo>.</mo><mo>.</mo></mtd></mtr><mtr><mtd><mo>−</mo><msubsup><mi>L</mi><mi>z</mi><mo>′</mo></msubsup><mo stretchy="false">(</mo><msub><mi>y</mi><mi>l</mi></msub><mo>,</mo><msub><mi>a</mi><mrow class="MJX-TeXAtom-ORD"><mi>N</mi><mo>−</mo><mn>1</mn></mrow></msub><mo stretchy="false">(</mo><msub><mi>x</mi><mi>l</mi></msub><mo stretchy="false">)</mo><mo stretchy="false">)</mo></mtd></mtr></mtable><mo>)</mo></mrow></math></span></span><script type="math/tex" id="MathJax-Element-383">s = -\nabla L = \begin{pmatrix} -L'_z(y_1, a_{N - 1}(x_1))\\ ...  \\ -L'_z(y_l, a_{N - 1}(x_l)) \end{pmatrix}</script></span>
<ul>
<li><span>Здесь предполагается, что </span><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-384-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 118%; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>L</mi></math>" role="presentation"><span id="MJXc-Node-5694" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-5695" class="mjx-mrow"><span id="MJXc-Node-5696" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.267em;">L</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>L</mi></math></span></span><script type="math/tex" id="MathJax-Element-384">L</script></span><span> зависит от двух векторов — </span><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-385-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 118%; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>y</mi></math>" role="presentation"><span id="MJXc-Node-5697" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-5698" class="mjx-mrow"><span id="MJXc-Node-5699" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.215em; padding-bottom: 0.479em; padding-right: 0.006em;">y</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>y</mi></math></span></span><script type="math/tex" id="MathJax-Element-385">y</script></span><span> и </span><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-386-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 118%; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>z</mi></math>" role="presentation"><span id="MJXc-Node-5700" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-5701" class="mjx-mrow"><span id="MJXc-Node-5702" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.215em; padding-bottom: 0.267em; padding-right: 0.003em;">z</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>z</mi></math></span></span><script type="math/tex" id="MathJax-Element-386">z</script></span><span> где вместо первого подставляется вектор истинных значений таргета, а вместо второго — ответы уже обученной части ансмабля на обучающей выборке.</span></li>
</ul>
</li>
<li><span>Строим алгоритм решающий задачу регрессии, в качестве функции ошибки используя MSE: </span><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-387-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 118%; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>b</mi><mi>N</mi></msub><mo stretchy=&quot;false&quot;>(</mo><mi>x</mi><mo stretchy=&quot;false&quot;>)</mo><mo>=</mo><mtext>arg</mtext><munder><mo form=&quot;prefix&quot;>min</mo><mi>b</mi></munder><mstyle displaystyle=&quot;true&quot; scriptlevel=&quot;0&quot;><mfrac><mn>1</mn><mi>l</mi></mfrac></mstyle><munderover><mo>&amp;#x2211;</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>l</mi></mrow></munderover><mo stretchy=&quot;false&quot;>(</mo><mi>b</mi><mo stretchy=&quot;false&quot;>(</mo><msub><mi>x</mi><mi>i</mi></msub><mo stretchy=&quot;false&quot;>)</mo><mo>&amp;#x2212;</mo><msub><mi>s</mi><mi>i</mi></msub><msup><mo stretchy=&quot;false&quot;>)</mo><mn>2</mn></msup></math>" role="presentation"><span id="MJXc-Node-5703" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-5704" class="mjx-mrow"><span id="MJXc-Node-5705" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-5706" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.267em;">b</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-5707" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.267em; padding-right: 0.085em;">N</span></span></span></span><span id="MJXc-Node-5708" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.479em; padding-bottom: 0.585em;">(</span></span><span id="MJXc-Node-5709" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.215em; padding-bottom: 0.267em;">x</span></span><span id="MJXc-Node-5710" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.479em; padding-bottom: 0.585em;">)</span></span><span id="MJXc-Node-5711" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.056em; padding-bottom: 0.32em;">=</span></span><span id="MJXc-Node-5712" class="mjx-mtext MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.162em; padding-bottom: 0.532em;">arg</span></span><span id="MJXc-Node-5713" class="mjx-munderover MJXc-space1"><span class="mjx-itable"><span class="mjx-row"><span class="mjx-cell"><span class="mjx-op"><span id="MJXc-Node-5714" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.373em; padding-bottom: 0.32em;">min</span></span></span></span></span><span class="mjx-row"><span class="mjx-under" style="font-size: 70.7%; padding-top: 0.236em; padding-bottom: 0.141em; padding-left: 0.964em;"><span id="MJXc-Node-5715" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.267em;">b</span></span></span></span></span></span><span id="MJXc-Node-5716" class="mjx-mstyle MJXc-space1"><span id="MJXc-Node-5717" class="mjx-mrow"><span id="MJXc-Node-5718" class="mjx-mfrac"><span class="mjx-box MJXc-stacked" style="width: 0.7em; padding: 0px 0.12em;"><span class="mjx-numerator" style="width: 0.7em; top: -1.368em;"><span id="MJXc-Node-5719" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.373em; padding-bottom: 0.32em;">1</span></span></span><span class="mjx-denominator" style="width: 0.7em; bottom: -0.731em;"><span id="MJXc-Node-5720" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.267em;">l</span></span></span><span style="border-bottom-width: 1.3px; border-bottom-style: solid; top: -0.283em; width: 0.7em;" class="mjx-line"></span></span><span style="height: 2.098em; vertical-align: -0.731em;" class="mjx-vsize"></span></span></span></span><span id="MJXc-Node-5721" class="mjx-munderover MJXc-space1"><span class="mjx-base"><span id="MJXc-Node-5722" class="mjx-mo"><span class="mjx-char MJXc-TeX-size1-R" style="padding-top: 0.532em; padding-bottom: 0.532em;">∑</span></span></span><span class="mjx-stack" style="vertical-align: -0.31em;"><span class="mjx-sup" style="font-size: 70.7%; padding-bottom: 0.422em; padding-left: 0px; padding-right: 0.071em;"><span id="MJXc-Node-5728" class="mjx-texatom" style=""><span id="MJXc-Node-5729" class="mjx-mrow"><span id="MJXc-Node-5730" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.267em;">l</span></span></span></span></span><span class="mjx-sub" style="font-size: 70.7%; padding-right: 0.071em;"><span id="MJXc-Node-5723" class="mjx-texatom" style=""><span id="MJXc-Node-5724" class="mjx-mrow"><span id="MJXc-Node-5725" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.426em; padding-bottom: 0.267em;">i</span></span><span id="MJXc-Node-5726" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.056em; padding-bottom: 0.32em;">=</span></span><span id="MJXc-Node-5727" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.373em; padding-bottom: 0.32em;">1</span></span></span></span></span></span></span><span id="MJXc-Node-5731" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.479em; padding-bottom: 0.585em;">(</span></span><span id="MJXc-Node-5732" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.267em;">b</span></span><span id="MJXc-Node-5733" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.479em; padding-bottom: 0.585em;">(</span></span><span id="MJXc-Node-5734" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-5735" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.215em; padding-bottom: 0.267em;">x</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-5736" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.426em; padding-bottom: 0.267em;">i</span></span></span></span><span id="MJXc-Node-5737" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.479em; padding-bottom: 0.585em;">)</span></span><span id="MJXc-Node-5738" class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.32em; padding-bottom: 0.426em;">−</span></span><span id="MJXc-Node-5739" class="mjx-msubsup MJXc-space2"><span class="mjx-base"><span id="MJXc-Node-5740" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.215em; padding-bottom: 0.267em;">s</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-5741" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.426em; padding-bottom: 0.267em;">i</span></span></span></span><span id="MJXc-Node-5742" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-5743" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.479em; padding-bottom: 0.585em;">)</span></span></span><span class="mjx-sup" style="font-size: 70.7%; vertical-align: 0.513em; padding-left: 0px; padding-right: 0.071em;"><span id="MJXc-Node-5744" class="mjx-mn" style=""><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.373em; padding-bottom: 0.32em;">2</span></span></span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>b</mi><mi>N</mi></msub><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mo>=</mo><mtext>arg</mtext><munder><mo form="prefix">min</mo><mi>b</mi></munder><mstyle displaystyle="true" scriptlevel="0"><mfrac><mn>1</mn><mi>l</mi></mfrac></mstyle><munderover><mo>∑</mo><mrow class="MJX-TeXAtom-ORD"><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mrow class="MJX-TeXAtom-ORD"><mi>l</mi></mrow></munderover><mo stretchy="false">(</mo><mi>b</mi><mo stretchy="false">(</mo><msub><mi>x</mi><mi>i</mi></msub><mo stretchy="false">)</mo><mo>−</mo><msub><mi>s</mi><mi>i</mi></msub><msup><mo stretchy="false">)</mo><mn>2</mn></msup></math></span></span><script type="math/tex" id="MathJax-Element-387">b_N(x)= \text{arg} \min\limits_b \dfrac{1}{l}\sum_{i = 1}^{l}(b(x_i) - s_i)^2</script></span>
<ul>
<li><span>То есть мы ищем такой алгоритм </span><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-388-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 118%; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>b</mi><mi>N</mi></msub><mo>,</mo></math>" role="presentation"><span id="MJXc-Node-5745" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-5746" class="mjx-mrow"><span id="MJXc-Node-5747" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-5748" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.267em;">b</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-5749" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.267em; padding-right: 0.085em;">N</span></span></span></span><span id="MJXc-Node-5750" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="margin-top: -0.156em; padding-bottom: 0.532em;">,</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>b</mi><mi>N</mi></msub><mo>,</mo></math></span></span><script type="math/tex" id="MathJax-Element-388">b_N,</script></span><span> чтобы прибавив его к построенному ансамблю точка </span><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-389-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 118%; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mo stretchy=&quot;false&quot;>(</mo><mi>y</mi><mo>,</mo><msub><mi>a</mi><mi>N</mi></msub><mo stretchy=&quot;false&quot;>(</mo><mi>x</mi><mo stretchy=&quot;false&quot;>)</mo><mo stretchy=&quot;false&quot;>)</mo></math>" role="presentation"><span id="MJXc-Node-5751" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-5752" class="mjx-mrow"><span id="MJXc-Node-5753" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.479em; padding-bottom: 0.585em;">(</span></span><span id="MJXc-Node-5754" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.215em; padding-bottom: 0.479em; padding-right: 0.006em;">y</span></span><span id="MJXc-Node-5755" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="margin-top: -0.156em; padding-bottom: 0.532em;">,</span></span><span id="MJXc-Node-5756" class="mjx-msubsup MJXc-space1"><span class="mjx-base"><span id="MJXc-Node-5757" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.215em; padding-bottom: 0.267em;">a</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-5758" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.267em; padding-right: 0.085em;">N</span></span></span></span><span id="MJXc-Node-5759" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.479em; padding-bottom: 0.585em;">(</span></span><span id="MJXc-Node-5760" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.215em; padding-bottom: 0.267em;">x</span></span><span id="MJXc-Node-5761" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.479em; padding-bottom: 0.585em;">)</span></span><span id="MJXc-Node-5762" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.479em; padding-bottom: 0.585em;">)</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo stretchy="false">(</mo><mi>y</mi><mo>,</mo><msub><mi>a</mi><mi>N</mi></msub><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-389">(y, a_N(x))</script></span><span> сдинулась в направлении уменьшения функции потерь.</span></li>
</ul>
</li>
<li><span>Добавляем </span><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-390-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 118%; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>b</mi><mi>N</mi></msub><mo stretchy=&quot;false&quot;>(</mo><mi>x</mi><mo stretchy=&quot;false&quot;>)</mo></math>" role="presentation"><span id="MJXc-Node-5763" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-5764" class="mjx-mrow"><span id="MJXc-Node-5765" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-5766" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.267em;">b</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-5767" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.267em; padding-right: 0.085em;">N</span></span></span></span><span id="MJXc-Node-5768" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.479em; padding-bottom: 0.585em;">(</span></span><span id="MJXc-Node-5769" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.215em; padding-bottom: 0.267em;">x</span></span><span id="MJXc-Node-5770" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.479em; padding-bottom: 0.585em;">)</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>b</mi><mi>N</mi></msub><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-390">b_N(x)</script></span><span> в композицию: </span><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-391-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 118%; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>a</mi><mi>n</mi></msub><mo stretchy=&quot;false&quot;>(</mo><mi>x</mi><mo stretchy=&quot;false&quot;>)</mo><mo>=</mo><munderover><mo>&amp;#x2211;</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>m</mi><mo>=</mo><mn>1</mn></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>n</mi></mrow></munderover><msub><mi>b</mi><mi>m</mi></msub><mo stretchy=&quot;false&quot;>(</mo><mi>x</mi><mo stretchy=&quot;false&quot;>)</mo></math>" role="presentation"><span id="MJXc-Node-5771" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-5772" class="mjx-mrow"><span id="MJXc-Node-5773" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-5774" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.215em; padding-bottom: 0.267em;">a</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-5775" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.215em; padding-bottom: 0.267em;">n</span></span></span></span><span id="MJXc-Node-5776" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.479em; padding-bottom: 0.585em;">(</span></span><span id="MJXc-Node-5777" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.215em; padding-bottom: 0.267em;">x</span></span><span id="MJXc-Node-5778" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.479em; padding-bottom: 0.585em;">)</span></span><span id="MJXc-Node-5779" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.056em; padding-bottom: 0.32em;">=</span></span><span id="MJXc-Node-5780" class="mjx-munderover MJXc-space3"><span class="mjx-base"><span id="MJXc-Node-5781" class="mjx-mo"><span class="mjx-char MJXc-TeX-size1-R" style="padding-top: 0.532em; padding-bottom: 0.532em;">∑</span></span></span><span class="mjx-stack" style="vertical-align: -0.31em;"><span class="mjx-sup" style="font-size: 70.7%; padding-bottom: 0.422em; padding-left: 0px; padding-right: 0.071em;"><span id="MJXc-Node-5787" class="mjx-texatom" style=""><span id="MJXc-Node-5788" class="mjx-mrow"><span id="MJXc-Node-5789" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.215em; padding-bottom: 0.267em;">n</span></span></span></span></span><span class="mjx-sub" style="font-size: 70.7%; padding-right: 0.071em;"><span id="MJXc-Node-5782" class="mjx-texatom" style=""><span id="MJXc-Node-5783" class="mjx-mrow"><span id="MJXc-Node-5784" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.215em; padding-bottom: 0.267em;">m</span></span><span id="MJXc-Node-5785" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.056em; padding-bottom: 0.32em;">=</span></span><span id="MJXc-Node-5786" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.373em; padding-bottom: 0.32em;">1</span></span></span></span></span></span></span><span id="MJXc-Node-5790" class="mjx-msubsup MJXc-space1"><span class="mjx-base"><span id="MJXc-Node-5791" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.267em;">b</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-5792" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.215em; padding-bottom: 0.267em;">m</span></span></span></span><span id="MJXc-Node-5793" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.479em; padding-bottom: 0.585em;">(</span></span><span id="MJXc-Node-5794" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.215em; padding-bottom: 0.267em;">x</span></span><span id="MJXc-Node-5795" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.479em; padding-bottom: 0.585em;">)</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>a</mi><mi>n</mi></msub><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mo>=</mo><munderover><mo>∑</mo><mrow class="MJX-TeXAtom-ORD"><mi>m</mi><mo>=</mo><mn>1</mn></mrow><mrow class="MJX-TeXAtom-ORD"><mi>n</mi></mrow></munderover><msub><mi>b</mi><mi>m</mi></msub><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-391">a_n(x) = \sum_{m =1}^{n} b_m(x)</script></span></li>
</ol><h3 id="19-Зачем-нужен-backprop-что-такое-производная-вектора-по-вектору" data-id="19-Зачем-нужен-backprop-что-такое-производная-вектора-по-вектору"><a class="anchor hidden-xs" href="#19-Зачем-нужен-backprop-что-такое-производная-вектора-по-вектору" title="19-Зачем-нужен-backprop-что-такое-производная-вектора-по-вектору"><span class="octicon octicon-link"></span></a><span>19. Зачем нужен backprop, что такое производная вектора по вектору?</span></h3><p><strong><span>Backpropogation</span></strong><span> — алгоритм, использующийся для расчёта градиента нейронной сети по всем её параметрам. Для обучения нейронных сетей нам нужно уметь вычислять этот градиент, т.к. с ним работает большинство используемых методов оптимизации. Однако вычислять частную производную по каждому параметру (или даже по параметрам каждого слоя) и составлять из них многомерное нечто долго, поэтому используется другой подход, учитывающий архитектуру нейронных сетей.</span><br>
<span>Мы постепенно начинаем считать градиент с производной функции ошибки по результату последнего слоя. Так как для каждого слоя мы умеем считать производную результата по входным данным и по параметрам, то мы слой за слоем подсчитываем эти градиенты, начиная с последнего. Если обозначить </span><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-392-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 118%; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>L</mi></math>" role="presentation"><span id="MJXc-Node-5796" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-5797" class="mjx-mrow"><span id="MJXc-Node-5798" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.267em;">L</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>L</mi></math></span></span><script type="math/tex" id="MathJax-Element-392">L</script></span><span> — функцию ошибки, </span><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-393-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 118%; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>X</mi></math>" role="presentation"><span id="MJXc-Node-5799" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-5800" class="mjx-mrow"><span id="MJXc-Node-5801" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.267em; padding-right: 0.024em;">X</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>X</mi></math></span></span><script type="math/tex" id="MathJax-Element-393">X</script></span><span> — входные данные слоя, </span><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-394-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 118%; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>Y</mi></math>" role="presentation"><span id="MJXc-Node-5802" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-5803" class="mjx-mrow"><span id="MJXc-Node-5804" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.267em; padding-right: 0.182em;">Y</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>Y</mi></math></span></span><script type="math/tex" id="MathJax-Element-394">Y</script></span><span> — результат работы слоя, а </span><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-395-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 118%; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>&amp;#x03B8;</mi></math>" role="presentation"><span id="MJXc-Node-5805" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-5806" class="mjx-mrow"><span id="MJXc-Node-5807" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.267em;">θ</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>θ</mi></math></span></span><script type="math/tex" id="MathJax-Element-395">\theta</script></span><span> — параметры слоя, то эти производные вычисляются следующим образом:</span><br>
<span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span class="mjx-chtml MJXc-display" style="text-align: center;"><span id="MathJax-Element-396-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 118%; text-align: center; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><mtable rowspacing=&quot;3pt&quot; columnspacing=&quot;1em&quot; displaystyle=&quot;true&quot;><mtr><mtd><mfrac><mrow><mi mathvariant=&quot;normal&quot;>&amp;#x2202;</mi><mi>L</mi></mrow><mrow><mi mathvariant=&quot;normal&quot;>&amp;#x2202;</mi><mi>X</mi></mrow></mfrac><mo>=</mo><mfrac><mrow><mi mathvariant=&quot;normal&quot;>&amp;#x2202;</mi><mi>L</mi></mrow><mrow><mi mathvariant=&quot;normal&quot;>&amp;#x2202;</mi><mi>Y</mi></mrow></mfrac><mo>&amp;#x22C5;</mo><mfrac><mrow><mi mathvariant=&quot;normal&quot;>&amp;#x2202;</mi><mi>Y</mi></mrow><mrow><mi mathvariant=&quot;normal&quot;>&amp;#x2202;</mi><mi>X</mi></mrow></mfrac></mtd></mtr><mtr><mtd><mfrac><mrow><mi mathvariant=&quot;normal&quot;>&amp;#x2202;</mi><mi>L</mi></mrow><mrow><mi mathvariant=&quot;normal&quot;>&amp;#x2202;</mi><mi>&amp;#x03B8;</mi></mrow></mfrac><mo>=</mo><mfrac><mrow><mi mathvariant=&quot;normal&quot;>&amp;#x2202;</mi><mi>L</mi></mrow><mrow><mi mathvariant=&quot;normal&quot;>&amp;#x2202;</mi><mi>Y</mi></mrow></mfrac><mo>&amp;#x22C5;</mo><mfrac><mrow><mi mathvariant=&quot;normal&quot;>&amp;#x2202;</mi><mi>Y</mi></mrow><mrow><mi mathvariant=&quot;normal&quot;>&amp;#x2202;</mi><mi>&amp;#x03B8;</mi></mrow></mfrac></mtd></mtr></mtable></math>" role="presentation"><span id="MJXc-Node-5808" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-5809" class="mjx-mrow"><span id="MJXc-Node-5810" class="mjx-mtable" style="vertical-align: -2.079em; padding: 0px 0.167em;"><span class="mjx-table"><span id="MJXc-Node-5811" class="mjx-mtr" style="height: 2.329em;"><span id="MJXc-Node-5812" class="mjx-mtd" style="padding: 0px; width: 7.541em;"><span id="MJXc-Node-5813" class="mjx-mrow"><span id="MJXc-Node-5814" class="mjx-mfrac"><span class="mjx-box MJXc-stacked" style="width: 1.618em; padding: 0px 0.12em;"><span class="mjx-numerator" style="width: 1.618em; top: -1.417em;"><span id="MJXc-Node-5815" class="mjx-mrow"><span id="MJXc-Node-5816" class="mjx-mi"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.426em; padding-bottom: 0.373em; padding-right: 0.035em;">∂</span></span><span id="MJXc-Node-5817" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.267em;">L</span></span></span></span><span class="mjx-denominator" style="width: 1.618em; bottom: -0.763em;"><span id="MJXc-Node-5818" class="mjx-mrow"><span id="MJXc-Node-5819" class="mjx-mi"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.426em; padding-bottom: 0.373em; padding-right: 0.035em;">∂</span></span><span id="MJXc-Node-5820" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.267em; padding-right: 0.024em;">X</span></span></span></span><span style="border-bottom-width: 1.3px; border-bottom-style: solid; top: -0.283em; width: 1.618em;" class="mjx-line"></span></span><span style="height: 2.179em; vertical-align: -0.763em;" class="mjx-vsize"></span></span><span id="MJXc-Node-5821" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.056em; padding-bottom: 0.32em;">=</span></span><span id="MJXc-Node-5822" class="mjx-mfrac MJXc-space3"><span class="mjx-box MJXc-stacked" style="width: 1.529em; padding: 0px 0.12em;"><span class="mjx-numerator" style="width: 1.529em; top: -1.417em;"><span id="MJXc-Node-5823" class="mjx-mrow"><span id="MJXc-Node-5824" class="mjx-mi"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.426em; padding-bottom: 0.373em; padding-right: 0.035em;">∂</span></span><span id="MJXc-Node-5825" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.267em;">L</span></span></span></span><span class="mjx-denominator" style="width: 1.529em; bottom: -0.763em;"><span id="MJXc-Node-5826" class="mjx-mrow"><span id="MJXc-Node-5827" class="mjx-mi"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.426em; padding-bottom: 0.373em; padding-right: 0.035em;">∂</span></span><span id="MJXc-Node-5828" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.267em; padding-right: 0.182em;">Y</span></span></span></span><span style="border-bottom-width: 1.3px; border-bottom-style: solid; top: -0.283em; width: 1.529em;" class="mjx-line"></span></span><span style="height: 2.179em; vertical-align: -0.763em;" class="mjx-vsize"></span></span><span id="MJXc-Node-5829" class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.003em; padding-bottom: 0.32em;">⋅</span></span><span id="MJXc-Node-5830" class="mjx-mfrac MJXc-space2"><span class="mjx-box MJXc-stacked" style="width: 1.618em; padding: 0px 0.12em;"><span class="mjx-numerator" style="width: 1.618em; top: -1.417em;"><span id="MJXc-Node-5831" class="mjx-mrow"><span id="MJXc-Node-5832" class="mjx-mi"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.426em; padding-bottom: 0.373em; padding-right: 0.035em;">∂</span></span><span id="MJXc-Node-5833" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.267em; padding-right: 0.182em;">Y</span></span></span></span><span class="mjx-denominator" style="width: 1.618em; bottom: -0.763em;"><span id="MJXc-Node-5834" class="mjx-mrow"><span id="MJXc-Node-5835" class="mjx-mi"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.426em; padding-bottom: 0.373em; padding-right: 0.035em;">∂</span></span><span id="MJXc-Node-5836" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.267em; padding-right: 0.024em;">X</span></span></span></span><span style="border-bottom-width: 1.3px; border-bottom-style: solid; top: -0.283em; width: 1.618em;" class="mjx-line"></span></span><span style="height: 2.179em; vertical-align: -0.763em;" class="mjx-vsize"></span></span><span class="mjx-strut"></span></span></span></span><span id="MJXc-Node-5837" class="mjx-mtr" style="height: 2.329em;"><span id="MJXc-Node-5838" class="mjx-mtd" style="padding: 0.15em 0px 0px;"><span id="MJXc-Node-5839" class="mjx-mrow"><span id="MJXc-Node-5840" class="mjx-mfrac"><span class="mjx-box MJXc-stacked" style="width: 1.447em; padding: 0px 0.12em;"><span class="mjx-numerator" style="width: 1.447em; top: -1.417em;"><span id="MJXc-Node-5841" class="mjx-mrow"><span id="MJXc-Node-5842" class="mjx-mi"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.426em; padding-bottom: 0.373em; padding-right: 0.035em;">∂</span></span><span id="MJXc-Node-5843" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.267em;">L</span></span></span></span><span class="mjx-denominator" style="width: 1.447em; bottom: -0.763em;"><span id="MJXc-Node-5844" class="mjx-mrow"><span id="MJXc-Node-5845" class="mjx-mi"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.426em; padding-bottom: 0.373em; padding-right: 0.035em;">∂</span></span><span id="MJXc-Node-5846" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.267em;">θ</span></span></span></span><span style="border-bottom-width: 1.3px; border-bottom-style: solid; top: -0.283em; width: 1.447em;" class="mjx-line"></span></span><span style="height: 2.179em; vertical-align: -0.763em;" class="mjx-vsize"></span></span><span id="MJXc-Node-5847" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.056em; padding-bottom: 0.32em;">=</span></span><span id="MJXc-Node-5848" class="mjx-mfrac MJXc-space3"><span class="mjx-box MJXc-stacked" style="width: 1.529em; padding: 0px 0.12em;"><span class="mjx-numerator" style="width: 1.529em; top: -1.417em;"><span id="MJXc-Node-5849" class="mjx-mrow"><span id="MJXc-Node-5850" class="mjx-mi"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.426em; padding-bottom: 0.373em; padding-right: 0.035em;">∂</span></span><span id="MJXc-Node-5851" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.267em;">L</span></span></span></span><span class="mjx-denominator" style="width: 1.529em; bottom: -0.763em;"><span id="MJXc-Node-5852" class="mjx-mrow"><span id="MJXc-Node-5853" class="mjx-mi"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.426em; padding-bottom: 0.373em; padding-right: 0.035em;">∂</span></span><span id="MJXc-Node-5854" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.267em; padding-right: 0.182em;">Y</span></span></span></span><span style="border-bottom-width: 1.3px; border-bottom-style: solid; top: -0.283em; width: 1.529em;" class="mjx-line"></span></span><span style="height: 2.179em; vertical-align: -0.763em;" class="mjx-vsize"></span></span><span id="MJXc-Node-5855" class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.003em; padding-bottom: 0.32em;">⋅</span></span><span id="MJXc-Node-5856" class="mjx-mfrac MJXc-space2"><span class="mjx-box MJXc-stacked" style="width: 1.529em; padding: 0px 0.12em;"><span class="mjx-numerator" style="width: 1.529em; top: -1.417em;"><span id="MJXc-Node-5857" class="mjx-mrow"><span id="MJXc-Node-5858" class="mjx-mi"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.426em; padding-bottom: 0.373em; padding-right: 0.035em;">∂</span></span><span id="MJXc-Node-5859" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.267em; padding-right: 0.182em;">Y</span></span></span></span><span class="mjx-denominator" style="width: 1.529em; bottom: -0.763em;"><span id="MJXc-Node-5860" class="mjx-mrow"><span id="MJXc-Node-5861" class="mjx-mi"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.426em; padding-bottom: 0.373em; padding-right: 0.035em;">∂</span></span><span id="MJXc-Node-5862" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.267em;">θ</span></span></span></span><span style="border-bottom-width: 1.3px; border-bottom-style: solid; top: -0.283em; width: 1.529em;" class="mjx-line"></span></span><span style="height: 2.179em; vertical-align: -0.763em;" class="mjx-vsize"></span></span><span class="mjx-strut"></span></span></span></span></span></span></span></span><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mtable rowspacing="3pt" columnspacing="1em" displaystyle="true"><mtr><mtd><mfrac><mrow><mi mathvariant="normal">∂</mi><mi>L</mi></mrow><mrow><mi mathvariant="normal">∂</mi><mi>X</mi></mrow></mfrac><mo>=</mo><mfrac><mrow><mi mathvariant="normal">∂</mi><mi>L</mi></mrow><mrow><mi mathvariant="normal">∂</mi><mi>Y</mi></mrow></mfrac><mo>⋅</mo><mfrac><mrow><mi mathvariant="normal">∂</mi><mi>Y</mi></mrow><mrow><mi mathvariant="normal">∂</mi><mi>X</mi></mrow></mfrac></mtd></mtr><mtr><mtd><mfrac><mrow><mi mathvariant="normal">∂</mi><mi>L</mi></mrow><mrow><mi mathvariant="normal">∂</mi><mi>θ</mi></mrow></mfrac><mo>=</mo><mfrac><mrow><mi mathvariant="normal">∂</mi><mi>L</mi></mrow><mrow><mi mathvariant="normal">∂</mi><mi>Y</mi></mrow></mfrac><mo>⋅</mo><mfrac><mrow><mi mathvariant="normal">∂</mi><mi>Y</mi></mrow><mrow><mi mathvariant="normal">∂</mi><mi>θ</mi></mrow></mfrac></mtd></mtr></mtable></math></span></span></span><script type="math/tex; mode=display" id="MathJax-Element-396">
\begin{gather}
    \frac{\partial L}{\partial X} = \frac{\partial L}{\partial Y} \cdot \frac{\partial Y}{\partial X}\\
    \frac{\partial L}{\partial \theta} = \frac{\partial L}{\partial Y} \cdot \frac{\partial Y}{\partial \theta}
\end{gather}
</script></span><br>
<span>Здесь </span><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-397-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 118%; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mfrac><mrow><mi mathvariant=&quot;normal&quot;>&amp;#x2202;</mi><mi>L</mi></mrow><mrow><mi mathvariant=&quot;normal&quot;>&amp;#x2202;</mi><mi>Y</mi></mrow></mfrac></math>" role="presentation"><span id="MJXc-Node-5863" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-5864" class="mjx-mrow"><span id="MJXc-Node-5865" class="mjx-mfrac"><span class="mjx-box MJXc-stacked" style="width: 1.081em; padding: 0px 0.12em;"><span class="mjx-numerator" style="font-size: 70.7%; width: 1.529em; top: -1.37em;"><span id="MJXc-Node-5866" class="mjx-mrow" style=""><span id="MJXc-Node-5867" class="mjx-mi"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.426em; padding-bottom: 0.373em; padding-right: 0.035em;">∂</span></span><span id="MJXc-Node-5868" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.267em;">L</span></span></span></span><span class="mjx-denominator" style="font-size: 70.7%; width: 1.529em; bottom: -0.663em;"><span id="MJXc-Node-5869" class="mjx-mrow" style=""><span id="MJXc-Node-5870" class="mjx-mi"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.426em; padding-bottom: 0.373em; padding-right: 0.035em;">∂</span></span><span id="MJXc-Node-5871" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.267em; padding-right: 0.182em;">Y</span></span></span></span><span style="border-bottom-width: 1.3px; border-bottom-style: solid; top: -0.283em; width: 1.081em;" class="mjx-line"></span></span><span style="height: 1.438em; vertical-align: -0.469em;" class="mjx-vsize"></span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mfrac><mrow><mi mathvariant="normal">∂</mi><mi>L</mi></mrow><mrow><mi mathvariant="normal">∂</mi><mi>Y</mi></mrow></mfrac></math></span></span><script type="math/tex" id="MathJax-Element-397">\frac{\partial L}{\partial Y}</script></span><span> — градиент посчитанный на предыдущем шаге (то есть в структуре сети — на следующем слое), </span><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-398-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 118%; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mfrac><mrow><mi mathvariant=&quot;normal&quot;>&amp;#x2202;</mi><mi>L</mi></mrow><mrow><mi mathvariant=&quot;normal&quot;>&amp;#x2202;</mi><mi>X</mi></mrow></mfrac></math>" role="presentation"><span id="MJXc-Node-5872" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-5873" class="mjx-mrow"><span id="MJXc-Node-5874" class="mjx-mfrac"><span class="mjx-box MJXc-stacked" style="width: 1.144em; padding: 0px 0.12em;"><span class="mjx-numerator" style="font-size: 70.7%; width: 1.618em; top: -1.37em;"><span id="MJXc-Node-5875" class="mjx-mrow" style=""><span id="MJXc-Node-5876" class="mjx-mi"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.426em; padding-bottom: 0.373em; padding-right: 0.035em;">∂</span></span><span id="MJXc-Node-5877" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.267em;">L</span></span></span></span><span class="mjx-denominator" style="font-size: 70.7%; width: 1.618em; bottom: -0.663em;"><span id="MJXc-Node-5878" class="mjx-mrow" style=""><span id="MJXc-Node-5879" class="mjx-mi"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.426em; padding-bottom: 0.373em; padding-right: 0.035em;">∂</span></span><span id="MJXc-Node-5880" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.267em; padding-right: 0.024em;">X</span></span></span></span><span style="border-bottom-width: 1.3px; border-bottom-style: solid; top: -0.283em; width: 1.144em;" class="mjx-line"></span></span><span style="height: 1.438em; vertical-align: -0.469em;" class="mjx-vsize"></span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mfrac><mrow><mi mathvariant="normal">∂</mi><mi>L</mi></mrow><mrow><mi mathvariant="normal">∂</mi><mi>X</mi></mrow></mfrac></math></span></span><script type="math/tex" id="MathJax-Element-398">\frac{\partial L}{\partial X}</script></span><span> — производная по </span><em><span>результату предыдущего (в архитектуре сети) слоя</span></em><span>, которая передаётся дальше в качестве </span><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-399-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 118%; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mfrac><mrow><mi mathvariant=&quot;normal&quot;>&amp;#x2202;</mi><mi>L</mi></mrow><mrow><mi mathvariant=&quot;normal&quot;>&amp;#x2202;</mi><mi>Y</mi></mrow></mfrac></math>" role="presentation"><span id="MJXc-Node-5881" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-5882" class="mjx-mrow"><span id="MJXc-Node-5883" class="mjx-mfrac"><span class="mjx-box MJXc-stacked" style="width: 1.081em; padding: 0px 0.12em;"><span class="mjx-numerator" style="font-size: 70.7%; width: 1.529em; top: -1.37em;"><span id="MJXc-Node-5884" class="mjx-mrow" style=""><span id="MJXc-Node-5885" class="mjx-mi"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.426em; padding-bottom: 0.373em; padding-right: 0.035em;">∂</span></span><span id="MJXc-Node-5886" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.267em;">L</span></span></span></span><span class="mjx-denominator" style="font-size: 70.7%; width: 1.529em; bottom: -0.663em;"><span id="MJXc-Node-5887" class="mjx-mrow" style=""><span id="MJXc-Node-5888" class="mjx-mi"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.426em; padding-bottom: 0.373em; padding-right: 0.035em;">∂</span></span><span id="MJXc-Node-5889" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.267em; padding-right: 0.182em;">Y</span></span></span></span><span style="border-bottom-width: 1.3px; border-bottom-style: solid; top: -0.283em; width: 1.081em;" class="mjx-line"></span></span><span style="height: 1.438em; vertical-align: -0.469em;" class="mjx-vsize"></span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mfrac><mrow><mi mathvariant="normal">∂</mi><mi>L</mi></mrow><mrow><mi mathvariant="normal">∂</mi><mi>Y</mi></mrow></mfrac></math></span></span><script type="math/tex" id="MathJax-Element-399">\frac{\partial L}{\partial Y}</script></span><span> предыдущему слою и </span><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-400-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 118%; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mfrac><mrow><mi mathvariant=&quot;normal&quot;>&amp;#x2202;</mi><mi>L</mi></mrow><mrow><mi mathvariant=&quot;normal&quot;>&amp;#x2202;</mi><mi>&amp;#x03B8;</mi></mrow></mfrac></math>" role="presentation"><span id="MJXc-Node-5890" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-5891" class="mjx-mrow"><span id="MJXc-Node-5892" class="mjx-mfrac"><span class="mjx-box MJXc-stacked" style="width: 1.023em; padding: 0px 0.12em;"><span class="mjx-numerator" style="font-size: 70.7%; width: 1.447em; top: -1.37em;"><span id="MJXc-Node-5893" class="mjx-mrow" style=""><span id="MJXc-Node-5894" class="mjx-mi"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.426em; padding-bottom: 0.373em; padding-right: 0.035em;">∂</span></span><span id="MJXc-Node-5895" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.267em;">L</span></span></span></span><span class="mjx-denominator" style="font-size: 70.7%; width: 1.447em; bottom: -0.663em;"><span id="MJXc-Node-5896" class="mjx-mrow" style=""><span id="MJXc-Node-5897" class="mjx-mi"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.426em; padding-bottom: 0.373em; padding-right: 0.035em;">∂</span></span><span id="MJXc-Node-5898" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.267em;">θ</span></span></span></span><span style="border-bottom-width: 1.3px; border-bottom-style: solid; top: -0.283em; width: 1.023em;" class="mjx-line"></span></span><span style="height: 1.438em; vertical-align: -0.469em;" class="mjx-vsize"></span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mfrac><mrow><mi mathvariant="normal">∂</mi><mi>L</mi></mrow><mrow><mi mathvariant="normal">∂</mi><mi>θ</mi></mrow></mfrac></math></span></span><script type="math/tex" id="MathJax-Element-400">\frac{\partial L}{\partial \theta}</script></span><span> — производная по параметром, которую мы где-то храним и которую будем использовать для обновления параметров этого слоя.</span><br>
<span>Заметим, что значения градиентов нужно вычислять в конкретных точках, то есть нам нужно хранить в слоях значения входных данных каждого слоя.</span><br>
<strong><span>Производная вектора </span><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-401-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 118%; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>f</mi><mo stretchy=&quot;false&quot;>(</mo><mi>x</mi><mo stretchy=&quot;false&quot;>)</mo></math>" role="presentation"><span id="MJXc-Node-5899" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-5900" class="mjx-mrow"><span id="MJXc-Node-5901" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.479em; padding-right: 0.06em;">f</span></span><span id="MJXc-Node-5902" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.479em; padding-bottom: 0.585em;">(</span></span><span id="MJXc-Node-5903" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.215em; padding-bottom: 0.267em;">x</span></span><span id="MJXc-Node-5904" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.479em; padding-bottom: 0.585em;">)</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>f</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-401">f(x)</script></span><span> по вектору </span><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-402-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 118%; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>x</mi></math>" role="presentation"><span id="MJXc-Node-5905" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-5906" class="mjx-mrow"><span id="MJXc-Node-5907" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.215em; padding-bottom: 0.267em;">x</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>x</mi></math></span></span><script type="math/tex" id="MathJax-Element-402">x</script></span></strong><span> — это матрица, где на месте </span><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-403-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 118%; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>i</mi><mo>,</mo><mi>j</mi></math>" role="presentation"><span id="MJXc-Node-5908" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-5909" class="mjx-mrow"><span id="MJXc-Node-5910" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.426em; padding-bottom: 0.267em;">i</span></span><span id="MJXc-Node-5911" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="margin-top: -0.156em; padding-bottom: 0.532em;">,</span></span><span id="MJXc-Node-5912" class="mjx-mi MJXc-space1"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.426em; padding-bottom: 0.479em;">j</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>i</mi><mo>,</mo><mi>j</mi></math></span></span><script type="math/tex" id="MathJax-Element-403">i, j</script></span><span> стоит производная </span><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-404-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 118%; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mfrac><mrow><mi mathvariant=&quot;normal&quot;>&amp;#x2202;</mi><msub><mi>f</mi><mi>j</mi></msub></mrow><mrow><mi mathvariant=&quot;normal&quot;>&amp;#x2202;</mi><msub><mi>x</mi><mi>i</mi></msub></mrow></mfrac><mo>.</mo></math>" role="presentation"><span id="MJXc-Node-5913" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-5914" class="mjx-mrow"><span id="MJXc-Node-5915" class="mjx-mfrac"><span class="mjx-box MJXc-stacked" style="width: 1.144em; padding: 0px 0.12em;"><span class="mjx-numerator" style="font-size: 70.7%; width: 1.617em; top: -1.635em;"><span id="MJXc-Node-5916" class="mjx-mrow" style=""><span id="MJXc-Node-5917" class="mjx-mi"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.426em; padding-bottom: 0.373em; padding-right: 0.035em;">∂</span></span><span id="MJXc-Node-5918" class="mjx-msubsup"><span class="mjx-base" style="margin-right: -0.06em;"><span id="MJXc-Node-5919" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.479em; padding-right: 0.06em;">f</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-5920" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.426em; padding-bottom: 0.479em;">j</span></span></span></span></span></span><span class="mjx-denominator" style="font-size: 70.7%; width: 1.617em; bottom: -0.792em;"><span id="MJXc-Node-5921" class="mjx-mrow" style=""><span id="MJXc-Node-5922" class="mjx-mi"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.426em; padding-bottom: 0.373em; padding-right: 0.035em;">∂</span></span><span id="MJXc-Node-5923" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-5924" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.215em; padding-bottom: 0.267em;">x</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-5925" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.426em; padding-bottom: 0.267em;">i</span></span></span></span></span></span><span style="border-bottom-width: 1.3px; border-bottom-style: solid; top: -0.283em; width: 1.144em;" class="mjx-line"></span></span><span style="height: 1.716em; vertical-align: -0.56em;" class="mjx-vsize"></span></span><span id="MJXc-Node-5926" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="margin-top: -0.156em; padding-bottom: 0.32em;">.</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mfrac><mrow><mi mathvariant="normal">∂</mi><msub><mi>f</mi><mi>j</mi></msub></mrow><mrow><mi mathvariant="normal">∂</mi><msub><mi>x</mi><mi>i</mi></msub></mrow></mfrac><mo>.</mo></math></span></span><script type="math/tex" id="MathJax-Element-404">\frac{\partial f_j}{\partial x_i}.</script></span><span> В качестве примера можно рассмотреть вектор-функцию </span><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-405-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 118%; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>A</mi><mi>x</mi><mo>,</mo></math>" role="presentation"><span id="MJXc-Node-5927" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-5928" class="mjx-mrow"><span id="MJXc-Node-5929" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.267em;">A</span></span><span id="MJXc-Node-5930" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.215em; padding-bottom: 0.267em;">x</span></span><span id="MJXc-Node-5931" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="margin-top: -0.156em; padding-bottom: 0.532em;">,</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>A</mi><mi>x</mi><mo>,</mo></math></span></span><script type="math/tex" id="MathJax-Element-405">Ax,</script></span><span> которая является линейным преобразованием вектора.</span><br>
<span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span class="mjx-chtml MJXc-display" style="text-align: center;"><span id="MathJax-Element-406-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 118%; text-align: center; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><mfrac><mrow><mi mathvariant=&quot;normal&quot;>&amp;#x2202;</mi><mo stretchy=&quot;false&quot;>(</mo><mi>A</mi><mi>x</mi><mo stretchy=&quot;false&quot;>)</mo></mrow><mrow><mi mathvariant=&quot;normal&quot;>&amp;#x2202;</mi><mi>x</mi></mrow></mfrac><mo>=</mo><mi>A</mi></math>" role="presentation"><span id="MJXc-Node-5932" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-5933" class="mjx-mrow"><span id="MJXc-Node-5934" class="mjx-mfrac"><span class="mjx-box MJXc-stacked" style="width: 2.866em; padding: 0px 0.12em;"><span class="mjx-numerator" style="width: 2.866em; top: -1.526em;"><span id="MJXc-Node-5935" class="mjx-mrow"><span id="MJXc-Node-5936" class="mjx-mi"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.426em; padding-bottom: 0.373em; padding-right: 0.035em;">∂</span></span><span id="MJXc-Node-5937" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.479em; padding-bottom: 0.585em;">(</span></span><span id="MJXc-Node-5938" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.267em;">A</span></span><span id="MJXc-Node-5939" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.215em; padding-bottom: 0.267em;">x</span></span><span id="MJXc-Node-5940" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.479em; padding-bottom: 0.585em;">)</span></span></span></span><span class="mjx-denominator" style="width: 2.866em; bottom: -0.763em;"><span id="MJXc-Node-5941" class="mjx-mrow"><span id="MJXc-Node-5942" class="mjx-mi"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.426em; padding-bottom: 0.373em; padding-right: 0.035em;">∂</span></span><span id="MJXc-Node-5943" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.215em; padding-bottom: 0.267em;">x</span></span></span></span><span style="border-bottom-width: 1.3px; border-bottom-style: solid; top: -0.283em; width: 2.866em;" class="mjx-line"></span></span><span style="height: 2.288em; vertical-align: -0.763em;" class="mjx-vsize"></span></span><span id="MJXc-Node-5944" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.056em; padding-bottom: 0.32em;">=</span></span><span id="MJXc-Node-5945" class="mjx-mi MJXc-space3"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.267em;">A</span></span></span></span><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mfrac><mrow><mi mathvariant="normal">∂</mi><mo stretchy="false">(</mo><mi>A</mi><mi>x</mi><mo stretchy="false">)</mo></mrow><mrow><mi mathvariant="normal">∂</mi><mi>x</mi></mrow></mfrac><mo>=</mo><mi>A</mi></math></span></span></span><script type="math/tex; mode=display" id="MathJax-Element-406">
    \frac{\partial (Ax)}{\partial x} = A
</script></span></p><h3 id="20-Опишите-принцип-работы-свёрточного-слоя-CNN" data-id="20-Опишите-принцип-работы-свёрточного-слоя-CNN"><a class="anchor hidden-xs" href="#20-Опишите-принцип-работы-свёрточного-слоя-CNN" title="20-Опишите-принцип-работы-свёрточного-слоя-CNN"><span class="octicon octicon-link"></span></a><span>20. Опишите принцип работы свёрточного слоя (CNN).</span></h3><p><span>На вход приходит трехмерный тензор, характеризующий изображение (длина х ширина х кол-во каналов).</span></p><p><span>К этому изображению применяется операция свертки. Выбирается определённый фильтр, который также называется ядром свёртки. По сути это линейная функция, которая применяется к некоторому “кубику внутри тензора” размера (</span><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-407-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 118%; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>k</mi><mo>&amp;#x00D7;</mo><mi>k</mi><mo>&amp;#x00D7;</mo></math>" role="presentation"><span id="MJXc-Node-5946" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-5947" class="mjx-mrow"><span id="MJXc-Node-5948" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.267em;">k</span></span><span id="MJXc-Node-5949" class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.215em; padding-bottom: 0.32em;">×</span></span><span id="MJXc-Node-5950" class="mjx-mi MJXc-space2"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.267em;">k</span></span><span id="MJXc-Node-5951" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.215em; padding-bottom: 0.32em;">×</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>k</mi><mo>×</mo><mi>k</mi><mo>×</mo></math></span></span><script type="math/tex" id="MathJax-Element-407">k \times k \times</script></span><span> кол-во каналов). Требование к нему такое чтобы глубина совпадала с глубиной входного тензора. Пространственные размеры меньше (у исходного тензора был размер 32х32, а у фильтра 5х5).</span><br>
<span>Соответственно, значение фильтра на каждом “подтензоре” размера совпадающего с размером фильтра — одно число. Составим из этих чисел новую матрицу — это называется картой активацией и является выходом свёрточного слоя.</span></p><ul>
<li><span>Можно вместо одного фильтра применять сразу несколько, которые будут обучаться независимо друг от друга. Тогда выходом свёрточного слоя будет трёхмерный тензор, глубина которого равна количеству фильтров.</span></li>
</ul><p><img src="https://i.imgur.com/dxCkd2j.png" alt=""></p><h3 id="21-Опишите-принцип-работы-базового-рекуррентного-слоя-RNN" data-id="21-Опишите-принцип-работы-базового-рекуррентного-слоя-RNN"><a class="anchor hidden-xs" href="#21-Опишите-принцип-работы-базового-рекуррентного-слоя-RNN" title="21-Опишите-принцип-работы-базового-рекуррентного-слоя-RNN"><span class="octicon octicon-link"></span></a><span>21. Опишите принцип работы базового рекуррентного слоя (RNN).</span></h3><ul>
<li><span>Рекуррентные слои обычно работают с последовательностями данных. Любой рекуррентный слой хранит в себе состояние (которое называют скрытым), которое является некоторым </span><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-408-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 118%; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>d</mi></math>" role="presentation"><span id="MJXc-Node-5952" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-5953" class="mjx-mrow"><span id="MJXc-Node-5954" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.267em; padding-right: 0.003em;">d</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>d</mi></math></span></span><script type="math/tex" id="MathJax-Element-408">d</script></span><span>-мерным вектором и которое используется для хранения информации обо всей увиденной части последовательности.</span></li>
<li><span>Также рекуррентный слой на вход принимает обычный, хорошо знакомый читателю, объект-вектор из пространства признаков. Его размерность, вообще говоря, никак не связана с размерностью скрытого состояния.</span></li>
<li><span>Базовый рекуррентный слой работает следующим образом:</span>
<ul>
<li><span>Сначала он соединяет между собой скрытое состояние и входной вектор с помощью, например конкатенции (просто приписывания одного вектора к другому).</span></li>
<li><span>Затем к этому объединенному вектору применяется линейное преобразование (параметры этого преобразования являются параметрами слоя), которое переводит этот вектор в пространство размерности совпадающей со скрытым состоянием.</span></li>
<li><span>После, к вектору применяется нелинейная функция активации (в базовом варианте — сигмоида, но, кажется, в общем случае чаще используют </span><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-409-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 118%; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>tanh</mi><mo>.</mo></math>" role="presentation"><span id="MJXc-Node-5955" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-5956" class="mjx-mrow"><span id="MJXc-Node-5957" class="mjx-mi"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.426em; padding-bottom: 0.373em;">tanh</span></span><span id="MJXc-Node-5958" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="margin-top: -0.156em; padding-bottom: 0.32em;">.</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>tanh</mi><mo>.</mo></math></span></span><script type="math/tex" id="MathJax-Element-409">\tanh.</script></span><span>). Она обязательно должна быть ограниченной, иначе рекуррентный слой каждый раз будет смещать данные в сторону положительных, что мешает его же обучению.</span></li>
<li><span>Итоговый вектор записывается как новое скрытое состояние слоя и возвращется как результат работы слоя. После него обычно добавляют ещё некоторые преобразования, чтобы решить поставленную задачу.</span></li>
</ul>
</li>
<li><span>Чтобы обучить слой на какой-то последовательности:</span>
<ul>
<li><span>Инициализируем скрытое состояние нулями.</span></li>
<li><span>Для объекта </span><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-410-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 118%; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>i</mi></math>" role="presentation"><span id="MJXc-Node-5959" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-5960" class="mjx-mrow"><span id="MJXc-Node-5961" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.426em; padding-bottom: 0.267em;">i</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>i</mi></math></span></span><script type="math/tex" id="MathJax-Element-410">i</script></span><span> последовательности как входа слоя используем объект </span><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-411-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 118%; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>i</mi><mo>+</mo><mn>1</mn></math>" role="presentation"><span id="MJXc-Node-5962" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-5963" class="mjx-mrow"><span id="MJXc-Node-5964" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.426em; padding-bottom: 0.267em;">i</span></span><span id="MJXc-Node-5965" class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.32em; padding-bottom: 0.426em;">+</span></span><span id="MJXc-Node-5966" class="mjx-mn MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.373em; padding-bottom: 0.32em;">1</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>i</mi><mo>+</mo><mn>1</mn></math></span></span><script type="math/tex" id="MathJax-Element-411">i+1</script></span><span> как целевую переменную.</span></li>
</ul>
</li>
<li><span>Такая архитектура отлично подходит для работы с последовательными данными (например, текстами или временными рядами). После обучения можно использовать RNN слой для генерации новой последовательности, задав какое-то скрытое состояние.</span><br>
<img src="https://i.imgur.com/ErX6oTw.png" alt=""></li>
</ul><h3 id="22-Что-такое-dropout" data-id="22-Что-такое-dropout"><a class="anchor hidden-xs" href="#22-Что-такое-dropout" title="22-Что-такое-dropout"><span class="octicon octicon-link"></span></a><span>22. Что такое dropout?</span></h3><p><span>Метод регуляризации искусственных нейронных сетей, предназначен для уменьшения переобучения сети за счет обучения не на всей тестовой выборке, а только на её подмножестве на каждой итерации. Повышает качество предсказаний на тестовых данных, а также увеличивает скорость обучения.</span></p><ul>
<li><span>Если называть одну компоненту результата преобразования нейроном, то Dropout помогает предотвращать переобучение под конкретные нейроны во время обучения.</span></li>
<li><span>Пусть матрица </span><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-412-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 118%; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>X</mi></math>" role="presentation"><span id="MJXc-Node-5967" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-5968" class="mjx-mrow"><span id="MJXc-Node-5969" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.267em; padding-right: 0.024em;">X</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>X</mi></math></span></span><script type="math/tex" id="MathJax-Element-412">X</script></span><span> — входные данные этого слоя. Во время обучения для каждого элемента матрицы занулим его с заранее выбранной вероятностью </span><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-413-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 118%; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>p</mi><mo>.</mo></math>" role="presentation"><span id="MJXc-Node-5970" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-5971" class="mjx-mrow"><span id="MJXc-Node-5972" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.215em; padding-bottom: 0.479em;">p</span></span><span id="MJXc-Node-5973" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="margin-top: -0.156em; padding-bottom: 0.32em;">.</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>p</mi><mo>.</mo></math></span></span><script type="math/tex" id="MathJax-Element-413">p.</script></span><span> Соответственно, с вероятностью </span><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-414-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 118%; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mn>1</mn><mo>&amp;#x2212;</mo><mi>p</mi></math>" role="presentation"><span id="MJXc-Node-5974" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-5975" class="mjx-mrow"><span id="MJXc-Node-5976" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.373em; padding-bottom: 0.32em;">1</span></span><span id="MJXc-Node-5977" class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.32em; padding-bottom: 0.426em;">−</span></span><span id="MJXc-Node-5978" class="mjx-mi MJXc-space2"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.215em; padding-bottom: 0.479em;">p</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mn>1</mn><mo>−</mo><mi>p</mi></math></span></span><script type="math/tex" id="MathJax-Element-414">1 - p</script></span><span> мы ничего не делаем с элементом матрицы и так и оставляем его в выходе слоя.</span></li>
<li><span>Отметим, что во время обучения стоит домножать выходы слоя на нормировочный коэффициент </span><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-415-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 118%; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mfrac><mn>1</mn><mrow><mn>1</mn><mo>&amp;#x2212;</mo><mi>p</mi></mrow></mfrac></math>" role="presentation"><span id="MJXc-Node-5979" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-5980" class="mjx-mrow"><span id="MJXc-Node-5981" class="mjx-mfrac"><span class="mjx-box MJXc-stacked" style="width: 1.401em; padding: 0px 0.12em;"><span class="mjx-numerator" style="font-size: 70.7%; width: 1.981em; top: -1.299em;"><span id="MJXc-Node-5982" class="mjx-mn" style=""><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.373em; padding-bottom: 0.32em;">1</span></span></span><span class="mjx-denominator" style="font-size: 70.7%; width: 1.981em; bottom: -0.786em;"><span id="MJXc-Node-5983" class="mjx-mrow" style=""><span id="MJXc-Node-5984" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.373em; padding-bottom: 0.32em;">1</span></span><span id="MJXc-Node-5985" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.32em; padding-bottom: 0.426em;">−</span></span><span id="MJXc-Node-5986" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.215em; padding-bottom: 0.479em;">p</span></span></span></span><span style="border-bottom-width: 1.3px; border-bottom-style: solid; top: -0.283em; width: 1.401em;" class="mjx-line"></span></span><span style="height: 1.475em; vertical-align: -0.556em;" class="mjx-vsize"></span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mfrac><mn>1</mn><mrow><mn>1</mn><mo>−</mo><mi>p</mi></mrow></mfrac></math></span></span><script type="math/tex" id="MathJax-Element-415">\frac{1}{1 - p}</script></span><span> чтобы не менять среднее выборки (так модель становится более устойчивой).</span></li>
<li><span>Во время эксплуатации модели (inference) этот слой не делает ничего, чтобы использовать полную информацию о выборке.</span><br>
<img src="https://i.imgur.com/uJG0dGL.png" alt=""></li>
</ul><h3 id="23-Как-Dropout-и-BatchNorm-меняют-свое-поведение-при-эксплуатации-модели-в-режиме-inference" data-id="23-Как-Dropout-и-BatchNorm-меняют-свое-поведение-при-эксплуатации-модели-в-режиме-inference"><a class="anchor hidden-xs" href="#23-Как-Dropout-и-BatchNorm-меняют-свое-поведение-при-эксплуатации-модели-в-режиме-inference" title="23-Как-Dropout-и-BatchNorm-меняют-свое-поведение-при-эксплуатации-модели-в-режиме-inference"><span class="octicon octicon-link"></span></a><span>23. Как Dropout и BatchNorm меняют свое поведение при эксплуатации модели (в режиме inference)?</span></h3><ul>
<li><span>Dropout — слой нейронной сети, который регуляризует нашу модель.</span>
<ul>
<li><span>Во время эксплуатации модели (inference) этот слой не делает ничего, чтобы использовать полную информацию о выборке.</span></li>
<li><span>Отметим, что во время обучения стоит домножать выходы слоя на нормировочный коэффициент </span><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-416-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 118%; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mfrac><mn>1</mn><mrow><mn>1</mn><mo>&amp;#x2212;</mo><mi>p</mi></mrow></mfrac></math>" role="presentation"><span id="MJXc-Node-5987" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-5988" class="mjx-mrow"><span id="MJXc-Node-5989" class="mjx-mfrac"><span class="mjx-box MJXc-stacked" style="width: 1.401em; padding: 0px 0.12em;"><span class="mjx-numerator" style="font-size: 70.7%; width: 1.981em; top: -1.299em;"><span id="MJXc-Node-5990" class="mjx-mn" style=""><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.373em; padding-bottom: 0.32em;">1</span></span></span><span class="mjx-denominator" style="font-size: 70.7%; width: 1.981em; bottom: -0.786em;"><span id="MJXc-Node-5991" class="mjx-mrow" style=""><span id="MJXc-Node-5992" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.373em; padding-bottom: 0.32em;">1</span></span><span id="MJXc-Node-5993" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.32em; padding-bottom: 0.426em;">−</span></span><span id="MJXc-Node-5994" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.215em; padding-bottom: 0.479em;">p</span></span></span></span><span style="border-bottom-width: 1.3px; border-bottom-style: solid; top: -0.283em; width: 1.401em;" class="mjx-line"></span></span><span style="height: 1.475em; vertical-align: -0.556em;" class="mjx-vsize"></span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mfrac><mn>1</mn><mrow><mn>1</mn><mo>−</mo><mi>p</mi></mrow></mfrac></math></span></span><script type="math/tex" id="MathJax-Element-416">\frac{1}{1 - p}</script></span><span> чтобы не менять среднее выборки (так модель становится более устойчивой).</span></li>
</ul>
</li>
<li><span>Batch Normalization:</span>
<ul>
<li><span>На обучении считает среднее и дисперсию пришедшей выборки. Затем вычитает среднее и делит на дисперсию (нормализует данные). Затем применяется линейное преобразование — домножение на число и прибавление сдвига [коэффициенты </span><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-417-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 118%; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>b</mi><mo>,</mo><mi>&amp;#x03B3;</mi></math>" role="presentation"><span id="MJXc-Node-5995" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-5996" class="mjx-mrow"><span id="MJXc-Node-5997" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.267em;">b</span></span><span id="MJXc-Node-5998" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="margin-top: -0.156em; padding-bottom: 0.532em;">,</span></span><span id="MJXc-Node-5999" class="mjx-mi MJXc-space1"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.215em; padding-bottom: 0.479em; padding-right: 0.025em;">γ</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>b</mi><mo>,</mo><mi>γ</mi></math></span></span><script type="math/tex" id="MathJax-Element-417">b, \gamma</script></span><span>](оно нужно чтобы BatchNorm мог обучиться быть тождественным преобразованием и вообще обучиться на любые среднее и дисперсию, удобные нейронной сети).</span><br>
<img src="https://i.imgur.com/PGHaaHS.png" alt=""></li>
<li><span>Также во время обучения происходит подсчёт </span><em><span>двигающегося среднего</span></em><span> и </span><em><span>двигающейся дисперсии</span></em><span> с параметром </span><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-418-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 118%; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>&amp;#x03B1;</mi><mo>.</mo></math>" role="presentation"><span id="MJXc-Node-6000" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-6001" class="mjx-mrow"><span id="MJXc-Node-6002" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.215em; padding-bottom: 0.267em;">α</span></span><span id="MJXc-Node-6003" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="margin-top: -0.156em; padding-bottom: 0.32em;">.</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>α</mi><mo>.</mo></math></span></span><script type="math/tex" id="MathJax-Element-418">\alpha.</script></span><br>
<img src="https://i.imgur.com/29VicQe.png" alt=""></li>
<li><span>Так как за одну итерацию сеть видит не всю выборку, а только определённую её часть (батч), то двигающиеся параметры хранят в себе информацию о всей выборке за всё время обучения.</span></li>
<li><span>Во время инференса (при использовании модели, а не обучении) слой BatchNorm не считает среднее и дисперсию выборки, а использует двигающиеся аналоги этих величин.</span></li>
</ul>
</li>
</ul><h3 id="24-Теорема-Байеса" data-id="24-Теорема-Байеса"><a class="anchor hidden-xs" href="#24-Теорема-Байеса" title="24-Теорема-Байеса"><span class="octicon octicon-link"></span></a><span>24. Теорема Байеса.</span></h3><p><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span class="mjx-chtml MJXc-display" style="text-align: center;"><span id="MathJax-Element-419-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 118%; text-align: center; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><mi>P</mi><mo stretchy=&quot;false&quot;>(</mo><mi>A</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>|</mo></mrow><mi>B</mi><mo stretchy=&quot;false&quot;>)</mo><mo>=</mo><mfrac><mrow><mi>P</mi><mo stretchy=&quot;false&quot;>(</mo><mi>B</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>|</mo></mrow><mi>A</mi><mo stretchy=&quot;false&quot;>)</mo><mo>&amp;#x22C5;</mo><mi>P</mi><mo stretchy=&quot;false&quot;>(</mo><mi>A</mi><mo stretchy=&quot;false&quot;>)</mo></mrow><mrow><mi>P</mi><mo stretchy=&quot;false&quot;>(</mo><mi>B</mi><mo stretchy=&quot;false&quot;>)</mo></mrow></mfrac></math>" role="presentation"><span id="MJXc-Node-6004" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-6005" class="mjx-mrow"><span id="MJXc-Node-6006" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.267em; padding-right: 0.109em;">P</span></span><span id="MJXc-Node-6007" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.479em; padding-bottom: 0.585em;">(</span></span><span id="MJXc-Node-6008" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.267em;">A</span></span><span id="MJXc-Node-6009" class="mjx-texatom"><span id="MJXc-Node-6010" class="mjx-mrow"><span id="MJXc-Node-6011" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.479em; padding-bottom: 0.585em;">|</span></span></span></span><span id="MJXc-Node-6012" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.267em;">B</span></span><span id="MJXc-Node-6013" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.479em; padding-bottom: 0.585em;">)</span></span><span id="MJXc-Node-6014" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.056em; padding-bottom: 0.32em;">=</span></span><span id="MJXc-Node-6015" class="mjx-mfrac MJXc-space3"><span class="mjx-box MJXc-stacked" style="width: 6.517em; padding: 0px 0.12em;"><span class="mjx-numerator" style="width: 6.517em; top: -1.526em;"><span id="MJXc-Node-6016" class="mjx-mrow"><span id="MJXc-Node-6017" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.267em; padding-right: 0.109em;">P</span></span><span id="MJXc-Node-6018" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.479em; padding-bottom: 0.585em;">(</span></span><span id="MJXc-Node-6019" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.267em;">B</span></span><span id="MJXc-Node-6020" class="mjx-texatom"><span id="MJXc-Node-6021" class="mjx-mrow"><span id="MJXc-Node-6022" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.479em; padding-bottom: 0.585em;">|</span></span></span></span><span id="MJXc-Node-6023" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.267em;">A</span></span><span id="MJXc-Node-6024" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.479em; padding-bottom: 0.585em;">)</span></span><span id="MJXc-Node-6025" class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.003em; padding-bottom: 0.32em;">⋅</span></span><span id="MJXc-Node-6026" class="mjx-mi MJXc-space2"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.267em; padding-right: 0.109em;">P</span></span><span id="MJXc-Node-6027" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.479em; padding-bottom: 0.585em;">(</span></span><span id="MJXc-Node-6028" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.267em;">A</span></span><span id="MJXc-Node-6029" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.479em; padding-bottom: 0.585em;">)</span></span></span></span><span class="mjx-denominator" style="width: 6.517em; bottom: -1.026em;"><span id="MJXc-Node-6030" class="mjx-mrow"><span id="MJXc-Node-6031" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.267em; padding-right: 0.109em;">P</span></span><span id="MJXc-Node-6032" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.479em; padding-bottom: 0.585em;">(</span></span><span id="MJXc-Node-6033" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.267em;">B</span></span><span id="MJXc-Node-6034" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.479em; padding-bottom: 0.585em;">)</span></span></span></span><span style="border-bottom-width: 1.3px; border-bottom-style: solid; top: -0.283em; width: 6.517em;" class="mjx-line"></span></span><span style="height: 2.551em; vertical-align: -1.026em;" class="mjx-vsize"></span></span></span></span><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mi>P</mi><mo stretchy="false">(</mo><mi>A</mi><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><mi>B</mi><mo stretchy="false">)</mo><mo>=</mo><mfrac><mrow><mi>P</mi><mo stretchy="false">(</mo><mi>B</mi><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><mi>A</mi><mo stretchy="false">)</mo><mo>⋅</mo><mi>P</mi><mo stretchy="false">(</mo><mi>A</mi><mo stretchy="false">)</mo></mrow><mrow><mi>P</mi><mo stretchy="false">(</mo><mi>B</mi><mo stretchy="false">)</mo></mrow></mfrac></math></span></span></span><script type="math/tex; mode=display" id="MathJax-Element-419">
    P(A|B) = \frac{P(B|A) \cdot P(A)}{P(B)}
</script></span></p><p><span>Используя формулу полной вероятности:</span><br>
<span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span class="mjx-chtml MJXc-display" style="text-align: center;"><span id="MathJax-Element-420-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 118%; text-align: center; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><mi>P</mi><mo stretchy=&quot;false&quot;>(</mo><msub><mi>A</mi><mi>j</mi></msub><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>|</mo></mrow><mi>B</mi><mo stretchy=&quot;false&quot;>)</mo><mo>=</mo><mfrac><mrow><mi>P</mi><mo stretchy=&quot;false&quot;>(</mo><mi>B</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>|</mo></mrow><msub><mi>A</mi><mi>j</mi></msub><mo stretchy=&quot;false&quot;>)</mo><mo>&amp;#x22C5;</mo><mi>P</mi><mo stretchy=&quot;false&quot;>(</mo><msub><mi>A</mi><mi>j</mi></msub><mo stretchy=&quot;false&quot;>)</mo></mrow><mrow><munderover><mo movablelimits=&quot;false&quot;>&amp;#x2211;</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>N</mi></munderover><mi>P</mi><mo stretchy=&quot;false&quot;>(</mo><msub><mi>A</mi><mi>i</mi></msub><mo stretchy=&quot;false&quot;>)</mo><mi>P</mi><mo stretchy=&quot;false&quot;>(</mo><mi>B</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>|</mo></mrow><msub><mi>A</mi><mi>i</mi></msub><mo stretchy=&quot;false&quot;>)</mo></mrow></mfrac></math>" role="presentation"><span id="MJXc-Node-6035" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-6036" class="mjx-mrow"><span id="MJXc-Node-6037" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.267em; padding-right: 0.109em;">P</span></span><span id="MJXc-Node-6038" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.479em; padding-bottom: 0.585em;">(</span></span><span id="MJXc-Node-6039" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-6040" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.267em;">A</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-6041" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.426em; padding-bottom: 0.479em;">j</span></span></span></span><span id="MJXc-Node-6042" class="mjx-texatom"><span id="MJXc-Node-6043" class="mjx-mrow"><span id="MJXc-Node-6044" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.479em; padding-bottom: 0.585em;">|</span></span></span></span><span id="MJXc-Node-6045" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.267em;">B</span></span><span id="MJXc-Node-6046" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.479em; padding-bottom: 0.585em;">)</span></span><span id="MJXc-Node-6047" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.056em; padding-bottom: 0.32em;">=</span></span><span id="MJXc-Node-6048" class="mjx-mfrac MJXc-space3"><span class="mjx-box MJXc-stacked" style="width: 7.668em; padding: 0px 0.12em;"><span class="mjx-numerator" style="width: 7.668em; top: -1.562em;"><span id="MJXc-Node-6049" class="mjx-mrow"><span id="MJXc-Node-6050" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.267em; padding-right: 0.109em;">P</span></span><span id="MJXc-Node-6051" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.479em; padding-bottom: 0.585em;">(</span></span><span id="MJXc-Node-6052" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.267em;">B</span></span><span id="MJXc-Node-6053" class="mjx-texatom"><span id="MJXc-Node-6054" class="mjx-mrow"><span id="MJXc-Node-6055" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.479em; padding-bottom: 0.585em;">|</span></span></span></span><span id="MJXc-Node-6056" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-6057" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.267em;">A</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-6058" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.426em; padding-bottom: 0.479em;">j</span></span></span></span><span id="MJXc-Node-6059" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.479em; padding-bottom: 0.585em;">)</span></span><span id="MJXc-Node-6060" class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.003em; padding-bottom: 0.32em;">⋅</span></span><span id="MJXc-Node-6061" class="mjx-mi MJXc-space2"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.267em; padding-right: 0.109em;">P</span></span><span id="MJXc-Node-6062" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.479em; padding-bottom: 0.585em;">(</span></span><span id="MJXc-Node-6063" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-6064" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.267em;">A</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-6065" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.426em; padding-bottom: 0.479em;">j</span></span></span></span><span id="MJXc-Node-6066" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.479em; padding-bottom: 0.585em;">)</span></span></span></span><span class="mjx-denominator" style="width: 7.668em; bottom: -2.607em;"><span id="MJXc-Node-6067" class="mjx-mrow"><span id="MJXc-Node-6068" class="mjx-munderover"><span class="mjx-itable"><span class="mjx-row"><span class="mjx-cell"><span class="mjx-stack"><span class="mjx-over" style="font-size: 70.7%; padding-bottom: 0.258em; padding-top: 0.141em; padding-left: 0.368em;"><span id="MJXc-Node-6075" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.267em; padding-right: 0.085em;">N</span></span></span><span class="mjx-op" style="padding-left: 0.046em;"><span id="MJXc-Node-6069" class="mjx-mo"><span class="mjx-char MJXc-TeX-size1-R" style="padding-top: 0.532em; padding-bottom: 0.532em;">∑</span></span></span></span></span></span><span class="mjx-row"><span class="mjx-under" style="font-size: 70.7%; padding-top: 0.236em; padding-bottom: 0.141em;"><span id="MJXc-Node-6070" class="mjx-texatom" style=""><span id="MJXc-Node-6071" class="mjx-mrow"><span id="MJXc-Node-6072" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.426em; padding-bottom: 0.267em;">i</span></span><span id="MJXc-Node-6073" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.056em; padding-bottom: 0.32em;">=</span></span><span id="MJXc-Node-6074" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.373em; padding-bottom: 0.32em;">1</span></span></span></span></span></span></span></span><span id="MJXc-Node-6076" class="mjx-mi MJXc-space1"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.267em; padding-right: 0.109em;">P</span></span><span id="MJXc-Node-6077" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.479em; padding-bottom: 0.585em;">(</span></span><span id="MJXc-Node-6078" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-6079" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.267em;">A</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-6080" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.426em; padding-bottom: 0.267em;">i</span></span></span></span><span id="MJXc-Node-6081" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.479em; padding-bottom: 0.585em;">)</span></span><span id="MJXc-Node-6082" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.267em; padding-right: 0.109em;">P</span></span><span id="MJXc-Node-6083" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.479em; padding-bottom: 0.585em;">(</span></span><span id="MJXc-Node-6084" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.267em;">B</span></span><span id="MJXc-Node-6085" class="mjx-texatom"><span id="MJXc-Node-6086" class="mjx-mrow"><span id="MJXc-Node-6087" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.479em; padding-bottom: 0.585em;">|</span></span></span></span><span id="MJXc-Node-6088" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-6089" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.267em;">A</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-6090" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.426em; padding-bottom: 0.267em;">i</span></span></span></span><span id="MJXc-Node-6091" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.479em; padding-bottom: 0.585em;">)</span></span></span></span><span style="border-bottom-width: 1.3px; border-bottom-style: solid; top: -0.283em; width: 7.668em;" class="mjx-line"></span></span><span style="height: 4.169em; vertical-align: -2.607em;" class="mjx-vsize"></span></span></span></span><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mi>P</mi><mo stretchy="false">(</mo><msub><mi>A</mi><mi>j</mi></msub><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><mi>B</mi><mo stretchy="false">)</mo><mo>=</mo><mfrac><mrow><mi>P</mi><mo stretchy="false">(</mo><mi>B</mi><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><msub><mi>A</mi><mi>j</mi></msub><mo stretchy="false">)</mo><mo>⋅</mo><mi>P</mi><mo stretchy="false">(</mo><msub><mi>A</mi><mi>j</mi></msub><mo stretchy="false">)</mo></mrow><mrow><munderover><mo movablelimits="false">∑</mo><mrow class="MJX-TeXAtom-ORD"><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>N</mi></munderover><mi>P</mi><mo stretchy="false">(</mo><msub><mi>A</mi><mi>i</mi></msub><mo stretchy="false">)</mo><mi>P</mi><mo stretchy="false">(</mo><mi>B</mi><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><msub><mi>A</mi><mi>i</mi></msub><mo stretchy="false">)</mo></mrow></mfrac></math></span></span></span><script type="math/tex; mode=display" id="MathJax-Element-420">
    P(A_j|B) = \frac{P(B|A_j)\cdot P(A_j)}{\sum\limits_{i = 1}^N P(A_i)P(B|A_i)}
</script></span></p><p><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span class="mjx-chtml MJXc-display" style="text-align: center;"><span id="MathJax-Element-421-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 118%; text-align: center; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><mi>P</mi><mo stretchy=&quot;false&quot;>(</mo><mi>&amp;#x03B8;</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>|</mo></mrow><mi>D</mi><mo stretchy=&quot;false&quot;>)</mo><mo>=</mo><mfrac><mrow><mi>P</mi><mo stretchy=&quot;false&quot;>(</mo><mi>D</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>|</mo></mrow><mi>&amp;#x03B8;</mi><mo stretchy=&quot;false&quot;>)</mo><mo>&amp;#x22C5;</mo><mi>P</mi><mo stretchy=&quot;false&quot;>(</mo><mi>&amp;#x03B8;</mi><mo stretchy=&quot;false&quot;>)</mo></mrow><mrow><munderover><mo>&amp;#x222B;</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>&amp;#x03B8;</mi></mrow><mi>N</mi></munderover><mi>P</mi><mo stretchy=&quot;false&quot;>(</mo><mi>D</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>|</mo></mrow><mi>&amp;#x03B8;</mi><mo stretchy=&quot;false&quot;>)</mo><mi>P</mi><mo stretchy=&quot;false&quot;>(</mo><mi>&amp;#x03B8;</mi><mo stretchy=&quot;false&quot;>)</mo><mi>d</mi><mi>&amp;#x03B8;</mi></mrow></mfrac></math>" role="presentation"><span id="MJXc-Node-6092" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-6093" class="mjx-mrow"><span id="MJXc-Node-6094" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.267em; padding-right: 0.109em;">P</span></span><span id="MJXc-Node-6095" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.479em; padding-bottom: 0.585em;">(</span></span><span id="MJXc-Node-6096" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.267em;">θ</span></span><span id="MJXc-Node-6097" class="mjx-texatom"><span id="MJXc-Node-6098" class="mjx-mrow"><span id="MJXc-Node-6099" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.479em; padding-bottom: 0.585em;">|</span></span></span></span><span id="MJXc-Node-6100" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.267em;">D</span></span><span id="MJXc-Node-6101" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.479em; padding-bottom: 0.585em;">)</span></span><span id="MJXc-Node-6102" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.056em; padding-bottom: 0.32em;">=</span></span><span id="MJXc-Node-6103" class="mjx-mfrac MJXc-space3"><span class="mjx-box MJXc-stacked" style="width: 7.194em; padding: 0px 0.12em;"><span class="mjx-numerator" style="width: 7.194em; top: -1.526em;"><span id="MJXc-Node-6104" class="mjx-mrow"><span id="MJXc-Node-6105" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.267em; padding-right: 0.109em;">P</span></span><span id="MJXc-Node-6106" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.479em; padding-bottom: 0.585em;">(</span></span><span id="MJXc-Node-6107" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.267em;">D</span></span><span id="MJXc-Node-6108" class="mjx-texatom"><span id="MJXc-Node-6109" class="mjx-mrow"><span id="MJXc-Node-6110" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.479em; padding-bottom: 0.585em;">|</span></span></span></span><span id="MJXc-Node-6111" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.267em;">θ</span></span><span id="MJXc-Node-6112" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.479em; padding-bottom: 0.585em;">)</span></span><span id="MJXc-Node-6113" class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.003em; padding-bottom: 0.32em;">⋅</span></span><span id="MJXc-Node-6114" class="mjx-mi MJXc-space2"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.267em; padding-right: 0.109em;">P</span></span><span id="MJXc-Node-6115" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.479em; padding-bottom: 0.585em;">(</span></span><span id="MJXc-Node-6116" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.267em;">θ</span></span><span id="MJXc-Node-6117" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.479em; padding-bottom: 0.585em;">)</span></span></span></span><span class="mjx-denominator" style="width: 7.194em; bottom: -2.745em;"><span id="MJXc-Node-6118" class="mjx-mrow"><span id="MJXc-Node-6119" class="mjx-munderover"><span class="mjx-itable"><span class="mjx-row"><span class="mjx-cell"><span class="mjx-stack"><span class="mjx-over" style="font-size: 70.7%; padding-bottom: 0.258em; padding-top: 0.141em; padding-left: 0.15em;"><span id="MJXc-Node-6124" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.267em; padding-right: 0.085em;">N</span></span></span><span class="mjx-op"><span id="MJXc-Node-6120" class="mjx-mo" style="padding-right: 0.138em;"><span class="mjx-char MJXc-TeX-size1-R" style="padding-top: 0.585em; padding-bottom: 0.585em;">∫</span></span></span></span></span></span><span class="mjx-row"><span class="mjx-under" style="font-size: 70.7%; padding-top: 0.236em; padding-bottom: 0.141em; padding-left: 0.035em;"><span id="MJXc-Node-6121" class="mjx-texatom" style=""><span id="MJXc-Node-6122" class="mjx-mrow"><span id="MJXc-Node-6123" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.267em;">θ</span></span></span></span></span></span></span></span><span id="MJXc-Node-6125" class="mjx-mi MJXc-space1"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.267em; padding-right: 0.109em;">P</span></span><span id="MJXc-Node-6126" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.479em; padding-bottom: 0.585em;">(</span></span><span id="MJXc-Node-6127" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.267em;">D</span></span><span id="MJXc-Node-6128" class="mjx-texatom"><span id="MJXc-Node-6129" class="mjx-mrow"><span id="MJXc-Node-6130" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.479em; padding-bottom: 0.585em;">|</span></span></span></span><span id="MJXc-Node-6131" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.267em;">θ</span></span><span id="MJXc-Node-6132" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.479em; padding-bottom: 0.585em;">)</span></span><span id="MJXc-Node-6133" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.267em; padding-right: 0.109em;">P</span></span><span id="MJXc-Node-6134" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.479em; padding-bottom: 0.585em;">(</span></span><span id="MJXc-Node-6135" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.267em;">θ</span></span><span id="MJXc-Node-6136" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.479em; padding-bottom: 0.585em;">)</span></span><span id="MJXc-Node-6137" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.267em; padding-right: 0.003em;">d</span></span><span id="MJXc-Node-6138" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.479em; padding-bottom: 0.267em;">θ</span></span></span></span><span style="border-bottom-width: 1.3px; border-bottom-style: solid; top: -0.283em; width: 7.194em;" class="mjx-line"></span></span><span style="height: 4.27em; vertical-align: -2.745em;" class="mjx-vsize"></span></span></span></span><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mi>P</mi><mo stretchy="false">(</mo><mi>θ</mi><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><mi>D</mi><mo stretchy="false">)</mo><mo>=</mo><mfrac><mrow><mi>P</mi><mo stretchy="false">(</mo><mi>D</mi><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><mi>θ</mi><mo stretchy="false">)</mo><mo>⋅</mo><mi>P</mi><mo stretchy="false">(</mo><mi>θ</mi><mo stretchy="false">)</mo></mrow><mrow><munderover><mo>∫</mo><mrow class="MJX-TeXAtom-ORD"><mi>θ</mi></mrow><mi>N</mi></munderover><mi>P</mi><mo stretchy="false">(</mo><mi>D</mi><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><mi>θ</mi><mo stretchy="false">)</mo><mi>P</mi><mo stretchy="false">(</mo><mi>θ</mi><mo stretchy="false">)</mo><mi>d</mi><mi>θ</mi></mrow></mfrac></math></span></span></span><script type="math/tex; mode=display" id="MathJax-Element-421">
    P(\theta|D) = \frac{P(D|\theta)\cdot P(\theta)}{\int\limits_{\theta}^N P(D|\theta)P(\theta)d\theta}
</script></span></p><hr class="footnotes-sep"><section class="footnotes">
<ol class="footnotes-list">
<li id="fn1" class="footnote-item"><p><a href="https://github.com/ml-mipt/ml-mipt/blob/basic_s20/program_basic_s20.pdf" target="_blank" rel="noopener"><span>Questions</span></a> <a href="#fnref1" class="footnote-backref">↩︎</a></p>
</li>
</ol>
</section></div>
    <div class="ui-toc dropup unselectable hidden-print" style="display:none;">
        <div class="pull-right dropdown">
            <a id="tocLabel" class="ui-toc-label btn btn-default" data-toggle="dropdown" href="#" role="button" aria-haspopup="true" aria-expanded="false" title="Table of content">
                <i class="fa fa-bars"></i>
            </a>
            <ul id="ui-toc" class="ui-toc-dropdown dropdown-menu" aria-labelledby="tocLabel">
                <div class="toc"><ul class="nav">
<li class=""><a href="#Экзамен-по-машинному-обучению-ФПМИ1" title="Экзамен по машинному обучению ФПМИ[1]">Экзамен по машинному обучению ФПМИ[1]</a><ul class="nav">
<li><a href="#Список-тем" title="Список тем">Список тем</a><ul class="nav">
<li><a href="#1-Метрики-качества-классификации-accuracy-balanced-accuracy-precision-recall-f1-score-w-multiclass-extensions-ROC-AUC" title="1. Метрики качества классификации: accuracy, balanced accuracy, precision, recall, f1-score (/w multiclass extensions), ROC-AUC.">1. Метрики качества классификации: accuracy, balanced accuracy, precision, recall, f1-score (/w multiclass extensions), ROC-AUC.</a></li>
<li><a href="#2-Метрики-качества-регрессии-MSE-MAE-R2-другие" title="2. Метрики качества регрессии: MSE, MAE, R2, другие.">2. Метрики качества регрессии: MSE, MAE, R2, другие.</a></li>
<li><a href="#3-Линейная-регрессия-Постановка-задачи-Аналитическое-решение-МНК-оптимальность-оценки-теорема-Гаусса-Маркова-формулировка-Градиентное-решение-задачи" title="3. Линейная регрессия. Постановка задачи. Аналитическое решение МНК, оптимальность оценки, теорема Гаусса-Маркова (формулировка). Градиентное решение задачи.">3. Линейная регрессия. Постановка задачи. Аналитическое решение МНК, оптимальность оценки, теорема Гаусса-Маркова (формулировка). Градиентное решение задачи.</a></li>
<li><a href="#4-Логистическая-регрессия-Эквивалентность-решений-полученных-методом-максимального-правдоподобия-и-минимизации-логистической-функции-потерь" title="4. Логистическая регрессия. Эквивалентность решений полученных методом максимального правдоподобия и минимизации логистической функции потерь.">4. Логистическая регрессия. Эквивалентность решений полученных методом максимального правдоподобия и минимизации логистической функции потерь.</a></li>
<li><a href="#5-Bias-Variance-tradeoff" title="5. Bias-Variance tradeoff.">5. Bias-Variance tradeoff.</a></li>
<li><a href="#6-Проблема-несбалансированных-классов" title="6. Проблема несбалансированных классов.">6. Проблема несбалансированных классов.</a></li>
<li><a href="#7-Задача-снижения-размерности-Алгоритм-PCA-Связь-с-SVD-теорема-Эккарта-Янга-формулировка" title="7. Задача снижения размерности. Алгоритм PCA. Связь с SVD, теорема Эккарта-Янга (формулировка).">7. Задача снижения размерности. Алгоритм PCA. Связь с SVD, теорема Эккарта-Янга (формулировка).</a></li>
<li><a href="#8-Понятие-информации-информационной-энтропии-Критерии-информативности-энтропийный-Джини" title="8. Понятие информации, информационной энтропии. Критерии информативности: энтропийный, Джини.">8. Понятие информации, информационной энтропии. Критерии информативности: энтропийный, Джини.</a></li>
<li><a href="#9-Процедура-bootstrap-Бэггинг-Метод-случайных-подпространств-Смесь-моделей-и-смесь-экспертов-декларативно" title="9. Процедура bootstrap. Бэггинг. Метод случайных подпространств. Смесь моделей и смесь экспертов (декларативно).">9. Процедура bootstrap. Бэггинг. Метод случайных подпространств. Смесь моделей и смесь экспертов (декларативно).</a></li>
<li><a href="#10-Random-Forest" title="10. Random Forest.">10. Random Forest.</a></li>
<li><a href="#11-Бустинг-Градиентный-бустинг" title="11. Бустинг. Градиентный бустинг.">11. Бустинг. Градиентный бустинг.</a></li>
<li><a href="#12-Матричные-вычисления-Матричное-дифференцирование-Производные-основных-функций-aTx-Ax" title="12. Матричные вычисления. Матричное дифференцирование. Производные основных функций: aTx,Ax.aTx,Ax.a^Tx, Ax.">12. Матричные вычисления. Матричное дифференцирование. Производные основных функций: aTx,Ax." role="presentation"&gt;aTx,Ax.aTx,Ax.a^Tx, Ax.</a></li>
<li><a href="#13-Backpropagation-Градиентный-спуск-GD-Стохастический-градиентный-спуск-SGD-Adaptive-gradient-methods-Adagrad-adamax-adadelta-RMSprop-Adam" title="13. Backpropagation. Градиентный спуск (GD). Стохастический градиентный спуск (SGD). Adaptive gradient methods. Adagrad, adamax, adadelta. RMSprop. Adam.">13. Backpropagation. Градиентный спуск (GD). Стохастический градиентный спуск (SGD). Adaptive gradient methods. Adagrad, adamax, adadelta. RMSprop. Adam.</a></li>
<li><a href="#14-Neural-network-concept-Fully-connected-networks-Logistic-regression-as-simple-NN-XOR-problem" title="14. Neural network concept. Fully-connected networks. Logistic regression as simple NN. XOR problem.">14. Neural network concept. Fully-connected networks. Logistic regression as simple NN. XOR problem.</a></li>
<li><a href="#15-Losses-for-NNs-logistic-loss-cross-entropy-Softmax-and-Log-softmax-activations-numerical-stability" title="15. Losses for NNs: logistic loss, cross-entropy. Softmax and Log-softmax activations, numerical stability.">15. Losses for NNs: logistic loss, cross-entropy. Softmax and Log-softmax activations, numerical stability.</a></li>
<li><a href="#16-Activation-functions-their-impact-on-the-network-computational-complexity" title="16. Activation functions, their impact on the network, computational complexity.">16. Activation functions, their impact on the network, computational complexity.</a></li>
<li><a href="#17-Matrix-convolution-Convoluational-layer-backpropagation-through-it-1x1-convolutions-comparison-to-Dense-layers-MaxAverage-Pooling" title="17. Matrix convolution. Convoluational layer, backpropagation through it. 1x1 convolutions, comparison to Dense layers. Max/Average Pooling.">17. Matrix convolution. Convoluational layer, backpropagation through it. 1x1 convolutions, comparison to Dense layers. Max/Average Pooling.</a></li>
<li><a href="#18-Seq2-something-Recurrence-as-proxy-to-work-with-local-context" title="18. Seq2 something. Recurrence as proxy to work with local context.">18. Seq2 something. Recurrence as proxy to work with local context.</a></li>
<li><a href="#19-LSTMGRU-memory-concept-gates-ideas" title="19. LSTM/GRU, memory concept, gates ideas.">19. LSTM/GRU, memory concept, gates ideas.</a></li>
<li><a href="#20-Vanishing-gradient-problem-Potential-solutions" title="20. Vanishing gradient problem. Potential solutions.">20. Vanishing gradient problem. Potential solutions.</a></li>
<li><a href="#21-Работа-с-категориальными-признаками-и-пропущенными-значениями-Mean-encoding" title="21. Работа с категориальными признаками и пропущенными значениями. Mean encoding.">21. Работа с категориальными признаками и пропущенными значениями. Mean encoding.</a></li>
<li><a href="#22-Наивный-байесовский-классификатор" title="22. Наивный байесовский классификатор.">22. Наивный байесовский классификатор.</a></li>
<li><a href="#23-Подбор-гиперпараметров-моделей-Кросс-валидация-Утечки-в-процессе-обучения" title="23. Подбор гиперпараметров моделей. Кросс-валидация. Утечки в процессе обучения.">23. Подбор гиперпараметров моделей. Кросс-валидация. Утечки в процессе обучения.</a></li>
<li><a href="#24-Проблема-переобучения-способы-борьбы-с-ней" title="24. Проблема переобучения, способы борьбы с ней.">24. Проблема переобучения, способы борьбы с ней.</a></li>
<li><a href="#25-Регуляризация-в-Supervised-learning-L1-и-L2-регуляризация-Другие-способы-регуляризации-Регуляризация-как-ограниченияprior-на-модель-eg-глубина-и-кол-во-деревьев-Dropout-Batch-normalization-Weights-normalization-Data-augmentation-etc" title="25. Регуляризация в Supervised learning. L1 и L2 регуляризация. Другие способы регуляризации. Регуляризация как ограничения/prior на модель (e.g. глубина и кол-во деревьев, Dropout, Batch-normalization, Weights normalization, Data augmentation etc.)">25. Регуляризация в Supervised learning. L1 и L2 регуляризация. Другие способы регуляризации. Регуляризация как ограничения/prior на модель (e.g. глубина и кол-во деревьев, Dropout, Batch-normalization, Weights normalization, Data augmentation etc.)</a></li>
</ul>
</li>
<li><a href="#Теоретический-минимум" title="Теоретический минимум.">Теоретический минимум.</a><ul class="nav">
<li><a href="#1-Постановка-задачи-обучения-с-учителем-supervised-learning-Отличие-регрессии-от-классификации" title="1. Постановка задачи обучения с учителем (supervised learning). Отличие регрессии от классификации.">1. Постановка задачи обучения с учителем (supervised learning). Отличие регрессии от классификации.</a></li>
<li><a href="#2-Что-такое-объект-целевая-переменная-признак-модель-функционал-ошибки-и-обучение" title="2. Что такое объект, целевая переменная, признак, модель, функционал ошибки и обучение.">2. Что такое объект, целевая переменная, признак, модель, функционал ошибки и обучение.</a></li>
<li><a href="#3-Что-такое-свойство-iid-" title="3. Что такое свойство i.i.d. ?">3. Что такое свойство i.i.d. ?</a></li>
<li><a href="#4-Запишите-формулы-для-линейной-модели-регрессии-и-для-среднеквадратичной-ошибки" title="4. Запишите формулы для линейной модели регрессии и для среднеквадратичной ошибки.">4. Запишите формулы для линейной модели регрессии и для среднеквадратичной ошибки.</a></li>
<li><a href="#5-Что-такое-градиент-Какое-его-свойство-используется-при-минимизации-функций" title="5. Что такое градиент? Какое его свойство используется при минимизации функций?">5. Что такое градиент? Какое его свойство используется при минимизации функций?</a></li>
<li><a href="#6-Запишите-формулу-для-одного-шага-градиентного-спуска-Как-модифицировать-градиентный-спуск-для-очень-большой-выборки" title="6. Запишите формулу для одного шага градиентного спуска. Как модифицировать градиентный спуск для очень большой выборки?">6. Запишите формулу для одного шага градиентного спуска. Как модифицировать градиентный спуск для очень большой выборки?</a></li>
<li><a href="#7-Что-такое-кросс-валидация-На-что-влияет-количество-блоков-в-кросс-валидации" title="7. Что такое кросс-валидация? На что влияет количество блоков в кросс-валидации?">7. Что такое кросс-валидация? На что влияет количество блоков в кросс-валидации?</a></li>
<li><a href="#8-Чем-гиперпараметры-отличаются-от-параметров-Что-является-параметрами-и-гиперпараметрами-в-линейных-моделях-и-в-решающих-деревьях" title="8. Чем гиперпараметры отличаются от параметров? Что является параметрами и гиперпараметрами в линейных моделях и в решающих деревьях?">8. Чем гиперпараметры отличаются от параметров? Что является параметрами и гиперпараметрами в линейных моделях и в решающих деревьях?</a></li>
<li><a href="#9-Что-такое-регуляризация-Чем-на-практике-отличается-L1-регуляризация-от-L2" title="9. Что такое регуляризация? Чем на практике отличается L1-регуляризация от L2?">9. Что такое регуляризация? Чем на практике отличается L1-регуляризация от L2?</a></li>
<li><a href="#10-Запишите-формулу-для-линейной-модели-классификации-Что-такое-отступ" title="10. Запишите формулу для линейной модели классификации. Что такое отступ?">10. Запишите формулу для линейной модели классификации. Что такое отступ?</a></li>
<li><a href="#11-Что-такое-точность-и-полнота" title="11. Что такое точность и полнота?">11. Что такое точность и полнота?</a></li>
<li><a href="#12-Что-такое-ROC-AUC-Как-построить-ROC-кривую" title="12. Что такое ROC-AUC? Как построить ROC-кривую?">12. Что такое ROC-AUC? Как построить ROC-кривую?</a></li>
<li><a href="#13-Запишите-функционал-логистической-регрессии-Как-он-связан-с-методом-максимума-правдоподобия" title="13. Запишите функционал логистической регрессии. Как он связан с методом максимума правдоподобия?">13. Запишите функционал логистической регрессии. Как он связан с методом максимума правдоподобия?</a></li>
<li><a href="#14-Опишите-жадный-алгоритм-обучения-решающего-дерева" title="14. Опишите жадный алгоритм обучения решающего дерева.">14. Опишите жадный алгоритм обучения решающего дерева.</a></li>
<li><a href="#15-Почему-с-помощью-решающего-дерева-можно-достичь-нулевой-ошибки-на-обучающей-выборке-без-повторяющихся-объектов" title="15. Почему с помощью решающего дерева можно достичь нулевой ошибки на обучающей выборке без повторяющихся объектов?">15. Почему с помощью решающего дерева можно достичь нулевой ошибки на обучающей выборке без повторяющихся объектов?</a></li>
<li><a href="#16-Что-такое-bagging" title="16. Что такое bagging?">16. Что такое bagging?</a></li>
<li><a href="#17-Что-такое-случайный-лес-Чем-он-отличается-от-бэггинга-над-решающими-деревьями" title="17. Что такое случайный лес? Чем он отличается от бэггинга над решающими деревьями?">17. Что такое случайный лес? Чем он отличается от бэггинга над решающими деревьями?</a></li>
<li><a href="#18-Как-в-градиентном-бустинге-обучаются-базовые-алгоритмы" title="18. Как в градиентном бустинге обучаются базовые алгоритмы?">18. Как в градиентном бустинге обучаются базовые алгоритмы?</a></li>
<li><a href="#19-Зачем-нужен-backprop-что-такое-производная-вектора-по-вектору" title="19. Зачем нужен backprop, что такое производная вектора по вектору?">19. Зачем нужен backprop, что такое производная вектора по вектору?</a></li>
<li><a href="#20-Опишите-принцип-работы-свёрточного-слоя-CNN" title="20. Опишите принцип работы свёрточного слоя (CNN).">20. Опишите принцип работы свёрточного слоя (CNN).</a></li>
<li><a href="#21-Опишите-принцип-работы-базового-рекуррентного-слоя-RNN" title="21. Опишите принцип работы базового рекуррентного слоя (RNN).">21. Опишите принцип работы базового рекуррентного слоя (RNN).</a></li>
<li><a href="#22-Что-такое-dropout" title="22. Что такое dropout?">22. Что такое dropout?</a></li>
<li><a href="#23-Как-Dropout-и-BatchNorm-меняют-свое-поведение-при-эксплуатации-модели-в-режиме-inference" title="23. Как Dropout и BatchNorm меняют свое поведение при эксплуатации модели (в режиме inference)?">23. Как Dropout и BatchNorm меняют свое поведение при эксплуатации модели (в режиме inference)?</a></li>
<li><a href="#24-Теорема-Байеса" title="24. Теорема Байеса.">24. Теорема Байеса.</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</div><div class="toc-menu"><a class="expand-toggle" href="#">Expand all</a><a class="back-to-top" href="#">Back to top</a><a class="go-to-bottom" href="#">Go to bottom</a></div>
            </ul>
        </div>
    </div>
    <div id="ui-toc-affix" class="ui-affix-toc ui-toc-dropdown unselectable hidden-print" data-spy="affix" style="top:17px;display:none;" null null>
        <div class="toc"><ul class="nav">
<li class=""><a href="#Экзамен-по-машинному-обучению-ФПМИ1" title="Экзамен по машинному обучению ФПМИ[1]">Экзамен по машинному обучению ФПМИ[1]</a><ul class="nav">
<li class=""><a href="#Список-тем" title="Список тем">Список тем</a><ul class="nav">
<li class=""><a href="#1-Метрики-качества-классификации-accuracy-balanced-accuracy-precision-recall-f1-score-w-multiclass-extensions-ROC-AUC" title="1. Метрики качества классификации: accuracy, balanced accuracy, precision, recall, f1-score (/w multiclass extensions), ROC-AUC.">1. Метрики качества классификации: accuracy, balanced accuracy, precision, recall, f1-score (/w multiclass extensions), ROC-AUC.</a></li>
<li><a href="#2-Метрики-качества-регрессии-MSE-MAE-R2-другие" title="2. Метрики качества регрессии: MSE, MAE, R2, другие.">2. Метрики качества регрессии: MSE, MAE, R2, другие.</a></li>
<li><a href="#3-Линейная-регрессия-Постановка-задачи-Аналитическое-решение-МНК-оптимальность-оценки-теорема-Гаусса-Маркова-формулировка-Градиентное-решение-задачи" title="3. Линейная регрессия. Постановка задачи. Аналитическое решение МНК, оптимальность оценки, теорема Гаусса-Маркова (формулировка). Градиентное решение задачи.">3. Линейная регрессия. Постановка задачи. Аналитическое решение МНК, оптимальность оценки, теорема Гаусса-Маркова (формулировка). Градиентное решение задачи.</a></li>
<li><a href="#4-Логистическая-регрессия-Эквивалентность-решений-полученных-методом-максимального-правдоподобия-и-минимизации-логистической-функции-потерь" title="4. Логистическая регрессия. Эквивалентность решений полученных методом максимального правдоподобия и минимизации логистической функции потерь.">4. Логистическая регрессия. Эквивалентность решений полученных методом максимального правдоподобия и минимизации логистической функции потерь.</a></li>
<li><a href="#5-Bias-Variance-tradeoff" title="5. Bias-Variance tradeoff.">5. Bias-Variance tradeoff.</a></li>
<li><a href="#6-Проблема-несбалансированных-классов" title="6. Проблема несбалансированных классов.">6. Проблема несбалансированных классов.</a></li>
<li><a href="#7-Задача-снижения-размерности-Алгоритм-PCA-Связь-с-SVD-теорема-Эккарта-Янга-формулировка" title="7. Задача снижения размерности. Алгоритм PCA. Связь с SVD, теорема Эккарта-Янга (формулировка).">7. Задача снижения размерности. Алгоритм PCA. Связь с SVD, теорема Эккарта-Янга (формулировка).</a></li>
<li><a href="#8-Понятие-информации-информационной-энтропии-Критерии-информативности-энтропийный-Джини" title="8. Понятие информации, информационной энтропии. Критерии информативности: энтропийный, Джини.">8. Понятие информации, информационной энтропии. Критерии информативности: энтропийный, Джини.</a></li>
<li><a href="#9-Процедура-bootstrap-Бэггинг-Метод-случайных-подпространств-Смесь-моделей-и-смесь-экспертов-декларативно" title="9. Процедура bootstrap. Бэггинг. Метод случайных подпространств. Смесь моделей и смесь экспертов (декларативно).">9. Процедура bootstrap. Бэггинг. Метод случайных подпространств. Смесь моделей и смесь экспертов (декларативно).</a></li>
<li><a href="#10-Random-Forest" title="10. Random Forest.">10. Random Forest.</a></li>
<li><a href="#11-Бустинг-Градиентный-бустинг" title="11. Бустинг. Градиентный бустинг.">11. Бустинг. Градиентный бустинг.</a></li>
<li><a href="#12-Матричные-вычисления-Матричное-дифференцирование-Производные-основных-функций-aTx-Ax" title="12. Матричные вычисления. Матричное дифференцирование. Производные основных функций: aTx,Ax.aTx,Ax.a^Tx, Ax.">12. Матричные вычисления. Матричное дифференцирование. Производные основных функций: aTx,Ax." role="presentation"&gt;aTx,Ax.aTx,Ax.a^Tx, Ax.</a></li>
<li><a href="#13-Backpropagation-Градиентный-спуск-GD-Стохастический-градиентный-спуск-SGD-Adaptive-gradient-methods-Adagrad-adamax-adadelta-RMSprop-Adam" title="13. Backpropagation. Градиентный спуск (GD). Стохастический градиентный спуск (SGD). Adaptive gradient methods. Adagrad, adamax, adadelta. RMSprop. Adam.">13. Backpropagation. Градиентный спуск (GD). Стохастический градиентный спуск (SGD). Adaptive gradient methods. Adagrad, adamax, adadelta. RMSprop. Adam.</a></li>
<li><a href="#14-Neural-network-concept-Fully-connected-networks-Logistic-regression-as-simple-NN-XOR-problem" title="14. Neural network concept. Fully-connected networks. Logistic regression as simple NN. XOR problem.">14. Neural network concept. Fully-connected networks. Logistic regression as simple NN. XOR problem.</a></li>
<li><a href="#15-Losses-for-NNs-logistic-loss-cross-entropy-Softmax-and-Log-softmax-activations-numerical-stability" title="15. Losses for NNs: logistic loss, cross-entropy. Softmax and Log-softmax activations, numerical stability.">15. Losses for NNs: logistic loss, cross-entropy. Softmax and Log-softmax activations, numerical stability.</a></li>
<li><a href="#16-Activation-functions-their-impact-on-the-network-computational-complexity" title="16. Activation functions, their impact on the network, computational complexity.">16. Activation functions, their impact on the network, computational complexity.</a></li>
<li><a href="#17-Matrix-convolution-Convoluational-layer-backpropagation-through-it-1x1-convolutions-comparison-to-Dense-layers-MaxAverage-Pooling" title="17. Matrix convolution. Convoluational layer, backpropagation through it. 1x1 convolutions, comparison to Dense layers. Max/Average Pooling.">17. Matrix convolution. Convoluational layer, backpropagation through it. 1x1 convolutions, comparison to Dense layers. Max/Average Pooling.</a></li>
<li><a href="#18-Seq2-something-Recurrence-as-proxy-to-work-with-local-context" title="18. Seq2 something. Recurrence as proxy to work with local context.">18. Seq2 something. Recurrence as proxy to work with local context.</a></li>
<li><a href="#19-LSTMGRU-memory-concept-gates-ideas" title="19. LSTM/GRU, memory concept, gates ideas.">19. LSTM/GRU, memory concept, gates ideas.</a></li>
<li><a href="#20-Vanishing-gradient-problem-Potential-solutions" title="20. Vanishing gradient problem. Potential solutions.">20. Vanishing gradient problem. Potential solutions.</a></li>
<li><a href="#21-Работа-с-категориальными-признаками-и-пропущенными-значениями-Mean-encoding" title="21. Работа с категориальными признаками и пропущенными значениями. Mean encoding.">21. Работа с категориальными признаками и пропущенными значениями. Mean encoding.</a></li>
<li><a href="#22-Наивный-байесовский-классификатор" title="22. Наивный байесовский классификатор.">22. Наивный байесовский классификатор.</a></li>
<li><a href="#23-Подбор-гиперпараметров-моделей-Кросс-валидация-Утечки-в-процессе-обучения" title="23. Подбор гиперпараметров моделей. Кросс-валидация. Утечки в процессе обучения.">23. Подбор гиперпараметров моделей. Кросс-валидация. Утечки в процессе обучения.</a></li>
<li><a href="#24-Проблема-переобучения-способы-борьбы-с-ней" title="24. Проблема переобучения, способы борьбы с ней.">24. Проблема переобучения, способы борьбы с ней.</a></li>
<li><a href="#25-Регуляризация-в-Supervised-learning-L1-и-L2-регуляризация-Другие-способы-регуляризации-Регуляризация-как-ограниченияprior-на-модель-eg-глубина-и-кол-во-деревьев-Dropout-Batch-normalization-Weights-normalization-Data-augmentation-etc" title="25. Регуляризация в Supervised learning. L1 и L2 регуляризация. Другие способы регуляризации. Регуляризация как ограничения/prior на модель (e.g. глубина и кол-во деревьев, Dropout, Batch-normalization, Weights normalization, Data augmentation etc.)">25. Регуляризация в Supervised learning. L1 и L2 регуляризация. Другие способы регуляризации. Регуляризация как ограничения/prior на модель (e.g. глубина и кол-во деревьев, Dropout, Batch-normalization, Weights normalization, Data augmentation etc.)</a></li>
</ul>
</li>
<li><a href="#Теоретический-минимум" title="Теоретический минимум.">Теоретический минимум.</a><ul class="nav">
<li><a href="#1-Постановка-задачи-обучения-с-учителем-supervised-learning-Отличие-регрессии-от-классификации" title="1. Постановка задачи обучения с учителем (supervised learning). Отличие регрессии от классификации.">1. Постановка задачи обучения с учителем (supervised learning). Отличие регрессии от классификации.</a></li>
<li><a href="#2-Что-такое-объект-целевая-переменная-признак-модель-функционал-ошибки-и-обучение" title="2. Что такое объект, целевая переменная, признак, модель, функционал ошибки и обучение.">2. Что такое объект, целевая переменная, признак, модель, функционал ошибки и обучение.</a></li>
<li><a href="#3-Что-такое-свойство-iid-" title="3. Что такое свойство i.i.d. ?">3. Что такое свойство i.i.d. ?</a></li>
<li><a href="#4-Запишите-формулы-для-линейной-модели-регрессии-и-для-среднеквадратичной-ошибки" title="4. Запишите формулы для линейной модели регрессии и для среднеквадратичной ошибки.">4. Запишите формулы для линейной модели регрессии и для среднеквадратичной ошибки.</a></li>
<li><a href="#5-Что-такое-градиент-Какое-его-свойство-используется-при-минимизации-функций" title="5. Что такое градиент? Какое его свойство используется при минимизации функций?">5. Что такое градиент? Какое его свойство используется при минимизации функций?</a></li>
<li><a href="#6-Запишите-формулу-для-одного-шага-градиентного-спуска-Как-модифицировать-градиентный-спуск-для-очень-большой-выборки" title="6. Запишите формулу для одного шага градиентного спуска. Как модифицировать градиентный спуск для очень большой выборки?">6. Запишите формулу для одного шага градиентного спуска. Как модифицировать градиентный спуск для очень большой выборки?</a></li>
<li><a href="#7-Что-такое-кросс-валидация-На-что-влияет-количество-блоков-в-кросс-валидации" title="7. Что такое кросс-валидация? На что влияет количество блоков в кросс-валидации?">7. Что такое кросс-валидация? На что влияет количество блоков в кросс-валидации?</a></li>
<li><a href="#8-Чем-гиперпараметры-отличаются-от-параметров-Что-является-параметрами-и-гиперпараметрами-в-линейных-моделях-и-в-решающих-деревьях" title="8. Чем гиперпараметры отличаются от параметров? Что является параметрами и гиперпараметрами в линейных моделях и в решающих деревьях?">8. Чем гиперпараметры отличаются от параметров? Что является параметрами и гиперпараметрами в линейных моделях и в решающих деревьях?</a></li>
<li><a href="#9-Что-такое-регуляризация-Чем-на-практике-отличается-L1-регуляризация-от-L2" title="9. Что такое регуляризация? Чем на практике отличается L1-регуляризация от L2?">9. Что такое регуляризация? Чем на практике отличается L1-регуляризация от L2?</a></li>
<li><a href="#10-Запишите-формулу-для-линейной-модели-классификации-Что-такое-отступ" title="10. Запишите формулу для линейной модели классификации. Что такое отступ?">10. Запишите формулу для линейной модели классификации. Что такое отступ?</a></li>
<li><a href="#11-Что-такое-точность-и-полнота" title="11. Что такое точность и полнота?">11. Что такое точность и полнота?</a></li>
<li><a href="#12-Что-такое-ROC-AUC-Как-построить-ROC-кривую" title="12. Что такое ROC-AUC? Как построить ROC-кривую?">12. Что такое ROC-AUC? Как построить ROC-кривую?</a></li>
<li><a href="#13-Запишите-функционал-логистической-регрессии-Как-он-связан-с-методом-максимума-правдоподобия" title="13. Запишите функционал логистической регрессии. Как он связан с методом максимума правдоподобия?">13. Запишите функционал логистической регрессии. Как он связан с методом максимума правдоподобия?</a></li>
<li><a href="#14-Опишите-жадный-алгоритм-обучения-решающего-дерева" title="14. Опишите жадный алгоритм обучения решающего дерева.">14. Опишите жадный алгоритм обучения решающего дерева.</a></li>
<li><a href="#15-Почему-с-помощью-решающего-дерева-можно-достичь-нулевой-ошибки-на-обучающей-выборке-без-повторяющихся-объектов" title="15. Почему с помощью решающего дерева можно достичь нулевой ошибки на обучающей выборке без повторяющихся объектов?">15. Почему с помощью решающего дерева можно достичь нулевой ошибки на обучающей выборке без повторяющихся объектов?</a></li>
<li><a href="#16-Что-такое-bagging" title="16. Что такое bagging?">16. Что такое bagging?</a></li>
<li><a href="#17-Что-такое-случайный-лес-Чем-он-отличается-от-бэггинга-над-решающими-деревьями" title="17. Что такое случайный лес? Чем он отличается от бэггинга над решающими деревьями?">17. Что такое случайный лес? Чем он отличается от бэггинга над решающими деревьями?</a></li>
<li><a href="#18-Как-в-градиентном-бустинге-обучаются-базовые-алгоритмы" title="18. Как в градиентном бустинге обучаются базовые алгоритмы?">18. Как в градиентном бустинге обучаются базовые алгоритмы?</a></li>
<li><a href="#19-Зачем-нужен-backprop-что-такое-производная-вектора-по-вектору" title="19. Зачем нужен backprop, что такое производная вектора по вектору?">19. Зачем нужен backprop, что такое производная вектора по вектору?</a></li>
<li><a href="#20-Опишите-принцип-работы-свёрточного-слоя-CNN" title="20. Опишите принцип работы свёрточного слоя (CNN).">20. Опишите принцип работы свёрточного слоя (CNN).</a></li>
<li><a href="#21-Опишите-принцип-работы-базового-рекуррентного-слоя-RNN" title="21. Опишите принцип работы базового рекуррентного слоя (RNN).">21. Опишите принцип работы базового рекуррентного слоя (RNN).</a></li>
<li><a href="#22-Что-такое-dropout" title="22. Что такое dropout?">22. Что такое dropout?</a></li>
<li><a href="#23-Как-Dropout-и-BatchNorm-меняют-свое-поведение-при-эксплуатации-модели-в-режиме-inference" title="23. Как Dropout и BatchNorm меняют свое поведение при эксплуатации модели (в режиме inference)?">23. Как Dropout и BatchNorm меняют свое поведение при эксплуатации модели (в режиме inference)?</a></li>
<li><a href="#24-Теорема-Байеса" title="24. Теорема Байеса.">24. Теорема Байеса.</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</div><div class="toc-menu"><a class="expand-toggle" href="#">Expand all</a><a class="back-to-top" href="#">Back to top</a><a class="go-to-bottom" href="#">Go to bottom</a></div>
    </div>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.1.1/jquery.min.js" integrity="sha256-hVVnYaiADRTO2PzUGmuLJr8BLUSjGIZsDYGmIJLv2b8=" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous" defer></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/gist-embed/2.6.0/gist-embed.min.js" integrity="sha256-KyF2D6xPIJUW5sUDSs93vWyZm+1RzIpKCexxElmxl8g=" crossorigin="anonymous" defer></script>
    <script>
        var markdown = $(".markdown-body");
        //smooth all hash trigger scrolling
        function smoothHashScroll() {
            var hashElements = $("a[href^='#']").toArray();
            for (var i = 0; i < hashElements.length; i++) {
                var element = hashElements[i];
                var $element = $(element);
                var hash = element.hash;
                if (hash) {
                    $element.on('click', function (e) {
                        // store hash
                        var hash = this.hash;
                        if ($(hash).length <= 0) return;
                        // prevent default anchor click behavior
                        e.preventDefault();
                        // animate
                        $('body, html').stop(true, true).animate({
                            scrollTop: $(hash).offset().top
                        }, 100, "linear", function () {
                            // when done, add hash to url
                            // (default click behaviour)
                            window.location.hash = hash;
                        });
                    });
                }
            }
        }

        smoothHashScroll();
        var toc = $('.ui-toc');
        var tocAffix = $('.ui-affix-toc');
        var tocDropdown = $('.ui-toc-dropdown');
        //toc
        tocDropdown.click(function (e) {
            e.stopPropagation();
        });

        var enoughForAffixToc = true;

        function generateScrollspy() {
            $(document.body).scrollspy({
                target: ''
            });
            $(document.body).scrollspy('refresh');
            if (enoughForAffixToc) {
                toc.hide();
                tocAffix.show();
            } else {
                tocAffix.hide();
                toc.show();
            }
            $(document.body).scroll();
        }

        function windowResize() {
            //toc right
            var paddingRight = parseFloat(markdown.css('padding-right'));
            var right = ($(window).width() - (markdown.offset().left + markdown.outerWidth() - paddingRight));
            toc.css('right', right + 'px');
            //affix toc left
            var newbool;
            var rightMargin = (markdown.parent().outerWidth() - markdown.outerWidth()) / 2;
            //for ipad or wider device
            if (rightMargin >= 133) {
                newbool = true;
                var affixLeftMargin = (tocAffix.outerWidth() - tocAffix.width()) / 2;
                var left = markdown.offset().left + markdown.outerWidth() - affixLeftMargin;
                tocAffix.css('left', left + 'px');
            } else {
                newbool = false;
            }
            if (newbool != enoughForAffixToc) {
                enoughForAffixToc = newbool;
                generateScrollspy();
            }
        }
        $(window).resize(function () {
            windowResize();
        });
        $(document).ready(function () {
            windowResize();
            generateScrollspy();
        });

        //remove hash
        function removeHash() {
            window.location.hash = '';
        }

        var backtotop = $('.back-to-top');
        var gotobottom = $('.go-to-bottom');

        backtotop.click(function (e) {
            e.preventDefault();
            e.stopPropagation();
            if (scrollToTop)
                scrollToTop();
            removeHash();
        });
        gotobottom.click(function (e) {
            e.preventDefault();
            e.stopPropagation();
            if (scrollToBottom)
                scrollToBottom();
            removeHash();
        });

        var toggle = $('.expand-toggle');
        var tocExpand = false;

        checkExpandToggle();
        toggle.click(function (e) {
            e.preventDefault();
            e.stopPropagation();
            tocExpand = !tocExpand;
            checkExpandToggle();
        })

        function checkExpandToggle () {
            var toc = $('.ui-toc-dropdown .toc');
            var toggle = $('.expand-toggle');
            if (!tocExpand) {
                toc.removeClass('expand');
                toggle.text('Expand all');
            } else {
                toc.addClass('expand');
                toggle.text('Collapse all');
            }
        }

        function scrollToTop() {
            $('body, html').stop(true, true).animate({
                scrollTop: 0
            }, 100, "linear");
        }

        function scrollToBottom() {
            $('body, html').stop(true, true).animate({
                scrollTop: $(document.body)[0].scrollHeight
            }, 100, "linear");
        }
    </script>
</body>

</html>
